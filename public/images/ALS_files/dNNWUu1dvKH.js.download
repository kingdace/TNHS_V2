;/*FB_PKG_DELIM*/

__d("LSFetchOccamThreadIfNeeded",["LSIssueNewTask"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(n){return t.count(t.db.table(9).fetch([[[e[0]]]])).then(function(e){return r[0]=e})},function(o){return t.i64.eq(r[0],t.i64.cast([0,0]))?(r[1]=new t.Map,r[1].set("thread_fbid",e[0]),r[1].set("force_upsert",!1),r[1].set("use_open_messenger_transport",!1),r[1].set("sync_group",t.i64.cast([0,95])),r[1].set("metadata_only",!1),r[1].set("preview_only",!1),r[2]=r[1].get("thread_fbid"),r[3]=t.toJSON(r[1]),t.storedProcedure(n("LSIssueNewTask"),t.i64.to_string(r[2]),t.i64.cast([0,209]),r[3],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))):t.resolve((function(e){t.logger(e).info(e)})("Thread already exists."))}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSE2EEMessagingMetadataMailboxFetchOccamThreadIfNeededStoredProcedure",e.__tables__=["threads"],a.exports=e}),null);