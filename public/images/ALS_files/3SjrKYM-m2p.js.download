;/*FB_PKG_DELIM*/

__d("E2EEBackupSecretRegisterModule",["E2EEBackupCommon","QuickPerformanceLogger","Random","VestaClient","VestaClientError","VestaClientV2","gkx","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("qpl")._(235865454,"167");function u(){return o("Random").uint32()}function c(t,n,o){var a=u();return(e||(e=r("QuickPerformanceLogger"))).markerStart(s,a),e.markerAnnotate(s,{string:{product_use_case:n.productUseCase,registration_mode:"regular_mode"}},{instanceKey:a}),m(t,n,!1,o,a)}function d(t,n,o){var a=u();return(e||(e=r("QuickPerformanceLogger"))).markerStart(s,a),e.markerAnnotate(s,{string:{product_use_case:n.productUseCase,registration_mode:"re-register_mode"}},{instanceKey:a}),m(t,n,!0,o,a)}async function m(t,n,a,i,l){try{var u=r("gkx")("13570");(e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{bool:{is_wasm_vesta_client_v2:u}},{instanceKey:l});var c=await t.initRegister({clientId:n.clientId,productUseCase:n.productUseCase},i),d=c.isRegistered,m=c.islandEd25519Pub,p=c.islandEd25519PubSig,_=c.islandRsaPub,f=c.islandRsaPubSig;if(e.markerPoint(s,"init_register_network_end",{instanceKey:l}),d&&!a)throw(e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{string:{failure_reason:"ALREADY_REGISTERED"}},{instanceKey:l}),e.markerEnd(s,3376,l),new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.ALREADY_REGISTERED);var g,h;if(u){var y=await Promise.all([o("VestaClientV2").validateHsmKey(_,f),o("VestaClientV2").validateHsmKey(m,p)]);if(g=y[0],h=y[1],!g.success)throw g.error;if(!h.success)throw h.error;g=g.value,h=h.value}else{var C=await Promise.all([o("VestaClient").validateHsmKey(_,f),o("VestaClient").validateHsmKey(m,p)]);g=C[0],h=C[1]}if(!g)throw(e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{string:{failure_reason:"ISLAND_PUB_RSA_KEY_INVALID"}},{instanceKey:l}),e.markerEnd(s,3,l),new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.ISLAND_PUB_RSA_KEY_INVALID);if(!h)throw(e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{string:{failure_reason:"ISLAND_PUB_ED25519_KEY_INVALID"}},{instanceKey:l}),e.markerEnd(s,3,l),new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.ISLAND_PUB_ED25519_KEY_INVALID);e.markerPoint(s,"validate_hsm_keys_client_end",{instanceKey:l});var b=n.vestaAccountPin;if(b==null)throw new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.MISSING_PIN_INPUT);var v=new TextEncoder,S;if(u){if(S=await o("VestaClientV2").beginRegister(v.encode(b)),!S.success)throw S.error;S=S.value}else S=await o("VestaClient").beginRegister(v.encode(b));var R=S,L=R.clientState,E=R.r1Message;(e||(e=r("QuickPerformanceLogger"))).markerPoint(s,"begin_register_client_end",{instanceKey:l});var k=await t.beginRegister({clientId:n.clientId,productUseCase:n.productUseCase,opaqueR1:E},i),I=k.opaqueChallenge,T=k.opaqueR2,D=k.opaqueR2Sig;e.markerPoint(s,"begin_register_network_end",{instanceKey:l});var x;if(u){if(x=await o("VestaClientV2").finishRegister(E,T,D,m,L,n.secret,I,_),!x.success)throw x.error;x=x.value}else x=await o("VestaClient").finishRegister(E,T,D,m,L,n.secret,I,_);var $=x,P=$.registerPayload;e.markerPoint(s,"finish_register_client_end",{instanceKey:l});var N=await t.finishRegister({clientId:n.clientId,productUseCase:n.productUseCase,encRegPayload:P},i),M=N.registerSuccess;if(e.markerPoint(s,"finish_register_network_end",{instanceKey:l}),!M)throw(e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{string:{failure_reason:"VESTA_SERVER_ERROR"}},{instanceKey:l}),e.markerEnd(s,3,l),new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.VESTA_SERVER_ERROR);e.markerEnd(s,2,l)}catch(t){throw t instanceof o("E2EEBackupCommon").BackupError?t:t instanceof r("VestaClientError")?((e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{string:{failure_reason:"VestaClientException: "+t.name}},{instanceKey:l}),e.markerEnd(s,3,l),new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.VESTA_CLIENT_ERROR,t)):((e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{string:{failure_reason:t.message}},{instanceKey:l}),e.markerEnd(s,3,l),new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.NETWORK_PROVIDER_ERROR,t))}}l.registerBackupSecret=c,l.reRegisterBackupSecret=d}),98);
__d("FBIconArrowsCircleFilled12.svg.react",["XPlatReactSVG","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs(o("XPlatReactSVG").Svg,babelHelpers.extends({viewBox:"0 0 12 13",width:"1em",height:"1em",fill:"currentColor",title:e.title},e,{children:[e.children!=null&&s.jsx(o("XPlatReactSVG").Defs,{children:e.children}),s.jsx(o("XPlatReactSVG").G,{fillRule:"evenodd",transform:"translate(-450 -1073)",children:s.jsxs(o("XPlatReactSVG").G,{fillRule:"nonzero",children:[s.jsx(o("XPlatReactSVG").Path,{d:"M99.582 923.359a4.496 4.496 0 0 1-.082-.86 4.485 4.485 0 0 1 1.318-3.181A4.483 4.483 0 0 1 104 918a4.485 4.485 0 0 1 2.886 1.046.75.75 0 1 0 .96-1.151A5.986 5.986 0 0 0 104 916.5a5.983 5.983 0 0 0-4.242 1.757A5.985 5.985 0 0 0 98 922.5c0 .389.037.772.11 1.145a.75.75 0 0 0 1.472-.286zm8.836-1.718a4.485 4.485 0 0 1-1.236 4.041A4.483 4.483 0 0 1 104 927a4.485 4.485 0 0 1-2.884-1.046.75.75 0 1 0-.963 1.15A5.986 5.986 0 0 0 104 928.5a5.983 5.983 0 0 0 4.244-1.756A5.985 5.985 0 0 0 110 922.5c0-.389-.037-.772-.11-1.145a.75.75 0 0 0-1.472.286z",transform:"translate(352 157)"}),s.jsx(o("XPlatReactSVG").Path,{d:"M107 918.5h-1.25a.75.75 0 1 0 0 1.5h2a.75.75 0 0 0 .75-.75v-2a.75.75 0 1 0-1.5 0v1.25zm-6 8h1.25a.75.75 0 1 0 0-1.5h-2a.75.75 0 0 0-.75.75v2a.75.75 0 1 0 1.5 0v-1.25z",transform:"translate(352 157)"})]})})]}))}u.displayName=u.name+" [from "+i.id+"]",u._isSVG=!0;var c=u;l.default=c}),98);
__d("FBNucleusArrowsCircleFilled16Icon.react",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs("svg",babelHelpers.extends({viewBox:"0 0 16 16",width:"1em",height:"1em",fill:"currentColor"},e,{children:[e.title!=null&&s.jsx("title",{children:e.title}),e.children!=null&&s.jsx("defs",{children:e.children}),s.jsx("path",{d:"M13.715 8.64a5.751 5.751 0 0 1-9.32 3.84l.521-.523a1 1 0 0 0-.707-1.707H2.042c-.736 0-1.333.597-1.333 1.333v2.167a1 1 0 0 0 1.707.707l.558-.558a7.751 7.751 0 0 0 12.729-5.04 1 1 0 1 0-1.988-.219zM.297 7.14a1 1 0 1 0 1.988.22 5.751 5.751 0 0 1 9.298-3.857l-.54.54a1 1 0 0 0 .707 1.707h2.167c.736 0 1.333-.597 1.333-1.333V2.25a1 1 0 0 0-1.707-.707l-.539.539A7.751 7.751 0 0 0 .297 7.14z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._size=16,u._isSVG=!0;var c=u;l.default=c}),98);
__d("LSCreateExtraVirtualDevice",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDebugToken.nop","LSCreateDerivedKeys.nop","LSCreateEncryptionKeyPair.nop","LSCreateSignatureKeyPair.nop","LSCreateSignatureWithArmadilloKey.nop","LSCreateSignature_v2.nop","LSGetArmadilloPublicKey.nop","LSGetBlobFromString.nop","LSGetOpenEpochKeys","LSGetViewerFBID","LSHandleCreateVirtualDeviceFailure","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSOcmfClientEvolve_v2.nop","LSParseRecoveryCode_v2.nop","LSSymmetricEncryptionCreateEncryptedString.nop","justknobx"],(function(t,n,r,o,a,i,l){function e(){var e=arguments,t=e[e.length-1],o=[],a=[];return t.sequence([function(i){return t.sequence([function(r){return o[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure] Beginning execution."),t.i64.eq(e[0],t.i64.cast([0,1]))?t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,o[27]=t[0],t})},function(e){return o[27]?o[28]=!0:o[28]=!1,o[28]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),o[30]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",o[30]].join("")),o[29]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",o[30],o[29],t.i64.cast([0,3]))):t.resolve()}]):t.i64.eq(e[0],t.i64.cast([0,2]))?t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,o[27]=t[0],t})},function(e){return o[27]?o[28]=!0:o[28]=!1,o[28]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),o[30]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",o[30]].join("")),o[29]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",o[30],o[29],t.i64.cast([0,3]))):t.resolve()}]):t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,o[27]=t[0],t})},function(e){return o[27]?o[28]=!0:o[28]=!1,o[28]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),o[30]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",o[30]].join("")),o[29]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",o[30],o[29],t.i64.cast([0,3]))):t.resolve()}])},function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,r){var a,i=e.done,l=e.value;return i?(a=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,t.i64.cast([0,1]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,t.i64.cast([0,20]),void 0,void 0],o[1]=a[0],o[2]=a[1],o[3]=a[2],o[4]=a[3],o[5]=a[4],o[6]=a[5],o[7]=a[6],o[8]=a[7],o[9]=a[8],o[10]=a[9],o[11]=a[10],o[12]=a[11],o[13]=a[12],o[14]=a[13],o[15]=a[14],o[16]=a[15],o[17]=a[16],o[18]=a[17],a):(r=l.item,t.sequence([function(e){return o[32]=r.backupTenancy,o[31]=r.encryptionVersion,o[27]=void 0,t.i64.neq(o[27],void 0)?t.resolve(o[28]=o[27]):t.sequence([function(e){return o[33]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,o[34]=t[0],t})},function(e){return o[34]&&(o[43]=(o[33].push(t.i64.cast([0,0])),o[33])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,o[35]=t[0],t})},function(e){return o[35]&&(o[43]=(o[33].push(t.i64.cast([0,2])),o[33])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,o[36]=t[0],t})},function(e){return o[36]&&(o[43]=(o[33].push(t.i64.cast([0,3])),o[33])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,o[37]=t[0],t})},function(e){return o[37]&&(o[43]=(o[33].push(t.i64.cast([0,4])),o[33])),o[38]=t.createArray(),o[39]=t.i64.of_int32(o[33].length),t.i64.gt(o[39],t.i64.cast([0,0]))?t.loopAsync(o[39],function(e){return o[43]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[33],o[43]).then(function(e){var t;return t=e,o[44]=t[0],o[45]=t[1],t})},function(e){return o[46]=(o[38].push(o[44]),o[38])}])}):t.resolve()},function(e){return t.sequence([function(e){return o[43]=t.createArray(),o[44]=t.i64.of_int32(o[38].length),t.i64.gt(o[44],t.i64.cast([0,0]))?t.loopAsync(o[44],function(e){return o[46]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[38],o[46]).then(function(e){var t;return t=e,o[47]=t[0],o[48]=t[1],t})},function(e){return o[49]=(o[43].push(t.i64.to_string(o[47])),o[43])}])}):t.resolve()},function(e){return o[45]=o[43].join(","),o[40]=o[45]}])},function(e){return o[38].some(function(e){return t.i64.eq(o[31],e)})?o[41]=o[31]:o[41]=void 0,t.i64.neq(o[41],void 0)?o[42]=o[41]:o[42]=void 0,o[28]=o[42]}])},function(e){var n;return t.i64.neq(o[28],void 0)?o[29]=o[28]:o[29]=t.i64.cast([0,0]),t.i64.neq(o[32],void 0)?o[30]=o[32]:o[30]=t.i64.cast([0,1]),n=[r.backupId,r.deviceId,r.mailboxRootKeyBlob,r.ocmfClientStateBlob,void 0,void 0,o[29],o[30],r.epochAuthPublicKeyBlob,r.epochAuthPrivateKeyBlob,r.devicePublicKeyBlob,r.devicePrivateKeyBlob,r.epochStoragePublicKeyBlob,r.epochStoragePrivateKeyBlob,r.obliviousValidationTokenBlob,r.authorityLevel,void 0,void 0],o[1]=n[0],o[2]=n[1],o[3]=n[2],o[4]=n[3],o[5]=n[4],o[6]=n[5],o[7]=n[6],o[8]=n[7],o[9]=n[8],o[10]=n[9],o[11]=n[10],o[12]=n[11],o[13]=n[12],o[14]=n[13],o[15]=n[14],o[16]=n[15],o[17]=n[16],o[18]=n[17]}]))})},function(a){return t.i64.neq(o[1],void 0)?t.sequence([function(a){return t.db.table(174).fetch([[[t.i64.cast([0,1])]]]).next().then(function(a,i){var l=a.done,s=a.value;return l?t.sequence([function(e){return t.db.table(178).put({pk:t.i64.cast([0,1]),recoveryCodeStatus:t.i64.cast([0,3])})},function(e){return o[29]="Recovery code not created, will not create extra virtual device",o[29]!==void 0?((function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure] ","",o[29]].join("")),o[30]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure",o[29],o[30],t.i64.cast([0,3]))):t.resolve()},function(e){return o[27]=t.i64.cast([0,1])}]):(i=s.item,t.sequence([function(e){return o[31]=i.recoveryCode,o[32]=i.virtualDeviceType,o[33]=i.cloudServiceAccount,o[34]=i.hsmPinNormalizationStatus,t.db.table(178).put({pk:t.i64.cast([0,1]),recoveryCodeStatus:t.i64.cast([0,1])})},function(e){return t.db.table(168).fetch().next().then(function(e,n){var r=e.done,a=e.value;return r?o[29]=t.i64.cast([0,1]):(n=a.item,o[36]=n.backupTenancy,t.i64.neq(o[36],void 0)?o[35]=o[36]:o[35]=t.i64.cast([0,1]),o[29]=o[35])})},function(a){return t.i64.eq(o[29],t.i64.cast([0,1]))&&o[31]==="1SHADOWTESTINGRECOVERYCODE00000000000000"?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Invalid Recovery Code Used."),o[36]="Invalid Recovery Code Used.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[36]].join("")),o[35]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[36],o[35],t.i64.cast([0,3]))):t.sequence([function(e){return o[35]=t.createArray(),t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,o[36]=t[0],t})},function(e){return t.nativeOperation(n("LSParseRecoveryCode_v2.nop"),o[31],t.i64.to_string(o[36]),o[35]).then(function(e){var t;return t=e,o[37]=t[0],o[38]=t[1],t})},function(a){return t.blobs.neq(o[38],void 0)?t.blobs.neq(o[37],void 0)?t.sequence([function(e){return t.storedProcedure(n("LSGetOpenEpochKeys"),!1).then(function(e){var t;return t=e,o[39]=t[0],t})},function(a){return o[39]!==void 0?t.sequence([function(e){return o[106]=r("justknobx")._("1310"),t.resolve()},function(e){return o[106]?t.resolve():t.sequence([function(e){return t.count(t.db.table(169).fetch()).then(function(e){return o[116]=e})},function(e){return t.i64.gt(o[116],t.i64.cast([0,1]))?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Multiple rows in $epoch_tables."),o[118]="Multiple rows in $epoch_tables.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[118]].join("")),o[117]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[118],o[117],t.i64.cast([0,3]))):t.resolve()}])},function(e){return t.nativeOperation(n("LSCreateSignatureKeyPair.nop")).then(function(e){var t;return t=e,o[40]=t[0],o[41]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateEncryptionKeyPair.nop")).then(function(e){var t;return t=e,o[42]=t[0],o[43]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),o[40],t.blob("MA=="),o[43]).then(function(e){var t;return t=e,o[44]=t[0],t})},function(e){return o[107]=t.blob(""),o[108]=t.blob(""),o[109]=t.blob(""),t.db.table(168).fetch([[[o[1]]]]).next().then(function(e,r){var a,i=e.done,l=e.value;return i?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Row with backupid not found in client state table"),o[117]="Row with backupid not found in client state table",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[117],o[116],t.i64.cast([0,3]))},function(e){var t;return t=[o[107],o[108],void 0,o[109]],o[45]=t[0],o[46]=t[1],o[47]=t[2],o[48]=t[3],t}]):(r=l.item,a=[r.obliviousValidationTokenBlob,r.mailboxRootKeyBlob,r.deviceId,r.ocmfClientStateBlob],o[45]=a[0],o[46]=a[1],o[47]=a[2],o[48]=a[3])})},function(e){return t.blobs.eq(o[45],o[107])?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] oblivious_token is empty!"),o[117]="oblivious_token is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[117],o[116],t.i64.cast([0,3]))):t.resolve()},function(e){return t.blobs.eq(o[46],o[108])?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] mailbox_root_key is empty!"),o[117]="mailbox_root_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[117],o[116],t.i64.cast([0,3]))):t.resolve()},function(e){return t.blobs.eq(o[48],o[109])?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ocmf_client_state is empty!"),o[117]="ocmf_client_state is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[117],o[116],t.i64.cast([0,3]))):t.resolve()},function(e){return o[50]=o[39].get("epoch_anon_id"),o[51]=o[39].get("epoch_root_key"),o[52]=t.createArray(),o[116]=(o[52].push(t.i64.cast([0,32])),o[52]),t.nativeOperation(n("LSBase64Encode.nop"),o[50]).then(function(e){var t;return t=e,o[53]=t[0],t})},function(e){return o[53]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blobs.of_string(["epoch_devices","_",o[53]].join("")),void 0,o[51],o[52]).then(function(e){var t;return t=e,o[116]=t[0],t})},function(e){return o[116]?o[117]=!1:o[117]=!0,o[117]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish"),o[120]="THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[120]].join("")),o[119]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[120],o[119],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[121]=t[0],t})},function(e){return o[118]=o[121]}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[116],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[119]=t[0],o[120]=t[1],t})},function(e){return o[118]=o[119]}])},function(e){return o[54]=o[118]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish"),o[117]="THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[117],o[116],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[118]=t[0],t})},function(e){return o[54]=o[118]}])},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),o[54],o[41]).then(function(e){var t;return t=e,o[55]=t[0],t})},function(e){return t.blobs.neq(o[55],void 0)?t.resolve(o[56]=o[55]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] device_epoch_hmac is null!"),o[117]="device_epoch_hmac is null!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[117],o[116],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[118]=t[0],t})},function(e){return o[56]=o[118]}])},function(e){return o[57]=o[39].get("epoch_root_key"),t.blobs.neq(o[57],void 0)?t.sequence([function(e){return o[116]=t.createArray(),o[122]=(o[116].push(t.i64.cast([0,18])),o[116]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,o[57],o[116]).then(function(e){var t;return t=e,o[117]=t[0],t})},function(e){return o[117]!==void 0?t.sequence([function(e){return o[122]=t.i64.of_int32(o[117].length),t.i64.ge(o[122],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[117],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[124]=t[0],o[125]=t[1],t})},function(e){return o[123]=o[124]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),o[125]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",o[125]].join("")),o[124]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",o[125],o[124],t.i64.cast([0,3]))},function(e){return o[123]=void 0}])},function(e){return o[118]=o[123]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),o[123]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",o[123]].join("")),o[122]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",o[123],o[122],t.i64.cast([0,3]))},function(e){return o[118]=void 0}])},function(e){return t.blobs.neq(o[118],void 0)?o[119]=!0:o[119]=!1,o[119]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),t.nativeOperation(n("LSBase64Encode.nop"),o[118]).then(function(e){var t;return t=e,o[120]=t[0],t})},function(e){return o[120]!==void 0?o[121]=o[120]:o[121]="encodingfailed",o[58]=o[121]}]):t.resolve(o[58]="null")},function(e){return t.nativeOperation(n("LSOcmfClientEvolve_v2.nop"),o[48]).then(function(e){var t;return t=e,o[59]=t[0],o[60]=t[1],t})},function(e){var r;return t.blobs.neq(void 0,void 0)?t.sequence([function(e){return t.nativeOperation(n("LSOcmfClientEvolve_v2.nop"),void 0).then(function(e){var t;return t=e,o[116]=t[0],o[117]=t[1],t})},function(e){var t;return t=[o[59],o[60],o[116],o[117]],o[61]=t[0],o[62]=t[1],o[63]=t[2],o[64]=t[3],t}]):t.resolve((r=[o[59],o[60],void 0,void 0],o[61]=r[0],o[62]=r[1],o[63]=r[2],o[64]=r[3],r))},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[40]).then(function(e){var t;return t=e,o[65]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[38],t.blob("dmlydHVhbF9kZXZpY2U6dmlydHVhbF9kZXZpY2VfcHJpdmF0ZV9rZXk="),o[65]==null?"":o[65]).then(function(e){var t;return t=e,o[66]=t[0],t})},function(e){return o[66]!==void 0?o[67]=o[66]:o[67]="",o[67]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_device_private_key is empty!"),o[117]="encrypted_device_private_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[117],o[116],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[42]).then(function(e){var t;return t=e,o[68]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[38],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfc3RvcmFnZV9wcml2YXRlX2tleQ=="),o[68]==null?"":o[68]).then(function(e){var t;return t=e,o[69]=t[0],t})},function(e){return o[69]!==void 0?o[70]=o[69]:o[70]="",o[70]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_epoch_storage_private_key is empty!"),o[117]="encrypted_epoch_storage_private_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[117],o[116],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[61]).then(function(e){var t;return t=e,o[71]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[38],t.blob("dmlydHVhbF9kZXZpY2U6b2NtZl9jbGllbnRfc3RhdGU="),o[71]==null?"":o[71]).then(function(e){var t;return t=e,o[72]=t[0],t})},function(e){return o[72]!==void 0?o[73]=o[72]:o[73]="",o[73]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_orf_client_state_v1_shape is empty!"),o[117]="encrypted_orf_client_state_v1_shape is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[117],o[116],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[45]).then(function(e){var t;return t=e,o[74]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[38],t.blob("dmlydHVhbF9kZXZpY2U6b2JsaXZpb3VzX3ZhbGlkYXRpb25fdG9rZW4="),o[74]==null?"":o[74]).then(function(e){var t;return t=e,o[75]=t[0],t})},function(e){return o[75]!==void 0?o[76]=o[75]:o[76]="",o[76]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_oblivious_validation_token is empty!"),o[117]="encrypted_oblivious_validation_token is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[117],o[116],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[46]).then(function(e){var t;return t=e,o[77]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[38],t.blob("dmlydHVhbF9kZXZpY2U6bWFpbGJveF9yb290X2tleQ=="),o[77]==null?"":o[77]).then(function(e){var t;return t=e,o[78]=t[0],t})},function(e){return o[78]!==void 0?o[79]=o[78]:o[79]="",o[79]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_mailbox_root_key is empty!"),o[117]="encrypted_mailbox_root_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[117],o[116],t.i64.cast([0,3]))):t.resolve()},function(e){return o[80]=o[39].get("epoch_anon_id"),t.nativeOperation(n("LSBase64Encode.nop"),o[80]).then(function(e){var t;return t=e,o[81]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[38],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfYW5vbl9pZA=="),o[81]==null?"":o[81]).then(function(e){var t;return t=e,o[82]=t[0],t})},function(e){return o[82]!==void 0?o[83]=o[82]:o[83]="",o[83]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_epoch_anon_id is empty!"),o[117]="encrypted_epoch_anon_id is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[117],o[116],t.i64.cast([0,3]))):t.resolve()},function(e){return o[84]=o[39].get("epoch_root_key"),t.nativeOperation(n("LSBase64Encode.nop"),o[84]).then(function(e){var t;return t=e,o[85]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[38],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfcm9vdF9rZXk="),o[85]==null?"":o[85]).then(function(e){var t;return t=e,o[86]=t[0],t})},function(e){return o[86]!==void 0?o[87]=o[86]:o[87]="",o[87]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_epoch_root_key is empty!"),o[117]="encrypted_epoch_root_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[117]].join("")),o[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[117],o[116],t.i64.cast([0,3]))):t.resolve()},function(e){return o[88]=new t.Map,o[88].set("encrypted_device_private_key",o[67]),o[88].set("encrypted_epoch_storage_private_key",o[70]),o[88].set("encrypted_ocmf_client_state",o[73]),o[88].set("encrypted_orf_client_state_v2",void 0),o[88].set("encrypted_oblivious_validation_token_blob",o[76]),o[88].set("encrypted_mailbox_root_key_blob",o[79]),o[88].set("encrypted_epoch_anon_id",o[83]),o[88].set("encrypted_epoch_root_key",o[87]),t.nativeOperation(n("LSBase64Encode.nop"),o[37]).then(function(e){var t;return t=e,o[89]=t[0],t})},function(e){return o[110]=o[89]==null?"":o[89],t.nativeOperation(n("LSBase64Encode.nop"),o[41]).then(function(e){var t;return t=e,o[90]=t[0],t})},function(e){return o[111]=o[90]==null?"":o[90],t.nativeOperation(n("LSBase64Encode.nop"),o[43]).then(function(e){var t;return t=e,o[91]=t[0],t})},function(e){return o[112]=o[91]==null?"":o[91],t.nativeOperation(n("LSBase64Encode.nop"),o[44]==null?t.blob("bnVsbA=="):o[44]).then(function(e){var t;return t=e,o[92]=t[0],t})},function(e){return o[113]=o[92]==null?"":o[92],t.nativeOperation(n("LSBase64Encode.nop"),o[56]).then(function(e){var t;return t=e,o[93]=t[0],t})},function(e){return o[114]=o[93]==null?"":o[93],t.nativeOperation(n("LSBase64Encode.nop"),o[62]).then(function(e){var t;return t=e,o[94]=t[0],t})},function(e){return o[115]=o[94]==null?"":o[94],t.nativeOperation(n("LSGetBlobFromString.nop"),o[31]).then(function(e){var t;return t=e,o[95]=t[0],t})},function(e){return t.blobs.neq(o[46],void 0)?t.sequence([function(e){return o[116]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),o[46],"private_key",o[40],t.i64.cast([0,1]),o[116]).then(function(e){var t;return t=e,o[117]=t[0],t})},function(e){return t.blobs.neq(o[117],void 0)?o[118]=o[117]:o[118]=void 0,o[96]=o[118]}]):t.resolve(o[96]=void 0)},function(e){return t.blobs.neq(o[96],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[96]).then(function(e){var t;return t=e,o[116]=t[0],t})},function(e){return o[97]=o[116]}]):t.resolve(o[97]=void 0)},function(e){return t.blobs.neq(o[46],void 0)?t.sequence([function(e){return o[116]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),o[46],"ocmf_client_state",o[61],t.i64.cast([0,1]),o[116]).then(function(e){var t;return t=e,o[117]=t[0],t})},function(e){return t.blobs.neq(o[117],void 0)?o[118]=o[117]:o[118]=void 0,o[98]=o[118]}]):t.resolve(o[98]=void 0)},function(e){return t.blobs.neq(o[98],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[98]).then(function(e){var t;return t=e,o[116]=t[0],t})},function(e){return o[99]=o[116]}]):t.resolve(o[99]=void 0)},function(e){return t.blobs.neq(o[46],void 0)?t.sequence([function(e){return o[116]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),o[46],"epoch_storage_private_key",o[42],t.i64.cast([0,1]),o[116]).then(function(e){var t;return t=e,o[117]=t[0],t})},function(e){return t.blobs.neq(o[117],void 0)?o[118]=o[117]:o[118]=void 0,o[100]=o[118]}]):t.resolve(o[100]=void 0)},function(e){return t.blobs.neq(o[100],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[100]).then(function(e){var t;return t=e,o[116]=t[0],t})},function(e){return o[101]=o[116]}]):t.resolve(o[101]=void 0)},function(e){return t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,o[102]=t[0],t})},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),t.i64.to_string(o[102])).then(function(e){var t;return t=e,o[103]=t[0],t})},function(e){return t.blobs.neq(o[103],void 0)?t.sequence([function(e){return o[116]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),o[103],"recovery_code",o[95],t.i64.cast([0,1]),o[116]).then(function(e){var t;return t=e,o[117]=t[0],t})},function(e){return t.blobs.neq(o[117],void 0)?o[118]=o[117]:o[118]=void 0,o[104]=o[118]}]):t.resolve(o[104]=void 0)},function(e){return t.blobs.neq(o[104],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[104]).then(function(e){var t;return t=e,o[116]=t[0],t})},function(e){return o[105]=o[116]}]):t.resolve(o[105]=void 0)},function(r){return t.i64.neq(o[47],void 0)?t.sequence([function(e){return o[116]=o[39].get("epoch_id"),t.db.table(168).fetch().next().then(function(e,n){var r=e.done,a=e.value;return r?o[117]=t.i64.cast([0,1]):(n=a.item,o[122]=n.backupTenancy,t.i64.neq(o[122],void 0)?o[121]=o[122]:o[121]=t.i64.cast([0,1]),o[117]=o[121])})},function(e){return t.i64.eq(o[117],t.i64.cast([0,2]))?t.resolve(o[119]=void 0):t.sequence([function(e){return t.nativeOperation(n("LSGetArmadilloPublicKey.nop")).then(function(e){var t;return t=e,o[121]=t[0],t})},function(e){return o[119]=o[121]}])},function(e){return t.blobs.neq(o[119],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSCreateSignatureWithArmadilloKey.nop"),o[41]).then(function(e){var t;return t=e,o[121]=t[0],t})},function(e){return t.blobs.neq(o[121],void 0)?t.resolve(o[122]=o[121]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoKeySigningUtils] Failed to create labyrinth signature"),o[127]="Failed to create labyrinth signature",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoKeySigningUtils] ","",o[127]].join("")),o[126]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoKeySigningUtils",o[127],o[126],t.i64.cast([0,3]))},function(e){return o[122]=void 0}])},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),o[40],t.blob("Mw=="),o[119]).then(function(e){var t;return t=e,o[123]=t[0],t})},function(e){return t.blobs.neq(o[123],void 0)?t.resolve(o[124]=o[123]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoKeySigningUtils] Failed to create armadillo signature"),o[127]="Failed to create armadillo signature",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoKeySigningUtils] ","",o[127]].join("")),o[126]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoKeySigningUtils",o[127],o[126],t.i64.cast([0,3]))},function(e){return o[124]=void 0}])},function(e){return t.blobs.neq(o[124],void 0)?(t.blobs.neq(o[122],void 0)?(o[127]=new t.Map,o[127].set("armadillo_public_key",o[119]),o[127].set("armadillo_key_signature",o[124]),o[127].set("labyrinth_key_signature",o[122]),o[126]=o[127]):o[126]=void 0,o[125]=o[126]):o[125]=void 0,o[120]=o[125]}]):t.resolve(o[120]=void 0)},function(r){return o[120]!==void 0?t.sequence([function(e){return o[121]=o[120].get("armadillo_public_key"),t.nativeOperation(n("LSBase64Encode.nop"),o[121]).then(function(e){var t;return t=e,o[122]=t[0],t})},function(e){return o[123]=o[120].get("armadillo_key_signature"),t.nativeOperation(n("LSBase64Encode.nop"),o[123]).then(function(e){var t;return t=e,o[124]=t[0],t})},function(e){return o[125]=o[120].get("labyrinth_key_signature"),t.nativeOperation(n("LSBase64Encode.nop"),o[125]).then(function(e){var t;return t=e,o[126]=t[0],t})},function(r){return o[127]=new t.Map,o[127].set("backup_id",o[1]),o[127].set("request_device_id",o[47]),o[127].set("virtual_device_id",o[110]),o[127].set("encrypted_secret_values",o[88]),o[127].set("public_key",o[111]),o[127].set("epoch_storage_pubkey",o[112]),o[127].set("epoch_storage_pubkey_sig",o[113]),o[127].set("device_epoch_hmac",o[114]),o[127].set("epoch_root_key_fingerprint",o[58]),o[127].set("ocmf_rotation_token",o[115]),o[127].set("is_init",!1),o[127].set("epoch_id",o[116]),o[127].set("virtual_device_type",o[32]),o[127].set("action_type",e[0]),o[127].set("private_key_debug_token",o[97]),o[127].set("ocmf_client_state_debug_token",o[99]),o[127].set("epoch_storage_pvtkey_debug_token",o[101]),o[127].set("recovery_code_debug_token",o[105]),o[127].set("trace_id",void 0),o[127].set("cloud_service_account",o[33]),o[127].set("hsm_pin_normalization_status",o[34]),o[127].set("security_question_type",void 0),o[127].set("trusted_contact_id",void 0),o[127].set("armadillo_public_key",o[122]==null?"":o[122]),o[127].set("armadillo_key_signature",o[124]==null?"":o[124]),o[127].set("labyrinth_key_signature",o[126]==null?"":o[126]),o[128]=t.toJSON(o[127]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50004]),o[128],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,o[129]=t[0],t})}]):((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] failed to get armadillo key and device signatures"),o[121]=new t.Map,o[121].set("backup_id",o[1]),o[121].set("request_device_id",o[47]),o[121].set("virtual_device_id",o[110]),o[121].set("encrypted_secret_values",o[88]),o[121].set("public_key",o[111]),o[121].set("epoch_storage_pubkey",o[112]),o[121].set("epoch_storage_pubkey_sig",o[113]),o[121].set("device_epoch_hmac",o[114]),o[121].set("epoch_root_key_fingerprint",o[58]),o[121].set("ocmf_rotation_token",o[115]),o[121].set("is_init",!1),o[121].set("epoch_id",o[116]),o[121].set("virtual_device_type",o[32]),o[121].set("action_type",e[0]),o[121].set("private_key_debug_token",o[97]),o[121].set("ocmf_client_state_debug_token",o[99]),o[121].set("epoch_storage_pvtkey_debug_token",o[101]),o[121].set("recovery_code_debug_token",o[105]),o[121].set("trace_id",void 0),o[121].set("cloud_service_account",o[33]),o[121].set("hsm_pin_normalization_status",o[34]),o[121].set("security_question_type",void 0),o[121].set("trusted_contact_id",void 0),o[122]=t.toJSON(o[121]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50004]),o[122],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,o[123]=t[0],t}))}]):t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),o[1],!1,void 0)}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Epoch keys are unavailable."),o[41]="Epoch keys are unavailable.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[41]].join("")),o[40]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[41],o[40],t.i64.cast([0,3]))},function(e){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),o[1],!1,void 0)}])}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Invalid Recovery Code Provided"),o[40]="Invalid Recovery Code Provided",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[40]].join("")),o[39]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[40],o[39],t.i64.cast([0,3]))},function(e){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),o[1],!1,void 0)}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Invalid Recovery Code Provided"),o[40]="Invalid Recovery Code Provided",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[40]].join("")),o[39]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[40],o[39],t.i64.cast([0,3]))},function(e){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),o[1],!1,void 0)}])}])},function(e){return o[27]=t.i64.cast([0,0])}]))})},function(e){return o[20]=o[27]}]):t.sequence([function(e){return t.db.table(178).put({pk:t.i64.cast([0,1]),recoveryCodeStatus:t.i64.cast([0,3])})},function(e){return o[27]="Backup is not initalized",o[27]!==void 0?((function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure] ","",o[27]].join("")),o[28]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure",o[27],o[28],t.i64.cast([0,3]))):t.resolve()},function(e){return t.forEach(t.db.table(174).fetch(),function(e){return e.delete()})},function(e){return o[20]=t.i64.cast([0,1])}])},function(e){return o[21]=t.i64.of_float(Date.now()),o[22]=t.i64.random(),o[24]="Finishing execution. Execution time: ",o[25]=t.i64.to_string(t.i64.sub(o[21],o[0])),o[26]=" ms",o[23]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure] ",o[23],o[24],o[23],o[25],o[23],o[26]].join("")),t.i64.eq(t.i64.mod_(o[22],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(o[27]=",",o[28]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure",[o[24],o[27],o[25],o[27],o[26]].join(""),o[28],t.i64.cast([0,4]))):t.resolve()},function(e){return a[0]=o[20]}])},function(e){return t.resolve(a)}])}e.__sproc_name__="LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_generated_recovery_code","secure_encrypted_backups_recovery_code_status","secure_encrypted_backups_epochs"];var s=e;l.default=s}),98);
__d("LSEncryptedBackupsCreateVirtualDeviceActionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({INSERT:1,UNIQUE_VD_TYPE_INSERT:2});i.default=e}),66);
__d("MAWEncryptedBackupsInitializeBackupDeferred",["EBSMAPI","MWChatEncryptedBackupsQPLEvents","QPLUserFlow","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.onBackupCreationSuccess,n=e.onFailure,a=e.onStart,i=e.qplEventName,l=i===void 0?o("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent:i,s=e.instanceKey,u=e.virtualDeviceType;a==null||a(),r("QPLUserFlow").addPoint(l,"SETUP_INITIALIZE_BACKUP_SPROC_START",{instanceKey:s}),r("promiseDone")(r("EBSMAPI").initializeBackup({virtualDeviceType:u}),function(e){e.success?(r("QPLUserFlow").addPoint(l,"SETUP_INITIALIZE_BACKUP_SPROC_END",{instanceKey:s}),r("QPLUserFlow").addPoint(l,"SETUP_INITIALIZE_BACKUP_END",{instanceKey:s}),t==null||t()):(r("QPLUserFlow").markError(l,"SETUP_INITIALIZE_BACKUP_SPROC_FAILURE",{instanceKey:s}),n())},function(){r("QPLUserFlow").markError(l,"SETUP_INITIALIZE_BACKUP_SPROC_FAILURE",{instanceKey:s}),n()})}l.initializeBackupDeferred=e}),98);
__d("MWChatEncryptedBackupsPinCodeConfirmStepContentWrapper.react",["FocusRegion.react","MWChatEncryptedBackupsNumericCodeErrorWrapper.react","MWChatEncryptedBackupsNumericCodeInput.react","focusScopeQueries","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["error","inputSize","isMessenger"],s,u=s||(s=o("react"));function c(t){var n=o("react-compiler-runtime").c(14),a,i,l;if(n[0]!==t){var s=t.error,c=t.inputSize,d=t.isMessenger,m=babelHelpers.objectWithoutPropertiesLoose(t,e);a=s,l=c,i=m,n[0]=t,n[1]=a,n[2]=i,n[3]=l}else a=n[1],i=n[2],l=n[3];var p=l===void 0?"large":l,_;n[4]!==i||n[5]!==p?(_=u.jsx(r("MWChatEncryptedBackupsNumericCodeInput.react"),babelHelpers.extends({testid:void 0},i,{inputSize:p})),n[4]=i,n[5]=p,n[6]=_):_=n[6];var f;n[7]!==i.focusRegionId||n[8]!==_?(f=u.jsx(o("FocusRegion.react").FocusRegion,{autoFocusQuery:o("focusScopeQueries").tabbableScopeQuery,id:i.focusRegionId,children:_}),n[7]=i.focusRegionId,n[8]=_,n[9]=f):f=n[9];var g;return n[10]!==a||n[11]!==p||n[12]!==f?(g=u.jsx(r("MWChatEncryptedBackupsNumericCodeErrorWrapper.react"),{error:a,inputSize:p,children:f}),n[10]=a,n[11]=p,n[12]=f,n[13]=g):g=n[13],g}l.default=c}),98);
__d("MWEBPinCodeSetupResult",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["SUCCESS","LABYRINTH_ERROR","VESTA_ERROR","DELETE_MAILBOX_ERROR"]);i.CodeSetupResult=e}),66);
__d("MWXIconRefresh",["MWXSvgIcon","SVGIcon","cr:22458","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgIcon(o("SVGIcon").svgIcon(n("cr:22458")),r("gkx")("23219"));l.default=e}),98);
__d("MessengerCheckmark.svg.react",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs("svg",babelHelpers.extends({viewBox:"0 0 36 36",width:"1em",height:"1em",fill:"currentColor"},e,{children:[e.title!=null&&s.jsx("title",{children:e.title}),e.children!=null&&s.jsx("defs",{children:e.children}),s.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M26.378 9.169c.597.347.8 1.112.453 1.709l-9 15.5a1.25 1.25 0 0 1-1.965.256l-6.5-6.5a1.25 1.25 0 1 1 1.768-1.768l5.121 5.121a.25.25 0 0 0 .393-.05L24.67 9.621a1.25 1.25 0 0 1 1.709-.453z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._isSVG=!0;var c=u;l.default=c}),98);
__d("MWEncryptedBackupsCreateExtraVirtualDeviceDeferred",["EBSMAPI","LSEncryptedBackupsCreateVirtualDeviceActionType"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.actionType,n=t===void 0?r("LSEncryptedBackupsCreateVirtualDeviceActionType").INSERT:t,o=e.onFailure,a=e.onSuccess;r("EBSMAPI").addVirtualDevice({actionType:n}).then(function(e){e.success?a():o()})}l.encryptedBackupsCreateExtraVirtualDeviceDeferred=e}),98);
__d("MWEncryptedBackupsGenerateRecoveryCode",["Base64Utils","I64","LSFactory","LSGenerateRecoveryCodeStoredProcedure"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var n=t.db,a=t.virtualDeviceType;return n.runInTransaction(function(t){return r("LSGenerateRecoveryCodeStoredProcedure")(r("LSFactory")(t),{virtualDeviceType:(e||(e=o("I64"))).of_int32(a)})},"readwrite",void 0,void 0,i.id+":31").then(function(e){var t=e[0],n=e[1],r=e[2];return{recoveryCode:t,sprocResult:n,virtualDeviceId:r!=null?o("Base64Utils").fromArrayBuffer(r):void 0}})}l.encryptedBackupsGenerateRecoveryCode=s}),98);
__d("VestaBackupSecretRegister",["requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e=r("requireDeferred")("E2EEBackupSecretRegisterModule").__setRef("VestaBackupSecretRegister"),s=r("requireDeferred")("VestaServerGraphQLRegisterProvider").__setRef("VestaBackupSecretRegister");async function u(t){var n=t.isAlreadyRegistered,r=n===void 0?!1:n,o=t.environment,a=t.input,i=await Promise.all([s.load(),e.load()]),l=i[0],u=l.beginRegister,c=l.finishRegister,d=l.initRegister,m=i[1],p=m.registerBackupSecret,_=m.reRegisterBackupSecret,f=[{beginRegister:u,finishRegister:c,initRegister:d},a,{environment:o}];return r?_.apply(void 0,f):p.apply(void 0,f)}l.vestaBackupSecretRegister=u}),98);
__d("useCreateEncryptedBackup",["CometRelay","FBLogger","LSIntEnum","MAWEncryptedBackupsInitializeBackupDeferred","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEBODSEntityName.enum","MWEncryptedBackupsCreateExtraVirtualDeviceDeferred","MWEncryptedBackupsGenerateRecoveryCode","MWEncryptedBackupsLocalStorageEntryEnum","QPLUserFlow","VestaBackupSecretRegister","getErrorSafe","gkx","promiseDone","requireDeferred","useLabyrinthLogging","useMWEBFlowSourceContext","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("requireDeferred")("MWEncryptedBackupsSharedState").__setRef("useCreateEncryptedBackup"),c=r("requireDeferred")("VestaDeleteAccount").__setRef("useCreateEncryptedBackup");function d(t){var n=t.backupExists,a=t.onInit,i=t.onLabyrinthError,l=t.onSuccess,d=t.onVestaError,m=(s||(s=r("useReStore")))(),p=o("useLabyrinthLogging").useLabyrinthLoggingFlow(),_=p.startFlow,f=r("useMWEBFlowSourceContext")(),g=o("CometRelay").useRelayEnvironment(),h=async function(t,n,a){try{return r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,"ONBOARDING_INIT_BACKUP_START"),await new Promise(function(e,r){return o("MAWEncryptedBackupsInitializeBackupDeferred").initializeBackupDeferred({instanceKey:n,onBackupCreationSuccess:function(){return e()},onFailure:function(){return r()},qplEventName:t,virtualDeviceType:a})}),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,"ONBOARDING_INIT_BACKUP_END"),r("QPLUserFlow").addPoint(t,"success_backup_initialization",{instanceKey:n}),!0}catch(a){var e=r("getErrorSafe")(a);r("QPLUserFlow").markError(o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,"ONBOARDING_INIT_BACKUP_FAILURE"),r("QPLUserFlow").markError(t,"failed_backup_initialization",{instanceKey:n}),r("FBLogger")("wmi_eb").catching(e).mustfix("[labyrinth][onboarding] Error when initializing backup on device using PIN")}return!1},y=async function(t,n){try{return await new Promise(function(e,t){return o("MWEncryptedBackupsCreateExtraVirtualDeviceDeferred").encryptedBackupsCreateExtraVirtualDeviceDeferred({db:m,onFailure:t,onSuccess:e})}),r("QPLUserFlow").addPoint(t,"success_device_verification",{instanceKey:n}),!0}catch(o){var e=r("getErrorSafe")(o);r("QPLUserFlow").markError(t,"failed_device_verification",{instanceKey:n}),r("FBLogger")("wmi_eb").catching(e).mustfix("Error when creating extra virtual device with PIN")}return!1};return async function(t,s,p){s===void 0&&(s=o("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent),a==null||a(),r("QPLUserFlow").addAnnotations(s,{string:{source:f()}},{instanceKey:p});var C;try{_({event:o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_ONBOARDING_AUTH}),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,"ONBOARDING_RECOVERY_CODE_GENERATE_START"),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent,"SETUP_RECOVERY_CODE_GENERATE_START");var b=2,v=await o("MWEncryptedBackupsGenerateRecoveryCode").encryptedBackupsGenerateRecoveryCode({db:m,virtualDeviceType:b}),S=v.recoveryCode,R=v.virtualDeviceId;if(C=R,S==null||R==null){r("FBLogger")("wmi_eb").mustfix("Cannot setup a PIN Code without a recovery code"),r("QPLUserFlow").markError(s,"SETUP_RECOVERY_CODE_GENERATE_FAILURE",{instanceKey:p}),o("MWChatEncryptedBackupsLogging").endFailure({annotations:{string:{errorReason:"ONBOARDING_RECOVERY_CODE_GENERATE_FAILURE"}},errorName:"ONBOARDING_RECOVERY_CODE_GENERATE_FAILURE",event:o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_ONBOARDING_AUTH}),i==null||i();return}var L=new TextEncoder;r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,"ONBOARDING_SAP_VESTA_REGISTRATION_START"),r("QPLUserFlow").addPoint(s,"SETUP_SAP_VESTA_REGISTRATION_START",{instanceKey:p}),await o("VestaBackupSecretRegister").vestaBackupSecretRegister({environment:g,input:{clientId:R,productUseCase:r("gkx")("24066")?"IGD_ENC_BACKUP":"MSGR_ENC_BACKUP",secret:L.encode(S),vestaAccountPin:t}}),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,"ONBOARDING_SAP_VESTA_REGISTRATION_END"),r("QPLUserFlow").addPoint(s,"SETUP_SAP_VESTA_REGISTRATION_END",{instanceKey:p});var E=n?await y(s,p):await h(s,p,(e||(e=o("LSIntEnum"))).ofNumber(b));if(E)u.onReady(function(e){var t=e.upsertEBSharedStateEntry;r("promiseDone")(t({db:m,stateKey:r("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_ONBOARDED_SUCCESSFULLY}))}),l&&l(),o("MWChatEncryptedBackupsLogging").endSuccess({event:o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_ONBOARDING_AUTH}),o("MWChatEncryptedBackupsLogging").endSuccess({annotations:{string:{setup_type:"pin_code"}},event:s,instanceKey:p});else{r("QPLUserFlow").markError(s,"pin_code_create_vd_error",{instanceKey:p}),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,"ONBOARDING_DELETE_VESTA_ACCOUNT_START");var k=await c.load(),I=k.vestaDeleteAccount;I({clientId:R,environment:g,productUseCase:"MSGR_ENC_BACKUP",updater:function(t){var e,n=(e=t.getRootField("fbid_based_auth_layer_vesta_delete_account"))==null?void 0:e.getLinkedRecord("vesta_user_info");if(n!=null){var r;(r=t.getRoot())==null||(r=r.getLinkedRecord("viewer"))==null||(r=r.getLinkedRecord("messenger_default_encrypted_backup"))==null||(r=r.getLinkedRecord("vesta_user_info"))==null||r.copyFieldsFrom(n)}}}),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,"ONBOARDING_DELETE_VESTA_ACCOUNT_END"),o("MWChatEncryptedBackupsLogging").endFailure({annotations:{string:{errorReason:"ONBOARDING_VIRTUAL_DEVICE_CREATE_FAILURE"}},errorName:"ONBOARDING_RECOVERY_CODE_GENERATE_FAILURE",event:o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_ONBOARDING_AUTH}),i==null||i()}}catch(e){var T=r("getErrorSafe")(e);if(C!=null){var D=await c.load(),x=D.vestaDeleteAccount;x({clientId:C,environment:g,productUseCase:"MSGR_ENC_BACKUP",updater:function(t){var e,n=(e=t.getRootField("fbid_based_auth_layer_vesta_delete_account"))==null?void 0:e.getLinkedRecord("vesta_user_info");if(n!=null){var r;(r=t.getRoot())==null||(r=r.getLinkedRecord("viewer"))==null||(r=r.getLinkedRecord("messenger_default_encrypted_backup"))==null||(r=r.getLinkedRecord("vesta_user_info"))==null||r.copyFieldsFrom(n)}}})}r("QPLUserFlow").markError(s,"pin_code_vesta_error",{instanceKey:p}),o("MWChatEncryptedBackupsLogging").endFailure({annotations:{string:{errorReason:T.toString()}},errorName:"ONBOARDING_UNKNOWN_FAILURE",event:o("MWChatEncryptedBackupsQPLEvents").onboardingAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_ONBOARDING_AUTH}),d==null||d(),r("FBLogger")("wmi_eb").catching(T).mustfix("[labyrinth][onboarding] Error when setting the pin code up")}}}l.default=d}),98);
__d("useMWChatEncryptedBackupsOnPinCodeSetup",["fbt","BaseToasterStateManager","FDSCheckmarkCircleFilled24Icon","FDSIcon.react","MWChatEncryptedBackupsQPLEvents","MWEBPinCodeSetupResult","MWEBUseLocalStorage","MWEncryptedBackupsLocalStorageEntryEnum","MWXIconRefresh","MWXIconStrict.react","MessengerCheckmark.svg.react","QPLUserFlow","SVGIcon","mwPushToast","react","react-compiler-runtime","useCreateEncryptedBackup"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useRef,d=r("BaseToasterStateManager").getInstance();function m(e){var t=o("react-compiler-runtime").c(14),n=e.backupExists,a=e.onFinish,i=e.onStart,l=c(null),s;t[0]!==i?(s=function(){l.current=p(l),i()},t[0]=i,t[1]=s):s=t[1];var u,d,m;t[2]!==a?(u=function(){a==null||a(o("MWEBPinCodeSetupResult").CodeSetupResult.LABYRINTH_ERROR),l.current=f(l)},d=function(){a==null||a(o("MWEBPinCodeSetupResult").CodeSetupResult.SUCCESS),o("MWEBUseLocalStorage").mwEBCreateLocalStorageEntry(r("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_SET_UP_IN_CURRENT_SESSION),l.current=_(l)},m=function(){a==null||a(o("MWEBPinCodeSetupResult").CodeSetupResult.VESTA_ERROR),l.current=f(l)},t[2]=a,t[3]=u,t[4]=d,t[5]=m):(u=t[3],d=t[4],m=t[5]);var g;t[6]!==n||t[7]!==s||t[8]!==u||t[9]!==d||t[10]!==m?(g={backupExists:n,onInit:s,onLabyrinthError:u,onSuccess:d,onVestaError:m},t[6]=n,t[7]=s,t[8]=u,t[9]=d,t[10]=m,t[11]=g):g=t[11];var h=r("useCreateEncryptedBackup")(g),y;return t[12]!==h?(y={onPinCodeSetup:h,showErrorToast:function(){l.current=f(l)},showInProgressToast:function(){l.current=p(l)}},t[12]=h,t[13]=y):y=t[13],y}function p(e){if(e.current!=null)return e.current;var t=3600*24*1e3;return r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent,"pin_code_creation_begin_toast"),o("mwPushToast").mwPushToast({icon:{comet:u.jsx(r("MWXIconStrict.react"),{icon:r("MWXIconRefresh"),size:20}),mds:r("MWXIconRefresh").originalComponent},title:s._(/*BTDS*/"Creating your PIN\u2026")},t)}function _(e){return g(e),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent,"pin_code_creation_success_toast"),o("mwPushToast").mwPushToast({icon:{comet:u.jsx(r("FDSIcon.react"),{icon:r("FDSCheckmarkCircleFilled24Icon")}),mds:o("SVGIcon").svgIcon(r("MessengerCheckmark.svg.react"))},testid:"mw-encrypted-backups-pin-code-created-toast",title:s._(/*BTDS*/"PIN created")})}function f(e){return g(e),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent,"pin_code_creation_failed_toast"),o("mwPushToast").mwPushErrorToast({body:s._(/*BTDS*/"Failed to create PIN. Try again.")})}function g(e){e.current!=null&&(d.expire(e.current),e.current=null)}l.default=m}),226);
__d("MWEBOnboardingConfirmPINJewelStep.react",["fbt","MWChatEncryptedBackupsPINInterstitialIcon.react","MWChatEncryptedBackupsPinCodeConfirmStepContentWrapper.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsUpsellJewelChatTabLayout.react","MWEBPinCodeSize","MWXCircleButton.react","MWXColumn.react","MWXColumnItem.react","MWXIconArrowLeft","MWXText.react","promiseDone","react","react-compiler-runtime","useEncryptedBackupsQplImpressionRef","useMWChatEncryptedBackupsNumericCode","useMWChatEncryptedBackupsOnPinCodeSetup","xplatToDOMRef"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c="eb-onboarding-confirm-pin-dialog-step";function d(e){var t=o("react-compiler-runtime").c(37),n=e.enteredPinCode,a=e.onComplete,i=e.onReturn,l=e.setIsMismatchError,d=e.subtitle,m=e.title,p=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent,"ONBOARDING_EB_PIN_CONFIRM_STEP_IMPRESSION"),_;t[0]!==a?(_={backupExists:!1,onStart:a},t[0]=a,t[1]=_):_=t[1];var f=r("useMWChatEncryptedBackupsOnPinCodeSetup")(_),g=f.onPinCodeSetup,h;t[2]!==i||t[3]!==l?(h=function(){l(!0),i()},t[2]=i,t[3]=l,t[4]=h):h=t[4];var y;t[5]!==n||t[6]!==h?(y={onCodeMismatch:h,previouslyInsertedCode:n},t[5]=n,t[6]=h,t[7]=y):y=t[7];var C;t[8]!==g?(C=function(t){r("promiseDone")(g(t,o("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent))},t[8]=g,t[9]=C):C=t[9];var b;t[10]!==y||t[11]!==C?(b={checkPreviouslyInsertedCode:y,focusRegionId:c,inputSize:o("MWEBPinCodeSize").EB_PIN_CODE_SIZE,onComplete:C,type:"pin"},t[10]=y,t[11]=C,t[12]=b):b=t[12];var v=o("useMWChatEncryptedBackupsNumericCode").useMWChatEncryptedBackupsNumericCode(b),S=v[0],R=v[1],L=R.invalidKeyPressedError,E;t[13]===Symbol.for("react.memo_cache_sentinel")?(E=s._(/*BTDS*/"Back"),t[13]=E):E=t[13];var k;t[14]!==i?(k={align:"start",item:u.jsx(r("MWXCircleButton.react"),{color:"primary",icon:r("MWXIconArrowLeft"),label:E,onPress:i,size:32})},t[14]=i,t[15]=k):k=t[15];var I;t[16]!==p?(I=o("xplatToDOMRef").xplatToDOMRef(p),t[16]=p,t[17]=I):I=t[17];var T;t[18]===Symbol.for("react.memo_cache_sentinel")?(T=u.jsx(r("MWXColumnItem.react"),{children:u.jsx(r("MWChatEncryptedBackupsPINInterstitialIcon.react"),{})}),t[18]=T):T=t[18];var D;t[19]===Symbol.for("react.memo_cache_sentinel")?(D={className:"x78zum5 x141feeh"},t[19]=D):D=t[19];var x;t[20]===Symbol.for("react.memo_cache_sentinel")?(x={className:"xpvyfi4 x3ajldb"},t[20]=x):x=t[20];var $;t[21]!==m?($=u.jsx(r("MWXColumnItem.react"),{paddingHorizontal:20,paddingTop:20,children:u.jsx("div",babelHelpers.extends({},D,{children:u.jsx(r("MWXColumnItem.react"),{paddingHorizontal:20,paddingTop:8,verticalAlign:"bottom",children:u.jsx("div",babelHelpers.extends({},x,{children:u.jsx(r("MWXText.react"),{align:"center",type:"headlineEmphasized2",children:m})}))})}))}),t[21]=m,t[22]=$):$=t[22];var P;t[23]!==d?(P=u.jsx(r("MWXColumnItem.react"),{align:"center",paddingHorizontal:16,paddingTop:20,children:u.jsx(r("MWXColumnItem.react"),{paddingVertical:12,children:u.jsx(r("MWXText.react"),{align:"center",color:"secondary",type:"body3",children:d})})}),t[23]=d,t[24]=P):P=t[24];var N;t[25]!==S||t[26]!==L?(N=u.jsx(r("MWXColumnItem.react"),{paddingTop:20,children:u.jsx(r("MWXColumnItem.react"),{align:"center",paddingTop:8,children:u.jsx(r("MWChatEncryptedBackupsPinCodeConfirmStepContentWrapper.react"),babelHelpers.extends({error:L,isMessenger:!1},S,{inputSize:"small"}))})}),t[25]=S,t[26]=L,t[27]=N):N=t[27];var M;t[28]===Symbol.for("react.memo_cache_sentinel")?(M=u.jsx(r("MWXColumn.react"),{paddingVertical:20,children:u.jsx(r("MWXColumnItem.react"),{paddingTop:12,children:u.jsx("div",{className:"xx9tyur"})})}),t[28]=M):M=t[28];var w;t[29]!==$||t[30]!==P||t[31]!==N||t[32]!==I?(w=u.jsxs(r("MWXColumn.react"),{align:"center",paddingHorizontal:16,ref:I,children:[T,$,P,N,M]}),t[29]=$,t[30]=P,t[31]=N,t[32]=I,t[33]=w):w=t[33];var A;return t[34]!==w||t[35]!==k?(A=u.jsx(r("MWChatEncryptedBackupsUpsellJewelChatTabLayout.react"),{size:"large",topItem:k,children:w}),t[34]=w,t[35]=k,t[36]=A):A=t[36],A}l.default=d}),226);
__d("MWFDSRefresh.svg.react",["cr:21756"],(function(t,n,r,o,a,i,l){"use strict";l.default=n("cr:21756")}),98);
__d("VestaDeleteAccountMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="24472846029024529"}),null);
__d("VestaDeleteAccountMutation.graphql",["VestaDeleteAccountMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"delete_account_request",variableName:"input"}],r={alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"VestaDeleteAccountMutation",selections:[{alias:null,args:t,concreteType:"VestaDeleteAccountResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_delete_account",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWChatEncryptedBackupsVestaUserInfo_viewer"},{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"hsm_virtual_device",plural:!1,selections:[r],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"VestaDeleteAccountMutation",selections:[{alias:null,args:t,concreteType:"VestaDeleteAccountResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_delete_account",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_timeout_remaining_secs",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"hsm_virtual_device",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:n("VestaDeleteAccountMutation_facebookRelayOperation"),metadata:{},name:"VestaDeleteAccountMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("VestaDeleteAccount",["CometRelay","VestaDeleteAccountMutation.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var r=t.clientId,a=t.environment,i=t.optimisticUpdater,l=t.productUseCase,s=t.updater,u=e!==void 0?e:e=n("VestaDeleteAccountMutation.graphql");return o("CometRelay").commitMutation(a,{mutation:u,optimisticUpdater:i,updater:s,variables:{input:{fbid:r,product_use_case:l,vesta_client_api_version:6}}})}l.vestaDeleteAccount=s}),98);
__d("VestaServerGraphQLRegisterProviderBeginRegisterMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9596958053703216"}),null);
__d("VestaServerGraphQLRegisterProviderBeginRegisterMutation.graphql",["VestaServerGraphQLRegisterProviderBeginRegisterMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"begin_register_request",variableName:"input"}],concreteType:"VestaBeginRegisterResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_begin_register",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_r2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_challenge",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_r2_sig",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"VestaServerGraphQLRegisterProviderBeginRegisterMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"VestaServerGraphQLRegisterProviderBeginRegisterMutation",selections:t},params:{id:n("VestaServerGraphQLRegisterProviderBeginRegisterMutation_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLRegisterProviderBeginRegisterMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("VestaServerGraphQLRegisterProviderFinishRegisterMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="24657038213948849"}),null);
__d("VestaServerGraphQLRegisterProviderFinishRegisterMutation.graphql",["VestaServerGraphQLRegisterProviderFinishRegisterMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"finish_register_request",variableName:"input"}],r={alias:null,args:null,kind:"ScalarField",name:"register_success",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"VestaServerGraphQLRegisterProviderFinishRegisterMutation",selections:[{alias:null,args:t,concreteType:"VestaFinishRegisterResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_finish_register",plural:!1,selections:[r,{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWChatEncryptedBackupsVestaUserInfo_viewer"},{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"hsm_virtual_device",plural:!1,selections:[o],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"VestaServerGraphQLRegisterProviderFinishRegisterMutation",selections:[{alias:null,args:t,concreteType:"VestaFinishRegisterResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_finish_register",plural:!1,selections:[r,{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_timeout_remaining_secs",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"hsm_virtual_device",plural:!1,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:n("VestaServerGraphQLRegisterProviderFinishRegisterMutation_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLRegisterProviderFinishRegisterMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("VestaServerGraphQLRegisterProviderInitQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="10088892487810238"}),null);
__d("VestaServerGraphQLRegisterProviderInitQuery.graphql",["VestaServerGraphQLRegisterProviderInitQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"request"}],t=[{alias:null,args:[{kind:"Variable",name:"vesta_init_request",variableName:"request"}],concreteType:"VestaInitIqResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_register_init",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_rsa_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_rsa_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_ed25519_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_ed25519_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"VestaServerGraphQLRegisterProviderInitQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"VestaServerGraphQLRegisterProviderInitQuery",selections:t},params:{id:n("VestaServerGraphQLRegisterProviderInitQuery_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLRegisterProviderInitQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("VestaServerGraphQLRegisterProvider",["E2EEBackupUtil","RelayHooks","RelayModern","VestaServerGraphQLRegisterProviderBeginRegisterMutation.graphql","VestaServerGraphQLRegisterProviderFinishRegisterMutation.graphql","VestaServerGraphQLRegisterProviderInitQuery.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;async function c(t,r){var a=r.environment,i=await o("RelayHooks").fetchQuery(a,e!==void 0?e:e=n("VestaServerGraphQLRegisterProviderInitQuery.graphql"),{request:{fbid:t.clientId,product_use_case:t.productUseCase,vesta_client_api_version:6}}).toPromise(),l=i==null?void 0:i.fbid_based_auth_layer_vesta_register_init,s=l==null?void 0:l.base64url_encoded_island_rsa_pub,u=l==null?void 0:l.base64url_encoded_island_rsa_pub_signature,c=l==null?void 0:l.base64url_encoded_opaque_pub,d=l==null?void 0:l.base64url_encoded_opaque_pub_signature,m=l==null?void 0:l.base64url_encoded_island_ed25519_pub,p=l==null?void 0:l.base64url_encoded_island_ed25519_pub_signature,_=l==null?void 0:l.is_registered,f=l==null?void 0:l.attempts_remaining;if(s!=null&&u!=null&&c!=null&&d!=null&&m!=null&&p!=null&&_!=null){var g;return{islandRsaPub:(g=o("E2EEBackupUtil")).decodeBase64Url(s),islandRsaPubSig:g.decodeBase64Url(u),opaquePub:g.decodeBase64Url(c),opaquePubSig:g.decodeBase64Url(d),islandEd25519Pub:g.decodeBase64Url(m),islandEd25519PubSig:g.decodeBase64Url(p),isRegistered:_,loginAttemptsRemaining:f}}throw new Error("GraphQL Response is Null")}function d(e,t){var r=t.environment,a=s!==void 0?s:s=n("VestaServerGraphQLRegisterProviderBeginRegisterMutation.graphql"),i={input:{base64url_encoded_opaque_r1:o("E2EEBackupUtil").encodeBase64Url(e.opaqueR1),fbid:e.clientId,product_use_case:e.productUseCase,vesta_client_api_version:6}};return new Promise(function(e,t){o("RelayModern").commitMutation(r,{mutation:a,variables:i,onCompleted:function(r){var n=r.fbid_based_auth_layer_vesta_begin_register,a=n==null?void 0:n.base64url_encoded_opaque_r2,i=n==null?void 0:n.base64url_encoded_opaque_challenge,l=n==null?void 0:n.base64url_encoded_opaque_r2_sig;if(a!=null&&i!=null&&l!=null){e({opaqueR2:o("E2EEBackupUtil").decodeBase64Url(a),opaqueChallenge:o("E2EEBackupUtil").decodeBase64Url(i),opaqueR2Sig:o("E2EEBackupUtil").decodeBase64Url(l)});return}t(new Error("GraphQL Response is Null"))},onError:function(n){t(n)}})})}function m(e,t){var r=t.environment,a=t.updater;return new Promise(function(t,i){o("RelayModern").commitMutation(r,{mutation:u!==void 0?u:u=n("VestaServerGraphQLRegisterProviderFinishRegisterMutation.graphql"),variables:{input:{base64url_encoded_enc_reg_payload:o("E2EEBackupUtil").encodeBase64Url(e.encRegPayload),fbid:e.clientId,product_use_case:e.productUseCase,vesta_client_api_version:6}},onCompleted:function(n){var e,r=(e=n.fbid_based_auth_layer_vesta_finish_register)==null?void 0:e.register_success;if(r!=null){t({registerSuccess:r});return}i(new Error("GraphQL Response is Null"))},onError:function(t){i(t)},updater:a})})}l.initRegister=c,l.beginRegister=d,l.finishRegister=m}),98);