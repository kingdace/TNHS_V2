;/*FB_PKG_DELIM*/

__d("LSIssueAttachmentsRangeQuery",["LSGetCursor","LSIssueNewTask"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(n){return t.db.table(9).fetch([[[e[0]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[0]=t.i64.cast([0,1]):(n=a.item,r[5]=n.syncGroup,t.i64.neq(r[5],void 0)?r[4]=r[5]:r[4]=t.i64.cast([0,1]),r[0]=r[4])})},function(e){return t.storedProcedure(n("LSGetCursor"),r[0]).then(function(e){var t;return t=e,r[2]=t[0],t})},function(o){return t.db.table(17).fetch([[[e[0],e[1]]]]).next().then(function(o,a){var i=o.done,l=o.value;return i?t.sequence([function(n){return t.db.table(9).fetch([[[e[0]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[4]=t.i64.cast([0,1]):(n=a.item,r[9]=n.syncGroup,t.i64.neq(r[9],void 0)?r[8]=r[9]:r[8]=t.i64.cast([0,1]),r[4]=r[8])})},function(o){return r[6]=new t.Map,r[6].set("thread_key",e[0]),r[6].set("media_group",e[1]),r[6].set("max_timestamp_ms",t.i64.cast([2328,1316134911])),r[6].set("cursor",r[2]),r[6].set("sync_group",r[4]),r[6].set("last_loaded_message_id",void 0),r[7]=t.toJSON(r[6]),t.storedProcedure(n("LSIssueNewTask"),"arq",t.i64.cast([0,105]),r[7],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))}]):(a=l.item,a.hasMoreBefore?t.sequence([function(n){return t.db.table(9).fetch([[[e[0]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[4]=t.i64.cast([0,1]):(n=a.item,r[9]=n.syncGroup,t.i64.neq(r[9],void 0)?r[8]=r[9]:r[8]=t.i64.cast([0,1]),r[4]=r[8])})},function(o){return r[6]=new t.Map,r[6].set("thread_key",e[0]),r[6].set("media_group",e[1]),r[6].set("max_timestamp_ms",a.minTimestampMs),r[6].set("cursor",r[2]),r[6].set("sync_group",r[4]),r[6].set("last_loaded_message_id",void 0),r[7]=t.toJSON(r[6]),t.storedProcedure(n("LSIssueNewTask"),"arq",t.i64.cast([0,105]),r[7],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))}]):t.resolve())})}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxIssueAttachmentsRangeQueryStoredProcedure",e.__tables__=["threads","attachments_ranges_v2__generated"],a.exports=e}),null);
__d("LSIssueAttachmentsRangeQueryStoredProcedure",["LSIssueAttachmentsRangeQuery","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSIssueAttachmentsRangeQuery"),a.threadKey,a.mediaGroup);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("MAWFetchAndPersistMedia",["I64","LSDatabaseSingleton","LSIntEnum","LSMEBTaskCreationSource","MAWJobDefinitions","MAWMediaRestoreEBRange","MAWProtobufDeserializers","MAWRestoreProtobufsFromEncryptedBackupsDeferred","MSGDataclassTypes.flow","MpsMediaToBridge","MpsOverBridge","MpsTypes","ReQL","WAJids","WALogger","WAResultOrError","justknobx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=r("justknobx")._("3177"),m=r("justknobx")._("2538"),p=r("justknobx")._("3916"),_="timeout";function f(e,t,n,r){var a,i=o("MAWMediaRestoreEBRange").getMediaRestoreEBRange(),l=i.getRange(t),s=o("WAJids").threadIdForChatJid(e);if(r==null||r.addAnnotations({bool:{rangeHasMoreBefore:l.hasMoreBefore,rangeIsDefault:l.isDefault===!0}}),l.hasMoreBefore===!1)return Promise.resolve();r==null||r.addPoint("eb_fetch_and_persist_start",{int:{mediaGalleryGroup:n}});var u=l.nextTimestampMsBefore;return y({jid:e,nextTimestampMsBefore:u,numMessages:(a=l.pageSize)!=null?a:d,threadId:s}).then(function(e){var a=e.error;if(e.success===!1)r==null||r.addPoint("eb_fetch_and_persist_error",{string:{error:a}});else{var l;r==null||r.addAnnotations({bool:{responseHasMoreBefore:e.value.cursorInfo.hasNext},int:{responseProtoMessages:(l=e.value.messages)==null?void 0:l.length}})}if(a!==_){var c,d,m,p;i.updateRange(t,{hasMoreBefore:(c=(d=e.value)==null?void 0:d.cursorInfo.hasNext)!=null?c:!1,nextTimestampMsBefore:(m=(p=e.value)==null||(p=p.cursorInfo)==null||(p=p.endCursor)==null?void 0:p[0])!=null?m:o("MpsTypes").toTimestamp(0)})}return g(e,s,t,u).then(function(){return r==null||r.addPoint("eb_fetch_and_persist_end"),h(t,n,{hasMoreBefore:!0})})})}function g(t,n,a,i){if(t.success===!1)return Promise.resolve();var l=t.value,u=l.cursorInfo,c=l.messages;if(c.length===0)return Promise.resolve();var d=c.filter(function(e){var t,n=o("MAWProtobufDeserializers").DeserializedBackupMessage.create(e.toplevelProtobuf.payload).encryptedTransportMessage(),r=n==null?void 0:n.consumerMessage(),a=r!=null&&o("MpsMediaToBridge").getMediaTypeForMessage(r)!=null,i=(n==null||(t=n.armadillo())==null?void 0:t.extendedContentMessage())!=null;return i||a});if(c.length!==d.length){var p=o("MAWMediaRestoreEBRange").getMediaRestoreEBRange();p.updatePageSize(a,m)}return o("MAWRestoreProtobufsFromEncryptedBackupsDeferred").call("AdvancedCrypto",o("MAWJobDefinitions").toThreadJidPrimaryId(n),d.map(o("MAWJobDefinitions").mpsMessageToEncryptedBackupsMessage),u.hasNext,void 0,u.hasPrevious,void 0,!1,void 0,i.toString(),void 0,void 0,(s||(s=o("I64"))).of_int32(r("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE)).catch(function(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["MediaPersist Protobuf error: ",""])),t)})}async function h(e,t,n){var r=await(u||(u=o("LSDatabaseSingleton"))).LSDatabaseSingleton;return r.runInTransaction(async function(a){var i=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(r.tables.attachments_ranges_v2__generated).getKeyRange(e).filter(function(e){return(s||(s=o("I64"))).equal(e.mediaGroup,(c||(c=o("LSIntEnum"))).ofNumber(t))}));if(i!=null){var l=babelHelpers.extends({},i,n);return a.attachments_ranges_v2__generated.upsert([i.threadKey,i.mediaGroup,i.minTimestampMs],l)}},"readwrite","ui",void 0,i.id+":183")}async function y(e){var t,n,r=e.jid,a=e.nextTimestampMsBefore,i=e.numMessages,l=e.threadId,s=o("MpsOverBridge").mps().loadMessages({config:{persistToReverb:"no-persist",shouldFetchSupplementals:!1,shouldFetchTags:!0,shouldIgnoreLocalOnly:!0,strategy:"remote-only",tagsFilter:new Set([o("MSGDataclassTypes.flow").MpsMessageTag.Photo,o("MSGDataclassTypes.flow").MpsMessageTag.Video])},debug:{purpose:"MAWFetchAndPersistMedia"},direction:"desc",from:[o("MpsTypes").toTimestamp(Number(a)),null],numMessages:20,threadId:o("MpsTypes").toThreadId(r)}),u=null,c=await Promise.race([s,new Promise(function(e){u=window.setTimeout(function(){return e(o("WAResultOrError").makeError(_))},p)})]);if(window.clearTimeout(u),c.success===!1)return c;var d=c.value.cursorInfo,f=(t=(n=d.endCursor)==null?void 0:n[0])!=null?t:o("MpsTypes").toTimestamp(0);return a===f?i===m?o("WAResultOrError").makeError("Retried with max pageSize: "+m+". Still stuck"):y({jid:r,nextTimestampMsBefore:f,numMessages:m,threadId:l}):c}l.MAWFetchAndPersistMedia=f,l.updateLocalAttachmentsRange=h}),98);
__d("useMAWBulkMaybeAutoTriggerDownload",["MAWDownloadMediaInWorkerDeferred","MAWMediaDownloadStatus","MAWMediaManagerUiIntegrationCheck","react","react-compiler-runtime","useAsyncReStore","useMAWMediaDownloadStatusBulk"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useEffect,c=s.useMemo,d=s.useRef;function m(e,t,n,a){var i=o("react-compiler-runtime").c(13),l=r("useMAWMediaDownloadStatusBulk")(e,a),s=l.mawMediaStatuses,c,m;i[0]===Symbol.for("react.memo_cache_sentinel")?(m=[r("MAWMediaDownloadStatus").MISSING_FILE,r("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE,r("MAWMediaDownloadStatus").DOWNLOADING].filter(Boolean),i[0]=m):m=i[0];var p=m,_;i[1]!==e||i[2]!==n||i[3]!==s?(_=new Map(s==null?void 0:s.map(function(t,r){var a=(!o("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()||n==null||n==="fullsize"||n==="fullsizeAndPreview")&&p.includes(t==null?void 0:t.mainMediaStatus),i=o("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()&&n==="preview"&&p.includes(t==null?void 0:t.previewMediaStatus),l=i||a;return[e[r].attachment.attachmentFbid,l]})),i[1]=e,i[2]=n,i[3]=s,i[4]=_):_=i[4],c=_;var f=c,g;i[5]===Symbol.for("react.memo_cache_sentinel")?(g=new Map,i[5]=g):g=i[5];var h=d(g),y=r("useAsyncReStore")(),C,b;i[6]!==e||i[7]!==y||i[8]!==n||i[9]!==f||i[10]!==t?(C=function(){var r=[];e.forEach(function(e){var t,n,o=e.attachment,a=e.mediaRenderQpl,i=(t=f.get(o.attachmentFbid))!=null?t:!1,l=(n=h.current.get(o.attachmentFbid))!=null?n:!1;i&&!l&&(h.current.set(o.attachmentFbid,!0),r.push({attachment:o,mediaRenderQpl:a}))}),r.length>0&&o("MAWDownloadMediaInWorkerDeferred").maybeBulkDownloadMediaInWorker({attachmentsWithQpl:r,dbPromise:y,downloadType:n,triggerUIView:t})},b=[e,y,n,h,f,t],i[6]=e,i[7]=y,i[8]=n,i[9]=f,i[10]=t,i[11]=C,i[12]=b):(C=i[11],b=i[12]),u(C,b)}l.default=m}),98);
__d("MWChatAttachmentMediaState.react",["$InternalEnum","I64","LSIntEnum","MAWClientMediaStatusUtils","MAWMediaManagerUiIntegrationCheck","MAWVideoAudioPlaybackErrorHandlerUtils","MessagingAttachmentType","RavenMessagingState","filterNulls","gkx","react","useClientMediaStatus","useMAWBulkMaybeAutoTriggerDownload","usePrevious"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=e||(e=o("react")),d=e,m=d.createContext,p=d.useEffect,_=d.useMemo,f=d.useState,g=n("$InternalEnum")({Image:0,Video:1,AnimatedImage:2}),h=m({canMoveBackward:!1,canMoveForward:!1,card:void 0,cards:[],currentIndex:0,isImageExpanded:!1,moveBackward:function(){},moveForward:function(){},moveTo:function(){},numberOfCards:0,setIsImageExpanded:function(){},shouldTriggerLoadMore:!1});function y(e){var t=e.attachmentType,n=e.ephemeralMediaState;return n!=null&&(s||(s=o("I64"))).equal(t,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").EPHEMERAL_IMAGE))&&(s||(s=o("I64"))).equal(n,(u||(u=o("LSIntEnum"))).ofNumber(r("RavenMessagingState").PERMANENT))}function C(e){var t=e.attachmentType,n=e.ephemeralMediaState;return n!=null&&(s||(s=o("I64"))).equal(t,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").EPHEMERAL_VIDEO))&&(s||(s=o("I64"))).equal(n,(u||(u=o("LSIntEnum"))).ofNumber(r("RavenMessagingState").PERMANENT))}function b(e,t,n,r){return n?r.hasMedia:t(r,"isPlayableMedia")!=null&&e(r,"isPlayableMedia")!=null}function v(e,t,n,a){var i=a.attachmentType;return b(e,t,n,a)?y(a)||(s||(s=o("I64"))).equal(i,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE)):!1}function S(e,t,n,a,i){var l=a.attachmentFbid,c=a.attachmentType,d=!1,m=!1,p=o("MAWClientMediaStatusUtils").getStatusDataFromLsdb({clientMediaStatus:i,statusKey:l}),_=p.hasStatus,f=p.statusData;if(_&&!r("gkx")("17009")){var g=f!=null?f:{},h=g.validationResult;d=h!=null?o("MAWVideoAudioPlaybackErrorHandlerUtils").isInvalidVideo(a,h):!1,m=h!=null?o("MAWVideoAudioPlaybackErrorHandlerUtils").isUnsupportedVideo(a,h):!1}return!b(e,t,n,a)||d||m?!1:C(a)||(s||(s=o("I64"))).equal(c,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO))}function R(e,t){p(function(){e.forEach(function(e){try{e.attachment.hasMedia&&!(s||(s=o("I64"))).equal(e.attachment.attachmentType,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE))&&t(e.attachment,"usePreloadThumbnails");return}catch(e){return}})},[e,t])}function L(e){var t=e.attachments,n=e.children,a=e.getIsSecureThread,i=e.getPlayableUrl,l=e.getPreviewUrl,s=e.initialAttachment,u=f(s),d=u[0],m=u[1],p=f(!1),y=p[0],C=p[1],b=r("usePrevious")(d==null?void 0:d.messageId),L=_(function(){return t.map(function(e){return{attachment:e,mediaRenderQpl:null,statusKey:e.attachmentFbid}})},[t]),E=r("useClientMediaStatus")(L),k=_(function(){return d!=null&&o("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()?[{attachment:d,mediaRenderQpl:null,statusKey:d.attachmentFbid}]:[]},[d]);r("useMAWBulkMaybeAutoTriggerDownload")(L,"fullsize","preview",E),r("useMAWBulkMaybeAutoTriggerDownload")(k,"fullsize","fullsizeAndPreview",E);var I=_(function(){return r("filterNulls")(t.map(function(e){var t=a(e);return v(i,l,t,e)?{attachment:e,type:g.Image}:S(i,l,t,e,E)?{attachment:e,type:g.Video}:null}))},[t,E,a,i,l]),T=d==null?-1:I.findIndex(function(e){return e.attachment.attachmentFbid===d.attachmentFbid&&e.attachment.messageId===d.messageId}),D=b!=null&&(d==null?void 0:d.messageId)!==b&&T>I.length-5;R(I,l);var x=_(function(){var e=Math.max(0,I.length-1);return{canMoveBackward:T>0&&T!==-1,canMoveForward:T<e&&T!==-1,card:I[T],cards:I,currentIndex:T,isImageExpanded:y,moveBackward:function(){var e,t=Math.max(T-1,0);m((e=I[t])==null?void 0:e.attachment)},moveForward:function(){var t,n=Math.min(T+1,e);m((t=I[n])==null?void 0:t.attachment)},moveTo:function(t){m(t.attachment)},numberOfCards:I.length,setIsImageExpanded:C,shouldTriggerLoadMore:D}},[I,T,D,y]);return c.jsx(h.Provider,{value:x,children:n})}L.displayName=L.name+" [from "+i.id+"]",l.AttachmentMediaType=g,l.context=h,l.MWChatAttachmentMediaStateProviderFromAttachments=L}),98);
__d("MWChatAttachmentMediaNavigationHotkeys.react",["fbt","CometKeys","MWChatAttachmentMediaState.react","justknobx","react","react-compiler-runtime","useLayerKeyCommands"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useContext,m=c.useMemo,p={key:r("CometKeys").LEFT},_={key:r("CometKeys").RIGHT},f={key:r("CometKeys").ESCAPE},g=s._(/*BTDS*/"Next item"),h=s._(/*BTDS*/"Previous item"),y=s._(/*BTDS*/"Close");function C(e){var t=o("react-compiler-runtime").c(18),n=e.children,a=e.onClose,i=d(o("MWChatAttachmentMediaState.react").context),l=i.isImageExpanded,s=i.moveBackward,c=i.moveForward,m=i.setIsImageExpanded,C,b;t[0]!==l||t[1]!==s?(b={command:p,description:g,handler:function(){!l&&s()}},t[0]=l,t[1]=s,t[2]=b):b=t[2];var v;t[3]!==l||t[4]!==c?(v={command:_,description:h,handler:function(){!l&&c()}},t[3]=l,t[4]=c,t[5]=v):v=t[5];var S;t[6]!==l||t[7]!==a||t[8]!==m?(S=a!=null?{command:f,description:y,handler:function(){if(l)return m(!1);a()}}:null,t[6]=l,t[7]=a,t[8]=m,t[9]=S):S=t[9];var R;t[10]!==b||t[11]!==v||t[12]!==S?(R=[b,v,S],t[10]=b,t[11]=v,t[12]=S,t[13]=R):R=t[13];var L=R,E;t[14]!==L?(E=L.filter(Boolean),t[14]=L,t[15]=E):E=t[15],C=E;var k=C;r("useLayerKeyCommands")(k);var I;return t[16]!==n?(I=r("justknobx")._("3491")?u.jsx(u.Fragment,{children:n!=null?n:null}):u.jsx("div",{children:n!=null?n:null}),t[16]=n,t[17]=I):I=t[17],I}l.keyLeft=p,l.keyRight=_,l.keyEscape=f,l.MWChatAttachmentMediaNavigationHotkeys=C}),226);
__d("MWChatAttachmentMediaUtils",["MWChatAttachmentMediaState.react"],(function(t,n,r,o,a,i,l){"use strict";var e="/images/comet/gray.png";function s(t){var n=t.card,r=t.getPlayableUrl,a=t.getPreviewUrl,i=n.attachment,l;if(i.hasMedia)try{l=a(i,"toFilmstripThumbnail")}catch(e){l=null}var s=l;if(n.type===o("MWChatAttachmentMediaState.react").AttachmentMediaType.Video&&l==null)try{s=r(i,"toFilmstripThumbnail")}catch(e){s=null}if(n.type===o("MWChatAttachmentMediaState.react").AttachmentMediaType.Image){var u;return{alt:(u=i.accessibilitySummaryText)!=null?u:"",backgroundColor:void 0,height:0,isUseImageResizing:void 0,mediaType:"image",uri:l!=null?l:e,width:0}}return{height:0,mediaType:"video",thumbnailUri:l!=null?l:e,uri:s!=null?s:e,width:0}}function u(t){var n=t.card,r=t.getPlayableUrl,a=t.getPreviewUrl,i=n.attachment,l;i.hasMedia&&(l=a(i,"toFilmstripThumbnailSuspends"));var s=l;if(n.type===o("MWChatAttachmentMediaState.react").AttachmentMediaType.Video&&l==null&&(s=r(i,"toFilmstripThumbnailSuspends")),n.type===o("MWChatAttachmentMediaState.react").AttachmentMediaType.Image){var u;return{alt:(u=i.accessibilitySummaryText)!=null?u:"",backgroundColor:void 0,height:0,isUseImageResizing:void 0,mediaType:"image",uri:l!=null?l:e,width:0}}return{height:0,mediaType:"video",thumbnailUri:l!=null?l:e,uri:s!=null?s:e,width:0}}l.loadingStateUri=e,l.toFilmstripThumbnail=s,l.toFilmstripThumbnailSuspends=u}),98);
__d("MWV2MediaViewerContext.react",["react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useMemo,c=s.createContext({getDownloadUrl:function(){},getPlayableUrl:function(){},getPreviewUrl:function(){},heroLoggingComponent:function(t){return null},loadMore:function(){},media:[]});function d(e){var t=o("react-compiler-runtime").c(10),n=e.children,r=e.getDownloadUrl,a=e.getPlayableUrl,i=e.getPreviewUrl,l=e.heroLoggingComponent,u=e.loadMore,d=e.media,m,p;t[0]!==r||t[1]!==a||t[2]!==i||t[3]!==l||t[4]!==u||t[5]!==d?(p={getDownloadUrl:r,getPlayableUrl:a,getPreviewUrl:i,heroLoggingComponent:l,loadMore:u,media:d},t[0]=r,t[1]=a,t[2]=i,t[3]=l,t[4]=u,t[5]=d,t[6]=p):p=t[6],m=p;var _=m,f;return t[7]!==n||t[8]!==_?(f=s.jsx(c.Provider,{value:_,children:n}),t[7]=n,t[8]=_,t[9]=f):f=t[9],f}l.context=c,l.MWV2MediaViewerContextProvider=d}),98);
__d("MWChatAttachmentMediaThumbnails.react",["CometMediaViewerFilmstrip.react","CometPlaceholder.react","MWChatAttachmentMediaState.react","MWChatAttachmentMediaUtils","MWV2MediaViewerContext.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.useContext,d=u.useDeferredValue;function m(e){var t,n,a=o("react-compiler-runtime").c(23),i=e.activeCard,l=e.cards,u=e.getPreviewUrl,d=e.onSetImage,m=c(o("MWV2MediaViewerContext.react").context),p;a[0]!==m?(p=function(t,n){return t==null?"":m.getDownloadUrl(t,n)},a[0]=m,a[1]=p):p=a[1];var _=p,f;if(a[2]!==l||a[3]!==_||a[4]!==u){var g;a[6]!==_||a[7]!==u?(g=function(t){return o("MWChatAttachmentMediaUtils").toFilmstripThumbnail({card:t,getPlayableUrl:_,getPreviewUrl:u})},a[6]=_,a[7]=u,a[8]=g):g=a[8],f=l.map(g),a[2]=l,a[3]=_,a[4]=u,a[5]=f}else f=a[5];var h=f,y;if(a[9]!==(i==null||(t=i.attachment)==null?void 0:t.attachmentFbid)||a[10]!==(i==null||(n=i.attachment)==null?void 0:n.messageId)||a[11]!==l){var C,b,v,S,R;if(a[13]!==(i==null||(C=i.attachment)==null?void 0:C.attachmentFbid)||a[14]!==(i==null||(b=i.attachment)==null?void 0:b.messageId)){var L,E;R=function(t){var e,n;return t.attachment.attachmentFbid===(i==null||(e=i.attachment)==null?void 0:e.attachmentFbid)&&t.attachment.messageId===(i==null||(n=i.attachment)==null?void 0:n.messageId)},a[13]=i==null||(L=i.attachment)==null?void 0:L.attachmentFbid,a[14]=i==null||(E=i.attachment)==null?void 0:E.messageId,a[15]=R}else R=a[15];y=l.findIndex(R),a[9]=i==null||(v=i.attachment)==null?void 0:v.attachmentFbid,a[10]=i==null||(S=i.attachment)==null?void 0:S.messageId,a[11]=l,a[12]=y}else y=a[12];var k=y,I;a[16]!==l||a[17]!==d?(I=function(t){return d(l[t])},a[16]=l,a[17]=d,a[18]=I):I=a[18];var T;return a[19]!==k||a[20]!==h||a[21]!==I?(T=s.jsx(r("CometMediaViewerFilmstrip.react"),{activeIndex:k,images:h,onSetImage:I}),a[19]=k,a[20]=h,a[21]=I,a[22]=T):T=a[22],T}function p(e){var t=o("react-compiler-runtime").c(10),n=e.getPreviewUrl,a=e.shouldHide,i=a===void 0?!1:a,l=c(o("MWChatAttachmentMediaState.react").context),u=l.card,p=l.cards,_=l.moveTo,f=d(p),g;t[0]!==i?(g={0:{className:"xdj266r x11t971q xat24cr xvc5jky x193iq5w x6ikm8r x10wlt62"},1:{className:"xdj266r x11t971q xat24cr xvc5jky x193iq5w x6ikm8r x10wlt62 x1s85apg"}}[!!i<<0],t[0]=i,t[1]=g):g=t[1];var h;t[2]!==u||t[3]!==f||t[4]!==n||t[5]!==_?(h=s.jsx(r("CometPlaceholder.react"),{fallback:null,name:"MWChatAttachmentMediaThumbnails",children:s.jsx(m,{activeCard:u,cards:f,getPreviewUrl:n,onSetImage:_})}),t[2]=u,t[3]=f,t[4]=n,t[5]=_,t[6]=h):h=t[6];var y;return t[7]!==g||t[8]!==h?(y=s.jsx("div",babelHelpers.extends({},g,{"data-testid":void 0,children:h})),t[7]=g,t[8]=h,t[9]=y):y=t[9],y}l.default=p}),98);
__d("MWMediaViewerRenderQpl",["MWMediaRenderQplUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return o("MWMediaRenderQplUtils").useCommonMediaRenderQplForAttachment(e,t,"full_screen_view")}l.useMediaViewerRenderQpl=e}),98);
__d("MWMessageSearchStatusTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["IN_PROGRESS","COMPLETE","NOT_RUNNING","NOT_REQUIRED"]),l=n("$InternalEnum").Mirrored(["IN_PROGRESS","COMPLETE","NOT_STARTED"]),s=n("$InternalEnum").Mirrored(["NOT_STARTED","IN_PROGRESS","COMPLETE","FAILED"]);i.RestoreStatus=e,i.OverallStatus=l,i.PrimarySearchStatus=s}),66);
__d("MWSharedAttachmentsSectionHooks",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MessagingAttachmentType","ReQL","ReQLSuspense","react","react-compiler-runtime","usePrevious","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=c||(c=o("react")),m=d.useCallback,p=d.useEffect,_=d.useState;function f(e){var t,n,a=o("react-compiler-runtime").c(33),i=e.attachmentsRange,l=e.hasMore,s=e.loadMore,u=e.logLoadMediaCancel,c=e.logLoadMediaSuccess,d=e.media,m=e.skipInitialLoad,f=_(!1),g=f[0],h=f[1],y=d.length,C=(t=r("usePrevious")(y))!=null?t:0,b=r("usePrevious")(l),v=(n=r("usePrevious")(g))!=null?n:!1,S=i!=null,R,L;a[0]!==S||a[1]!==s||a[2]!==m?(R=function(){!S&&m!==!0&&(s(),h(!0))},L=[S,s,m],a[0]=S,a[1]=s,a[2]=m,a[3]=R,a[4]=L):(R=a[3],L=a[4]),p(R,L);var E;a[5]!==i||a[6]!==l||a[7]!==g||a[8]!==s||a[9]!==c||a[10]!==y||a[11]!==b||a[12]!==v||a[13]!==C?(E=function(){var e=C!==y,t=b===!0&&!l||i==null&&l===!1&&b===!1&&C===y;g&&(t||e)?(h(!1),c==null||c({fetchedMediaCount:y-C,startMediaCount:C})):C===y&&l&&g&&v===!0&&(c==null||c({fetchedMediaCount:y-C,isAlreadyPreloaded:!0,startMediaCount:C}),s())},a[5]=i,a[6]=l,a[7]=g,a[8]=s,a[9]=c,a[10]=y,a[11]=b,a[12]=v,a[13]=C,a[14]=E):E=a[14];var k;a[15]!==i||a[16]!==l||a[17]!==g||a[18]!==s||a[19]!==u||a[20]!==c||a[21]!==y||a[22]!==b||a[23]!==v||a[24]!==C?(k=[y,l,g,C,b,i,s,v,c,u],a[15]=i,a[16]=l,a[17]=g,a[18]=s,a[19]=u,a[20]=c,a[21]=y,a[22]=b,a[23]=v,a[24]=C,a[25]=k):k=a[25],p(E,k);var I;a[26]!==g||a[27]!==s?(I=function(){if(!g)return s(),h(!0)},a[26]=g,a[27]=s,a[28]=I):I=a[28];var T=I,D=y>0||!g&&!l,x;return a[29]!==D||a[30]!==g||a[31]!==T?(x=[g,T,D],a[29]=D,a[30]=g,a[31]=T,a[32]=x):x=a[32],x}function g(t,n,a,l){var s=o("react-compiler-runtime").c(19),u;s[0]!==l?(u=l===void 0?{}:l,s[0]=l,s[1]=u):u=s[1];var c=u,d=c.removeUnsentMessages,m=d===void 0?!1:d,p=(e||(e=r("useReStore")))(),_=R(t,n),f=_.attachmentsRange,g=_.hasMoreBefore,h=_.minTimestampMs,y=_.query,C;s[2]!==p||s[3]!==a||s[4]!==m?(C=function(t){if(!a(t))return null;if(!m)return t;var e=o("ReQLSuspense").first(o("ReQL").fromTableAscending(p.tables.messages.index("messageId")).getKeyRange(t.messageId),i.id+":146");return e==null||e.isUnsent?null:t},s[2]=p,s[3]=a,s[4]=m,s[5]=C):C=s[5];var b=C,v;s[6]!==b||s[7]!==y?(v=function(){return y.map(b).filter(Boolean)},s[6]=b,s[7]=y,s[8]=v):v=s[8];var S;s[9]!==p||s[10]!==h||s[11]!==b||s[12]!==t?(S=[p,t,b,h],s[9]=p,s[10]=h,s[11]=b,s[12]=t,s[13]=S):S=s[13];var L=o("ReQLSuspense").useArray(v,S,i.id+":159"),E;return s[14]!==L||s[15]!==f||s[16]!==g||s[17]!==h?(E=[L,f,h,g],s[14]=L,s[15]=f,s[16]=g,s[17]=h,s[18]=E):E=s[18],E}function h(e){var t=e.attachmentType,n=e.defaultCtaType;return(s||(s=o("I64"))).equal(t,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").XMA))?n==="xma_web_url"||n==="xma_open_native":!1}function y(e,t){var n=o("react-compiler-runtime").c(7),a;n[0]===Symbol.for("react.memo_cache_sentinel")?(a=(u||(u=o("LSIntEnum"))).ofNumber(r("LSThreadMediaGalleryGroup").LINKS),n[0]=a):a=n[0];var i=g(e,a,h,t),l=i[0],s=i[1],c=i[2],d=i[3],m;n[1]===Symbol.for("react.memo_cache_sentinel")?(m=(u||(u=o("LSIntEnum"))).ofNumber(r("LSThreadMediaGalleryGroup").LINKS),n[1]=m):m=n[1];var p;return n[2]!==l||n[3]!==s||n[4]!==d||n[5]!==c?(p=[l,m,s,c,d],n[2]=l,n[3]=s,n[4]=d,n[5]=c,n[6]=p):p=n[6],p}function C(e){var t=e.attachmentType;return(s||(s=o("I64"))).equal(t,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE))||(s||(s=o("I64"))).equal(t,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO))}function b(e,t){var n=o("react-compiler-runtime").c(7),a;n[0]===Symbol.for("react.memo_cache_sentinel")?(a=(u||(u=o("LSIntEnum"))).ofNumber(r("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),n[0]=a):a=n[0];var i=g(e,a,C,t),l=i[0],s=i[1],c=i[2],d=i[3],m;n[1]===Symbol.for("react.memo_cache_sentinel")?(m=(u||(u=o("LSIntEnum"))).ofNumber(r("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),n[1]=m):m=n[1];var p;return n[2]!==l||n[3]!==s||n[4]!==d||n[5]!==c?(p=[l,m,s,c,d],n[2]=l,n[3]=s,n[4]=d,n[5]=c,n[6]=p):p=n[6],p}function v(e){var t=e.attachmentType;return(s||(s=o("I64"))).equal(t,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").FILE))}function S(e,t){var n=o("react-compiler-runtime").c(7),a;n[0]===Symbol.for("react.memo_cache_sentinel")?(a=(u||(u=o("LSIntEnum"))).ofNumber(r("LSThreadMediaGalleryGroup").FILES_ONLY),n[0]=a):a=n[0];var i=g(e,a,v,t),l=i[0],s=i[1],c=i[2],d=i[3],m;n[1]===Symbol.for("react.memo_cache_sentinel")?(m=(u||(u=o("LSIntEnum"))).ofNumber(r("LSThreadMediaGalleryGroup").FILES_ONLY),n[1]=m):m=n[1];var p;return n[2]!==l||n[3]!==s||n[4]!==d||n[5]!==c?(p=[l,m,s,c,d],n[2]=l,n[3]=s,n[4]=d,n[5]=c,n[6]=p):p=n[6],p}function R(t,n){var a=o("react-compiler-runtime").c(17),l=(e||(e=r("useReStore")))(),u;a[0]!==l.tables.attachments_ranges_v2__generated||a[1]!==n||a[2]!==t?(u=function(){return o("ReQL").fromTableDescending(l.tables.attachments_ranges_v2__generated).getKeyRange(t).filter(function(e){return(s||(s=o("I64"))).equal(e.mediaGroup,n)})},a[0]=l.tables.attachments_ranges_v2__generated,a[1]=n,a[2]=t,a[3]=u):u=a[3];var c;a[4]!==l||a[5]!==n||a[6]!==t?(c=[l,t,n],a[4]=l,a[5]=n,a[6]=t,a[7]=c):c=a[7];var d=o("ReQLSuspense").useFirst(u,c,i.id+":284"),m=d==null?void 0:d.minTimestampMs,p=d==null?void 0:d.hasMoreBefore,_;if(a[8]!==l.tables.attachments||a[9]!==m||a[10]!==t){var f=o("ReQL").fromTableDescending(l.tables.attachments.index("fk_messages")).getKeyRange(t);_=m!=null&&(s||(s=o("I64"))).to_float(m)!==Number.MAX_SAFE_INTEGER?f.bounds({gte:o("ReQL").key(m)}):f,a[8]=l.tables.attachments,a[9]=m,a[10]=t,a[11]=_}else _=a[11];var g=_,h;return a[12]!==d||a[13]!==p||a[14]!==m||a[15]!==g?(h={attachmentsRange:d,hasMoreBefore:p,minTimestampMs:m,query:g},a[12]=d,a[13]=p,a[14]=m,a[15]=g,a[16]=h):h=a[16],h}l.useLoader=f,l.useQueryLinkAttachments=y,l.filterMediaAttachments=C,l.useQueryMediaAttachments=b,l.useQueryFileAttachments=S,l.useAttachmentsQuery=R}),98);
__d("useLoadMoreThreadSharedAttachments.react",["Int64Hooks","LSFactory","LSIssueAttachmentsRangeQueryStoredProcedure","MAWThreadCutover","MWThreadKey.react","promiseDone","react-compiler-runtime","useAsyncReStore"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){var a=o("react-compiler-runtime").c(6),l=r("useAsyncReStore")(),s=o("MWThreadKey.react").useMWThreadKeyMemoized();s==null&&(s=t);var u=o("MAWThreadCutover").useGetCutoverOpenThreadKey(s),c=u!=null?u:s,d,m;return a[0]!==l||a[1]!==c||a[2]!==n||a[3]!==e?(d=function(){n==null||n(),r("promiseDone")(l,function(t){return t.runInTransaction(function(t){return r("LSIssueAttachmentsRangeQueryStoredProcedure")(r("LSFactory")(t),{mediaGroup:e,threadKey:c})},"readwrite",void 0,void 0,i.id+":40")})},m=[n,l,e,c],a[0]=l,a[1]=c,a[2]=n,a[3]=e,a[4]=d,a[5]=m):(d=a[4],m=a[5]),o("Int64Hooks").useCallbackInt64(d,m)}l.default=e}),98);
__d("useMAWLoadMoreThreadSharedAttachments",["I64","Int64Hooks","MAWBridgeSendAndReceive","MAWMediaGalleryEBTaggingUtils","MAWMiActOnActThreadReady","Promise","cr:20241","promiseDone","react-compiler-runtime","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(t){var a=o("react-compiler-runtime").c(16),i=t.earliestLoadedMediaMessageId,l=t.hasMoreBefore,c=t.mediaGalleryGroup,d=t.minTimestampMs,m=t.pageSize,p=t.qplLogger,_=t.threadKey,f=(u||(u=r("useReStore")))(),g,h;a[0]!==l||a[1]!==d?(g=function(){return l!=null&&l&&d!=null?(s||(s=o("I64"))).to_float(d):Number.MAX_SAFE_INTEGER},h=[l,d],a[0]=l,a[1]=d,a[2]=g,a[3]=h):(g=a[2],h=a[3]);var y=o("Int64Hooks").useCallbackInt64(g,h),C;a[4]!==c?(C=o("MAWMediaGalleryEBTaggingUtils").isMediaGalleryGroupSupportedForTaggedRestore(c),a[4]=c,a[5]=C):C=a[5];var b=C,v,S;return a[6]!==f.tables||a[7]!==i||a[8]!==y||a[9]!==b||a[10]!==c||a[11]!==m||a[12]!==p||a[13]!==_?(v=function(){_!=null&&(p==null||p.logLoadMediaStart==null||p.logLoadMediaStart(),r("promiseDone")(o("MAWMiActOnActThreadReady").onActThreadReady(f.tables,_,"useMAWLoadMoreThreadSharedAttachments",function(t,r){return(n("cr:20241")!=null&&b?n("cr:20241").MAWFetchAndPersistMedia(r,_,c,p):(e||(e=n("Promise"))).resolve()).then(function(){return p==null||p.addPoint("fetch_from_maw_db",{int:{mediaGalleryGroup:c}}),o("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMoreMedia",{earliestLoadedMediaMessageId:i,earliestLoadedMediaTs:y(),mediaGalleryGroup:c,pageSize:m,threadJid:r})})})))},S=[_,f.tables,b,c,p,i,y,m],a[6]=f.tables,a[7]=i,a[8]=y,a[9]=b,a[10]=c,a[11]=m,a[12]=p,a[13]=_,a[14]=v,a[15]=S):(v=a[14],S=a[15]),o("Int64Hooks").useCallbackInt64(v,S)}l.default=c}),98);
__d("useMAWQuerySecureMediaAttachments",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MWSharedAttachmentsSectionHooks","ReQL","ReQLSuspense","justknobx","react","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=c||(c=o("react")),m=d.useCallback,p=d.useMemo;function _(t,n,a){var l=a===void 0?{}:a,c=l.removeUnsentMessages,d=c===void 0?!1:c,_=(e||(e=r("useReStore")))(),g=n==null?r("justknobx")._("1132"):n,y=o("MWSharedAttachmentsSectionHooks").useAttachmentsQuery(t,(s||(s=o("LSIntEnum"))).ofNumber(r("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS)),C=y.attachmentsRange,b=y.hasMoreBefore,v=y.minTimestampMs,S=y.query,R=m(function(e){if(!o("MWSharedAttachmentsSectionHooks").filterMediaAttachments(e))return null;var t=o("ReQLSuspense").first(o("ReQL").fromTableAscending(_.tables.messages.index("messageId")).getKeyRange(e.messageId),i.id+":77");return d&&(t==null||t.isUnsent)?null:t==null?{attachment:e}:{attachment:e,message:t}},[_,d]),L=o("ReQLSuspense").useArray(function(){var e=S.map(R).filter(Boolean);return(v==null||(u||(u=o("I64"))).equal(v,(u||(u=o("I64"))).zero))&&(e=e.take(g)),e},[_,t,R,v],i.id+":95"),E=p(function(){var e=f(L);return e.sort(h),e},[L]),k=p(function(){return E.map(function(e){var t=e.attachment;return t})},[E]);return[k,s.ofNumber(r("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),C,v,b]}function f(e){var t=g(e);return e.map(function(e){var n,r=e.attachment,a=e.message,i=a==null?void 0:a.groupId,l=t.get(i!=null?i:"");if(i==null||l==null){var s,c,d;return{attachment:r,message:a,sortKey:{sortingMessageGroupIndex:Number.MAX_SAFE_INTEGER,sortingMessageId:r.messageId,sortingMessagePrimarySortTS:(s=a==null?void 0:a.primarySortKey)!=null?s:r.timestampMs,sortingMessageSecondarySortTS:(c=(d=a==null?void 0:a.secondarySortKey)!=null?d:a==null?void 0:a.timestampMs)!=null?c:r.timestampMs}}}return{attachment:r,message:a,sortKey:{sortingMessageGroupIndex:(u||(u=o("I64"))).to_int32((n=a==null?void 0:a.groupIndex)!=null?n:(u||(u=o("I64"))).zero),sortingMessageId:l.messageId,sortingMessagePrimarySortTS:l.primarySortTs,sortingMessageSecondarySortTS:l.secondarySortTs}}})}function g(e){var t=new Map;return e.forEach(function(e){var n,r,a,i=e.message;if(!(!i||i.groupId==null||i.groupIndex==null)){var l=i.groupId,s=(u||(u=o("I64"))).to_int32(i.groupIndex),c=Math.min((n=(r=t.get(l))==null?void 0:r.groupIndex)!=null?n:Number.MAX_SAFE_INTEGER,s),d=s===c?{groupIndex:s,messageId:i.messageId,primarySortTs:i.primarySortKey,secondarySortTs:(a=i.secondarySortKey)!=null?a:i.timestampMs}:t.get(l);d&&t.set(l,d)}}),t}function h(e,t){var n=e.sortKey,r=t.sortKey,a=e.message,i=t.message;return(u||(u=o("I64"))).equal(n.sortingMessagePrimarySortTS,r.sortingMessagePrimarySortTS)?(u||(u=o("I64"))).equal(r.sortingMessageSecondarySortTS,n.sortingMessageSecondarySortTS)?n.sortingMessageId!==r.sortingMessageId?r.sortingMessageId.localeCompare(n.sortingMessageId):(a==null?void 0:a.groupId)!=null&&(i==null?void 0:i.groupId)!=null&&a.groupId===i.groupId?r.sortingMessageGroupIndex-n.sortingMessageGroupIndex:0:(u||(u=o("I64"))).compare(r.sortingMessageSecondarySortTS,n.sortingMessageSecondarySortTS):(u||(u=o("I64"))).compare(r.sortingMessagePrimarySortTS,n.sortingMessagePrimarySortTS)}l.default=_}),98);
__d("useMWMediaLoadingQplLogger",["MWMediaRenderQplUtils","QPLUserFlow","QuickPerformanceLogger","Random","qpl","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c=u.useCallback,d=u.useEffect,m=u.useMemo;function p(t){var n=o("react-compiler-runtime").c(12),a=t.entrypoint,i=t.threadType,l,s;n[0]===Symbol.for("react.memo_cache_sentinel")?(s=C(),n[0]=s):s=n[0],l=s;var u=l,c;n[1]!==a||n[2]!==i?(c=function(t){var e,n;_({entrypoint:a,instanceKey:u,isCutoverThread:(e=t==null?void 0:t.isCutoverThread)!=null?e:!1,isPreCutoverMedia:(n=t==null?void 0:t.isPreCutoverMedia)!=null?n:!1,threadType:i})},n[1]=a,n[2]=i,n[3]=c):c=n[3];var m=c,p;n[4]===Symbol.for("react.memo_cache_sentinel")?(p=function(t){var e=t.fetchedMediaCount,n=t.isAlreadyPreloaded,r=t.startMediaCount;f({fetchedMediaCount:e,instanceKey:u,isAlreadyPreloaded:n,startMediaCount:r})},n[4]=p):p=n[4];var b=p,v;n[5]===Symbol.for("react.memo_cache_sentinel")?(v=function(){g({instanceKey:u})},n[5]=v):v=n[5];var S=v,R;n[6]===Symbol.for("react.memo_cache_sentinel")?(R=function(t,n){h({annotations:n,instanceKey:u,name:t})},n[6]=R):R=n[6];var L=R,E;n[7]===Symbol.for("react.memo_cache_sentinel")?(E=function(t){y({annotations:t,instanceKey:u})},n[7]=E):E=n[7];var k=E,I,T;n[8]===Symbol.for("react.memo_cache_sentinel")?(I=function(){return function(){var t=(e||(e=r("QuickPerformanceLogger"))).isMarkerOn(r("qpl")._(25300395,"1954"),u);t&&S()}},T=[u,S],n[8]=I,n[9]=T):(I=n[8],T=n[9]),d(I,T);var D,x;return n[10]!==m?(x={addAnnotations:k,addPoint:L,logLoadMediaCancel:S,logLoadMediaStart:m,logLoadMediaSuccess:b},n[10]=m,n[11]=x):x=n[11],D=x,D}function _(e){var t=e.entrypoint,n=e.instanceKey,a=e.isCutoverThread,i=a===void 0?!1:a,l=e.isPreCutoverMedia,s=l===void 0?!1:l,u=e.threadType;r("QPLUserFlow").start(r("qpl")._(25300395,"1954"),{annotations:{bool:{isCutoverThread:i,isPreCutoverMedia:s},string:{entrypoint:t,threadType:o("MWMediaRenderQplUtils").getThreadTypeStringFromEnum(u)}},cancelOnUnload:!0,instanceKey:n,timeoutInMs:60*1e3})}function f(e){var t=e.fetchedMediaCount,n=e.instanceKey,o=e.isAlreadyPreloaded,a=e.startMediaCount;r("QPLUserFlow").endSuccess(r("qpl")._(25300395,"1954"),{annotations:{bool:{isAlreadyPreloaded:o!=null?o:!1},int:{fetchedMediaCount:t,startMediaCount:a}},instanceKey:n})}function g(e){var t=e.instanceKey;r("QPLUserFlow").endCancel(r("qpl")._(25300395,"1954"),{instanceKey:t})}function h(e){var t=e.annotations,n=e.instanceKey,o=e.name;r("QPLUserFlow").addPoint(r("qpl")._(25300395,"1954"),o,{data:t,instanceKey:n})}function y(e){var t=e.annotations,n=e.instanceKey;r("QPLUserFlow").addAnnotations(r("qpl")._(25300395,"1954"),t,{instanceKey:n})}function C(){return Date.now()+Math.round(o("Random").random()*1e4)}l.default=p}),98);
__d("useMAWLoadMoreCutoverThreadSharedAttachments",["MAWDbMsg","MWSharedAttachmentsSectionHooks","gkx","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMAWLoadMoreThreadSharedAttachments","useMAWQuerySecureMediaAttachments","useMWMediaLoadingQplLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useCallback;function u(e,t,n,a,i,l,s){var u=o("react-compiler-runtime").c(55),d=r("useMAWQuerySecureMediaAttachments")(e,s),m=d[0],p=d[1],_=d[2],f=d[3],g=d[4],h;u[0]!==(_==null?void 0:_.lastLoadedMessageId)?(h=(_==null?void 0:_.lastLoadedMessageId)!=null?o("MAWDbMsg").toMsgId(_==null?void 0:_.lastLoadedMessageId):void 0,u[0]=_==null?void 0:_.lastLoadedMessageId,u[1]=h):h=u[1];var y=h,C=g!=null?g:!0,b;u[2]!==a.entrypoint||u[3]!==n?(b={entrypoint:a.entrypoint,threadType:n},u[2]=a.entrypoint,u[3]=n,u[4]=b):b=u[4];var v=r("useMWMediaLoadingQplLogger")(b),S;u[5]!==v?(S=function(){v.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!1})},u[5]=v,u[6]=S):S=u[6];var R=S,L=y!=null?y:void 0,E;u[7]!==R||u[8]!==v?(E=babelHelpers.extends({},v,{logLoadMediaStart:R}),u[7]=R,u[8]=v,u[9]=E):E=u[9];var k;u[10]!==g||u[11]!==i||u[12]!==f||u[13]!==s||u[14]!==e||u[15]!==L||u[16]!==E?(k={earliestLoadedMediaMessageId:L,hasMoreBefore:g,mediaGalleryGroup:i,minTimestampMs:f,pageSize:s,qplLogger:E,threadKey:e},u[10]=g,u[11]=i,u[12]=f,u[13]=s,u[14]=e,u[15]=L,u[16]=E,u[17]=k):k=u[17];var I=r("useMAWLoadMoreThreadSharedAttachments")(k),T=o("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(t),D=T[0],x=T[2],$=T[4],P=$!=null?$:r("gkx")("6241"),N;u[18]!==v?(N=function(){v.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!0})},u[18]=v,u[19]=N):N=u[19];var M=N,w=r("useLoadMoreThreadSharedAttachments.react")(p,t,M),A;u[20]!==_||u[21]!==C||u[22]!==I||u[23]!==m||u[24]!==v.logLoadMediaCancel||u[25]!==v.logLoadMediaSuccess?(A={attachmentsRange:_,hasMore:C,loadMore:I,logLoadMediaCancel:v.logLoadMediaCancel,logLoadMediaSuccess:v.logLoadMediaSuccess,media:m},u[20]=_,u[21]=C,u[22]=I,u[23]=m,u[24]=v.logLoadMediaCancel,u[25]=v.logLoadMediaSuccess,u[26]=A):A=u[26];var F=o("MWSharedAttachmentsSectionHooks").useLoader(A),O=F[0],B=F[1],W=F[2],q=C||O,U;u[27]!==x||u[28]!==P||u[29]!==w||u[30]!==D||u[31]!==v.logLoadMediaCancel||u[32]!==v.logLoadMediaSuccess||u[33]!==q?(U={attachmentsRange:x,hasMore:P,loadMore:w,logLoadMediaCancel:v.logLoadMediaCancel,logLoadMediaSuccess:v.logLoadMediaSuccess,media:D,skipInitialLoad:q},u[27]=x,u[28]=P,u[29]=w,u[30]=D,u[31]=v.logLoadMediaCancel,u[32]=v.logLoadMediaSuccess,u[33]=q,u[34]=U):U=u[34];var V=o("MWSharedAttachmentsSectionHooks").useLoader(U),H=V[0],G=V[1],z=V[2];if(C||O||l===!0){var j;return u[35]!==W||u[36]!==C||u[37]!==O||u[38]!==m||u[39]!==B?(j={attachments:m,completedFirstLoad:W,hasMore:C,isLoadingMore:O,onLoadMore:B},u[35]=W,u[36]=C,u[37]=O,u[38]=m,u[39]=B,u[40]=j):j=u[40],j}else if(P||H){var K;u[41]!==D||u[42]!==m?(K=m.concat(D),u[41]=D,u[42]=m,u[43]=K):K=u[43];var Q;return u[44]!==z||u[45]!==P||u[46]!==H||u[47]!==G||u[48]!==K?(Q={attachments:K,completedFirstLoad:z,hasMore:P,isLoadingMore:H,onLoadMore:G},u[44]=z,u[45]=P,u[46]=H,u[47]=G,u[48]=K,u[49]=Q):Q=u[49],Q}else{var X;u[50]!==D||u[51]!==m?(X=m.concat(D),u[50]=D,u[51]=m,u[52]=X):X=u[52];var Y;return u[53]!==X?(Y={attachments:X,completedFirstLoad:!0,hasMore:!1,isLoadingMore:!1,onLoadMore:c},u[53]=X,u[54]=Y):Y=u[54],Y}}function c(){}l.default=u}),98);
__d("useMWMaybeInboxMediaRestoreLoop",["cr:20239","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=o("react-compiler-runtime").c(2),r=n("cr:20239")(e),a;return t[0]!==r?(a=r!=null?r:{onEBOnboarded:u,startMediaSync:s},t[0]=r,t[1]=a):a=t[1],a}function s(){}function u(){}l.default=e}),98);
__d("useMWMediaGalleryRestoreStatus",["Int64Hooks","LSMessagingThreadTypeUtil","MAWFTSRestoreSync","MAWMiActOnActThreadReady","MWEBEntrypointsKillswitch.enum","MWMessageSearchStatusTypes","cr:11999","justknobx","promiseDone","react","react-compiler-runtime","useMWEBBackupState","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useState;function c(t){var a=o("react-compiler-runtime").c(12),i=t.threadKey,l=t.threadType,s=(e||(e=r("useReStore")))(),c=u(null),m=c[0],p=c[1],_;a[0]===Symbol.for("react.memo_cache_sentinel")?(_={entrypoint:r("MWEBEntrypointsKillswitch.enum").MEDIA_GALLERY_RESTORE},a[0]=_):_=a[0];var f=r("useMWEBBackupState")(_),g=n("cr:11999")(m,"media"),h;a[1]!==l?(h=o("LSMessagingThreadTypeUtil").isArmadilloSecure(l),a[1]=l,a[2]=h):h=a[2];var y=h,C;a[3]===Symbol.for("react.memo_cache_sentinel")?(C=o("MAWFTSRestoreSync").getMediaRestoreSync(),a[3]=C):C=a[3];var b=C,v;a[4]===Symbol.for("react.memo_cache_sentinel")?(v=function(){return b.isStarted()},a[4]=v):v=a[4];var S=u(v),R=S[0],L=S[1],E;a[5]===Symbol.for("react.memo_cache_sentinel")?(E=function(){return b.isEBMaybeAvailable()},a[5]=E):E=a[5];var k=u(E),I=k[0],T=k[1],D;a[6]===Symbol.for("react.memo_cache_sentinel")?(D=function(){return b.getActiveThreadId()},a[6]=D):D=a[6];var x=u(D),$=x[0],P=x[1],N=u(-1),M=N[0],w=N[1],A=u(!1),F=A[0],O=A[1],B,W;if(a[7]!==s.tables||a[8]!==y||a[9]!==i?(B=function(){var e;(e=o("MAWFTSRestoreSync")).MAWGalleryEventEmitter.addListener("isSyncStarted",function(e){return L(e)}),e.MAWGalleryEventEmitter.addListener("isEBMaybeAvailable",function(e){return T(e)}),e.MAWGalleryEventEmitter.addListener("activeThreadJid",function(e){return P(e)}),e.MAWGalleryEventEmitter.addListener("isPersisting",function(e){return O(e)}),e.MAWGalleryEventEmitter.addListener("restoredUntilMs",function(e){w(e)});var t=async function(){await o("MAWMiActOnActThreadReady").onActThreadReady(s.tables,i,"useMWMediaGalleryRestoreStatus",function(e,t){return p(t),Promise.resolve()})};return y?r("promiseDone")(t()):p(null),d},W=[s.tables,y,i],a[7]=s.tables,a[8]=y,a[9]=i,a[10]=B,a[11]=W):(B=a[10],W=a[11]),o("Int64Hooks").useEffectInt64(B,W),m!=null&&b.getDoneThreads().has(m))return o("MWMessageSearchStatusTypes").RestoreStatus.COMPLETE;var q=m!=null&&$===m;if(!y)return o("MWMessageSearchStatusTypes").RestoreStatus.NOT_REQUIRED;if(f!==3)return o("MWMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING;if(R){if(!I||!q)return o("MWMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING;var U=r("justknobx")._("3245")?M===0:g===0;return U&&!F?o("MWMessageSearchStatusTypes").RestoreStatus.COMPLETE:o("MWMessageSearchStatusTypes").RestoreStatus.IN_PROGRESS}else return o("MWMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING}function d(){o("MAWFTSRestoreSync").MAWGalleryEventEmitter.removeAllListeners()}l.default=c}),98);
__d("useMWV2MediaViewerOpenPlayableUrl",["I64","LSIntEnum","LSMediaUrlAttachment","MessagingAttachmentType","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=(e||(e=o("react"))).useCallback;function d(){return m}function m(e){if(e!=null)return(s||(s=o("I64"))).equal(e.attachmentType,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE))?o("LSMediaUrlAttachment").previewUrl(e):o("LSMediaUrlAttachment").playableUrl(e)}l.default=d}),98);
__d("useMWV2MediaViewerOpenDownloadUrl",["react","react-compiler-runtime","useMWV2MediaViewerOpenPlayableUrl"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useCallback;function u(){var e=o("react-compiler-runtime").c(2),t=r("useMWV2MediaViewerOpenPlayableUrl")(),n;return e[0]!==t?(n=function(n,r,o){var e=t(n,r,o);if(e!=null){var a=new URL(e);return a.searchParams.set("dl","1"),a.toString()}},e[0]=t,e[1]=n):n=e[1],n}l.default=u}),98);
__d("useMWV2MediaViewerOpenPreviewUrl",["LSMediaUrlAttachment","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useCallback;function u(){return c}function c(e){return e!=null?o("LSMediaUrlAttachment").previewUrl(e):void 0}l.default=u}),98);
__d("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense",["cr:5931","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useCallback;function u(){return c}function c(e,t,r){return n("cr:5931")==null?void 0:n("cr:5931").getThumbnailBlob_CausesSuspense(e,t,r)}l.default=u}),98);
__d("MWV2MediaViewerCutoverWrapper.react",["LSThreadMediaGalleryGroup","MWChatAttachmentMediaState.react","MWMessageSearchStatusTypes","MWV2MediaViewerContext.react","emptyFunction","justknobx","react","react-compiler-runtime","useMAWLoadMoreCutoverThreadSharedAttachments","useMWMaybeInboxMediaRestoreLoop","useMWMediaGalleryRestoreStatus","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useCallback;function c(e){var t=o("react-compiler-runtime").c(30),n=e.children,a=e.initialAttachment,i=e.openThreadKey,l=e.secureThreadKey,u=e.threadType,c;t[0]!==l||t[1]!==u?(c={threadKey:l,threadType:u},t[0]=l,t[1]=u,t[2]=c):c=t[2],r("useMWMaybeInboxMediaRestoreLoop")(c);var m;t[3]!==l||t[4]!==u?(m={threadKey:l,threadType:u},t[3]=l,t[4]=u,t[5]=m):m=t[5];var p=r("useMWMediaGalleryRestoreStatus")(m),_=p===o("MWMessageSearchStatusTypes").RestoreStatus.IN_PROGRESS,f;t[6]===Symbol.for("react.memo_cache_sentinel")?(f={entrypoint:"media_viewer"},t[6]=f):f=t[6];var g;t[7]===Symbol.for("react.memo_cache_sentinel")?(g=r("justknobx")._("3233"),t[7]=g):g=t[7];var h=r("useMAWLoadMoreCutoverThreadSharedAttachments")(l,i,u,f,r("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,_,g),y=h.attachments,C=h.onLoadMore,b=d,v=r("useMWV2MediaViewerOpenPreviewUrl")(),S=r("useMWV2MediaViewerOpenPlayableUrl")(),R=r("useMWV2MediaViewerOpenDownloadUrl")(),L=r("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")(),E=r("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")(),k;t[8]!==v||t[9]!==L?(k=function(t,n,r){return t?b(t)?L(t,n,r):v(t,n,r):""},t[8]=v,t[9]=L,t[10]=k):k=t[10];var I=k,T;t[11]!==S||t[12]!==E?(T=function(t,n,r){return t==null?"":b(t)?E(t,n,r):S(t,n,r)},t[11]=S,t[12]=E,t[13]=T):T=t[13];var D=T,x;t[14]!==R||t[15]!==E?(x=function(t,n,r){return t==null?"":b(t)?E(t,n,r):R(t,n,r)},t[14]=R,t[15]=E,t[16]=x):x=t[16];var $=x,P;t[17]!==y||t[18]!==n||t[19]!==D||t[20]!==I||t[21]!==a?(P=s.jsx(o("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:y,getIsSecureThread:b,getPlayableUrl:D,getPreviewUrl:I,initialAttachment:a,children:n}),t[17]=y,t[18]=n,t[19]=D,t[20]=I,t[21]=a,t[22]=P):P=t[22];var N;return t[23]!==y||t[24]!==$||t[25]!==D||t[26]!==I||t[27]!==C||t[28]!==P?(N=s.jsx(o("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:$,getPlayableUrl:D,getPreviewUrl:I,heroLoggingComponent:r("emptyFunction"),loadMore:C,media:y,children:P}),t[23]=y,t[24]=$,t[25]=D,t[26]=I,t[27]=C,t[28]=P,t[29]=N):N=t[29],N}function d(e){return!((e==null?void 0:e.transportKey)==="FBBroker"||(e==null?void 0:e.transportKey)==="FBLegacyBroker")}l.default=c}),98);
__d("MWV2MediaViewerNullState.react",["fbt","CometColumn.react","CometColumnItem.react","FDSNullState.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(){var e=o("react-compiler-runtime").c(1),t;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t=u.jsx(r("CometColumn.react"),{expanding:!0,verticalAlign:"center",children:u.jsx(r("CometColumnItem.react"),{children:u.jsx(r("FDSNullState.react"),{headline:s._(/*BTDS*/"Sorry, this content isn't available right now")})})}),e[0]=t):t=e[0],t}l.default=c}),226);
__d("MWV2MediaViewerOpenWrapper.react",["CometHero.react","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMWMediaLoadingQplLogger","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useCallback;function c(e){var t=o("react-compiler-runtime").c(22),n=e.children,a=e.initialAttachment,i=e.thread,l=o("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(i.threadKey),u=l[0],c=l[1],p=l[2],_=l[4],f;t[0]!==i.threadType?(f={entrypoint:"media_viewer",threadType:i.threadType},t[0]=i.threadType,t[1]=f):f=t[1];var g=r("useMWMediaLoadingQplLogger")(f),h=r("useLoadMoreThreadSharedAttachments.react")(c,i.threadKey,g.logLoadMediaStart),y=_!=null?_:!0,C;t[2]!==p||t[3]!==h||t[4]!==u||t[5]!==g.logLoadMediaCancel||t[6]!==g.logLoadMediaSuccess||t[7]!==y?(C={attachmentsRange:p,hasMore:y,loadMore:h,logLoadMediaCancel:g.logLoadMediaCancel,logLoadMediaSuccess:g.logLoadMediaSuccess,media:u},t[2]=p,t[3]=h,t[4]=u,t[5]=g.logLoadMediaCancel,t[6]=g.logLoadMediaSuccess,t[7]=y,t[8]=C):C=t[8];var b=o("MWSharedAttachmentsSectionHooks").useLoader(C),v=b[1],S=r("useMWV2MediaViewerOpenPreviewUrl")(),R=r("useMWV2MediaViewerOpenPlayableUrl")(),L=r("useMWV2MediaViewerOpenDownloadUrl")(),E=m,k;t[9]!==n||t[10]!==R||t[11]!==S||t[12]!==a||t[13]!==u?(k=s.jsx(o("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:u,getIsSecureThread:E,getPlayableUrl:R,getPreviewUrl:S,initialAttachment:a,children:n}),t[9]=n,t[10]=R,t[11]=S,t[12]=a,t[13]=u,t[14]=k):k=t[14];var I;return t[15]!==L||t[16]!==R||t[17]!==S||t[18]!==v||t[19]!==u||t[20]!==k?(I=s.jsx(o("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:L,getPlayableUrl:R,getPreviewUrl:S,heroLoggingComponent:d,loadMore:v,media:u,children:k}),t[15]=L,t[16]=R,t[17]=S,t[18]=v,t[19]=u,t[20]=k,t[21]=I):I=t[21],I}function d(e){return s.jsx(r("CometHero.react"),{description:e})}d.displayName=d.name+" [from "+i.id+"]";function m(){return!1}l.default=c}),98);
__d("MWV2MediaViewerSecureWrapper.react",["LSThreadMediaGalleryGroup","MAWDbMsg","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","MWV2MediaViewerNullState.react","cr:5709","cr:5931","cr:5970","emptyFunction","justknobx","react","react-compiler-runtime","useMAWQuerySecureMediaAttachments","useMWMaybeInboxMediaRestoreLoop","useMWMediaLoadingQplLogger","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useCallback;function c(e){return d}function d(){}var m=n("cr:5709")==null?c:n("cr:5709");function p(e){var t=o("react-compiler-runtime").c(34),a=e.children,i=e.initialAttachment,l=e.thread,u;t[0]===Symbol.for("react.memo_cache_sentinel")?(u=r("justknobx")._("3233"),t[0]=u):u=t[0];var c=u,d=r("useMAWQuerySecureMediaAttachments")(l.threadKey,c),p=d[0],f=d[2],g=d[3],h=d[4];r("useMWMaybeInboxMediaRestoreLoop")(l);var y=h!=null?h:!0,C;t[1]!==l.threadType?(C={entrypoint:"media_viewer",threadType:l.threadType},t[1]=l.threadType,t[2]=C):C=t[2];var b=r("useMWMediaLoadingQplLogger")(C),v;if(t[3]!==(f==null?void 0:f.lastLoadedMessageId)){var S,R;v=(S=o("MAWDbMsg").toMsgId((R=f==null?void 0:f.lastLoadedMessageId)!=null?R:""))!=null?S:void 0,t[3]=f==null?void 0:f.lastLoadedMessageId,t[4]=v}else v=t[4];var L;t[5]!==y||t[6]!==g||t[7]!==b||t[8]!==v||t[9]!==l.threadKey?(L={earliestLoadedMediaMessageId:v,hasMoreBefore:y,mediaGalleryGroup:r("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,minTimestampMs:g,pageSize:c,qplLogger:b,threadKey:l.threadKey},t[5]=y,t[6]=g,t[7]=b,t[8]=v,t[9]=l.threadKey,t[10]=L):L=t[10];var E=m(L),k;t[11]!==y||t[12]!==E?(k=function(){y&&E()},t[11]=y,t[12]=E,t[13]=k):k=t[13];var I=k,T;t[14]!==f||t[15]!==y||t[16]!==I||t[17]!==p||t[18]!==b.logLoadMediaCancel||t[19]!==b.logLoadMediaSuccess?(T={attachmentsRange:f,hasMore:y,loadMore:I,logLoadMediaCancel:b.logLoadMediaCancel,logLoadMediaSuccess:b.logLoadMediaSuccess,media:p},t[14]=f,t[15]=y,t[16]=I,t[17]=p,t[18]=b.logLoadMediaCancel,t[19]=b.logLoadMediaSuccess,t[20]=T):T=t[20];var D=o("MWSharedAttachmentsSectionHooks").useLoader(T),x=D[1],$=r("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")(),P=r("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")(),N=_;if(n("cr:5970")==null||n("cr:5931")==null){var M;return t[21]===Symbol.for("react.memo_cache_sentinel")?(M=s.jsx(r("MWV2MediaViewerNullState.react"),{}),t[21]=M):M=t[21],M}var w;t[22]!==a||t[23]!==P||t[24]!==$||t[25]!==i||t[26]!==p?(w=s.jsx(o("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:p,getIsSecureThread:N,getPlayableUrl:P,getPreviewUrl:$,initialAttachment:i,children:a}),t[22]=a,t[23]=P,t[24]=$,t[25]=i,t[26]=p,t[27]=w):w=t[27];var A;return t[28]!==P||t[29]!==$||t[30]!==x||t[31]!==p||t[32]!==w?(A=s.jsx(o("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:P,getPlayableUrl:P,getPreviewUrl:$,heroLoggingComponent:r("emptyFunction"),loadMore:x,media:p,children:w}),t[28]=P,t[29]=$,t[30]=x,t[31]=p,t[32]=w,t[33]=A):A=t[33],A}function _(){return!0}l.default=p}),98);
__d("MWV2MediaViewer.react",["FBLogger","FocusRegion.react","FocusWithinHandler.react","I64","LSMessagingThreadTypeUtil","MAWThreadCutover","MWFocusTable.react","MWLSThread","MWPThreadCapabilitiesContext","MWV2MediaViewerCutoverWrapper.react","MWV2MediaViewerNullState.react","MWV2MediaViewerOpenWrapper.react","MWV2MediaViewerSecureWrapper.react","XPlatReactFocusRegion.react","cr:7186","focusScopeQueries","justknobx","react","react-compiler-runtime","useMWMediaViewerOpenQPLLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e||(e=o("react")),c=e,d=c.useCallback,m=c.useEffect,p=c.useId;function _(e){var t=o("react-compiler-runtime").c(54),a=e.attachment,i=e.onClose,l=o("useMWMediaViewerOpenQPLLogger").useMWMediaViewerOpenQPLLogger(),c=l.endSuccess,d,_;t[0]!==c?(d=function(){c()},_=[c],t[0]=c,t[1]=d,t[2]=_):(d=t[1],_=t[2]),m(d,_);var f=o("MWLSThread").useThread(a.threadKey),g=o("MWPThreadCapabilitiesContext").Provider,h=p(),y;t[3]!==h?(y=function(t){t||o("FocusRegion.react").focusRegionById(h,o("MWFocusTable.react").tabbableScopeQuery)},t[3]=h,t[4]=y):y=t[4];var C=y,b=o("MAWThreadCutover").useGetCutoverOpenThreadKey(a.threadKey),v=o("MAWThreadCutover").useCutoverSecureThreadKeyForOpenThreadKey(b==null?a.threadKey:void 0);if(f==null){r("FBLogger")("messenger_web_media").mustfix("Thread is null in media viewer for attachment with threadKey: %s",(s||(s=o("I64"))).to_string(a.threadKey));var S;return t[5]===Symbol.for("react.memo_cache_sentinel")?(S=u.jsx(r("MWV2MediaViewerNullState.react"),{}),t[5]=S):S=t[5],S}var R=o("LSMessagingThreadTypeUtil").isArmadilloSecure(f.threadType);if(b!=null||v!=null){var L=b!=null?b:f.threadKey,E=v!=null?v:f.threadKey,k;t[6]!==i?(k=function(){i&&i()},t[6]=i,t[7]=k):k=t[7];var I;t[8]!==a||t[9]!==k||t[10]!==f?(I=u.jsx(n("cr:7186"),{initialAttachment:a,onClose:k,thread:f}),t[8]=a,t[9]=k,t[10]=f,t[11]=I):I=t[11];var T;t[12]!==a||t[13]!==L||t[14]!==E||t[15]!==I||t[16]!==f.threadType?(T=u.jsx(r("MWV2MediaViewerCutoverWrapper.react"),{initialAttachment:a,openThreadKey:L,secureThreadKey:E,threadType:f.threadType,children:I}),t[12]=a,t[13]=L,t[14]=E,t[15]=I,t[16]=f.threadType,t[17]=T):T=t[17];var D=T,x;t[18]!==D||t[19]!==f?(x=u.jsx(g,{thread:f,children:D}),t[18]=D,t[19]=f,t[20]=x):x=t[20];var $=x,P;t[21]!==$||t[22]!==h?(P=u.jsx(r("XPlatReactFocusRegion.react"),{autoFocusQuery:o("MWFocusTable.react").tabbableScopeQuery,containFocusQuery:o("MWFocusTable.react").tabbableScopeQuery,id:h,recoverFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:$}),t[21]=$,t[22]=h,t[23]=P):P=t[23];var N=P,M;return t[24]!==N||t[25]!==C?(M=r("justknobx")._("3588")?u.jsx(r("FocusWithinHandler.react"),{onFocusChange:C,onFocusVisibleChange:C,children:N}):N,t[24]=N,t[25]=C,t[26]=M):M=t[26],M}if(R){var w;t[27]!==i?(w=function(){i&&i()},t[27]=i,t[28]=w):w=t[28];var A;t[29]!==a||t[30]!==w||t[31]!==f?(A=u.jsx(n("cr:7186"),{initialAttachment:a,onClose:w,thread:f}),t[29]=a,t[30]=w,t[31]=f,t[32]=A):A=t[32];var F;t[33]!==a||t[34]!==A||t[35]!==f?(F=u.jsx(r("MWV2MediaViewerSecureWrapper.react"),{initialAttachment:a,thread:f,children:A}),t[33]=a,t[34]=A,t[35]=f,t[36]=F):F=t[36];var O=F,B;t[37]!==O||t[38]!==f?(B=u.jsx(g,{thread:f,children:O}),t[37]=O,t[38]=f,t[39]=B):B=t[39];var W=B,q;t[40]!==W||t[41]!==h?(q=u.jsx(r("XPlatReactFocusRegion.react"),{autoFocusQuery:o("MWFocusTable.react").tabbableScopeQuery,containFocusQuery:o("MWFocusTable.react").tabbableScopeQuery,id:h,recoverFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:W}),t[40]=W,t[41]=h,t[42]=q):q=t[42];var U=q,V;return t[43]!==U||t[44]!==C?(V=r("justknobx")._("3588")?u.jsx(r("FocusWithinHandler.react"),{onFocusChange:C,onFocusVisibleChange:C,children:U}):U,t[43]=U,t[44]=C,t[45]=V):V=t[45],V}var H;t[46]!==a||t[47]!==i||t[48]!==f?(H=u.jsx(n("cr:7186"),{initialAttachment:a,onClose:i,thread:f}),t[46]=a,t[47]=i,t[48]=f,t[49]=H):H=t[49];var G;return t[50]!==a||t[51]!==H||t[52]!==f?(G=u.jsx(r("MWV2MediaViewerOpenWrapper.react"),{initialAttachment:a,thread:f,children:H}),t[50]=a,t[51]=H,t[52]=f,t[53]=G):G=t[53],G}l.default=_}),98);
__d("MWV2MediaViewerAspectRatioContainer.react",["BaseAspectRatioContainer.react","gkx","react","react-compiler-runtime","stylex"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c={marginTop:"xr1yuqi",marginInlineEnd:"x11t971q",marginBottom:"x4ii5y1",marginInlineStart:"xvc5jky",maxHeight:"x1jols5v",maxWidth:"xf68679",width:"xh8yej3",$$css:!0},d={transform:"xsqj5wx",$$css:!0},m={containerMaxSize:function(t,n,r){return[c,{aspectRatio:n!=null?"x10y9f9r":n,$$css:!0},{"--x-aspectRatio":n!=null?n:void 0,"--x-maxHeight":(function(e){return typeof e=="number"?e+"px":e!=null?e:void 0})("min(calc(100vh - "+r+"px),"+(t!=null?t:1e4)+"px)"),"--x-maxWidth":(function(e){return typeof e=="number"?e+"px":e!=null?e:void 0})("min(calc((100vh - "+r+"px) * "+n+"),"+(t!=null?t:1e4)*n+"px)")}]},scale:function(t){return[d,{"--x-transform":"scale3d("+t+", "+t+", 1)"!=null?"scale3d("+t+", "+t+", 1)":void 0}]}};function p(t){var n=o("react-compiler-runtime").c(20),a=t.children,i=t.height,l=t.imageContainerRef,s=t.imageExpansionFactor,c=t.isImageExpanded,d=t.onClickOutsideOfChildren,p=t.outsideContainerRef,f=t.width,g=s===void 0?1:s,h=c===void 0?!1:c,y=f!=null&&i!=null?f/i:1,C=r("gkx")("17009")?174:76,b;n[0]===Symbol.for("react.memo_cache_sentinel")?(b={className:"x6s0dn4 x78zum5 x5yr21d xl56j7k xh8yej3"},n[0]=b):b=n[0];var v;if(n[1]!==y||n[2]!==i||n[3]!==g||n[4]!==h){var S;n[6]!==g||n[7]!==h?(S=h&&m.scale(g),n[6]=g,n[7]=h,n[8]=S):S=n[8],v=(e||(e=r("stylex"))).props(m.containerMaxSize(i,y,C),S),n[1]=y,n[2]=i,n[3]=g,n[4]=h,n[5]=v}else v=n[5];var R;n[9]!==y||n[10]!==a?(R=u.jsx(r("BaseAspectRatioContainer.react"),{aspectRatio:y,children:a}),n[9]=y,n[10]=a,n[11]=R):R=n[11];var L;n[12]!==l||n[13]!==v||n[14]!==R?(L=u.jsx("div",babelHelpers.extends({},v,{"aria-hidden":!0,onClick:_,ref:l,children:R})),n[12]=l,n[13]=v,n[14]=R,n[15]=L):L=n[15];var E;return n[16]!==d||n[17]!==p||n[18]!==L?(E=u.jsx("div",babelHelpers.extends({"aria-hidden":!0},b,{onClick:d,ref:p,children:L})),n[16]=d,n[17]=p,n[18]=L,n[19]=E):E=n[19],E}function _(e){e.cancelBubble=!0,e.stopPropagation()}l.default=p}),98);
__d("MWV2MediaViewerDownloadControl.react",["fbt","MWV2MediaViewerActionButton.react","MWXIconDownload","MWXRowItem.react","MessengerWebUXLogger","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=s._(/*BTDS*/"Download");function d(e){var t=o("react-compiler-runtime").c(7),n=e.uri,a=r("MessengerWebUXLogger").useInteractionLogger(),i;t[0]!==n?(i={download:!0,target:"_blank",url:n},t[0]=n,t[1]=i):i=t[1];var l;t[2]!==a?(l=function(){a==null||a({eventName:"fsmv_download_click"})},t[2]=a,t[3]=l):l=t[3];var s;return t[4]!==i||t[5]!==l?(s=u.jsx(r("MWXRowItem.react"),{children:u.jsx(r("MWV2MediaViewerActionButton.react"),{icon:r("MWXIconDownload"),label:c,linkProps:i,onPress:l})}),t[4]=i,t[5]=l,t[6]=s):s=t[6],s}l.default=d}),226);
__d("MWV2MediaViewerForwardControl.react",["fbt","Int64Hooks","LSMessagingThreadTypeUtil","MWV2MediaViewerActionButton.react","MWXIconShare","MWXRowItem.react","ODS","react","react-compiler-runtime","useMWHasForwardAction","useMWV2MessageForwardAction"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=e||(e=o("react"));function d(e){var t=o("react-compiler-runtime").c(8),n=e.attachment,a=e.message,i=e.thread,l=n==null?void 0:n.attachmentFbid,d;t[0]!==i.threadType?(d=o("LSMessagingThreadTypeUtil").isArmadilloSecure(i.threadType),t[0]=i.threadType,t[1]=d):d=t[1];var m=d,p,_;t[2]!==i.threadType?(p=function(){return i.threadType},_=[i.threadType],t[2]=i.threadType,t[3]=p,t[4]=_):(p=t[3],_=t[4]);var f=o("Int64Hooks").useMemoInt64(p,_),g=r("useMWV2MessageForwardAction")(m,a,f,n),h=r("useMWHasForwardAction")(i.threadType,a,n),y=h.hasForwardAction,C=l!=null&&y;if(l==null||!C)return null;var b;t[5]===Symbol.for("react.memo_cache_sentinel")?(b=s._(/*BTDS*/"Forward"),t[5]=b):b=t[5];var v=b,S;return t[6]!==g?(S=c.jsx(r("MWXRowItem.react"),{children:c.jsx(r("MWV2MediaViewerActionButton.react"),{icon:r("MWXIconShare"),label:v,onPress:function(){(u||(u=o("ODS"))).bumpEntityKey(3185,"mwchat_media_viewer","forward"),g()},testid:void 0})}),t[6]=g,t[7]=S):S=t[7],S}l.default=d}),226);
__d("MWV2MediaViewerControls.react",["MWV2MediaViewerCloseControl.react","MWV2MediaViewerContext.react","MWV2MediaViewerDownloadControl.react","MWV2MediaViewerForwardControl.react","MWXRow.react","cr:9742","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useContext;function c(e){var t=o("react-compiler-runtime").c(19),a=e.attachment,i=e.message,l=e.onClose,c=e.thread,d=u(o("MWV2MediaViewerContext.react").context),m;t[0]!==a||t[1]!==d?(m=d.getDownloadUrl(a,"MWV2MediaViewerControls"),t[0]=a,t[1]=d,t[2]=m):m=t[2];var p=m,_;t[3]!==a||t[4]!==i?(_=i!=null&&a!=null&&n("cr:9742")!=null&&s.jsx(n("cr:9742"),{attachment:a,message:i}),t[3]=a,t[4]=i,t[5]=_):_=t[5];var f;t[6]!==p?(f=p!=null&&s.jsx(r("MWV2MediaViewerDownloadControl.react"),{uri:p}),t[6]=p,t[7]=f):f=t[7];var g;t[8]!==a||t[9]!==i||t[10]!==c?(g=i!=null?s.jsx(r("MWV2MediaViewerForwardControl.react"),{attachment:a,message:i,thread:c}):null,t[8]=a,t[9]=i,t[10]=c,t[11]=g):g=t[11];var h;t[12]!==l?(h=l!=null?s.jsx(r("MWV2MediaViewerCloseControl.react"),{onClose:l}):null,t[12]=l,t[13]=h):h=t[13];var y;return t[14]!==_||t[15]!==f||t[16]!==g||t[17]!==h?(y=s.jsxs(r("MWXRow.react"),{paddingTop:0,spacing:8,testid:void 0,children:[_,f,g,h]}),t[14]=_,t[15]=f,t[16]=g,t[17]=h,t[18]=y):y=t[18],y}l.default=c}),98);
__d("MWV2MediaViewerControlsContainer.react",["CometPlaceholder.react","MWV2MediaViewerControls.react","MWV2MediaViewerControlsFallback.react","cr:7197","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(10),a=e.attachment,i=e.message,l=e.onClose,u=e.thread,c;t[0]!==l?(c=l!=null&&!n("cr:7197")?s.jsx(r("MWV2MediaViewerControlsFallback.react"),{onClose:l}):null,t[0]=l,t[1]=c):c=t[1];var d;t[2]!==a||t[3]!==i||t[4]!==l||t[5]!==u?(d=n("cr:7197")?s.jsx(n("cr:7197"),{attachment:a,message:i,onClose:l,thread:u}):s.jsx(r("MWV2MediaViewerControls.react"),{attachment:a,message:i,onClose:l,thread:u}),t[2]=a,t[3]=i,t[4]=l,t[5]=u,t[6]=d):d=t[6];var m;return t[7]!==c||t[8]!==d?(m=s.jsx(r("CometPlaceholder.react"),{fallback:c,name:"MWV2MediaViewerContent.Controls",children:d}),t[7]=c,t[8]=d,t[9]=m):m=t[9],m}l.default=u}),98);
__d("MWV2MediaViewerDimensions",["I64"],(function(t,n,r,o,a,i,l){"use strict";var e,s=1.75;function u(t){return t.previewHeightLarge!=null?(e||(e=o("I64"))).to_float(t.previewHeightLarge):t.previewHeight!=null?(e||(e=o("I64"))).to_float(t.previewHeight):void 0}function c(t){return t.previewWidthLarge!=null?(e||(e=o("I64"))).to_float(t.previewWidthLarge):t.previewWidth!=null?(e||(e=o("I64"))).to_float(t.previewWidth):void 0}function d(e){return{height:u(e),width:c(e)}}l.IMAGE_EXPANSION_FACTOR=s,l.getLargestAttachmentDimensions=d}),98);
__d("MWV2MediaViewerItemImage.react",["fbt","BaseImage.react","I64","MWAnimatedImageControlsUtil","MWAnimatedImageThumbnailWithPlayButton.react","MWChatAttachmentMediaState.react","MWV2MediaViewerContext.react","MWV2MediaViewerDimensions","MWXIconHd","MWXIconStrict.react","MWXPressable.react","MWXThreadThemeColor","MessagingAttachmentType","cr:7201","cr:7203","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=e||(e=o("react")),d=e,m=d.useContext,p=d.useEffect,_=d.useRef,f=d.useState;function g(e){var t=o("react-compiler-runtime").c(31),a=e.attachment,i=e.imageContainerRef,l=e.mediaRenderQpl,d=e.outsideContainerRef,g=o("MWAnimatedImageControlsUtil").useGetMessengerAutoplaySetting(),y=m(o("MWChatAttachmentMediaState.react").context),C=y.isImageExpanded,b=m(o("MWV2MediaViewerContext.react").context),v=b.getPlayableUrl,S=b.heroLoggingComponent,R=_(null),L=f(!1),E=L[0],k=L[1],I,T;t[0]!==l?(I=function(){var e;R.current!=null&&(e=R.current)!=null&&e.complete&&l.endSuccess()},T=[l],t[0]=l,t[1]=I,t[2]=T):(I=t[1],T=t[2]),p(I,T);var D;t[3]!==a?(D=o("MWV2MediaViewerDimensions").getLargestAttachmentDimensions(a),t[3]=a,t[4]=D):D=t[4];var x=D,$=x.height,P=x.width,N=(u||(u=o("I64"))).to_int32(a.attachmentType)===r("MessagingAttachmentType").ANIMATED_IMAGE,M;t[5]!==a||t[6]!==v||t[7]!==l?(M=v(a,"MediaViewerImage",l),t[5]=a,t[6]=v,t[7]=l,t[8]=M):M=t[8];var w=M;if(w!=null){var A=N&&g!==o("MWAnimatedImageControlsUtil").MWAutoplayAnimationsSetting.ON,F;t[9]!==S?(F=S("MWV2MediaViewerImage"),t[9]=S,t[10]=F):F=t[10];var O;t[11]!==a||t[12]!==$||t[13]!==i||t[14]!==N||t[15]!==E||t[16]!==l||t[17]!==d||t[18]!==A||t[19]!==w||t[20]!==P?(O=A?E===!1?c.jsx(o("MWAnimatedImageThumbnailWithPlayButton.react").MWAnimatedImageThumbnailWithPlayButton,{connectBottom:!1,connectTop:!1,dbAttachment:a,entryPoint:o("MWAnimatedImageThumbnailWithPlayButton.react").AnimatedImageEntryPoint.MediaViewer,mediaRenderQpl:l,message:null,onPlay:function(){return k(!0)},outgoing:!1,previewHeight:$,previewWidth:P}):c.jsx(r("MWXPressable.react"),{"aria-label":s._(/*BTDS*/"Pause GIF"),hideHoverOverlay:!0,onPress:function(){A&&k(!1)},children:c.jsx(r("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){l.endFail("load-image-error")},onLoad:function(){l.endSuccess()},ref:R,src:w,width:"100%"})}):!N&&n("cr:7203")!=null?c.jsx(n("cr:7203"),{imageContainerRef:i,outsideContainerRef:d,children:c.jsx(r("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){l.endFail("load-image-error")},onLoad:function(){l.endSuccess()},ref:R,src:w,width:"100%"})}):c.jsx(r("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){l.endFail("load-image-error")},onLoad:function(){l.endSuccess()},ref:R,src:w,width:"100%"}),t[11]=a,t[12]=$,t[13]=i,t[14]=N,t[15]=E,t[16]=l,t[17]=d,t[18]=A,t[19]=w,t[20]=P,t[21]=O):O=t[21];var B,W;t[22]!==a||t[23]!==C?(B=c.jsx(h,{attachment:a,shouldHide:C}),W=n("cr:7201")&&c.jsx(n("cr:7201"),{attachment:a,shouldHide:C}),t[22]=a,t[23]=C,t[24]=B,t[25]=W):(B=t[24],W=t[25]);var q;return t[26]!==F||t[27]!==O||t[28]!==B||t[29]!==W?(q=c.jsxs(c.Fragment,{children:[F,O,B,W]}),t[26]=F,t[27]=O,t[28]=B,t[29]=W,t[30]=q):q=t[30],q}else return l.endFail("missing-playable-url"),null}function h(e){var t=o("react-compiler-runtime").c(6),n=e.attachment,a=e.shouldHide,i=a===void 0?!1:a,l=n,s=l.isHd===!0;if(!s)return null;var u;t[0]!==i?(u={0:{className:"x78zum5 x5yr21d x47corl x10l6tqk xh8yej3"},1:{className:"x5yr21d x47corl x10l6tqk xh8yej3 x1s85apg"}}[!!i<<0],t[0]=i,t[1]=u):u=t[1];var d;t[2]===Symbol.for("react.memo_cache_sentinel")?(d={className:"xdg88n9 x10l6tqk xomnu4r"},t[2]=d):d=t[2];var m;t[3]===Symbol.for("react.memo_cache_sentinel")?(m=c.jsx("div",babelHelpers.extends({},d,{children:c.jsx(r("MWXIconStrict.react"),{color:o("MWXThreadThemeColor").mwxThreadThemeColor("rgba(255,255,255,0.7)"),icon:r("MWXIconHd"),size:24})})),t[3]=m):m=t[3];var p;return t[4]!==u?(p=c.jsx("div",babelHelpers.extends({},u,{children:m})),t[4]=u,t[5]=p):p=t[5],p}l.default=g}),226);
__d("MWV2MediaViewerItemVideo.react",["MWChatVideoPlayer.react","MWV2MediaViewerContext.react","cr:7201","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useContext;function c(e){var t=o("react-compiler-runtime").c(14),a=e.attachment,i=e.mediaRenderQpl,l=u(o("MWV2MediaViewerContext.react").context),c=l.getPlayableUrl,d;t[0]!==a||t[1]!==c||t[2]!==i?(d=c(a,"MediaViewerVideo",i),t[0]=a,t[1]=c,t[2]=i,t[3]=d):d=t[3];var m=d;if(m!=null){var p;t[4]===Symbol.for("react.memo_cache_sentinel")?(p={className:"x78zum5 x1iyjqo2 xmz0i5r"},t[4]=p):p=t[4];var _;t[5]!==a.attachmentFbid||t[6]!==i||t[7]!==m?(_=s.jsx(r("MWChatVideoPlayer.react"),{controls:"mwchat",fbid:a.attachmentFbid,hideExpandButton:!1,isMediaViewer:!0,mediaRenderQpl:i,originalHeight:1e3,originalWidth:1e3,sdSrc:m,shouldForcePauseOnClick:!1}),t[5]=a.attachmentFbid,t[6]=i,t[7]=m,t[8]=_):_=t[8];var f;t[9]!==a?(f=n("cr:7201")&&s.jsx(n("cr:7201"),{attachment:a}),t[9]=a,t[10]=f):f=t[10];var g;return t[11]!==_||t[12]!==f?(g=s.jsxs("div",babelHelpers.extends({},p,{children:[_,f]})),t[11]=_,t[12]=f,t[13]=g):g=t[13],g}else return i.endFail("missing-playable-url"),null}l.default=c}),98);
__d("MWV2MediaViewerItem.react",["I64","LSIntEnum","MWChatAttachmentMediaState.react","MWMediaViewerRenderQpl","MWV2MediaViewerAspectRatioContainer.react","MWV2MediaViewerDimensions","MWV2MediaViewerItemImage.react","MWV2MediaViewerItemVideo.react","MWV2MediaViewerNullState.react","MessagingAttachmentType","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=e||(e=o("react")),d=e,m=d.useContext,p=d.useRef;function _(e){var t=o("react-compiler-runtime").c(10),n=e.attachment,a=e.onClose,i=e.threadType,l=n.attachmentType;if(!((s||(s=o("I64"))).equal(l,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE))||(s||(s=o("I64"))).equal(l,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE))||(s||(s=o("I64"))).equal(l,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO)))){var d;return t[0]===Symbol.for("react.memo_cache_sentinel")?(d=c.jsx(r("MWV2MediaViewerNullState.react"),{}),t[0]=d):d=t[0],d}var m;t[1]===Symbol.for("react.memo_cache_sentinel")?(m={className:"x1ey2m1c xtijo5x x1o0tod x10l6tqk x13vifvy"},t[1]=m):m=t[1];var p;t[2]!==a?(p=c.jsx("div",babelHelpers.extends({"aria-hidden":!0},m,{"data-testid":void 0,onClick:a})),t[2]=a,t[3]=p):p=t[3];var _;t[4]!==n||t[5]!==i?(_=c.jsx(f,{attachment:n,threadType:i}),t[4]=n,t[5]=i,t[6]=_):_=t[6];var g;return t[7]!==p||t[8]!==_?(g=c.jsxs(c.Fragment,{children:[p,_]}),t[7]=p,t[8]=_,t[9]=g):g=t[9],g}function f(e){var t=o("react-compiler-runtime").c(11),n=e.attachment,a=e.onClose,i=e.threadType,l=o("MWMediaViewerRenderQpl").useMediaViewerRenderQpl(n,i),d=m(o("MWChatAttachmentMediaState.react").context),_=d.isImageExpanded,f=_?o("MWV2MediaViewerDimensions").IMAGE_EXPANSION_FACTOR:1,g=p(null),h=p(null),y;t[0]!==n?(y=o("MWV2MediaViewerDimensions").getLargestAttachmentDimensions(n),t[0]=n,t[1]=y):y=t[1];var C=y,b=C.height,v=C.width,S=n.attachmentType,R;return t[2]!==n||t[3]!==b||t[4]!==f||t[5]!==_||t[6]!==l||t[7]!==a||t[8]!==S||t[9]!==v?(R=(s||(s=o("I64"))).equal(S,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE))||(s||(s=o("I64"))).equal(S,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE))?c.jsx(r("MWV2MediaViewerAspectRatioContainer.react"),{height:b,imageContainerRef:h,imageExpansionFactor:f,isImageExpanded:_,onClickOutsideOfChildren:a,outsideContainerRef:g,width:v,children:c.jsx(r("MWV2MediaViewerItemImage.react"),{attachment:n,imageContainerRef:h,mediaRenderQpl:l,outsideContainerRef:g})}):(s||(s=o("I64"))).equal(S,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO))?c.jsx(r("MWV2MediaViewerItemVideo.react"),{attachment:n,mediaRenderQpl:l}):null,t[2]=n,t[3]=b,t[4]=f,t[5]=_,t[6]=l,t[7]=a,t[8]=S,t[9]=v,t[10]=R):R=t[10],R}l.default=_}),98);
__d("MWV2MediaViewerContent.react",["fbt","CometHideLayerOnEscape.react","CometPlaceholder.react","FDSBlurredBackgroundImage.react","I64","LSIntEnum","MWChatAttachmentMediaNavigationHotkeys.react","MWChatAttachmentMediaState.react","MWChatAttachmentMediaThumbnails.react","MWChatMediaViewerNavigationTapTarget.react","MWV2MediaViewerContainer.react","MWV2MediaViewerContext.react","MWV2MediaViewerControlsContainer.react","MWV2MediaViewerItem.react","MWV2MediaViewerNullState.react","MWXColumn.react","MWXColumnItem.react","MWXRow.react","MWXRowItem.react","MessagingAttachmentType","ReQL","ReQLSuspense","justknobx","react","react-compiler-runtime","useReStore","useShouldShowPlaybackErrorFallback","useShouldShowUnsupportedCodecFallback"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c,d,m=u||(u=o("react")),p=u,_=p.useContext,f=p.useEffect,g={mediaItem:{marginTop:"x14vqqas",marginInlineEnd:"xbmvrgn",marginBottom:"xod5an3",marginInlineStart:"x1diwwjn",$$css:!0},mediaRow:{minHeight:"x2lwn1j",$$css:!0},noOverflow:{maxWidth:"x193iq5w",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0}};function h(e){var t=o("react-compiler-runtime").c(6),n=e.attachment,a=_(o("MWV2MediaViewerContext.react").context),i=a.getPreviewUrl;if(n==null||(c||(c=o("I64"))).equal(n.attachmentType,(d||(d=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE)))return null;var l;t[0]!==n||t[1]!==i?(l=i(n,"BlurredBackground"),t[0]=n,t[1]=i,t[2]=l):l=t[2];var s=l;if(s==null)return null;var u;t[3]===Symbol.for("react.memo_cache_sentinel")?(u={className:"x1ey2m1c xtijo5x x1o0tod xuzhngd x10l6tqk x13vifvy"},t[3]=u):u=t[3];var p;return t[4]!==s?(p=m.jsx("div",babelHelpers.extends({},u,{children:m.jsx(r("FDSBlurredBackgroundImage.react"),{src:s})})),t[4]=s,t[5]=p):p=t[5],p}function y(t){var n=o("react-compiler-runtime").c(69),a=t.initialAttachment,l=t.onClose,u=t.thread,c=_(o("MWChatAttachmentMediaState.react").context),d=c.canMoveBackward,p=c.canMoveForward,y=c.card,C=c.isImageExpanded,b=c.moveBackward,v=c.moveForward,S=c.shouldTriggerLoadMore,R=_(o("MWV2MediaViewerContext.react").context),L=R.getPreviewUrl,E=R.loadMore,k=(e||(e=r("useReStore")))(),I=a==null?void 0:a.threadKey,T=a==null?void 0:a.messageId,D;n[0]!==k.tables.attachments||n[1]!==T||n[2]!==I?(D=function(){return o("ReQL").fromTableDescending(k.tables.attachments).getKeyRange(I,T)},n[0]=k.tables.attachments,n[1]=T,n[2]=I,n[3]=D):D=n[3];var x;n[4]!==k||n[5]!==T||n[6]!==I?(x=[k,T,I],n[4]=k,n[5]=T,n[6]=I,n[7]=x):x=n[7];var $=o("ReQLSuspense").useFirst(D,x,i.id+":114")!=null,P=y!=null?y.attachment:$?a:void 0,N;n[8]!==P||n[9]!==k.tables.messages?(N=function(){return(P==null?void 0:P.messageId)==null?o("ReQL").empty():o("ReQL").fromTableAscending(k.tables.messages.index("messageId")).getKeyRange(P.messageId)},n[8]=P,n[9]=k.tables.messages,n[10]=N):N=n[10];var M=P==null?void 0:P.messageId,w;n[11]!==k.tables.messages||n[12]!==M?(w=[M,k.tables.messages],n[11]=k.tables.messages,n[12]=M,n[13]=w):w=n[13];var A=o("ReQLSuspense").useFirst(N,w,i.id+":130"),F=S,O,B;n[14]!==E||n[15]!==F?(O=function(){F&&E()},B=[F,E],n[14]=E,n[15]=F,n[16]=O,n[17]=B):(O=n[16],B=n[17]),f(O,B);var W=r("useShouldShowUnsupportedCodecFallback")(P),q=r("useShouldShowPlaybackErrorFallback")(P),U;n[18]!==P||n[19]!==q||n[20]!==W||n[21]!==l||n[22]!==u?(U=P==null?m.jsx(r("MWV2MediaViewerNullState.react"),{}):!W&&!q?m.jsx(r("MWV2MediaViewerItem.react"),{attachment:P,onClose:l,threadType:u.threadType}):null,n[18]=P,n[19]=q,n[20]=W,n[21]=l,n[22]=u,n[23]=U):U=n[23];var V=U,H;n[24]===Symbol.for("react.memo_cache_sentinel")?(H=r("justknobx")._("3491"),n[24]=H):H=n[24];var G=H,z;n[25]!==P||n[26]!==A||n[27]!==l||n[28]!==u?(z=m.jsx(r("MWV2MediaViewerControlsContainer.react"),{attachment:P,message:A,onClose:l,thread:u}),n[25]=P,n[26]=A,n[27]=l,n[28]=u,n[29]=z):z=n[29];var j;n[30]!==l?(j=G?null:m.jsx(o("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:l}),n[30]=l,n[31]=j):j=n[31];var K;n[32]!==P?(K=m.jsx(r("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.BlurredBackground",children:m.jsx(h,{attachment:P})}),n[32]=P,n[33]=K):K=n[33];var Q;n[34]===Symbol.for("react.memo_cache_sentinel")?(Q=[g.mediaRow,g.noOverflow],n[34]=Q):Q=n[34];var X;n[35]===Symbol.for("react.memo_cache_sentinel")?(X=s._(/*BTDS*/"Previous photo"),n[35]=X):X=n[35];var Y=!d,J;n[36]!==C||n[37]!==b||n[38]!==Y?(J=m.jsx(r("MWXRowItem.react"),{children:m.jsx(r("MWChatMediaViewerNavigationTapTarget.react"),{direction:"previous",label:X,onClick:b,shouldHide:Y,shouldHideWithoutTransition:C,testid:void 0})}),n[36]=C,n[37]=b,n[38]=Y,n[39]=J):J=n[39];var Z;n[40]!==V?(Z=m.jsx(r("MWXRowItem.react"),{expanding:!0,verticalAlign:"stretch",xstyle:g.mediaItem,children:m.jsx(r("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.MediaContent",children:V})}),n[40]=V,n[41]=Z):Z=n[41];var ee;n[42]===Symbol.for("react.memo_cache_sentinel")?(ee=s._(/*BTDS*/"Next photo"),n[42]=ee):ee=n[42];var te=!p,ne;n[43]!==C||n[44]!==v||n[45]!==te?(ne=m.jsx(r("MWXRowItem.react"),{children:m.jsx(r("MWChatMediaViewerNavigationTapTarget.react"),{direction:"next",label:ee,onClick:v,shouldHide:te,shouldHideWithoutTransition:C,testid:void 0})}),n[43]=C,n[44]=v,n[45]=te,n[46]=ne):ne=n[46];var re;n[47]!==J||n[48]!==Z||n[49]!==ne?(re=m.jsx(r("MWXColumnItem.react"),{expanding:!0,verticalAlign:"center",children:m.jsxs(r("MWXRow.react"),{align:"justify",expanding:!0,paddingHorizontal:0,paddingVertical:0,spacingHorizontal:0,verticalAlign:"stretch",xstyle:Q,children:[J,Z,ne]})}),n[47]=J,n[48]=Z,n[49]=ne,n[50]=re):re=n[50];var oe;n[51]!==L||n[52]!==C?(oe=m.jsx(r("MWXColumnItem.react"),{children:m.jsx(r("MWChatAttachmentMediaThumbnails.react"),{getPreviewUrl:L,shouldHide:C})}),n[51]=L,n[52]=C,n[53]=oe):oe=n[53];var ae;n[54]!==re||n[55]!==oe?(ae=m.jsxs(r("MWXColumn.react"),{align:"stretch",expanding:!0,paddingHorizontal:0,verticalAlign:"space-between",children:[re,oe]}),n[54]=re,n[55]=oe,n[56]=ae):ae=n[56];var ie;n[57]!==C||n[58]!==z||n[59]!==j||n[60]!==K||n[61]!==ae?(ie=m.jsxs(r("MWV2MediaViewerContainer.react"),{actions:z,hideActions:C,children:[j,K,ae]}),n[57]=C,n[58]=z,n[59]=j,n[60]=K,n[61]=ae,n[62]=ie):ie=n[62];var le=ie;if(l!=null)if(G){var se;return n[63]!==le||n[64]!==l?(se=m.jsx(o("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:l,children:le}),n[63]=le,n[64]=l,n[65]=se):se=n[65],se}else{var ue;return n[66]!==le||n[67]!==l?(ue=m.jsx(r("CometHideLayerOnEscape.react"),{onHide:l,children:le}),n[66]=le,n[67]=l,n[68]=ue):ue=n[68],ue}return le}l.default=y}),226);
__d("useMWInboxMediaRestoreLoop",["Int64Hooks","LSMessagingThreadTypeUtil","MAWMiActOnActThreadReadyDeferred","promiseDone","react","react-compiler-runtime","requireDeferred","useAsyncReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useCallback,c=s.useState,d=r("requireDeferred")("MAWFTSRestoreSync").__setRef("useMWInboxMediaRestoreLoop");function m(e){var t=o("react-compiler-runtime").c(14),n=e.threadKey,a=r("useAsyncReStore")(),i=c(null),l=i[0],s=i[1],u,m;t[0]!==a||t[1]!==l||t[2]!==e.threadType||t[3]!==n?(u=function(){var t=async function(){var e=await a;r("promiseDone")(r("MAWMiActOnActThreadReadyDeferred")(e,n,"mediaRestore",function(e,t){return d.onReady(function(e){var n=e.getMediaRestoreSync;n().setActiveThreadId(t),r("promiseDone")(n().startMediaSyncingLoop()),s(n())}),Promise.resolve()}))};return o("LSMessagingThreadTypeUtil").isArmadilloSecure(e.threadType)&&r("promiseDone")(t()),function(){l==null||l.setIsStarted(!1),l==null||l.setShouldPauseRestore(!0)}},m=[a,l,e.threadType,n],t[0]=a,t[1]=l,t[2]=e.threadType,t[3]=n,t[4]=u,t[5]=m):(u=t[4],m=t[5]),o("Int64Hooks").useEffectInt64(u,m);var p;t[6]!==l?(p=function(){l!=null&&(l.resetEBAvailability(),l.isStarted()||r("promiseDone")(l.startMediaSyncingLoop()))},t[6]=l,t[7]=p):p=t[7];var _=p,f;t[8]!==l?(f=function(){l!=null&&(l.isStarted()||r("promiseDone")(l.startMediaSyncingLoop()))},t[8]=l,t[9]=f):f=t[9];var g=f,h,y;return t[10]!==_||t[11]!==g?(h=function(){return{onEBOnboarded:_,startMediaSync:g}},y=[_,g],t[10]=_,t[11]=g,t[12]=h,t[13]=y):(h=t[12],y=t[13]),o("Int64Hooks").useMemoInt64(h,y)}l.default=m}),98);