;/*FB_PKG_DELIM*/

__d("WAGetUserMedia",[],(function(t,n,r,o,a,i){"use strict";function e(){var e=navigator.mediaDevices;return e==null?null:function(t){return e.getUserMedia(t)}}var l=e();i.getUserMedia=l}),66);
__d("WAPttComposerOpusRecorder",["$InternalEnum","WAGetUserMedia","WANullthrows","WAOpusRecorderWorkerClient","err"],(function(t,n,r,o,a,i,l){var e={bitRate:16e3,bufferLength:4096,numberOfChannels:1,encoderSampleRate:16e3,maxBuffersPerPage:40,encoderApplication:2048,encoderFrameSize:20,streamOptions:{optional:[],mandatory:{googEchoCancellation:!1,googAutoGainControl:!1,googNoiseSuppression:!1,googHighpassFilter:!1}}},s=n("$InternalEnum").Mirrored(["INACTIVE","RECORDING","PAUSED","STOPPED"]),u=(function(){function t(t){var n=this;if(this._duration=0,this._recordedPages=[],this._state=s.INACTIVE,this._isFirstBuffer=!1,this._requestCount=0,this._pendingFlushResolvers=new Map,this._handleEncoderMessage=function(e){var t=e.data;switch(t.message){case"page":n._storePage(t.page);break;case"flushed":n._handleFlushed(t.requestId);break;default:throw r("err")("Invalid message event type: "+t.message)}},!d())throw r("err")("Recording is not supported in this browser");this._createStream=t.createStream,this._onDuration=t.onDuration,this._onPause=t.onPause,this._onResume=t.onResume,this._onStart=t.onStart,this._onStop=t.onStop,this._handlePage=t.onPage,this._completeRecordingPromise=new Promise(function(e){n._resolveCompleteRecordingPromise=e}),this._audioContext=new AudioContext,this._encoderNode=this._audioContext.createScriptProcessor(e.bufferLength,e.numberOfChannels,e.numberOfChannels),this._encoderNode.onaudioprocess=function(e){n._encodeBuffers(e.inputBuffer)},this._monitorNode=this._audioContext.createGain()}var n=t.prototype;return n.getState=function(){return this._state},n.start=async function(){var t,n;switch(this._state){case s.RECORDING:return!0;case s.STOPPED:return!1;case s.PAUSED:return this.resume();case s.INACTIVE:break}this._recordedPages=[],this._isFirstBuffer=!0,this._duration=0;var r=o("WAOpusRecorderWorkerClient").getOpusEncoderWorker();this._encoder=r,r.addEventListener("message",this._handleEncoderMessage);var a=await this._startRecording();return a?((t=this._onStart)==null||t.call(this),(n=this._onDuration)==null||n.call(this,this._duration),r.postMessage({command:"encode-init",config:babelHelpers.extends({},e,{originalSampleRate:this._audioContext.sampleRate})}),this._encoderNode.connect(this._audioContext.destination),!0):!1},n.stop=function(){var e,t;this._state!==s.STOPPED&&(this._state=s.STOPPED,(e=this._recordingAbortController)==null||e.abort(),this._audioContext.close&&this._audioContext.close(),this._monitorNode.disconnect(),this._encoderNode.disconnect(),(t=this._encoder)==null||t.postMessage({command:"encode-done"}))},n.pause=function(){var e,t;this._state===s.RECORDING&&(this._state=s.PAUSED,(e=this._recordingAbortController)==null||e.abort(),(t=this._onPause)==null||t.call(this))},n.resume=async function(){var e;switch(this._state){case s.RECORDING:return!0;case s.STOPPED:return!1;case s.INACTIVE:throw r("err")("Attempting to resume recording that hasn't started");case s.PAUSED:break}var t=await this._startRecording();return t?((e=this._onResume)==null||e.call(this),!0):!1},n.getDuration=function(){return this._duration},n.getMonitorNode=function(){return this._monitorNode},n._encodeBuffers=function(t){var e;if(this._isFirstBuffer){this._isFirstBuffer=!1;return}if(this._state===s.RECORDING){for(var n=[],o=0;o<t.numberOfChannels;o++)n[o]=t.getChannelData(o);var a=r("WANullthrows")(this._encoder);a.postMessage({command:"encode",buffers:n}),this._duration+=t.duration,(e=this._onDuration)==null||e.call(this,this._duration)}},n._getNextRequestId=function(){return this._requestCount++,this._requestCount},n._startRecording=async function(){this._state=s.RECORDING,this._recordingAbortController=new AbortController;var e=await m(this._createStream,this._audioContext,[this._encoderNode,this._monitorNode],this._recordingAbortController.signal);return e?!0:(this.stop(),!1)},n._storePage=function(t){var e;if(this._recordedPages.push(t),t[5]&4){var n,o;(n=this._handlePage)==null||n.call(this,t,!0);var a=r("WANullthrows")(this._encoder);a.removeEventListener("message",this._handleEncoderMessage),this._resolveCompleteRecordingPromise(c(this._recordedPages)),this._recordedPages=[],(o=this._onStop)==null||o.call(this);return}(e=this._handlePage)==null||e.call(this,t,!1)},n._handleFlushed=function(t){var e=r("WANullthrows")(this._pendingFlushResolvers.get(t));this._pendingFlushResolvers.delete(t),e(c(this._recordedPages))},n.getPartialRecording=function(){var e=this,t=this._getNextRequestId(),n=new Promise(function(n){e._pendingFlushResolvers.set(t,n)}),o=r("WANullthrows")(this._encoder);return o.postMessage({command:"flush",requestId:t}),n},n.getCompleteRecording=function(){return this._completeRecordingPromise},t})();function c(e){var t=e.reduce(function(e,t){return e+t.length},0),n=new Uint8Array(t),r=0;for(var o of e)n.set(o,r),r+=o.length;return new Blob([n],{type:"audio/ogg; codecs=opus"})}function d(){return!!(window.AudioContext&&o("WAGetUserMedia").getUserMedia)}async function m(e,t,n,r){var o=await e(r);if(r.aborted||o==null)return!1;var a=t.createMediaStreamSource(o);return n.forEach(function(e){a.connect(e)}),r.addEventListener("abort",function(){o.getTracks().forEach(function(e){e.stop()}),a.disconnect()},{once:!0}),!0}l.OpusRecorderState=s,l.OpusRecorder=u}),98);
__d("WAPttComposerRecorderPollableTimer",[],(function(t,n,r,o,a,i){var e=(function(){function e(){}var t=e.prototype;return t.start=function(){this.$1=Date.now()},t.stop=function(){this.$2=Date.now()},t.pause=function(){this.stop()},t.resume=function(){this.$1=Date.now()-this.getTime(),this.$2=null},t.getTime=function(){var e,t=this.$1;if(t==null)return 0;var n=(e=this.$2)!=null?e:Date.now();return n-t},e})();i.default=e}),66);
__d("WAPttComposerScaleWaveform",["invariant"],(function(t,n,r,o,a,i,l,s){function e(e,t){return t===e.length?e:t===0?[]:e.length===0?new Array(t).fill(0):t>e.length?u(e,t):c(e,t)}function u(e,t){t>e.length||s(0,75746,t,e.length);var n;if(e.length===1)n=0;else{var r=(t-e.length)/(e.length-1);n=1/(1+r)}var o=[];t>=1&&o.push(e[0]);for(var a=1;a<t-1;a++){var i=a*n,l=Math.floor(i),u=i-l;o.push(d(e[l],e[Math.ceil(i)],u))}return t>=2&&o.push(e[e.length-1]),o}function c(e,t){t<e.length||s(0,75747,t,e.length);var n=[],r=t/e.length,o=0,a=0,i=0;for(var l of e)o+=l,i+=1,a+=r,a>=1&&(n.push(o/i),i=0,o=0,a-=1);return i>0&&n.push(o/i),n}function d(e,t,n){return e+(t-e)*n}l.default=e}),98);
__d("WAStartAnimationLoop",[],(function(t,n,r,o,a,i){function e(e,t){var n=t!=null?t:{},r=n.delay,o=r===void 0?0:r,a,i,l,s=function(){i=!0,window.cancelAnimationFrame(a)},u=function(n){(l==null||n-l>=o)&&(e(n),l=n),!i&&(a=window.requestAnimationFrame(u))};return a=window.requestAnimationFrame(u),s}i.startAnimationLoop=e}),66);
__d("WAPttComposerWaveformRecorder",["WANullthrows","WAPttComposerRecorderPollableTimer","WAPttComposerScaleWaveform","WAStartAnimationLoop"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e,t){var n=this;this.$2=new(r("WAPttComposerRecorderPollableTimer")),this.$3=[],this.$4=[],this.$5=0,this.$10=function(){n.$5=Math.max(n.$5,n.$11());var e=n.$3.length/n.$1,t=Math.floor((n.getDuration()-e)*n.$1);if(t!==0){for(var r=0;r<t;r++)n.$3.push(n.$5);n.$5=0}},this.$12=0,this.$7=s(e),e.connect(this.$7),this.$1=t}var t=e.prototype;return t.start=function(){this.$2.start(),this.$9()},t.stop=function(){var e;this.$2.stop(),(e=this.$6)==null||e.call(this)},t.pause=function(){var e;this.$2.pause(),(e=this.$6)==null||e.call(this)},t.resume=function(){this.$2.resume(),this.$9()},t.$9=function(){this.$6=o("WAStartAnimationLoop").startAnimationLoop(this.$10)},t.$11=function(){var e,t=r("WANullthrows")(this.$7);this.$8=(e=this.$8)!=null?e:new Uint8Array(t.frequencyBinCount);var n=this.$8;return t.getByteFrequencyData(n),Math.max.apply(Math,Array.from(n))/255},t.commitSamples=function(t){var e=Math.floor(t*this.$1),n=e-this.$4.length,o=this.$3.length-this.$12;if(!(n===0||o===0)){var a=this.$3.slice(this.$12,this.$3.length),i=r("WAPttComposerScaleWaveform")(a,n);for(var l of i)this.$4.push(l);this.$12=this.$3.length}},t.getSamples=function(){return this.$3},t.getDuration=function(){var e,t=(e=this.$2.getTime())!=null?e:0;return t/1e3},t.getCorrectedSamples=function(){return this.$4},e})();function s(e){var t=e.context.createAnalyser();return t.fftSize=32,t.smoothingTimeConstant=0,t.minDecibels=-60,t.maxDecibels=-10,t}l.default=e}),98);
__d("WAPttComposerRecorder",["WAPttComposerOpusRecorder","WAPttComposerWaveformRecorder"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e){var t=this;this._handleOpusRecorderDuration=function(){t._waveformRecorder.commitSamples(t.getDuration()),t._onDuration==null||t._onDuration(t.getDuration())},this._onDuration=e.onDuration,this._opusRecorder=new(o("WAPttComposerOpusRecorder")).OpusRecorder({createStream:e.createStream,onDuration:this._handleOpusRecorderDuration,onPage:function(n,r){e.onPage==null||e.onPage(n,r)}}),this._waveformRecorder=new(r("WAPttComposerWaveformRecorder"))(this._opusRecorder.getMonitorNode(),e.waveformSampleRate)}var t=e.prototype;return t.start=async function(){var e=await this._opusRecorder.start();return e?(this._waveformRecorder.start(),!0):!1},t.stop=function(){this._opusRecorder.stop(),this._waveformRecorder.stop()},t.pause=function(){this._opusRecorder.pause(),this._waveformRecorder.pause()},t.resume=async function(){var e=await this._opusRecorder.resume();return e?(this._waveformRecorder.resume(),!0):!1},t.getDuration=function(){return this._opusRecorder.getDuration()},t.getPreciseDuration=function(){var e;return(e=this._waveformRecorder.getDuration())!=null?e:0},t.getLiveWaveformSamples=function(){return this._waveformRecorder.getSamples()},t.getCorrectedWaveformSamples=function(){return this._waveformRecorder.getCorrectedSamples()},t.getPartialRecording=function(){return this._opusRecorder.getPartialRecording()},t.getCompleteRecording=function(){return this._opusRecorder.getCompleteRecording()},e})();l.default=e}),98);
__d("MWPUseVoiceRecorderV2",["FBLogger","MWPAudioPlayerIcons.react","MWPAudioPlayerLabels","WAGetSafeQPLError","WAMaybeTranscodeOggOpusToWavForPlayback","WAPttComposerRecorder","clearTimeout","emptyFunction","err","react","setTimeout","useIsMountedRef","usePrevious"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p=m||(m=o("react")),_=m,f=_.useCallback,g=_.useEffect,h=_.useReducer,y=_.useRef,C=function(){return r("FBLogger")("wmi").tags(["audio"])},b=8.5;function v(e){switch(e.stage){case"Unopen":case"Recording":return!1;case"Recorded":case"Playing":return!0}}function S(e){switch(e.stage){case"Unopen":case"Recording":return!1;case"Recorded":case"Playing":return!0}}function R(e){switch(e.stage){case"Unopen":return 0;case"Recording":return e.duration;case"Recorded":case"Playing":return Math.max(e.duration-e.currentTime,0)}}function L(e){switch(e.stage){case"Unopen":return 0;case"Recording":return e.recordingTimeout;case"Recorded":case"Playing":return e.duration}}function E(e){switch(e.stage){case"Unopen":case"Recording":return;case"Recorded":case"Playing":return e.currentTime}}function k(e){switch(e.stage){case"Unopen":case"Recorded":return!1;case"Recording":case"Playing":return!0}}function I(e){return e.stage==="Recorded"?e.currentTime===0:!1}function T(e){switch(e.stage){case"Recording":return o("MWPAudioPlayerLabels").stopLabel;case"Unopen":case"Recorded":return o("MWPAudioPlayerLabels").playLabel;case"Playing":return o("MWPAudioPlayerLabels").pauseLabel}}function D(e,t){switch(e.stage){case"Recording":return p.jsx(o("MWPAudioPlayerIcons.react").StopIcon,{color:t});case"Unopen":case"Recorded":return p.jsx(o("MWPAudioPlayerIcons.react").PlayIcon,{color:t});case"Playing":return p.jsx(o("MWPAudioPlayerIcons.react").PauseIcon,{color:t})}}D.displayName=D.name+" [from "+i.id+"]";function x(e,t){switch(t.type){case"Start":return{duration:0,mediaStream:t.mediaStream,recordingTimeout:t.recordingTimeout,stage:"Recording"};case"Toggle":{switch(e.stage){case"Unopen":return e;case"Recording":return{currentTime:0,duration:e.duration,stage:"Recorded"};case"Recorded":return{currentTime:e.currentTime,duration:e.duration,stage:"Playing"};case"Playing":return{currentTime:e.currentTime,duration:e.duration,stage:"Recorded"}}break}case"UpdateDuration":{if(e.duration!=null&&t.duration<e.duration)return e;var n=t.duration;switch(e.stage){case"Unopen":return e;case"Recording":return{duration:n,mediaStream:e.mediaStream,recordingTimeout:e.recordingTimeout,stage:"Recording"};case"Recorded":return{currentTime:e.currentTime,duration:n,stage:"Recorded"};case"Playing":return{currentTime:e.currentTime,duration:n,stage:"Playing"}}break}case"UpdateTime":{var r=t.currentTime;switch(e.stage){case"Unopen":case"Recording":return e;case"Recorded":{var o=e.duration;return r===o?{currentTime:0,duration:o,stage:"Recorded"}:{currentTime:r,duration:o,stage:"Recorded"}}case"Playing":{var a=e.duration;return r===a?{currentTime:0,duration:a,stage:"Recorded"}:{currentTime:r,duration:a,stage:"Playing"}}}break}case"RecordingTimeout":return{currentTime:0,duration:t.recordingTimeout,stage:"Recorded"};case"Reset":return{stage:"Unopen"}}}var $={stage:"Unopen"};function P(t){var n=t.maxDuration,a=n===void 0?60:n,i=t.logClickStartRecording,l=i===void 0?r("emptyFunction"):i,m=t.logBrowserDenyAccess,p=m===void 0?r("emptyFunction"):m,_=t.createVoiceRecordQpl,v=h(x,$),S=v[0],R=v[1],L=r("useIsMountedRef")(),E=y(),k=y(),I=y(),T=y(),D=y(),P=y(r("emptyFunction")),N=f(async function(t){var n=t[0],r=t[1],a=t[2];if(L.current){var i=new Date().getTime(),l=Math.round(r*1e3),s="audioclip-"+i+"-"+l+".ogg",u=new File([n],s,{type:"audio/ogg"}),c=URL.createObjectURL(await o("WAMaybeTranscodeOggOpusToWavForPlayback").maybeTranscodeOggOpusToWavForPlayback(n));I.current=c;var d=new Audio(c);d.addEventListener("error",function(){var t,n;C().MUSTFIX(e||(e=babelHelpers.taggedTemplateLiteralLoose(["audioElement error code: ",". message: ",""])),(t=d.error)==null?void 0:t.code,(n=d.error)==null?void 0:n.message)}),d.addEventListener("canplay",function(){var e;k.current=d;var t=d.duration;R({duration:t,type:"UpdateDuration"});var n={amplitudes:a,sampling_freq:b},r={duration:t,file:u,waveformData:n};T.current=r,P.current(r),(e=D.current)==null||e.endSuccess()}),d.addEventListener("timeupdate",function(){var e,t=(e=k.current)==null?void 0:e.currentTime;t!=null&&R({currentTime:t,type:"UpdateTime"})}),d.addEventListener("durationchange",function(){var e,t=(e=k.current)==null?void 0:e.duration;t!=null&&!Number.isNaN(t)&&R({duration:t,type:"UpdateDuration"})})}},[L]);g(function(){if(S.stage==="Recording"){l();var e=S.mediaStream;return Promise.resolve().then(function(){var t=new(r("WAPttComposerRecorder"))({createStream:function(){return Promise.resolve(e)},waveformSampleRate:b});return E.current=t,t.start()}).then(function(e){if(e){C().INFO(s||(s=babelHelpers.taggedTemplateLiteralLoose(["PTT recording start successfully"])));return}return Promise.reject(r("err")("PTT recording start failed"))}).catch(function(e){var t;C().MUSTFIX(u||(u=babelHelpers.taggedTemplateLiteralLoose(["PTT recording start Error ",""])),e),(t=D.current)==null||t.endFail("start-error",{string:{failReason:o("WAGetSafeQPLError").getSafeQPLErrorMessage(e)}})}),function(){var e;(e=E.current)==null||e.stop()}}},[l,S.mediaStream,S.stage]);var M=r("usePrevious")(S);g(function(){if((M==null?void 0:M.stage)==="Recording"&&S.stage==="Recorded"){var e=E.current;if(e==null)return;e.stop(),Promise.all([e.getCompleteRecording(),e.getCorrectedWaveformSamples()]).then(function(t){var n=t[0],r=t[1],o=e.getDuration();return N([n,o,r])}).catch(function(e){var t;C().MUSTFIX(c||(c=babelHelpers.taggedTemplateLiteralLoose(["PTT recording stop Error ",""])),e),(t=D.current)==null||t.endFail("browser-deny-access",{string:{failReason:o("WAGetSafeQPLError").getSafeQPLErrorMessage(e)}})})}},[N,M==null?void 0:M.stage,S.stage]),g(function(){if(S.stage==="Recording"){var e=Date.now(),t,n=function(){var o=(Date.now()-e)/1e3;if(o>=a){R({recordingTimeout:a,type:"RecordingTimeout"});return}R({duration:o,type:"UpdateDuration"}),t=r("setTimeout")(n,1e3)};return t=r("setTimeout")(n,1e3),function(){t!=null&&r("clearTimeout")(t)}}},[a,S.stage]);var w=f(function(e){var t=_==null?void 0:_();D.current=t,t==null||t.start({startInfo:{isOpusRecorder:!0}}),R({mediaStream:e,recordingTimeout:a,type:"Start"})},[a,_]),A=f(function(){var e,t;(e=D.current)==null||e.endCancel(),R({type:"Reset"}),(t=k.current)==null||t.pause(),k.current=void 0,T.current=void 0;var n=I.current;n!=null&&(URL.revokeObjectURL(n),I.current=void 0)},[]),F=f(function(){var e=function(){R({maxDuration:a,type:"Toggle"})},t=k.current;if(t==null){e();return}switch(S.stage){case"Unopen":{e();break}case"Recording":{var n;(n=D.current)==null||n.addPoint("stop-recording"),e();break}case"Recorded":{var r;(r=D.current)==null||r.addPoint("play-audio"),t.play().then(e).catch(function(e){var t;C().MUSTFIX(d||(d=babelHelpers.taggedTemplateLiteralLoose(["PTT recording play Error ",""])),e),(t=D.current)==null||t.endFail("browser-deny-access",{string:{failReason:o("WAGetSafeQPLError").getSafeQPLErrorMessage(e)}}),p()});break}case"Playing":{var i;(i=D.current)==null||i.addPoint("pause-playing"),t.pause(),e();break}}},[p,S.stage,a]),O=f(function(){return new Promise(function(e){var t=T.current;if(t!=null)return e(t);if(P.current=e,S.stage==="Recording")return F()})},[S,F]);return{audioEl:k,getVoiceClip:O,reset:A,start:w,state:S,toggle:F}}l.showScreenReaderLabel=v,l.hasScrubber=S,l.getTimerTime=R,l.getDuration=L,l.getCurrentTime=E,l.isProgressing=k,l.isCompleted=I,l.getPlaybackLabel=T,l.getPlaybackIcon=D,l.useVoiceRecorder=P}),98);
__d("MWV2ChatVideoLazyLoad.react",["JSResourceForInteraction","lazyLoadComponent"],(function(t,n,r,o,a,i,l){"use strict";var e=r("lazyLoadComponent")(r("JSResourceForInteraction")("MWV2ChatVideo.react").__setRef("MWV2ChatVideoLazyLoad.react")),s=e;l.default=s}),98);
__d("MWXMAAttachmentLazyLoad.react",["JSResourceForInteraction","lazyLoadComponent"],(function(t,n,r,o,a,i,l){"use strict";var e=r("lazyLoadComponent")(r("JSResourceForInteraction")("MWXMAAttachmentImpl.react").__setRef("MWXMAAttachmentLazyLoad.react")),s=e;l.default=s}),98);
__d("MWXMAV2AttachmentContainerLazyLoad.react",["JSResourceForInteraction","lazyLoadComponent"],(function(t,n,r,o,a,i,l){"use strict";var e=r("lazyLoadComponent")(r("JSResourceForInteraction")("MWXMAV2AttachmentContainerComponent.react").__setRef("MWXMAV2AttachmentContainerLazyLoad.react")),s=e;l.default=s}),98);