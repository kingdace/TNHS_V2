;/*FB_PKG_DELIM*/

__d("AdsValidationConsts",[],(function(t,n,r,o,a,i){var e=Object.freeze({ixCanvasPrefix:"https://fb.com/canvas_doc/",maxAge:65,maxAdgroupNameLength:400,maxFriendlyNameLength:128,maxURLLength:1024,minAge:13,minAgeDefault:18,nonDefaultMinAgeByCountryCode:{ID:21,TH:20},minMessagingDestinationAge:18,minLeadGenerationAge:18,minCallNowAge:18,minWAMOStatusAge:13,nameMaxLength:400,maxAdObjectNameLength:400});i.default=e}),66);
__d("AssertionError",["ManagedError"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t){return e.call(this,t)||this}return babelHelpers.inheritsLoose(t,e),t})(r("ManagedError"));l.default=e}),98);
__d("Assert",["AssertionError","sprintf"],(function(t,n,r,o,a,i,l){function e(e,t){if(typeof e!="boolean"||e===!1)throw new(r("AssertionError"))(t);return e}function s(t,n,o){var a;if(n===void 0)a="undefined";else if(n===null)a="null";else{var i=Object.prototype.toString.call(n),l=/\s(\w*)/.exec(i);a=l==null?typeof l:l[1].toLowerCase()}return e(t.indexOf(a)!==-1,o!=null?o:r("sprintf")("Expression is of type %s, not %s",a,t)),n}function u(t,n,r){return e(n instanceof t,r!=null?r:"Expression not instance of type"),n}function c(e,t){m["is"+e]=t,m["maybe"+e]=function(e,n){return e==null?e:t(e,n)}}var d=function(t,n){return t},m={isInstanceOf:u,isTrue:e,isTruthy:function(n,r){return e(!!n,r)},isBoolean:d,isFunction:d,isNumber:d,isObject:d,isString:d,isUndefined:d,maybeObject:d,maybeNumber:d,maybeFunction:d};["Boolean","Function","Number","Object","String","Undefined"].forEach(function(e){c(e,s.bind(null,e.toLowerCase()))});var p=m;l.default=p}),98);
__d("BandicootSession",[],(function(t,n,r,o,a,i){"use strict";var e=Object.freeze({ACTIVE:"ACTIVE",INACTIVE:"INACTIVE",CLOSED:"CLOSED"}),l=600*1e3,s=336*60*60*1e3;function u(e){return Date.now()-e.lastUpdated}function c(e){return!!(typeof e=="object"&&e&&e.lastUpdated&&e.status)}function d(t){return t.status===e.CLOSED?!1:!(t.status===e.INACTIVE&&u(t)>l)}function m(t){return t.status===e.ACTIVE&&u(t)>l}function p(e){return u(e)>s}i.Status=e,i.isValidSession=c,i.isTrackedSession=d,i.isCrashedSession=m,i.isOrphanSession=p}),66);
__d("Bandicoot",["invariant","BandicootSession","FBLogger"],(function(t,n,r,o,a,i,l,s){"use strict";var e=5e3,u=e*2,c="Bandicoot:";function d(){try{var e=window.localStorage;if(e){var t="__test"+Date.now();e.setItem(t,""),e.removeItem(t)}return e}catch(e){return r("FBLogger")("bandicoot").warn("Local storage is full"),null}}var m=d(),p=(function(){function t(e){this.$5=c+e,this.$4={},this.$1=this.$7.bind(this),this.sessionID=null,this.sessionStartTime=null,this.storage=m}var n=t.prototype;return n.getCrashTimeData=function(){var e=window.performance&&window.performance.memory||{},t=this.sessionStartTime;return{duration:t?Date.now()-t:0,tabs:Object.keys(this.$8()).length,jsHeapSizeLimit:e.jsHeapSizeLimit,totalJSHeapSize:e.totalJSHeapSize,usedJSHeapSize:e.usedJSHeapSize,elementsInDOM:document.getElementsByTagName("*").length,uri:window.location.href}},n.getLogTimeData=function(){return{userAgent:window.navigator.userAgent}},n.logCrash=function(t,n,o){r("FBLogger")("bandicoot").warn("Session %s crashed at %s",t,o)},n.logBrowserUnsupported=function(){r("FBLogger")("bandicoot").warn("Browser not supported")},n.logTrackingError=function(){r("FBLogger")("bandicoot").warn("Failed to record data for current session")},n.startSession=function(){var t=this;if(!this.storage){this.logBrowserUnsupported();return}this.$2||(this.sessionID||(this.sessionID=Math.random().toString(36).slice(2,9)),this.sessionStartTime||(this.sessionStartTime=Date.now()),this.$2=setInterval(function(){t.$9()},e),this.$9(),document.addEventListener&&document.addEventListener("visibilitychange",this.$1),this.$10())},n.endSession=function(){this.storage&&this.$2&&(clearInterval(this.$2),this.$2=null,this.$3||this.$11({status:o("BandicootSession").Status.CLOSED}),this.sessionID=null,this.sessionStartTime=null,document.removeEventListener&&document.removeEventListener("visibilitychange",this.$1))},n.logKnownCrashes=function(){var e=this;if(this.storage&&!this.$2){var t=this.$8();t=this.$12(t,function(t,n){return o("BandicootSession").isCrashedSession(t)?(e.logCrash(n,t,e.getLogTimeData()),null):t}),this.$13(t)}},n.$14=function(){var e=this.sessionID;return e||s(0,663),e},n.$9=function(){var e=this.$8();this.$15(e),e=this.$16(e),this.$13(e)},n.$15=function(t){var e=this.$14(),n=t[e]?t[e]:{};t[e]=babelHelpers.extends({},n,this.getCrashTimeData(),{lastUpdated:Date.now(),status:this.$17()})},n.$12=function(t,n){var e={};return Object.keys(t).forEach(function(r){var a=t[r];if(o("BandicootSession").isValidSession(a)&&o("BandicootSession").isTrackedSession(a)&&!o("BandicootSession").isOrphanSession(a)){var i=n(a,r);i&&(e[r]=i)}}),e},n.$16=function(t){var e=this;return this.$12(t,function(t,n){if(o("BandicootSession").isCrashedSession(t)){var r=t.loggerReportTime||0;if(Date.now()-r>u)t.loggerReportTime=Date.now(),t.loggerReportSession=e.$14();else if(t.loggerReportSession==e.$14())return e.logCrash(n,t,e.getLogTimeData()),e.$4[n]=!0,null}return t})},n.$8=function(t){t=t||this.$5;var e=this.storage.getItem(t)||"{}";try{e=JSON.parse(e)}catch(n){e={},this.storage.removeItem(t),r("FBLogger")("bandicoot").catching(n).warn("Invalid JSON data")}return e},n.$11=function(t){t.lastUpdated=Date.now();var e=this.$8(),n=this.sessionID;n&&e[n]&&(Object.assign(e[n],t),this.$13(e))},n.$13=function(n){var t=JSON.stringify(n);try{this.storage.setItem(this.$5,t)}catch(t){var o=this.$6,a=Date.now();(!o||a>o+e)&&(this.logTrackingError(),this.$6=a);try{this.storage.removeItem(this.$5)}catch(e){this.$3=!0,this.endSession(),r("FBLogger")("bandicoot").catching(e).warn("Removing from storage failed")}}},n.$10=function(){for(var e=0;e<this.storage.length;++e){var t=this.storage.key(e);if(t.indexOf(c)===0&&t!==this.$5){var n=this.$8(t),r=Object.keys(n).every(function(e){var t=n[e];return!o("BandicootSession").isValidSession(t)||o("BandicootSession").isOrphanSession(t)});r&&this.storage.removeItem(t)}}},n.$7=function(){this.$11({status:this.$17()})},n.$17=function(){return document.hidden?o("BandicootSession").Status.INACTIVE:o("BandicootSession").Status.ACTIVE},t})();l.default=p}),98);
__d("BrandedContentSharedToSponsorStatus",[],(function(t,n,r,o,a,i){var e=Object.freeze({NOT_SHARED:0,ALL_SHARED:1});i.default=e}),66);
__d("BusinessComposerIGAudienceTypes",["$InternalEnum"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum").Mirrored(["IG_AUDIENCE_PUBLIC","IG_AUDIENCE_RESTRICTED"]),s=["SD","CU","IR","SY","KP"];l.BusinessComposerIGAudienceTypes=e,l.UnsupportedIGAudienceCountryList=s}),98);
__d("CallToActionTypes",[],(function(t,n,r,o,a,i){var e=Object.freeze({OPEN_LINK:"OPEN_LINK",LIKE_PAGE:"LIKE_PAGE",SHOP_NOW:"SHOP_NOW",PLAY_GAME:"PLAY_GAME",INSTALL_APP:"INSTALL_APP",USE_APP:"USE_APP",CALL:"CALL",CALL_ME:"CALL_ME",VIDEO_CALL:"VIDEO_CALL",GET_MOBILE_APP:"GET_MOBILE_APP",INSTALL_MOBILE_APP:"INSTALL_MOBILE_APP",INSTALL_FREE_MOBILE_APP:"INSTALL_FREE_MOBILE_APP",USE_MOBILE_APP:"USE_MOBILE_APP",MOBILE_DOWNLOAD:"MOBILE_DOWNLOAD",BOOK_TRAVEL:"BOOK_TRAVEL",LISTEN_MUSIC:"LISTEN_MUSIC",WATCH_VIDEO:"WATCH_VIDEO",LEARN_MORE:"LEARN_MORE",SIGN_UP:"SIGN_UP",DOWNLOAD:"DOWNLOAD",WATCH_MORE:"WATCH_MORE",NO_BUTTON:"NO_BUTTON",VISIT_PAGES_FEED:"VISIT_PAGES_FEED",MISSED_CALL:"MISSED_CALL",CALL_NOW:"CALL_NOW",DIAL_CODE:"DIAL_CODE",APPLY_NOW:"APPLY_NOW",CONTACT:"CONTACT",BUY_NOW:"BUY_NOW",GET_OFFER:"GET_OFFER",GET_OFFER_VIEW:"GET_OFFER_VIEW",BUY_TICKETS:"BUY_TICKETS",UPDATE_APP:"UPDATE_APP",GET_DIRECTIONS:"GET_DIRECTIONS",BUY:"BUY",SEE_DETAILS:"SEE_DETAILS",SEND_UPDATES:"SEND_UPDATES",MESSAGE_PAGE:"MESSAGE_PAGE",MESSAGE_USER:"MESSAGE_USER",DONATE:"DONATE",SUBSCRIBE:"SUBSCRIBE",SAY_THANKS:"SAY_THANKS",SELL_NOW:"SELL_NOW",SHARE:"SHARE",DONATE_NOW:"DONATE_NOW",GET_QUOTE:"GET_QUOTE",CONTACT_US:"CONTACT_US",ORDER_NOW:"ORDER_NOW",START_ORDER:"START_ORDER",ADD_TO_CART:"ADD_TO_CART",VIEW_CART:"VIEW_CART",VIEW_IN_CART:"VIEW_IN_CART",VIDEO_ANNOTATION:"VIDEO_ANNOTATION",MOMENTS:"MOMENTS",RECORD_NOW:"RECORD_NOW",INQUIRE_NOW:"INQUIRE_NOW",CONFIRM:"CONFIRM",VOTE_NOW:"VOTE_NOW",GIVE_FREE_RIDES:"GIVE_FREE_RIDES",REGISTER_NOW:"REGISTER_NOW",OPEN_MESSENGER_EXT:"OPEN_MESSENGER_EXT",CIVIC_ACTION:"CIVIC_ACTION",SEND_INVITES:"SEND_INVITES",REFER_FRIENDS:"REFER_FRIENDS",SAVE:"SAVE",REQUEST_TIME:"REQUEST_TIME",SEE_MENU:"SEE_MENU",EMAIL_NOW:"EMAIL_NOW",PAY_OR_REQUEST:"PAY_OR_REQUEST",SEARCH:"SEARCH",GET_SHOWTIMES:"GET_SHOWTIMES",TRY_IT:"TRY_IT",LISTEN_NOW:"LISTEN_NOW",TRY_ON:"TRY_ON",TRY_DEMO:"TRY_DEMO",WOODHENGE_SUPPORT:"WOODHENGE_SUPPORT",SOTTO_SUBSCRIBE:"SOTTO_SUBSCRIBE",SEARCH_MORE:"SEARCH_MORE",FOLLOW_USER:"FOLLOW_USER",BLOOD_DONATIONS:"BLOOD_DONATIONS",CLAIM_OFFER:"CLAIM_OFFER",RAISE_MONEY:"RAISE_MONEY",SEE_SHOP:"SEE_SHOP",GET_DETAILS:"GET_DETAILS",FIND_OUT_MORE:"FIND_OUT_MORE",VISIT_WEBSITE:"VISIT_WEBSITE",BROWSE_SHOP:"BROWSE_SHOP",UNLIKE_PAGE:"UNLIKE_PAGE",BET_NOW:"BET_NOW",OPEN_MOVIES:"OPEN_MOVIES",EVENT_RSVP:"EVENT_RSVP",INTERESTED:"INTERESTED",GO_LIVE:"GO_LIVE",SEND_TIP:"SEND_TIP",WHATSAPP_MESSAGE:"WHATSAPP_MESSAGE",GET_EVENT_TICKETS:"GET_EVENT_TICKETS",VIEW_INSTAGRAM_PROFILE:"VIEW_INSTAGRAM_PROFILE",INSTAGRAM_MESSAGE:"INSTAGRAM_MESSAGE",FOLLOW_NEWS_STORYLINE:"FOLLOW_NEWS_STORYLINE",LINK_CARD:"LINK_CARD",PRE_REGISTER:"PRE_REGISTER",SEE_MORE:"SEE_MORE",WATCH_APP_UPGRADE:"WATCH_APP_UPGRADE",LOYALTY_LEARN_MORE:"LOYALTY_LEARN_MORE",ACTIVATE_OFFER:"ACTIVATE_OFFER",BOOK_NOW:"BOOK_NOW",BOOK_TEST_DRIVE:"BOOK_TEST_DRIVE",CHECK_AVAILABILITY:"CHECK_AVAILABILITY",FIND_A_GROUP:"FIND_A_GROUP",FIND_YOUR_GROUPS:"FIND_YOUR_GROUPS",REMIND_ME:"REMIND_ME",SAVE_OFFER:"SAVE_OFFER",SEE_OFFER:"SEE_OFFER",PAY_TO_ACCESS:"PAY_TO_ACCESS",PURCHASE_GIFT_CARDS:"PURCHASE_GIFT_CARDS",FOLLOW_PAGE:"FOLLOW_PAGE",SEND_A_GIFT:"SEND_A_GIFT",JOBS_APPLY_NOW:"JOBS_APPLY_NOW",VIEW_RESUME:"VIEW_RESUME",SWIPE_UP_SHOP:"SWIPE_UP_SHOP",SWIPE_UP_PRODUCT:"SWIPE_UP_PRODUCT",SEND_GIFT_MONEY:"SEND_GIFT_MONEY",SEND_GIFT:"SEND_GIFT",WATCH_MUSIC_VIDEO:"WATCH_MUSIC_VIDEO",TRY_IN_CAMERA:"TRY_IN_CAMERA",WHATSAPP_LINK:"WHATSAPP_LINK",PLAY_GAME_ON_FACEBOOK:"PLAY_GAME_ON_FACEBOOK",GET_STARTED:"GET_STARTED",VISIT_WORLD:"VISIT_WORLD",OPEN_INSTANT_APP:"OPEN_INSTANT_APP",AUDIO_CALL:"AUDIO_CALL",JOIN_GROUP:"JOIN_GROUP",GET_PROMOTIONS:"GET_PROMOTIONS",JOIN_CHANNEL:"JOIN_CHANNEL",VISIT_PROFILE:"VISIT_PROFILE",CHAT_ON_WHATSAPP:"CHAT_ON_WHATSAPP",EXPLORE_MORE:"EXPLORE_MORE",PLAY:"PLAY",MAKE_AN_APPOINTMENT:"MAKE_AN_APPOINTMENT",ASK_ABOUT_SERVICES:"ASK_ABOUT_SERVICES",BOOK_A_CONSULTATION:"BOOK_A_CONSULTATION",GET_A_QUOTE:"GET_A_QUOTE",BUY_VIA_MESSAGE:"BUY_VIA_MESSAGE",ASK_FOR_MORE_INFO:"ASK_FOR_MORE_INFO",CHAT_WITH_US:"CHAT_WITH_US",VIEW_PRODUCT:"VIEW_PRODUCT",VIEW_CHANNEL:"VIEW_CHANNEL",GET_IN_TOUCH:"GET_IN_TOUCH",WATCH_LIVE_VIDEO:"WATCH_LIVE_VIDEO",IMAGINE:"IMAGINE",SHOP_WITH_AI:"SHOP_WITH_AI",TRY_ON_WITH_AI:"TRY_ON_WITH_AI",TRY_NOW:"TRY_NOW"});i.default=e}),66);
__d("fileSliceName",["UserAgent_DEPRECATED"],(function(t,n,r,o,a,i,l){var e="slice",s;(s=o("UserAgent_DEPRECATED").chrome())?s<21&&(e="webkitSlice"):(s=o("UserAgent_DEPRECATED").firefox())?s<13&&(e="mozSlice"):(s=o("UserAgent_DEPRECATED").safari())||o("UserAgent_DEPRECATED").webkit()&&(e="webkitSlice");var u=e;l.default=u}),98);
__d("fileSlice",["fileSliceName"],(function(t,n,r,o,a,i,l){var e=t.File&&t.File.prototype[r("fileSliceName")];e||(e=t.Blob&&t.Blob.prototype[r("fileSliceName")]);var s=e;l.default=s}),98);
__d("VideoUploadFeatureDetector",["UserAgent_DEPRECATED","fileSlice"],(function(t,n,r,o,a,i,l){function e(){return typeof r("fileSlice")=="function"&&d()}function s(){return!o("UserAgent_DEPRECATED").firefox()}function u(){return"FileList"in window}function c(){return"FileReader"in window&&"DataView"in window}function d(){return"FormData"in window}l.supportsChunking=e,l.supportsFullProgress=s,l.supportsFileAPI=u,l.supportsFileReading=c,l.supportsXHR=d}),98);
__d("VideoUploadFile",["VideoUploadFeatureDetector","fileSlice","md5"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e,t,n,r){this.$1=e,this.$2=t,this.$3=n,this.$4=r==null?void 0:r.toLowerCase()}e.fromBlob=function(n){var t=n.type.indexOf("/")!=-1?"."+n.type.split("/").pop().toLowerCase():"",r="blob"+t,o=new File([n],r,{type:n.type});return e.fromFile(o)},e.fromFile=function(n){var t=e.getExtensionFromFileName(n.name);return new this(null,n,n.size,t)},e.fromFileInput=function(n){var t=null,r=null,a=e.getExtensionFromFileInput(n);return o("VideoUploadFeatureDetector").supportsFileAPI()&&n.files.length&&(t=n.files[0],r=t.size),new this(n,t,r,a)};var t=e.prototype;return t.getFileInput=function(){return this.$1},t.getFile=function(){return this.$2},t.getSize=function(){return this.$3},t.getExtension=function(){return this.$4},t.getCreatorProduct=function(){return this.$4==="gif"?4:2},t.getChunk=function(t,n){return this.$2!=null?r("fileSlice").call(this.$2,t,n):null},t.getFilePath=function(){var e;return(e=this.$2)==null?void 0:e.name},t.getStableAssetID=function(){var e;return(e=r("md5")(this.getFilePath()))!=null?e:"unknown"},e.getExtensionFromFileInput=function(t){return this.getExtensionFromFileName(t.value)},e.getExtensionFromFileName=function(t){return t!=null&&t.indexOf(".")!==-1?t.split(".").pop().toLowerCase():""},e})();l.default=e}),98);
__d("MediaUploadAssetEvent",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["ASSET_ADDED","ASSET_STARTED","ASSET_REMOVED","ASSET_FAILED","ASSET_SUCCEED","ASSET_PROGRESS","ASSET_STALL"]),l=e;i.default=l}),66);
__d("MediaUploadClientEvent",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["CLIENT_CREATED","CLIENT_CONFIG_REQUESTED","CLIENT_CONFIG_RECEIVED","CLIENT_CONFIG_FAILED","CLIENT_CONFIG_CACHED","CLIENT_INTERNET_ONLINE","CLIENT_INTERNET_OFFLINE","CLIENT_INTERNET_UNKNOWN"]),l=e;i.default=l}),66);
__d("MediaUploadEntryPointID",[],(function(t,n,r,o,a,i){"use strict";var e=function(t){this.key=t};i.default=e}),66);
__d("MediaUploadFBEntryPointID",["MediaUploadEntryPointID"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t,n){var r;return r=e.call(this,t+"\\"+n)||this,r.sourceType=t,r.entryPointRef=n,r}return babelHelpers.inheritsLoose(t,e),t.castOrThrow=function(n,r){var e=r.createThrowableError;if(n instanceof t)return n;var o;throw e('Provided entry point ID has incorrect type of "'+((o=n.constructor)==null?void 0:o.name)+'"')},t})(r("MediaUploadEntryPointID"));l.default=e}),98);
__d("MediaUploadAsset",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e){this.mediaType=e.mediaType,this.data=e.data}var t=e.prototype;return t.dataAsFile=function(){var e=this.data;return e.mode==="File"?e:null},t.dataAsHTMLInput=function(){var e=this.data;return e.mode==="HTMLInput"?e:null},e})();i.default=e}),66);
__d("MediaUploadMediaType",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["VIDEO"]),l=e;i.default=l}),66);
__d("MediaUploadTime",[],(function(t,n,r,o,a,i){"use strict";var e=1e3,l=e*60,s=l*60;function u(e){return e}function c(t){return t*e}function d(e){return e*l}function m(e){return e*s}function p(e){return e}function _(t){return 1*t/e}function f(e){return 1*e/l}function g(e){return 1*e/s}function h(e,t){return e==null?null:t(e)}function y(e){return h(e,p)}function C(e){return h(e,_)}function b(e){return h(e,f)}function v(e){return h(e,g)}function S(e,t){return e+t}function R(e,t){return e-t}function L(e,t){return e<t?-1:e>t?1:0}i.millisecondsToTime=u,i.secondsToTime=c,i.minutesToTime=d,i.hoursToTime=m,i.timeToMilliseconds=p,i.timeToSeconds=_,i.timeToMinutes=f,i.timeToHours=g,i.maybeTimeToMilliseconds=y,i.maybeTimeToSeconds=C,i.maybeTimeToMinutes=b,i.maybeTimeToHours=v,i.addTime=S,i.subtractTime=R,i.compareTime=L}),66);
__d("MediaUploadAssetFactory",["MediaUploadAsset","MediaUploadMediaType","MediaUploadTime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){if(e==null)return null;var t=/\.([^.]+)$/.exec(e);return t==null||t.length<2?null:t[1]}var s=(function(){function t(e){var t=e.features;this.$1=t}var n=t.prototype;return n.$2=function(n){return{mode:"File",file:n,lastModified:o("MediaUploadTime").millisecondsToTime(n.lastModified),name:n.name,size:n.size,mimeType:n.type,extension:e(n.name)}},n.$3=function(n){return{mode:"HTMLInput",inputElement:n,name:n.value,extension:e(n.value)}},n.createFromFile=function(t,n){return n===void 0&&(n=r("MediaUploadMediaType").VIDEO),new(r("MediaUploadAsset"))({mediaType:n,data:this.$2(t)})},n.createFromHTMLInput=function(t,n){var e;n===void 0&&(n=r("MediaUploadMediaType").VIDEO);var o;if(this.$1.supportFileFromHTML&&((e=t.files)==null?void 0:e.length)>0){var a=t.files[0];o=this.$2(a)}else o=this.$3(t);return new(r("MediaUploadAsset"))({mediaType:n,data:o})},t})();l.default=s}),98);
__d("MediaUploadSDK",["MediaUploadAssetFactory"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){var e=this;this.isSupported=function(){return e.features.supportFileManipulation&&e.features.supportFileFromHTML},this.currentTimeProvider=t.currentTimeProvider,this.randomNumberProvider=t.randomNumberProvider,this.randomStringProvider=t.randomStringProvider,this.retryPolicyProvider=t.retryPolicyProvider,this.promiseTerminator=t.promiseTerminator,this.delayedExecutor=t.delayedExecutor,this.reportRecoverableError=t.reportRecoverableError,this.createThrowableError=t.createThrowableError,this.features=t.featureDetector(),this.registerUnloadHook=t.registerUnloadHook,this.factories={assets:new(r("MediaUploadAssetFactory"))(this)}};l.default=e}),98);
__d("mediaUploadFBRetryPolicyProvider",["MediaUploadTime"],(function(t,n,r,o,a,i,l){"use strict";var e,s={backoff:{initial:(e=o("MediaUploadTime")).millisecondsToTime(400),jitter:e.millisecondsToTime(100),expBase:e.millisecondsToTime(100),expMultiplier:1.5,max:e.secondsToTime(8)},limits:{totalRetryCount:3e3,totalTime:e.hoursToTime(6)}};function u(){return s}l.default=u}),98);
__d("MediaUploadFBSDK",["Banzai","FBLogger","MediaUploadSDK","MediaUploadTime","Random","SubscriptionsHandler","WaterfallIDGenerator","clearTimeout","fileSlice","getErrorSafe","mediaUploadFBRetryPolicyProvider","promiseDone","setTimeout"],(function(t,n,r,o,a,i,l){"use strict";var e="media_upload",s=(function(t){function n(){return t.call(this,{currentTimeProvider:function(){return o("MediaUploadTime").millisecondsToTime(Date.now())},randomNumberProvider:function(t,n){return(n-t)*r("Random").random()+t},randomStringProvider:function(){return o("WaterfallIDGenerator").generate()},retryPolicyProvider:r("mediaUploadFBRetryPolicyProvider"),promiseTerminator:function(t){return r("promiseDone")(t)},delayedExecutor:function(t,n,a){var e=r("setTimeout")(n,o("MediaUploadTime").timeToMilliseconds(t));return{cancel:function(){a!=null&&a(),r("clearTimeout")(e)}}},reportRecoverableError:function(n,o){o!=null?r("FBLogger")(e).catching(r("getErrorSafe")(o)).mustfix(n):r("FBLogger")(e).mustfix(n)},createThrowableError:function(n){throw r("FBLogger")(e).mustfixThrow(n)},featureDetector:function(){return{supportFileFromHTML:"FileList"in window,supportFileManipulation:"FileReader"in window&&"DataView"in window&&"FormData"in window&&typeof r("fileSlice")=="function"}},registerUnloadHook:function(n){var t=new(r("SubscriptionsHandler")),o=r("Banzai").subscribe(r("Banzai").SHUTDOWN,n);return o!=null?t.addSubscriptions():r("FBLogger")(e).mustfix("Banzai did not return handle for unsubscribing from the unload hook; logging quality will be bad"),{cancel:function(){try{t.release()}catch(t){r("FBLogger")(e).catching(r("getErrorSafe")(t)).mustfix("Failed to unsubscribe from the unload hook")}}}}})||this}return babelHelpers.inheritsLoose(n,t),n})(r("MediaUploadSDK")),u=new s,c=u;l.default=c}),98);
__d("MediaUploadFBStage",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["METADATA_EXTRACTION","METADATA_VALIDATION","HASHING","START_REQUEST","BYTES_UPLOAD","RECEIVE_REQUEST"]),l=e;i.default=l}),66);
__d("MediaUploadSessionEvent",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["SESSION_CONFIRMED","SESSION_SUCCEED","SESSION_FAILED","SESSION_CANCELED","SESSION_FINISHED","SESSION_PROGRESS","PUBLISH_STARTED","PUBLISH_SUCCEED","PUBLISH_FAILED"]),l=e;i.default=l}),66);
__d("MediaUploadStageEvent",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["STAGE_STARTED","STAGE_PROGRESS","STAGE_SUCCEED","STAGE_FAILED","STAGE_CANCELED"]),l=e;i.default=l}),66);
__d("MediaUploadVUShim",["MediaUploadAssetEvent","MediaUploadClientEvent","MediaUploadFBEntryPointID","MediaUploadFBSDK","MediaUploadFBStage","MediaUploadSessionEvent","MediaUploadStageEvent","MediaUploadVUShimSession","MediaUploadVUShimSurface","Promise","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function t(){this.$1=new Map}var o=t.prototype;return o.createSession=function(t){if(!r("MediaUploadFBSDK").isSupported())return null;var e=t.source,n=t.composer_entry_point_ref;if(e==null||n==null)return null;var o=new(r("MediaUploadFBEntryPointID"))(e,n);if(!r("MediaUploadVUShimSurface").isClientSupported(o)||!r("gkx")("25479"))return null;var a=r("MediaUploadVUShimSurface").getClient(o),i=new(r("MediaUploadVUShimSession"))(t,a);return this.$1.set(i.sessionID,i),i},o.triggerPublish=function(r,o){var t=this.$1.get(r.sessionID);return t==null?(e||(e=n("Promise"))).resolve({isSuccessful:!1,errorCode:"MISSING_SESSION"}):t.triggerPublish(r,o)},o.setupEventSubscription=function(t){var e=this,n=function(r){t.addClientEventListener(r,function(t){return e.emitClientEvents(r)})};for(var o of r("MediaUploadClientEvent").members())n(o);var a=function(r){t.addSessionEventListener(r,function(t){var n;return(n=e.$1.get(t.sessionID))==null?void 0:n.sessionUpdated(r,t)})};for(var i of r("MediaUploadSessionEvent").members())a(i);var l=function(r){t.addAssetEventListener(r,function(t,n){var o;(o=e.$1.get(t.sessionID))==null||o.assetUpdated(r,t,n)})};for(var s of r("MediaUploadAssetEvent").members())l(s);var u=function(o){var n=function(r){t.addStageEventListener(o,r,function(t,n){var a;(a=e.$1.get(t.sessionID))==null||a.stageUpdated(o,r,t,n)})};for(var a of r("MediaUploadFBStage").members())n(a)};for(var c of r("MediaUploadStageEvent").members())u(c)},o.emitClientEvents=function(t){var e;if(t===r("MediaUploadClientEvent").CLIENT_INTERNET_ONLINE)e="online";else if(t===r("MediaUploadClientEvent").CLIENT_INTERNET_OFFLINE)e="offline";else return;for(var n of this.$1.values())n.inform(e)},t})(),u=new s,c=u;l.default=c}),98);
__d("MediaUploadAssetStatus",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["REQUESTED","SCHEDULED","PROCESSING","UPLOADING","COMPLETED","FAILED","REMOVED"]),l=e;i.default=l}),66);
__d("MediaUploadCancelReason",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["USER_REQUEST","NAVIGATION_AWAY","UNLOAD_HOOK"]),l=e;i.default=l}),66);
__d("MediaUploadSessionStatus",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["UNCONFIRMED","CONFIRMED","FAILED","PUBLISHING","COMPLETED","CANCELED"]),l=e;i.default=l}),66);
__d("GraphQLVideoPublisherInputDataHandlerBase",["invariant"],(function(t,n,r,o,a,i,l,s){"use strict";var e=(function(){function e(e,t){this.postData=e,this.extraData=t}var t=e.prototype;return t.mapPostDataToGraphQLInputObject=function(){s(0,85)},t.hasAPISupport=function(){return u(this.postData)},t.uploadables=function(){s(0,85)},e})();function u(e){return!0}l.GraphQLVideoPublisherInputDataHandlerBase=e,l.hasAPISupport=u}),98);
__d("ExpirationType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NONE:0,DELETE:1,HIDE:2,ONLY_ME:3,HIDE_LONG_DURATION:4});i.default=e}),66);
__d("VideoAssetMatureContentRating",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNSET:0,SUITABLE_FOR_ALL:1,FOURTEEN_PLUS:2,EIGHTEEN_PLUS:3});i.default=e}),66);
__d("VideoCommentatingPermission",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNSET:"unset",ALLOW:"allow",DISALLOW:"disallow"});i.default=e}),66);
__d("VideoFundedContentFlagProgram",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNSET:0,IS_FUNDED_CONTENT:1,NOT_FUNDED_CONTENT:2});i.default=e}),66);
__d("VideoProjection",[],(function(t,n,r,o,a,i){var e=Object.freeze({FLAT:"flat",EQUIRECTANGULAR:"equirectangular",CUBEMAP:"cubemap",ROTATED_CUBEMAP:"rotated_cubemap",BARREL:"barrel",BARREL_SPLIT:"barrel_split",CDS_BARREL:"cds_barrel",HALF_EQUIRECTANGULAR:"half_equirectangular"});i.default=e}),66);
__d("VideoStereoFormat",[],(function(t,n,r,o,a,i){var e=Object.freeze({MONO:"mono",LEFT_RIGHT:"left-right",TOP_BOTTOM:"top-bottom"});i.default=e}),66);
__d("GraphQLVideoPublisherVideoUploaderInputDataHandler",["BrandedContentSharedToSponsorStatus","BrandedContentSponsorRelationship","CallToActionTypes","ClientIDs","ExpirationType","GraphQLVideoPublisherInputDataHandlerBase","VideoAssetMatureContentRating","VideoCommentatingPermission","VideoFundedContentFlagProgram","VideoProjection","VideoStereoFormat","enumUtils"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.mapPostDataToGraphQLInputObject=function(){var e,t=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_1(),n=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_2(),r=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_3(),a=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_4(),i=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_5(),l=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_6(),s=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_7(),u=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_8(),c=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_9(),d=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_10(),m=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_11(),p=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_12(),_=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_13(),f=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_14(),g=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_15(),h=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_16(),y=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_17(),C=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_18(),b=this.postData.publish_as_reel,v=this.postData.translated_audio_metadata,S=(e=this.postData.non_uuc_reel_data)!=null?e:this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_19(),R=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_20();return{actor_id:this.extraData.target_id,basic_data:t,client_mutation_id:o("ClientIDs").getNewClientID(),thumbnail_data:n,ad_break_data:a,vu_editor_data:u,post_status_data:r,main_composer_tab_data:i,distribution_data:l,stars_data:s,questions_data:c,polls_data:d,tracking_data:m,captions_data:p,spherical_data:_,live_premiere_data:f,video_editor_config_json:this.postData.video_editor_config_json,location_preset_data:g,video_abtesting_data:h,auto_dub_data:y,reel_publish_data:C,publish_as_reel:b,non_uuc_reel_data:S,translated_audio_data:{translated_audio_metadata:v},share_story_settings:R}},n.uploadables=function(){return babelHelpers.extends({},this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_21(),this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_22(),this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_23())},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_1=function(){var e;return{source:this.extraData.source,target_id:this.extraData.target_id,video_id:this.extraData.video_id,video_title:this.postData.video_title,waterfall_id:this.extraData.waterfall_id,xhpc_message:this.postData.xhpc_message,creator_product:(e=this.extraData.creator_product)==null?void 0:e.toString(),composer_entry_point_ref:this.extraData.composer_entry_point_ref,composer_dialog_version:this.extraData.composer_dialog_version,has_file_been_replaced:this.extraData.has_file_been_replaced,supports_chunking:this.extraData.supports_chunking}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_2=function(){return{thumbnail_type:this.postData.thumbnail_type}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_22=function(){return this.postData.thumbnail_uploadable},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_23=function(){var e={},t=this.postData.schedule_custom_background_image,n=this.postData.schedule_custom_profile_image,r=this.postData.schedule_feed_background_image;return t!=null&&(e.schedule_custom_background_image=t),n!=null&&(e.schedule_custom_profile_image=n),r!=null&&(e.schedule_feed_background_image=r),e},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_4=function(){var e,t=(e=this.postData.ad_breaks)==null?void 0:e.map(function(e){return{time_offset:parseInt(e.time_offset,10),status:e.status}});return{ad_breaks:t,ad_break_prereview:this.postData.ad_break_prereview,ad_breaks_experiment_revenue_loss_threshold:this.postData.ad_breaks_experiment_revenue_loss_threshold,ad_breaks_creator_chosen_contextual_category:this.postData.ad_breaks_creator_chosen_contextual_category,enable_ad_breaks_experiment:this.postData.enable_ad_breaks_experiment,ad_breaks_block_lists:this.postData.ad_breaks_block_lists,has_ad_breaks_block_lists:this.postData.has_ad_breaks_block_lists,is_in_stream_enabled:this.postData.is_in_stream_enabled,self_cert_answers:this.postData.self_cert_answers,self_cert_educational_form:this.postData.self_cert_educational_form,self_cert_selected_no_sensitive:this.postData.self_cert_selected_no_sensitive,self_cert_predicted_status:this.postData.self_cert_predicted_status,should_auto_adjust_manual_ad_breaks:this.postData.should_auto_adjust_manual_ad_breaks,should_auto_insert_ad_breaks:this.postData.should_auto_insert_ad_breaks,should_use_image_ads:this.postData.should_use_image_ads,monetization_pre_check_options:this.postData.monetization_pre_check_options}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_3=function(){return{dogfooding:this.postData.dogfooding,draft:this.postData.draft,is_reviewable_branded_content:this.postData.is_reviewable_branded_content,scheduled:this.postData.scheduled,future_date:this.postData.future_date,future_time:this.postData.future_time,expiring:this.postData.expiring,expire_type:this.postData.expire_type!=null?o("enumUtils").enumValueToKeyEnforcing(this.postData.expire_type,r("ExpirationType")):null,expire_time:this.postData.expire_time,backdated_date:this.postData.backdated_date,hide_from_newsfeed:this.postData.hide_from_newsfeed,schedule_timestamp:this.postData.schedule_timestamp}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_24=function(){var e=this.postData.branded_content_data;if(e==null)return null;var t=e.tagging_data;return t!=null&&(t=babelHelpers.extends({},t,{shared_to_sponsor_status:t.shared_to_sponsor_status!=null?o("enumUtils").enumValueToKeyEnforcing(t.shared_to_sponsor_status,r("BrandedContentSharedToSponsorStatus")):null,sponsor_relationship:t.sponsor_relationship!=null?o("enumUtils").enumValueToKeyEnforcing(t.sponsor_relationship,r("BrandedContentSponsorRelationship")):null})),babelHelpers.extends({},e,{tagging_data:t})},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_5=function(){return{action_type_id:this.postData.action_type_id,branded_content_data:this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_24(),collaborator_id:this.postData.collaborator_id,composertags_place_name:this.postData.composertags_place_name,composertags_place:this.postData.composertags_place,composertags_product_items:this.postData.composertags_product_items,composertags_sponsor:this.postData.composertags_sponsor,composertags_with:this.postData.composertags_with,content_tags:this.postData.content_tags,cta_type:this.postData.cta_type!=null?o("enumUtils").enumValueToKeyEnforcing(this.postData.cta_type,r("CallToActionTypes")):null,deal_id:this.postData.deal_id,direct_share_status:this.postData.direct_share_status!=null?o("enumUtils").enumValueToKeyEnforcing(this.postData.direct_share_status,r("BrandedContentSharedToSponsorStatus")):null,episode_data_json:this.postData.episode_data_json,external_movie_data:this.postData.external_movie_data,feed_targeted_data:this.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_25(),fan_funding_promotion_metadata:this.postData.fan_funding_promotion_metadata,free_form_tags:this.postData.free_form_tags,funded_content_program:this.postData.funded_content_program?o("enumUtils").enumValueToKeyEnforcing(this.postData.funded_content_program,r("VideoFundedContentFlagProgram")):null,fundraiser_for_story_charity_id:this.postData.fundraiser_for_story_charity_id,fundraiser_for_story_charity_type:this.postData.fundraiser_for_story_charity_type,game_id:this.postData.game_id,icon_id:this.postData.icon_id,is_explicitly_tagged_as_gaming_video:this.postData.is_explicitly_tagged_as_gaming_video,is_rewards_enabled:this.postData.is_rewards_enabled,is_stars_enabled_for_post:this.postData.is_stars_enabled_for_post,multilingual_specified_lang:this.postData.multilingual_specified_lang,multilingual_status_langs:this.postData.multilingual_status_langs,multilingual_statuses:this.postData.multilingual_statuses,object_id:this.postData.object_id,object_str:this.postData.object_str,playlistIDs:this.postData.playlistIDs,share_to_parent_page_option_selected:this.postData.share_to_parent_page_option_selected,send_dm_invite:this.postData.send_dm_invite,sponsor_relationship:this.postData.sponsor_relationship?o("enumUtils").enumValueToKeyEnforcing(this.postData.sponsor_relationship,r("BrandedContentSponsorRelationship")):null,targeted_privacy_data:JSON.stringify(this.postData.targeted_privacy_data),background_ab_opted_in:this.postData.background_ab_opted_in,video_duration:this.postData.video_duration}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_25=function(){var e=babelHelpers.extends({},this.postData.feed_targeted_data);return this.postData.relevant_until_date!=null&&(e["relevant-until-date"]=this.postData.relevant_until_date),this.postData.relevant_until_time!=null&&(e["relevant-until-time"]=this.postData.relevant_until_time),Object.keys(e).length===0&&(e=void 0),JSON.stringify(e)},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_6=function(){return{commentating_permission:this.postData.commentating_permission!=null?o("enumUtils").enumValueToKeyEnforcing(this.postData.commentating_permission,r("VideoCommentatingPermission")):null,crossposting_config:this.postData.crossposting_config,disturbing:this.postData.disturbing,embeddable:this.postData.embeddable,enable_drm:this.postData.enable_drm,exclude_from_watch:this.postData.exclude_from_watch,mature_content_rating:this.postData.mature_content_rating!=null?o("enumUtils").enumValueToKeyEnforcing(this.postData.mature_content_rating,r("VideoAssetMatureContentRating")):null,no_story:this.postData.no_story,secret:this.postData.secret,shows_v2_episode_data:this.postData.shows_v2_episode_data,social_actions:this.postData.social_actions}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_7=function(){return{is_receiving_stars_enabled:this.postData.is_receiving_stars_enabled,stars_goal_id:this.postData.stars_goal_id,stars_cue_trigger_timestamp:this.postData.stars_cue_trigger_timestamp}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_11=function(){return{custom_labels:this.postData.custom_labels,external_video_id:this.postData.external_video_id}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_9=function(){return{questions:this.postData.questions}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_10=function(){return{polls:this.postData.polls}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_26=function(t){return t.getIsDefault()?"captions_default":"captions_file"},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_12=function(){var e,t=this,n=(e=this.postData.captions)==null?void 0:e.map(function(e,n){return t.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_26(e)+n});return{autopublish_captions:this.postData.autopublish_captions,captions:n,should_review_all_captions:this.postData.should_review_all_captions,spoken_locale:this.postData.spoken_locale,autopublish_subtitles:this.postData.autopublish_subtitles}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_21=function(){var e,t=this,n={};return(e=this.postData.captions)==null||e.forEach(function(e,r){n[t.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_26(e)+r]=e.getFile()}),n},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_8=function(){return{auto_reframe_aspect_ratios:this.postData.auto_reframe_aspect_ratios,auto_reframe_publish_mode:this.postData.auto_reframe_publish_mode,trailer_review_required:this.postData.trailer_review_required,trailer_generate_on:this.postData.trailer_generate_on,auto_reframe_mobile_only:this.postData.auto_reframe_mobile_only||!1}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_13=function(){return{initialHeading:this.postData.initialHeading,initialPitch:this.postData.initialPitch,fov:this.postData.fov,guide_enabled:this.postData.guide_enabled,guide_keyframes:this.postData.guide_keyframes,enable_omnistab:this.postData.enable_omnistab,spherical:this.postData.spherical,projection:this.postData.projection!=null?o("enumUtils").enumValueToKeyEnforcing(this.postData.projection,r("VideoProjection")):null,stereoMode:this.postData.stereoMode!=null?o("enumUtils").enumValueToKeyEnforcing(this.postData.stereoMode,r("VideoStereoFormat")):null}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_14=function(){return{premiere_time_ms:this.postData.premiere_time_ms,should_premiere:this.postData.should_premiere,premiere_in_living_room_video_ids:this.postData.premiere_in_living_room_video_ids,premiere_custom_profile_image_focus:this.postData.premiere_custom_profile_image_focus,feed_background_focus:this.postData.feed_background_focus,premiere_audience:this.postData.premiere_audience,premiere_is_loe:this.postData.premiere_is_loe,premiere_event_category_id:this.postData.premiere_event_category_id}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_15=function(){return{location_preset_id:this.postData.location_preset_id}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_16=function(){return{is_abtesting:this.postData.is_abtesting,should_publish_uuc:this.postData.should_publish_uuc}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_17=function(){return{dubbing_enabled:this.postData.dubbing_enabled,dub_voice_speed:this.postData.dub_voice_speed,target_locale:this.postData.target_locale,voice_code:this.postData.voice_code}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_19=function(){return{publish_as_non_uuc_reel:this.postData.publish_as_non_uuc_reel}},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_18=function(){return this.postData.reel_publish_data},n.$GraphQLVideoPublisherVideoUploaderInputDataHandler$p_20=function(){return this.postData.reshare_post_as_sticker==null?null:{reshare_post_as_sticker:this.postData.reshare_post_as_sticker,resharing_frequency:this.postData.resharing_frequency}},t})(o("GraphQLVideoPublisherInputDataHandlerBase").GraphQLVideoPublisherInputDataHandlerBase);l.default=e}),98);
__d("ReelComposerReelPublishMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="24143317328587698"}),null);
__d("ReelComposerReelPublishMutation.graphql",["ReelComposerReelPublishMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"CpxReelPublishResponsePayload",kind:"LinkedField",name:"cpx_reel_publish",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"published_video_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ReelComposerReelPublishMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ReelComposerReelPublishMutation",selections:t},params:{id:n("ReelComposerReelPublishMutation_facebookRelayOperation"),metadata:{},name:"ReelComposerReelPublishMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("ReelComposerReframeAspectRatio",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["NONE","VERTICAL","SQUARE","FOUR_BY_FIVE","MANUAL_9X16","SPLIT_1X3"]);i.ReelComposerReframeAspectRatio=e}),66);
__d("ReelCreationFlowUtils",["$InternalEnum","vulture"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e=n("$InternalEnum")).Mirrored(["PUBLISH_NOW","SCHEDULE","DRAFT"]),u=e.Mirrored(["AUDIO","VIDEO"]),c=e.Mirrored(["CREATE","EDIT","AB_TESTING"]),d=e.Mirrored(["CREATOR_STUDIO","MBS","REELS_BULK_UPLOAD"]),m=e.Mirrored(["ENABLED","DISABLED"]),p=function(t){switch(r("vulture")("Zy_DFT_d9vEB43MOHwvCR9PVUGA="),t){case s.PUBLISH_NOW:return"published";case s.DRAFT:return"draft";case s.SCHEDULE:return"scheduled"}};l.ReelPublishType=s,l.ReelEnhancementType=u,l.ReelComposerMode=c,l.ReelsComposerEntrypoint=d,l.ReelsComposerOriginalAudioReuseMode=m,l.getReelPostStatusFromReelPublishType=p}),98);
__d("XFBXFamilyBusinessContentType.facebook",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["POST","REEL","STORY"]),l=e;i.default=l}),66);
__d("getEnumFromString",["memoizeByReference"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t={};return Object.values(e).forEach(function(e){t[e]=e}),t}var s=r("memoizeByReference")(e);function u(e,t){if(t==null)return null;var n=s(e);return n[t]!=null?n[t]:null}l.default=u}),98);
__d("getChunkForContentState",[],(function(t,n,r,o,a,i){"use strict";function e(e,t,n){if(t){var r=n.getEntity(t);if(r.getType()==="EMOTICON")return r.getData().originalEmoticon;if(r.getType()==="EMOJI")return r.getData().emoji.join("")}return e.replace("@[","@ [")}i.default=e}),66);
__d("getMentionsTextForContentState",["emptyFunction","getChunkForContentState"],(function(t,n,r,o,a,i){"use strict";var e=n("emptyFunction").thatReturnsTrue,l=/[\\\]:]/g;function s(t,n,r){n===void 0&&(n=""),r===void 0&&(r=!0);var o=t.getBlockMap().map(function(n){var o=n.getText(),a=[];return n.findEntityRanges(e,function(e,i){a.push(u(o.slice(e,i),n.getEntityAt(e),t,r))}),a.join("")});return o.join("\n"+n)}function u(e,t,r,o){if(t){var a=r.getEntity(t);if(a.getType()==="MENTION"){o&&(e=e.replace(l,function(e){return"\\"+e}));var i=a.getData().id;if(/^\d+$/.test(i))return"@["+i+":"+e+"]"}}return n("getChunkForContentState")(e,t,r)}a.exports=s}),null);
__d("getShouldDisableCollabsDraftsandScheduling",["gkx"],(function(t,n,r,o,a,i,l){"use strict";function e(){return!r("gkx")("9836")}l.getShouldDisableCollabsDraftsandScheduling=e}),98);
__d("shouldUsePostCollabsField",["getShouldDisableCollabsDraftsandScheduling","gkx"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return e?t===!1?r("gkx")("10000"):!o("getShouldDisableCollabsDraftsandScheduling").getShouldDisableCollabsDraftsandScheduling():!1}l.shouldUsePostCollabsField=e}),98);
__d("ReelComposerReelPublishMutation",["AdsValidationConsts","BusinessComposerIGAudienceTypes","DateConsts","ISOCountryCode","ReelComposerReelPublishMutation.graphql","ReelComposerReframeAspectRatio","ReelCreationFlowUtils","RelayModern","getEnumFromString","getMentionsTextForContentState","justknobx","requireDeferred","shouldUsePostCollabsField","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("ODS").__setRef("ReelComposerReelPublishMutation"),u=1,c=e!==void 0?e:e=n("ReelComposerReelPublishMutation.graphql");function d(e,t,n,r){var a=m(r);o("RelayModern").commitMutation(e,{mutation:c,variables:{input:a},onCompleted:t,onError:function(t){return n()}})}function m(e){var t,n,a,i,l,c,d,m,p=e.isFormatMergeEnabled,h=e.videoID,y=e.shouldSkipEncoding,C=e.shouldEnforceVideoEditorPath,b=e.loggingClientInfo,v=e.reelRemixingEnabled,S=e.reelPublishType,R=e.reelScheduledUnixTimestamp,L=e.reelDescription,E=e.trimStartTimeMs,k=e.trimEndTimeMs,I=e.isTrimTimestampsEqualToEntireVideo,T=e.reelReframeAspectRatio,D=e.collaborators,x=e.videoThumbnailFileID,$=e.thumbnailType,P=e.audioEnhancementProcessingAmount,N=e.music,M=e.audioCustomStartTimeMs,w=e.placements,A=e.igBusinessID,F=e.inStreamAdsSettings,O=e.manualCrop,B=e.mixingParams,W=e.geoTargetingData,q=e.overlay,U=e.mainTrack,V=e.photoTrack,H=e.original_resolution,G=e.isReceivingStarsEnabled,z=e.linkedVideoID,j=e.reelsCreatorPlaylistID,K=e.reelsCreatorPlaylistItemOrder,Q=e.reelsCreatorPlaylistItemBatchSize,X=e.addedHashtags,Y=e.fbMonetizationData,J=e.reelEmbeddingEnabled,Z=e.totalVideoDuration,ee=e.isABTest,te=e.shouldUseConsolidatedReelEditPublishPath,ne=e.shouldShareToStory,re=e.storySharingFrequency,oe=e.igTargetingPrivacyData,ae=e.locationTag,ie=e.reelsReshareDestination,le=e.reelsPoll,se=e.pageCaptionSettings,ue=e.reelCaptionSettings,ce=e.alternateAudioTracks,de=e.autoDubbingSettings,me=e.videoContainerType,pe=e.vodTitle,_e=e.allowTrimBeyondMaxLength,fe=e.closedCaptions,ge=e.shouldDisplayManualDescriptionsSectioninBYOA,he=e.isBoostToggleOn,ye=me==="POST"||p===!0,Ce=S===o("ReelCreationFlowUtils").ReelPublishType.DRAFT||ee===!0,be=S===o("ReelCreationFlowUtils").ReelPublishType.SCHEDULE&&ee!==!0,ve={caption:L,enable_remix:v,is_draft:Ce,is_scheduled:be,scheduled_publish_time:R},Se=(N==null?void 0:N.id)!=null?{id:N.id,offset:(M!=null?M:N.audio.highlightStartTimeMs)/o("DateConsts").MS_PER_SEC,duration:(k-E)/o("DateConsts").MS_PER_SEC}:null,Re=I&&T===o("ReelComposerReframeAspectRatio").ReelComposerReframeAspectRatio.NONE&&Se===null&&P===0,Le=Re?null:{start_time_in_sec:E/o("DateConsts").MS_PER_SEC,end_time_in_sec:k/o("DateConsts").MS_PER_SEC},Ee=(t=W==null||(n=W.countries)==null?void 0:n.map(function(e){return r("getEnumFromString")(r("ISOCountryCode"),e)}).filter(Boolean))!=null?t:[],ke=((a=W==null?void 0:W.regions)!=null?a:[]).map(function(e){var t,n;return{key:e.key,country:(t=e.country)!=null?t:"",name:(n=e.name)!=null?n:""}});Ee.length>0&&s.onReady(function(e){e.bumpEntityKey(5907,"fb_stories_web","geo_gating.reel.create",1)});var Ie=(i=oe==null||(l=oe.targetingData)==null?void 0:l.geoLocations.countries)!=null?i:null,Te=(c=oe==null?void 0:oe.isIncluded)!=null?c:!1,De=null;if(Ie!=null&&Ie.length>0)if(Te){var xe;De={age_min:r("AdsValidationConsts").minAge,geo_locations:{countries:(xe=Array.from(new Set(Ie)))!=null?xe:[]}}}else{var $e,Pe=Object.keys(r("ISOCountryCode")).filter(function(e){return!o("BusinessComposerIGAudienceTypes").UnsupportedIGAudienceCountryList.includes(e)&&!Ie.includes(e)});De={age_min:r("AdsValidationConsts").minAge,geo_locations:{countries:($e=Array.from(new Set(Pe)))!=null?$e:[]}}}var Ne={reshare_destination:ie==null?void 0:ie.map(function(e){return{message:{text:e.postText},reshare_audience:{to_id:e.groupID}}})},Me=null;j!=null&&(Me={videolist_ids:[j],order:K,batch_size:Q});var we=ye?["FACEBOOK_NEWS_FEED"]:w,Ae=null;if(ye&&F!=null){var Fe,Oe,Be,We,qe,Ue,Ve=(Fe=F==null||(Oe=F.ad_breaks_block_lists)==null||(Oe=Oe.filter(Boolean))==null?void 0:Oe.map(function(e){return e}))!=null?Fe:[],He=(Be=Ve==null?void 0:Ve.map(function(e){return e.toString()}))!=null?Be:[];Ae={has_ad_breaks_block_lists:(We=F==null?void 0:F.has_ad_breaks_block_lists)!=null?We:!1,should_auto_insert_ad_breaks:(qe=F==null?void 0:F.should_auto_insert_ad_breaks)!=null?qe:!1,should_use_image_ads:(Ue=F==null?void 0:F.should_use_image_ads)!=null?Ue:!1,ad_breaks_block_lists:He!=null?He:[]}}var Ge=f(T),ze=o("shouldUsePostCollabsField").shouldUsePostCollabsField(D.length>0,Ce||be),je=fe!=null&&fe.length>0?{caption_ids:fe.map(function(e){return e.id})}:null;return{video_id:h!=null?h:"",should_skip_encoding:y!=null?y:!1,should_enforce_video_editor_path:C!=null?C:!1,metadata:ve,trim_timestamps:Le,reframe_aspect_ratio:_(T),client_info:b,client_mutation_id:(d=b==null?void 0:b.client_session_id)!=null?d:r("uuidv4")(),reframe_aggressiveness:u,reframe_settings:Ge?{version:Ge}:void 0,video_collaboration:ze?null:{collaborators:D},post_collaborators:ze?{post_collaborators:D}:null,video_thumbnail_file_id:x,thumbnail_type:$.toString(),audio_enhancement:{processing:P},is_boost_toggle_on:he,music_overlay:Se,placements:we,ig_business_id:A,manual_reframe:O?g(O):null,audio_mixing:babelHelpers.extends({},B),targeted_privacy_data:Ee.length>0||ke.length>0?{age_min:0,geo_locations:{countries:Ee,regions:ke}}:null,overlay:q,main_track:U,photo_track:V,original_resolution:H,is_receiving_stars_enabled:G,linked_vod_data:z!=null?{target_video_id:z}:null,videolist:Me,hashtags_logging_data:{added_hashtags:(X!=null?X:[]).map(function(e){return{hashtag:e.hashtag,tool_type:e.toolType}})},fb_monetization_data:Y,embeddable:J,should_share_to_story:ne,total_video_duration:Z,should_use_consolidated_reel_edit_publish_path:te,ig_targeted_privacy_data:De,vod_in_stream_ads_settings:Ae,location_tag:ae!=null?{place_id:ae.id}:null,groups_schedule_resharing:Ne,reels_poll:le,auto_gen_captions_settings:ue!=null?{autogenerate_captions_enabled:ue.autogenerate_captions_enabled,should_review_all_captions:ue.should_review_all_captions}:r("justknobx")._("1058")&&se!=null?{autogenerate_captions_enabled:se.autogenerate_captions_enabled,should_review_all_captions:se.should_review_all_captions}:null,translated_audio_metadata:ce!=null&&ce.length>0?ce.map(function(e){var t,n,o,a=e.description,i=a!=null?r("getMentionsTextForContentState")(a.getCurrentContent()):null;return{audio_handle:(t=e.handle)!=null?t:"",lang_code:(n=(o=e.langCode)==null?void 0:o.valueOf())!=null?n:"",handle_type:"UPLOAD_SERVICE_HANDLE",enabled:!0,description:ge===!0&&i!==L?i:null}}):(de==null?void 0:de.translateVoiceWithMetaAi)===!0?de==null||(m=de.targetLanguages)==null?void 0:m.map(function(e){return{lang_code:e,is_lipsync_enabled:de.enableLipSyncing,enabled:!0,source_lang_code:de.sourceLanguage,audio_handle:"",require_review:de.reviewBeforePublishing}}):null,vod_title:ye?pe:void 0,allow_trim_beyond_max_length:_e,closed_captions:je,has_overridden_video_format:p===!0}}var p={aspect_ratio_denominator:16,aspect_ratio_numerator:9};function _(e){switch(e){case o("ReelComposerReframeAspectRatio").ReelComposerReframeAspectRatio.NONE:return null;case o("ReelComposerReframeAspectRatio").ReelComposerReframeAspectRatio.MANUAL_9X16:case o("ReelComposerReframeAspectRatio").ReelComposerReframeAspectRatio.SPLIT_1X3:case o("ReelComposerReframeAspectRatio").ReelComposerReframeAspectRatio.VERTICAL:return{aspect_ratio_denominator:16,aspect_ratio_numerator:9};case o("ReelComposerReframeAspectRatio").ReelComposerReframeAspectRatio.SQUARE:return{aspect_ratio_denominator:1,aspect_ratio_numerator:1};case o("ReelComposerReframeAspectRatio").ReelComposerReframeAspectRatio.FOUR_BY_FIVE:return{aspect_ratio_denominator:5,aspect_ratio_numerator:4}}}function f(e){if(e===o("ReelComposerReframeAspectRatio").ReelComposerReframeAspectRatio.VERTICAL)return"VERSION_3"}function g(e){return{left:e==null?void 0:e.crop_section_relative_top_x,right:e?e.crop_section_relative_top_x+e.crop_section_relative_width:void 0,top:e==null?void 0:e.crop_section_relative_top_y,bottom:e?e.crop_section_relative_top_y+e.crop_section_relative_height:void 0}}l.reelPublishMutation=d,l.getReelPublishInputObject=m,l.DEFAULT_ASPECT_RATIO_PARAMS=p,l.getAspectRatioParams=_,l.getReframeVersion=f,l.manualCropToReframeParameters=g}),98);
__d("VideoComposerVideoPublishingMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="29705123342436060"}),null);
__d("VideoComposerVideoPublishingMutation.graphql",["VideoComposerVideoPublishingMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"VideoPublishResponsePayload",kind:"LinkedField",name:"video_publish",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"video_asset_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"VideoComposerVideoPublishingMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"VideoComposerVideoPublishingMutation",selections:t},params:{id:n("VideoComposerVideoPublishingMutation_facebookRelayOperation"),metadata:{},name:"VideoComposerVideoPublishingMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("VideoComposerVideoPublishingMutation",["RelayAPIConfig","VideoComposerVideoPublishingMutation.graphql","cr:1012418"],(function(t,n,r,o,a,i,l){"use strict";var e,s=9e4,u=e!==void 0?e:e=n("VideoComposerVideoPublishingMutation.graphql");function c(e,t,o,a,i){var l=r("RelayAPIConfig").fetchTimeout;return r("RelayAPIConfig").fetchTimeout=s,n("cr:1012418").commitMutation(t,{uploadables:o,mutation:u,variables:{input:e},onCompleted:function(t){r("RelayAPIConfig").fetchTimeout=l,a(t)},onError:function(t){r("RelayAPIConfig").fetchTimeout=l,i(t)}})}l.commit=c}),98);
__d("getIsEligibleFor180SecondReelLimit",["gkx"],(function(t,n,r,o,a,i,l){"use strict";function e(){return r("gkx")("9083")}l.default=e}),98);
__d("VideoComposerVideoPublisher",["ReelComposerReelPublishMutation","ReelComposerReframeAspectRatio","ReelCreationFlowUtils","RelayFBEnvironmentFactory","VideoComposerVideoPublishingMutation","err","getIsEligibleFor180SecondReelLimit"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1=e.mapPostDataToGraphQLInputObject(),this.$3=e.hasAPISupport(),this.$2=e.uploadables()}var t=e.prototype;return t.publish=function(t,n){if(this.$1.publish_as_reel===!0){var e,a,i,l,s,u,c=r("RelayFBEnvironmentFactory").getForActorID(this.$1.basic_data.target_id),d=(e=this.$1.post_status_data)!=null&&e.draft?o("ReelCreationFlowUtils").ReelPublishType.DRAFT:(a=this.$1.post_status_data)!=null&&a.scheduled?o("ReelCreationFlowUtils").ReelPublishType.SCHEDULE:o("ReelCreationFlowUtils").ReelPublishType.PUBLISH_NOW,m=null,p=(i=this.$1.post_status_data)==null?void 0:i.future_date,_=(l=this.$1.post_status_data)==null?void 0:l.future_time;p!=null&&_!=null&&(m=+new Date(p).getTime()+ +_*1e3),o("ReelComposerReelPublishMutation").reelPublishMutation(c,function(){},function(){},{videoID:(s=this.$1.basic_data.video_id)!=null?s:"",shouldSkipEncoding:!1,shouldEnforceVideoEditorPath:null,loggingClientInfo:{entry_point:"CS_IG_CROSSPOST_REEL",composer_entry_point:"CS_IG_CROSSPOST_REEL",product:"CREATOR_STUDIO",feature:"IG_REELS_SHARED_TO_FB"},reelRemixingEnabled:!1,reelPublishType:d,reelScheduledUnixTimestamp:m!=null?m/1e3:0,reelDescription:(u=this.$1.basic_data.xhpc_message)!=null?u:"",trimStartTimeMs:0,trimEndTimeMs:0,isTrimTimestampsEqualToEntireVideo:!0,reelReframeAspectRatio:o("ReelComposerReframeAspectRatio").ReelComposerReframeAspectRatio.NONE,collaborators:[],videoThumbnailFileID:null,thumbnailType:"generated_default",audioEnhancementProcessingAmount:0,music:null,audioCustomStartTimeMs:null,placements:["FACEBOOK_REEL"],igBusinessID:null,manualCrop:null,mixingParams:null,geoTargetingData:null,allowTrimBeyondMaxLength:r("getIsEligibleFor180SecondReelLimit")()})}else{if(!this.$3)throw r("err")("This api does not support your publishing use case");o("VideoComposerVideoPublishingMutation").commit(this.$1,r("RelayFBEnvironmentFactory").getForActorID(this.$1.basic_data.target_id),this.$2,t,n)}},e})();l.default=e}),98);
__d("VideoUploadGraphQLPostRequestManager",["FBLogger","GraphQLVideoPublisherInputDataHandlerBase","GraphQLVideoPublisherVideoUploaderInputDataHandler","VideoComposerVideoPublisher","clearTimeout","cr:909282","err","mixin","setTimeout"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t,n,r,o){var a;return a=e.call(this)||this,a.$VideoUploadGraphQLPostRequestManager$p_1=0,a.$VideoUploadGraphQLPostRequestManager$p_2=0,a.$VideoUploadGraphQLPostRequestManager$p_3=0,a.$VideoUploadGraphQLPostRequestManager$p_4=0,a.$VideoUploadGraphQLPostRequestManager$p_5=0,a.$VideoUploadGraphQLPostRequestManager$p_6=0,a.$VideoUploadGraphQLPostRequestManager$p_7=null,a.$VideoUploadGraphQLPostRequestManager$p_8=null,a.$VideoUploadGraphQLPostRequestManager$p_9=!1,a.$VideoUploadGraphQLPostRequestManager$p_1=t,a.$VideoUploadGraphQLPostRequestManager$p_2=n,a.$VideoUploadGraphQLPostRequestManager$p_3=0,a.$VideoUploadGraphQLPostRequestManager$p_4=r,a.$VideoUploadGraphQLPostRequestManager$p_5=o,a.$VideoUploadGraphQLPostRequestManager$p_6=0,a}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.sendRequest=function(t){if(this.$VideoUploadGraphQLPostRequestManager$p_8=t,this.$VideoUploadGraphQLPostRequestManager$p_9){r("FBLogger")("video_publish_graphql").info("Sending publishing request again while processing another request");return}this.$VideoUploadGraphQLPostRequestManager$p_10(),this.inform("request-started")},n.clearRequest=function(){this.$VideoUploadGraphQLPostRequestManager$p_9=!1,this.$VideoUploadGraphQLPostRequestManager$p_6=0,this.$VideoUploadGraphQLPostRequestManager$p_3=0},n.$VideoUploadGraphQLPostRequestManager$p_10=function(){var e=this.$VideoUploadGraphQLPostRequestManager$p_8;if(e!=null){r("clearTimeout")(this.$VideoUploadGraphQLPostRequestManager$p_7),this.$VideoUploadGraphQLPostRequestManager$p_7=null;var t=e.getMetadata(),n=this.__createRequestData(e),o=new(r("GraphQLVideoPublisherVideoUploaderInputDataHandler"))(t,n);this.$VideoUploadGraphQLPostRequestManager$p_9=!0;var a=new(r("VideoComposerVideoPublisher"))(o);a.publish(this.$VideoUploadGraphQLPostRequestManager$p_11.bind(this),this.$VideoUploadGraphQLPostRequestManager$p_12.bind(this))}},n.__createRequestData=function(t){var e=t.getVideoID(),n=t.getTargetID();if(e==null)throw r("err")("Video id cannot be null");if(n==null)throw r("err")("Target id cannot be null");return{video_id:e,target_id:n,source:"COMPOSER",waterfall_id:t.getWaterfallID()||"",creator_product:t.getCreatorProduct(),composer_entry_point_ref:t.getComposerEntryPointRef&&t.getComposerEntryPointRef(),composer_dialog_version:t.getComposerDialogVersion(),has_file_been_replaced:t.getHasFileBeenReplaced(),supports_chunking:t.getSupportsChunking()}},n.$VideoUploadGraphQLPostRequestManager$p_11=function(t){var e;this.inform("request-finished",{video_asset_id:(e=t.video_publish)==null?void 0:e.video_asset_id}),this.clearRequest()},n.$VideoUploadGraphQLPostRequestManager$p_13=function(t){this.inform("request-failed",{error_code:t.number,error_description:t.message,error_summary:t.name,error_object:t}),this.clearRequest()},n.$VideoUploadGraphQLPostRequestManager$p_12=function(t){this.$VideoUploadGraphQLPostRequestManager$p_14(t)&&this.$VideoUploadGraphQLPostRequestManager$p_6<this.$VideoUploadGraphQLPostRequestManager$p_4?(r("FBLogger")("video_publish_graphql").info("retry publishing for error: %s",t.stack),this.$VideoUploadGraphQLPostRequestManager$p_6++,this.$VideoUploadGraphQLPostRequestManager$p_15(this.$VideoUploadGraphQLPostRequestManager$p_16(this.$VideoUploadGraphQLPostRequestManager$p_5,this.$VideoUploadGraphQLPostRequestManager$p_6))):this.$VideoUploadGraphQLPostRequestManager$p_13(t)},n.$VideoUploadGraphQLPostRequestManager$p_16=function(t,n){return Math.pow(t,n)*1e3},n.$VideoUploadGraphQLPostRequestManager$p_15=function(t){r("clearTimeout")(this.$VideoUploadGraphQLPostRequestManager$p_7),this.$VideoUploadGraphQLPostRequestManager$p_7=r("setTimeout")(this.$VideoUploadGraphQLPostRequestManager$p_10.bind(this),t)},n.$VideoUploadGraphQLPostRequestManager$p_14=function(t){var e=t.toString();return!!(e.includes("NetworkTransportError")||e.includes("NetworkTimeoutError")||e.includes("NetworkRequestError"))},n.hasAPISupport=function(t){return o("GraphQLVideoPublisherInputDataHandlerBase").hasAPISupport(t)},t})(r("mixin")(n("cr:909282")));l.default=e}),98);
__d("submitForm",["cr:6114"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.querySelector('input[type="submit"]');t!=null?t.click():(t=n("cr:6114").create("input",{type:"submit",className:"hidden_elem"}),n("cr:6114").appendContent(e,t),t.click(),n("cr:6114").remove(t))}l.default=e}),98);
__d("VideoUploadRequest",["AsyncRequest","DOM","DTSG","FileForm","Form","VideoUploadFeatureDetector","emptyFunction","flattenPHPQueryData","submitForm"],(function(t,n,r,o,a,i){var e="video",l=(function(){"use strict";function t(e){var t;this.$1=e,this.$2=null,this.$3=!1,this.$4=null,this.$5=null,this.$6=null,this.$7=null,this.$8=t=n("emptyFunction"),this.$9=t,this.$10=t,this.$11=t,this.$12=null}var r=t.prototype;return r.setAllowCrossOrigin=function(t){return this.$3=t,this},r.setData=function(t){return this.$4=t,this},r.setWaterfallID=function(t){return this.$6=t,this},r.setSuccessHandler=function(t){return this.$8=t,this},r.setErrorHandler=function(t){return this.$9=t,this},r.setTransportErrorHandler=function(t){return this.$10=t,this},r.setUploadProgressHandler=function(t){return this.$11=t,this},r.setTimeoutHandler=function(t,n){return this.$7=t,this.$12=n,this},r.setThumbnail=function(t){return this.$13=t,this},r.setCustomProfileImage=function(t){return this.$14=t,this},r.setCustomBackgroundImage=function(t){return this.$15=t,this},r.setFeedBackgroundImage=function(t){return this.$16=t,this},r.setHandle=function(t){return this.$5=t,this},r.setCaptions=function(t){return this.$17=t,this},r.setPollOptionImages=function(t){return this.$18=t,this},r.send=function(){if(this.$2)throw new Error("An upload request is already in progress.");if(n("VideoUploadFeatureDetector").supportsXHR()){if(this.$2=this.$19(),this.$13||this.$17||this.$14||this.$15||this.$16||this.$18){var e=new FormData;if(this.$13&&e.append("thumb",this.$13),this.$14&&e.append("schedule_custom_profile_image",this.$14),this.$15&&e.append("schedule_custom_background_image",this.$15),this.$16&&e.append("schedule_feed_background_image",this.$16),this.$17&&this.$17.forEach(function(t,n){var r=t.getIsDefault()?"captions_default":"captions_file"+n;e.append(r,t.getFile())}),this.$18){var t=this.$18;Object.keys(t).forEach(function(n){e.append(n,t[n])})}if(this.$4){var r=n("flattenPHPQueryData")(this.$4);Object.keys(r).forEach(function(t){e.append(t,r[t])})}this.$2.setRawData(e)}this.$2.send()}else this.$2=this.$20(),this.$21(this.$2)},r.sendChunk=function(t){if(this.$2)throw new Error("An upload request is already in progress.");var e=new FormData;this.$5?e.append("fbuploader_video_file_chunk",this.$5):e.append("video_file_chunk",t),this.$2=this.$19(),this.$2.setRawData(e),this.$2.send()},r.sendFile=function(r){if(this.$2)throw new Error("An upload request is already in progress.");this.$2=this.$20();var t=r.cloneNode(!1);r.name=e,n("DOM").replace(r,t),n("DOM").appendContent(this.$2.getRoot(),r),this.$21(this.$2),r.name=t.name,n("DOM").replace(t,r)},r.abort=function(){this.$2&&(this.$2.abort(),this.$2=null)},r.$19=function(){var e=this.__getAsyncRequest().setAllowCrossOrigin(this.$3).setURI(this.$1).setData(this.$4).setRequestHeader("X_FB_VIDEO_WATERFALL_ID",this.$6).setHandler(this.$8).setErrorHandler(this.$9).setTransportErrorHandler(this.$10).setUploadProgressHandler(this.$11);return this.$12&&e.setTimeoutHandler(this.$7,this.$12),e},r.__getAsyncRequest=function(){return new(n("AsyncRequest"))},r.$20=function(){var e=n("DOM").create("form",{action:this.$1,method:"POST"});n("Form").createHiddenInputs(babelHelpers.extends({fb_dtsg:n("DTSG").getToken()},this.$4),e);var t=new(n("FileForm"))(e,null,{allowCrossOrigin:this.$3});return t.subscribe("success",this.$22.bind(this)),t.subscribe("failure",this.$23.bind(this)),t.subscribe("progress",this.$24.bind(this)),t},r.$21=function(t){n("DOM").appendContent(document.body,t.getRoot()),n("submitForm")(t.getRoot())},r.$22=function(t,n){this.$8(n.response)},r.$23=function(t,n){this.$9(n.response)},r.$24=function(t,n){this.$11(n.event)},t})();a.exports=l}),null);
__d("VideoUploadPostRequestManager",["VideoUploadLogger","VideoUploadRequest","clearTimeout","cr:909282","isEmpty","mixin","setTimeout"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function n(e,n,r,o,a){var i;return i=t.call(this)||this,i.$VideoUploadPostRequestManager2=e,i.$VideoUploadPostRequestManager3=n,i.$VideoUploadPostRequestManager4=r,i.$VideoUploadPostRequestManager5=0,i.$VideoUploadPostRequestManager6=o,i.$VideoUploadPostRequestManager7=a,i.$VideoUploadPostRequestManager8=0,i}babelHelpers.inheritsLoose(n,t);var o=n.prototype;return o.$VideoUploadPostRequestManager9=function(){return this.$VideoUploadPostRequestManager1?new(r("VideoUploadLogger"))({source:this.$VideoUploadPostRequestManager1.getSource(),waterfall_id:this.$VideoUploadPostRequestManager1.getWaterfallID(),target_id:this.$VideoUploadPostRequestManager1.getTargetID(),composer_entry_point_ref:this.$VideoUploadPostRequestManager1.getComposerEntryPointRef&&this.$VideoUploadPostRequestManager1.getComposerEntryPointRef()}):null},o.getRequest=function(){return this.$VideoUploadPostRequestManager10},o.sendRequest=function(t){if(this.$VideoUploadPostRequestManager1=t,this.$VideoUploadPostRequestManager10){var e=this.$VideoUploadPostRequestManager9();e&&e.logEvent(r("VideoUploadLogger").EVENT_DUPLICATE_POST_REQUEST);return}this.$VideoUploadPostRequestManager11=babelHelpers.extends({},t.getMetadata(),this.__createRequestData(t)),this.$VideoUploadPostRequestManager12=this.$VideoUploadPostRequestManager11.thumb,this.$VideoUploadPostRequestManager13=this.$VideoUploadPostRequestManager11.schedule_custom_profile_image,this.$VideoUploadPostRequestManager14=this.$VideoUploadPostRequestManager11.schedule_custom_background_image,this.$VideoUploadPostRequestManager15=this.$VideoUploadPostRequestManager11.schedule_feed_background_image,delete this.$VideoUploadPostRequestManager11.thumb,this.$VideoUploadPostRequestManager16=this.$VideoUploadPostRequestManager11.captions,delete this.$VideoUploadPostRequestManager11.captions,this.$VideoUploadPostRequestManager17=t.getWaterfallID(),this.$VideoUploadPostRequestManager18=this.$VideoUploadPostRequestManager11.pollImages,this.$VideoUploadPostRequestManager19(),this.inform("request-started")},o.$VideoUploadPostRequestManager19=function(){r("clearTimeout")(this.$VideoUploadPostRequestManager20),this.$VideoUploadPostRequestManager20=null,this.$VideoUploadPostRequestManager10=this.__getVideoUploadRequest(this.$VideoUploadPostRequestManager2).setAllowCrossOrigin(!0).setData(this.$VideoUploadPostRequestManager11).setThumbnail(this.$VideoUploadPostRequestManager12).setCustomProfileImage(this.$VideoUploadPostRequestManager13).setCustomBackgroundImage(this.$VideoUploadPostRequestManager14).setFeedBackgroundImage(this.$VideoUploadPostRequestManager15).setCaptions(this.$VideoUploadPostRequestManager16).setWaterfallID(this.$VideoUploadPostRequestManager17).setPollOptionImages(this.$VideoUploadPostRequestManager18).setSuccessHandler(this.$VideoUploadPostRequestManager21.bind(this)).setErrorHandler(this.$VideoUploadPostRequestManager22.bind(this)).setTransportErrorHandler(this.$VideoUploadPostRequestManager23.bind(this)),this.$VideoUploadPostRequestManager10.send()},o.__createRequestData=function(t){return{video_id:t.getVideoID(),target_id:t.getTargetID(),source:t.getSource(),waterfall_id:t.getWaterfallID(),creator_product:t.getCreatorProduct(),composer_entry_point_ref:t.getComposerEntryPointRef&&t.getComposerEntryPointRef(),composer_dialog_version:t.getComposerDialogVersion(),has_file_been_replaced:t.getHasFileBeenReplaced(),supports_chunking:t.getSupportsChunking()}},o.__getVideoUploadRequest=function(t){return new(r("VideoUploadRequest"))(t)},o.clearRequest=function(){this.$VideoUploadPostRequestManager10=null,this.$VideoUploadPostRequestManager8=0,this.$VideoUploadPostRequestManager5=0},o.isInProgress=function(){return!!this.$VideoUploadPostRequestManager10},o.$VideoUploadPostRequestManager24=function(t){r("clearTimeout")(this.$VideoUploadPostRequestManager20),this.$VideoUploadPostRequestManager20=r("setTimeout")(this.$VideoUploadPostRequestManager19.bind(this),t)},o.$VideoUploadPostRequestManager25=function(t,n){return Math.pow(t,n)*1e3},o.$VideoUploadPostRequestManager21=function(t){var e=t.getPayload();this.inform("request-finished",{video_id:e.video_id,video_asset_id:e.video_asset_id,container_type:e.container_type,transport_retries:this.$VideoUploadPostRequestManager5,server_retries:this.$VideoUploadPostRequestManager8,premiere_destination_video_id:e.premiere_destination_video_id}),this.clearRequest()},o.$VideoUploadPostRequestManager26=function(n){var t,o,a=[].concat(n==null||(t=n.getPayload())==null||(t=t.error)==null?void 0:t.opes_mids,[n==null?void 0:n.errorMid]).filter(Boolean);this.inform("request-failed",{error_code:n.getError(),error_description:n.getErrorDescription(),error_summary:n.getErrorSummary(),transport_retries:this.$VideoUploadPostRequestManager5,server_retries:this.$VideoUploadPostRequestManager8,error_is_silent:n.isSilent(),error_is_transient:n.isTransient(),www_request_id:(o=n.getPayload())==null?void 0:o.__www_request_id__,opes_mids:(e||(e=r("isEmpty")))(a)?null:a}),this.clearRequest()},o.$VideoUploadPostRequestManager22=function(t){this.$VideoUploadPostRequestManager10=null,this.$VideoUploadPostRequestManager5=0;var e=this.$VideoUploadPostRequestManager9();if(e){var n={server_retries:this.$VideoUploadPostRequestManager8,extra_data:{failure_is_transient:t.isTransient()}};e.logEvent(r("VideoUploadLogger").EVENT_HANDLING_SERVER_FAILURE_RESPONSE,n)}t.isTransient()&&this.$VideoUploadPostRequestManager8<this.$VideoUploadPostRequestManager6?(this.$VideoUploadPostRequestManager8++,this.$VideoUploadPostRequestManager24(this.$VideoUploadPostRequestManager25(this.$VideoUploadPostRequestManager7,this.$VideoUploadPostRequestManager8))):this.$VideoUploadPostRequestManager26(t)},o.$VideoUploadPostRequestManager23=function(t){var e=this.$VideoUploadPostRequestManager9();if(e){var n={extra_data:{transport_retries:this.$VideoUploadPostRequestManager5}};e.logEvent(r("VideoUploadLogger").EVENT_HANDLING_TRANSPORT_FAILURE_RESPONSE,n)}this.$VideoUploadPostRequestManager3===0||this.$VideoUploadPostRequestManager5>=this.$VideoUploadPostRequestManager3?this.$VideoUploadPostRequestManager26(t):(this.$VideoUploadPostRequestManager5++,this.$VideoUploadPostRequestManager10=null,this.$VideoUploadPostRequestManager24(this.$VideoUploadPostRequestManager25(this.$VideoUploadPostRequestManager4,this.$VideoUploadPostRequestManager5)))},n})(r("mixin")(n("cr:909282"))),u=s;l.default=u}),98);
__d("VideoUploadRequestContext",[],(function(t,n,r,o,a,i){var e=(function(){function e(){var e=this;this.$14=!1,this.$21=0,this.$22=!1,this.$23=!1,this.$26=!1,this.getComposerEntryPointRef=function(){return e.$11},this.reset()}var t=e.prototype;return t.setFile=function(t){return this.$1=t,this},t.getFile=function(){return this.$1},t.setMetadata=function(t){return this.$24=t,this},t.getMetadata=function(){return this.$24},t.setVideoID=function(t){return this.$2=t,this},t.getVideoID=function(){return this.$2},t.setXPVAssetID=function(t){return this.$29=t,this},t.getXPVAssetID=function(){return this.$29},t.setIsXPVSingleProd=function(t){return this.$30=t,this},t.getIsXPVSingleProd=function(){return this.$30},t.setUploadSessionID=function(t){return this.$3=t,this},t.getUploadSessionID=function(){return this.$3},t.setFbRegion=function(t){return this.$4=t,this},t.getFbRegion=function(){return this.$4},t.setStartOffset=function(t){return this.$5=t,this},t.getStartOffset=function(){return this.$5},t.setEndOffset=function(t){return this.$6=t,this},t.getEndOffset=function(){return this.$6},t.setPartitionStartOffset=function(t){return this.$17=t,this},t.getPartitionStartOffset=function(){return this.$17},t.setPartitionEndOffset=function(t){return this.$18=t,this},t.getPartitionEndOffset=function(){return this.$18},t.setPartitionNo=function(t){return this.$19=t,this},t.getPartitionNo=function(){return this.$19},t.setTargetID=function(t){return this.$7=t,this},t.getTargetID=function(){return this.$7},t.setSource=function(t){return this.$8=t,this},t.setComposerDialogVersion=function(t){return this.$9=t,this},t.getComposerDialogVersion=function(){return this.$9},t.getSource=function(){return this.$8},t.setWaterfallID=function(t){return this.$10=t,this},t.getWaterfallID=function(){return this.$10},t.setComposerEntryPointRef=function(t){return this.$11=t,this},t.setComposerWorkSharedDraftMode=function(t){return this.$12=t,this},t.getComposerWorkSharedDraftMode=function(){return this.$12},t.setHasFileBeenReplaced=function(t){return this.$14=t,this},t.getHasFileBeenReplaced=function(){return this.$14},t.setSupportsChunking=function(t){return this.$15=t,this},t.getSupportsChunking=function(){return this.$15},t.setSupportsFileAPI=function(t){return this.$16=t,this},t.getSupportsFileAPI=function(){return this.$16},t.setCreatorProduct=function(t){return this.$20=t,this},t.getCreatorProduct=function(){return this.$20},t.setLastKnownUploadSpeed=function(t){return this.$21=t,this},t.getLastKnownUploadSpeed=function(){return this.$21||0},t.setUseParallelChunks=function(t){return this.$22=t,this},t.getUseParallelChunks=function(){return this.$22},t.setIsSphericalVideo=function(t){return this.$23=t,this},t.getIsSphericalVideo=function(){return this.$23},t.setSphericalMetadata=function(t){return this.$25=t,this},t.getSphericalMetadata=function(){return this.$25},t.setEnableOmnistab=function(t){return this.$26=t,this},t.getEnableOmnistab=function(){return this.$26},t.setClientChunkSize=function(t){return this.$27=t,this},t.getClientChunkSize=function(){return this.$27},t.setVideoPublisherActionSource=function(t){return this.$28=t,this},t.getVideoPublisherActionSource=function(){return this.$28},t.setComposerSessionID=function(t){return this.$13=t,this},t.getComposerSessionID=function(){return this.$13},t.setRetryState=function(t){return this.$31=t,this},t.getRetryState=function(){return this.$31},t.setCreativeTools=function(t){return this.$32=t,this},t.getCreativeTools=function(){return this.$32},t.reset=function(){this.$1=null,this.$2=null,this.$3=null,this.$4=null,this.$5=null,this.$6=null,this.$7=null,this.$8=null,this.$9=null,this.$10=null,this.$11=null,this.$12=null,this.$14=!1,this.$15=null,this.$16=null,this.$17=null,this.$18=null,this.$19=null,this.$20=null,this.$21=0,this.$22=!1,this.$23=!1,this.$24={},this.$25={},this.$26=!1,this.$27=null,this.$28={},this.$13=null,this.$31=null,this.$32=null},e})();i.default=e}),66);
__d("MediaUploadSingleAssetPublisher",["Promise","VideoUploadGraphQLPostRequestManager","VideoUploadPostRequestManager","VideoUploadRequestContext"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function t(){}t.publish=function(n){return t.$1==null&&(t.$1=new t),t.$1.publish(n)};var o=t.prototype;return o.publish=function(r){var t=this;return new(e||(e=n("Promise")))(function(e){var n=t.$2(r.sessionSnapshot,r.assetSnapshot,r.postData),o,a=t.$3(r.postRequestManagerParams);a.hasAPISupport(r.postData)&&(o=a),o==null&&(o=t.$4(r.postRequestManagerParams)),t.$5(o,e),o.sendRequest(n)})},o.$4=function(t){return new(r("VideoUploadPostRequestManager"))(t==null?void 0:t.chunk_post_uri,t==null?void 0:t.post_max_transport_retries,t==null?void 0:t.post_transport_retry_interval_base,t==null?void 0:t.post_max_server_retries,t==null?void 0:t.post_server_retry_interval_base)},o.$3=function(t){var e,n,o,a;return new(r("VideoUploadGraphQLPostRequestManager"))((e=t==null?void 0:t.post_max_transport_retries)!=null?e:0,(n=t==null?void 0:t.post_transport_retry_interval_base)!=null?n:0,(o=t==null?void 0:t.post_max_server_retries)!=null?o:0,(a=t==null?void 0:t.post_server_retry_interval_base)!=null?a:0)},o.$5=function(t,n){t.subscribe("request-finished",function(e,t){var r={event:e,payload:t};n({isSuccessful:!0,rawResponse:r})}),t.subscribe("request-failed",function(e,t){var r={event:e,payload:t},o=(t==null?void 0:t.error_code)==null||(t==null?void 0:t.error_code)==0?"PublishError":t==null?void 0:t.error_code;n({isSuccessful:!1,errorCode:o,rawErrorObject:t==null?void 0:t.error_object,rawResponse:r})})},o.$2=function(t,n,o){var e;return new(r("VideoUploadRequestContext"))().setVideoID(n.videoID).setTargetID(n.request.attributes.targetID).setSource(t.entryPoint.sourceType).setWaterfallID(t.sessionID).setCreatorProduct(n.request.attributes.creatorProduct).setComposerEntryPointRef(t.entryPoint.entryPointRef).setComposerDialogVersion(n.request.attributes.composerDialogVersion).setHasFileBeenReplaced((e=n.request.attributes.hasFileBeenReplaced)!=null?e:!1).setSupportsChunking(!0).setMetadata(o)},t})();l.default=s}),98);
__d("MediaUploadVUShimLogger",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e){this.$1=e}var t=e.prototype;return t.logEvent=function(t,n){},t.postOnShutdown=function(t){return{remove:function(){}}},t.getWaterfallID=function(){return this.$1},e})();i.default=e}),66);
__d("MediaUploadVUShimSession",["MediaUploadAssetEvent","MediaUploadAssetStatus","MediaUploadCancelReason","MediaUploadFBSDK","MediaUploadFBStage","MediaUploadSessionEvent","MediaUploadSessionStatus","MediaUploadSingleAssetPublisher","MediaUploadStageEvent","MediaUploadVUShimLogger","MediaUploadVUShimSurface","Promise","WaterfallIDGenerator","cr:909282","mixin"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(t){function a(e,n){var a,i;return i=t.call(this)||this,i.sessionID=o("WaterfallIDGenerator").generate(),i.$MediaUploadVUShimSession$p_1=e,i.$MediaUploadVUShimSession$p_3=(a=e.waterfall_id)!=null?a:i.sessionID,i.$MediaUploadVUShimSession$p_6=n,i.$MediaUploadVUShimSession$p_5=new(r("MediaUploadVUShimLogger"))(i.$MediaUploadVUShimSession$p_3),i.$MediaUploadVUShimSession$p_10=!i.$MediaUploadVUShimSession$p_1.background_upload,i}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.createTestLogger=function(){},i.getLogger=function(){return this.$MediaUploadVUShimSession$p_5},i.start=function(t){var e=this;this.inform("set-waterfall-id",{waterfallID:this.$MediaUploadVUShimSession$p_3});var n=r("MediaUploadVUShimSurface").createAssetRequest(function(e){var n=t.getFile(),o=t.getFileInput();if(n!=null)return e.createFromFile(n);if(o!=null){var a=e.createFromHTMLInput(o);if(a.dataAsFile()==null)throw r("MediaUploadFBSDK").createThrowableError("Cannot get File from the HTML input element");return a}else throw r("MediaUploadFBSDK").createThrowableError("Invalid video upload file, it contains only null objects")},t.getStableAssetID(),function(t){var n,r;return{targetID:(n=e.$MediaUploadVUShimSession$p_4)!=null?n:e.$MediaUploadVUShimSession$p_1.target_id,composerSessionID:e.$MediaUploadVUShimSession$p_2,actorID:e.$MediaUploadVUShimSession$p_1.as_actor_id,composerDialogVersion:"V2",publisherActionSource:e.$MediaUploadVUShimSession$p_1.video_publisher_action_source,creatorProduct:((r=t.dataAsFile())==null?void 0:r.extension)==="gif"?4:2}});this.$MediaUploadVUShimSession$p_9=n,this.$MediaUploadVUShimSession$p_6.startUploads(this.sessionID,[n]),this.$MediaUploadVUShimSession$p_10&&this.$MediaUploadVUShimSession$p_6.confirmSession(this.sessionID,[n],function(e){return e.set("dummyPublish",!0)})},i.setTargetID=function(t){this.$MediaUploadVUShimSession$p_4=t},i.setComposerSessionID=function(t){this.$MediaUploadVUShimSession$p_2=t},i.post=function(t){this.$MediaUploadVUShimSession$p_10?r("MediaUploadFBSDK").reportRecoverableError("Video upload client configured for pessimistic upload and explicit publish calls are now allowed"):this.$MediaUploadVUShimSession$p_9!=null&&this.$MediaUploadVUShimSession$p_6.confirmSession(this.sessionID,[this.$MediaUploadVUShimSession$p_9],function(e){return e.set("postData",t)})},i.cancel=function(t){this.$MediaUploadVUShimSession$p_6.cancelSession(this.sessionID,r("MediaUploadCancelReason").USER_REQUEST)},i.abandon=function(t){this.$MediaUploadVUShimSession$p_6.cancelSession(this.sessionID,r("MediaUploadCancelReason").USER_REQUEST)},i.isPostInProgress=function(){var e;return((e=this.$MediaUploadVUShimSession$p_7)==null?void 0:e.status)===r("MediaUploadSessionStatus").PUBLISHING},i.isInProgress=function(){var e,t;return((e=this.$MediaUploadVUShimSession$p_8)==null?void 0:e.status)===r("MediaUploadAssetStatus").PROCESSING||((t=this.$MediaUploadVUShimSession$p_8)==null?void 0:t.status)===r("MediaUploadAssetStatus").UPLOADING},i.getHasUploadFinished=function(){var e;return((e=this.$MediaUploadVUShimSession$p_8)==null?void 0:e.status)===r("MediaUploadAssetStatus").COMPLETED},i.getVideoID=function(){var e;return(e=this.$MediaUploadVUShimSession$p_8)==null?void 0:e.videoID},i.getUploadTime=function(){var e,t,n=(e=this.$MediaUploadVUShimSession$p_8)==null||(e=e.uploadSummary)==null?void 0:e.startedAtMs,r=(t=this.$MediaUploadVUShimSession$p_8)==null||(t=t.uploadSummary)==null?void 0:t.finishedAtMs;return n!=null&&r!=null?r-n:null},i.getExPartitionNumber=function(t){return 0},i.getIsSphericalVideo=function(){var e,t;return(e=(t=this.$MediaUploadVUShimSession$p_8)==null||(t=t.metadata)==null?void 0:t.isSpherical)!=null?e:!1},i.startFlow=function(){this.$MediaUploadVUShimSession$p_10?r("MediaUploadFBSDK").reportRecoverableError("Video upload client configured for pessimistic upload and explicit publish calls are now allowed"):this.$MediaUploadVUShimSession$p_9!=null&&this.$MediaUploadVUShimSession$p_6.confirmSession(this.sessionID,[this.$MediaUploadVUShimSession$p_9])},i.sessionUpdated=function(t,n){var e,o;this.$MediaUploadVUShimSession$p_7=n;var a=n.extras.getUnsafe("postData");if(a!=null){var i=n.publishingResponse;switch(t){case r("MediaUploadSessionEvent").PUBLISH_STARTED:this.inform("post-started",a);break;case r("MediaUploadSessionEvent").PUBLISH_SUCCEED:this.inform("post-finished",babelHelpers.extends({},(e=i==null?void 0:i.payload)!=null?e:{},a));break;case r("MediaUploadSessionEvent").PUBLISH_FAILED:this.inform("post-failed",(o=i==null?void 0:i.payload)!=null?o:{});break;default:}}},i.assetUpdated=function(t,n,o){var e,a,i,l,s,u,c,d,m,p,_,f,g;this.$MediaUploadVUShimSession$p_7=n,this.$MediaUploadVUShimSession$p_8=o;var h,y,C=(e=(a=o.asset.dataAsFile())==null?void 0:a.size)!=null?e:0,b=(i=(l=o.uploadSummary)==null?void 0:l.skippedUpload)!=null?i:!1;switch(t){case r("MediaUploadAssetEvent").ASSET_ADDED:h="upload-requested";break;case r("MediaUploadAssetEvent").ASSET_STARTED:h="upload-started";break;case r("MediaUploadAssetEvent").ASSET_REMOVED:h="upload-canceled";break;case r("MediaUploadAssetEvent").ASSET_PROGRESS:h="upload-progressed",y={start_offset:0,end_offset:C,file_size:C,sent_bytes:b?C:(s=(u=o.uploadSummary)==null?void 0:u.uploadedBytes)!=null?s:0,video_id:o.videoID,upload_domain:o.uploadServiceDomain,skip_upload:b,transport_retries:o.retries.totalRetryAttempts};break;case r("MediaUploadAssetEvent").ASSET_SUCCEED:h="upload-finished",y={start_offset:0,end_offset:C,video_id:o.videoID,is_spherical_video:(c=o==null||(d=o.metadata)==null?void 0:d.isSpherical)!=null?c:!1};break;case r("MediaUploadAssetEvent").ASSET_FAILED:h="upload-failed",y={error_code:(m=o.lastAction)==null?void 0:m.rawErrorCode,error_summary:(p=o.lastAction)==null||(p=p.displayError)==null?void 0:p.summary,error_description:(_=o.lastAction)==null||(_=_.displayError)==null?void 0:_.description,error_is_transient:(f=o.lastAction)==null||(f=f.errorAttributes)==null?void 0:f.transientError,upload_domain:o.uploadServiceDomain,www_request_id:(g=o.lastAction)==null?void 0:g.networkRequestID};break;default:}h!=null&&this.inform(h,y)},i.stageUpdated=function(t,n,o,a){if(this.$MediaUploadVUShimSession$p_7=o,this.$MediaUploadVUShimSession$p_8=a,t===r("MediaUploadStageEvent").STAGE_SUCCEED&&n===r("MediaUploadFBStage").METADATA_EXTRACTION){var e;if(a.metadata!=null){var i,l=a.metadata,s=l.durationMs==null?void 0:l.durationMs/1e3;e={format:{duration:s,isSpherical:(i=l.isSpherical)!=null?i:!1},metadata:{},streams:{numAudioTracks:1,primaryVideo:{type:"video",width:l.width,height:l.height,duration:s},primaryAudio:{type:"audio",duration:s}}}}else e=null;this.inform("metadata-parsed",e)}},i.triggerPublish=function(o,a){var t;this.$MediaUploadVUShimSession$p_7=o,this.$MediaUploadVUShimSession$p_8=a[0];var i=(t=o.extras.getBoolean("dummyPublish"))!=null?t:!1,l=o.extras.getUnsafe("postData");return i?(e||(e=n("Promise"))).resolve({isSuccessful:!0}):l==null?(e||(e=n("Promise"))).resolve({isSuccessful:!1,errorCode:"MISSING_POST_DATA"}):r("MediaUploadSingleAssetPublisher").publish({sessionSnapshot:o,assetSnapshot:a[0],postData:l,postRequestManagerParams:this.$MediaUploadVUShimSession$p_1})},a})(r("mixin")(n("cr:909282")));l.default=s}),98);
__d("MediaUploadOperationOutcome",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["SUCCESS","CANCELED","FAILED_NON_TRANSIENT","FAILED_NO_MORE_RETRIES","FAILED_OUT_OF_TIME"]),l=e;i.default=l}),66);
__d("MediaUploadCancelablePromise",["Promise"],(function(t,n,r,o,a,i){"use strict";var e,l={cancel:function(){}},s=(function(){function t(t){var r=this;this.$1=!1,this.promise=new(e||(e=n("Promise")))(function(e,n){r.$2=t(e,n),r.$2==null&&(r.$2=l),r.$1&&r.$2.cancel()})}t.resolve=function(n){return new t(function(e){e(n)})};var r=t.prototype;return r.then=function(n){var e=this;return new t(function(r,o){var a={cancelable:e};return e.promise.then(function(r){if(a.cancelable=l,e.$1)return r;var o=n(r);return o instanceof t?(a.cancelable=o,o.promise):o}).then(r).catch(function(){a.cancelable=l,o.apply(void 0,arguments)}),{cancel:function(){a.cancelable.cancel()}}})},r.isCanceled=function(){return this.$1},r.cancel=function(){if(!this.$1){var e;this.$1=!0,(e=this.$2)==null||e.cancel()}},t})();i.default=s}),66);
__d("MediaUploadPipeline",["MediaUploadCancelablePromise","MediaUploadOperationOutcome"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t){var n=this;this.$2=[],this.$3=null,this.$2=e,this.$1=t,this.cancelablePromise=new(r("MediaUploadCancelablePromise"))(function(e,t){return n.$4(e,t,[].concat(n.$2)),{cancel:function(){var t;(t=n.$3)==null||t.cancel(),n.$3=null,e(r("MediaUploadOperationOutcome").CANCELED)}}})}var t=e.prototype;return t.$4=function(t,n,o){var e=this;if(o.length===0)this.$3=null,t(r("MediaUploadOperationOutcome").SUCCESS);else{var a=o.shift(),i=a();this.$1.promiseTerminator(i.promise.then(function(a){e.cancelablePromise.isCanceled()?t(r("MediaUploadOperationOutcome").CANCELED):a===r("MediaUploadOperationOutcome").SUCCESS?e.$4(t,n,o):t(a)}).catch(n)),this.$3=i}},e})(),s=(function(){function t(e){this.$2=[],this.$1=e}var n=t.prototype;return n.addCancelableStep=function(t){this.$2.push(t)},n.addPlainStep=function(t){this.$2.push(function(){return new(r("MediaUploadCancelablePromise"))(function(e){e(t())})})},n.run=function(){var t=new e(this.$2,this.$1);return t.cancelablePromise},t})();l.default=s}),98);
__d("MediaUploadAssetStrategy",["MediaUploadAssetEvent","MediaUploadAssetStatus","MediaUploadOperationOutcome","MediaUploadPipeline","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function t(e){this.$1=e.implementation,this.$2=e.executor,this.$3=e.params}var o=t.prototype;return o.removeAsset=function(t){var e;t.updateStatusAndEmit(r("MediaUploadAssetStatus").REMOVED),(e=t.inFlightUpload)==null||e.cancel()},o.addAsset=function(t){t.sessionContext.assetsByID.set(t.assetID,t),t.emitAssetEvent(r("MediaUploadAssetEvent").ASSET_ADDED)},o.scheduleUpload=function(t){var e=this;return t.updateStatusAndEmit(r("MediaUploadAssetStatus").SCHEDULED),this.$2.schedule(function(){return e.$4(t)})},o.$4=function(o){var t=this;if(o.isRemoved())return(e||(e=n("Promise"))).resolve();o.updateStatusAndEmit(r("MediaUploadAssetStatus").PROCESSING);var a=new(r("MediaUploadPipeline"))(this.$3);a.addCancelableStep(function(){return t.$1.runClientLazyLoading(o)}),a.addCancelableStep(function(){return t.$1.runLocalAssetStategy(o)}),a.addCancelableStep(function(){return o.updateStatusAndEmit(r("MediaUploadAssetStatus").UPLOADING),t.$1.runNetworkAssetStategy(o)});var i=a.run();return o.inFlightUpload=i,i.promise.then(function(e){return t.$5(o,e)}).catch(function(e){t.$3.reportRecoverableError("Unexpected failure during asset pipeline execution",e),o.updateStatusAndEmit(r("MediaUploadAssetStatus").FAILED)})},o.$5=function(t,n){if(!t.isRemoved())switch(n){case r("MediaUploadOperationOutcome").SUCCESS:t.updateStatusAndEmit(r("MediaUploadAssetStatus").COMPLETED);break;case r("MediaUploadOperationOutcome").CANCELED:t.updateStatusAndEmit(r("MediaUploadAssetStatus").REMOVED);break;default:t.updateStatusAndEmit(r("MediaUploadAssetStatus").FAILED)}},t})();l.default=s}),98);
__d("MediaUploadRetryState",["MediaUploadTime"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t){this.retryPolicy=e,this.$3=0,this.$4=0,this.$1=t.currentTimeProvider,this.$2=t.randomNumberProvider,this.$5=this.$1()}var t=e.prototype;return t.resetBackoff=function(){this.$3=0},t.getRetryAttempts=function(){return this.$4},t.getRetryAttemptsSinceLastReset=function(){return this.$3},t.calculateBackoffDelay=function(){var e=this.retryPolicy.backoff,t=o("MediaUploadTime").timeToMilliseconds(e.initial),n=e.expBase,r=e.expMultiplier;this.$3>0&&n!=null&&r!=null&&(t+=o("MediaUploadTime").timeToMilliseconds(n)*Math.pow(r,this.$3-1)),e.max!=null&&(t=Math.min(t,o("MediaUploadTime").timeToMilliseconds(e.max)));var a=e.jitter==null?0:o("MediaUploadTime").timeToMilliseconds(e.jitter);return a>0&&(t+=this.$2(-.5*a,.5*a)),o("MediaUploadTime").millisecondsToTime(Math.round(t))},t.exceedTotalRetries=function(){var e;return((e=this.retryPolicy.limits)==null?void 0:e.totalRetryCount)!=null&&this.$4>this.retryPolicy.limits.totalRetryCount},t.exceedTotalDuration=function(){var e,t;return((e=this.retryPolicy.limits)==null?void 0:e.totalTime)!=null&&o("MediaUploadTime").compareTime((t=this.retryPolicy.limits)==null?void 0:t.totalTime,o("MediaUploadTime").subtractTime(this.$1(),this.$5))<=0},t.increaseRetryAttemptCounter=function(){this.$3++,this.$4++},e})();l.default=e}),98);
__d("MediaUploadClientResult",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["ACCEPTED","SESSION_NOT_FOUND","ASSET_NOT_FOUND","ASSET_ALREADY_EXISTS","SESSION_ALREADY_CANCELED","SESSION_ALREADY_PUBLISHING","SESSION_ALREADY_PUBLISHED","SESSION_NOT_FAILED","INVALID_TYPE","UNSUPPORTED_BROWSER"]),l=e;i.default=l}),66);
__d("MediaUploadSessionStrategy",["MediaUploadCancelReason","MediaUploadClientResult","MediaUploadSessionEvent","MediaUploadSessionStatus"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1=e.implementation,this.$2=e.assetStrategy,this.$3=e.params}var t=e.prototype;return t.$4=function(t){if(t.isConfirmed()&&t.progress.publishingExtrasProvided){var e=t.getActiveAssets();for(var n of e)if(n.isFailed()){t.updateStatusAndEmit(r("MediaUploadSessionStatus").FAILED);return}e.every(function(e){return e.isCompleted()})&&this.$5(t)}},t.$5=function(t){t.updateStatusAndEmit(r("MediaUploadSessionStatus").PUBLISHING);var e=[];for(var n of t.assetsByID.values())n.isCompleted()&&e.push(n);var o=this.$1.publish(t,e).then(function(e){t.progress.publishingResponse=e.rawResponse,e.isSuccessful?(t.emitSessionEvent(r("MediaUploadSessionEvent").PUBLISH_SUCCEED),t.updateStatusAndEmit(r("MediaUploadSessionStatus").COMPLETED)):(t.updateLastError({rawErrorCode:e.errorCode,rawErrorObject:e.rawErrorObject}),t.emitSessionEvent(r("MediaUploadSessionEvent").PUBLISH_FAILED),t.updateStatusAndEmit(r("MediaUploadSessionStatus").FAILED),t.updateLastError())}).catch(function(e){t.updateLastError({rawErrorObject:e}),t.emitSessionEvent(r("MediaUploadSessionEvent").PUBLISH_FAILED),t.updateStatusAndEmit(r("MediaUploadSessionStatus").FAILED),t.updateLastError()});this.$3.promiseTerminator(o)},t.$6=function(t,n){var e=this;this.$2.scheduleUpload(n).finally(function(){return e.$4(t)})},t.$7=function(t){return t.isPublished()?r("MediaUploadClientResult").SESSION_ALREADY_PUBLISHED:t.isPublishing()?r("MediaUploadClientResult").SESSION_ALREADY_PUBLISHING:t.isCanceled()?r("MediaUploadClientResult").SESSION_ALREADY_CANCELED:r("MediaUploadClientResult").ACCEPTED},t.$8=function(t){var e=this;t.releaseOnFinish.push(this.$3.registerUnloadHook(function(){e.cancel(t,r("MediaUploadCancelReason").UNLOAD_HOOK)})),t.updateStatusAndEmit(r("MediaUploadSessionStatus").CONFIRMED)},t.cancel=function(t,n){var e=this.$7(t);if(e!==r("MediaUploadClientResult").ACCEPTED)return e;t.progress.cancelReason=n,t.updateStatusAndEmit(r("MediaUploadSessionStatus").CANCELED);for(var o of t.assetsByID.values())this.$2.removeAsset(o);return r("MediaUploadClientResult").ACCEPTED},t.removeAsset=function(t,n){var e=this.$7(t);if(e!==r("MediaUploadClientResult").ACCEPTED)return e;var o=t.assetsByID.get(n);return o==null?r("MediaUploadClientResult").ASSET_NOT_FOUND:(this.$2.removeAsset(o),this.$4(t),r("MediaUploadClientResult").ACCEPTED)},t.uploadAsset=function(t,n){var e=this.$7(t);if(e!==r("MediaUploadClientResult").ACCEPTED)return e;var o=t.assetsByID.get(n.assetID);if(o!=null&&!o.isRemoved())return r("MediaUploadClientResult").ASSET_ALREADY_EXISTS;var a=this.$1.createAssetContext(t,n);return this.$2.addAsset(a),this.$6(t,a),r("MediaUploadClientResult").ACCEPTED},t.syncAssetUploads=function(t,n){var e=this.$7(t);if(e!==r("MediaUploadClientResult").ACCEPTED)return e;var o=new Set(n.map(function(e){return e.assetID})),a=new Set(t.assetsByID.keys());for(var i in a)if(!o.has(i)){var l=t.assetsByID.get(i);l!=null&&this.$2.removeAsset(l)}return this.uploadAssets(t,n),r("MediaUploadClientResult").ACCEPTED},t.uploadAssets=function(t,n){var e=this,r={};return n.forEach(function(n){return r[n.assetID]=e.uploadAsset(t,n)}),r},t.updateSessionExtras=function(t,n,o){var e=this.$7(t);return e!==r("MediaUploadClientResult").ACCEPTED?e:(n(t.extras),o&&(t.progress.publishingExtrasProvided=!0),r("MediaUploadClientResult").ACCEPTED)},t.retry=function(t){var e=this.$7(t);if(e!==r("MediaUploadClientResult").ACCEPTED)return e;if(!t.isFailed())return r("MediaUploadClientResult").SESSION_NOT_FAILED;t.renewRetryID(),this.$8(t);for(var n of t.assetsByID.values())n.isSchedulable()&&this.$6(t,n);return this.$4(t),r("MediaUploadClientResult").ACCEPTED},t.confirm=function(t){var e=this.$7(t);return e!==r("MediaUploadClientResult").ACCEPTED?e:t.isFailed()?this.retry(t):t.isConfirmed()?(this.$4(t),r("MediaUploadClientResult").ACCEPTED):(this.$8(t),this.$4(t),r("MediaUploadClientResult").ACCEPTED)},e})();l.default=e}),98);
__d("MediaUploadClientContext",["MediaUploadAssetStrategy","MediaUploadRetryState","MediaUploadSessionStrategy"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.sdk=e.sdk,this.emitter=e.emitter,this.executor=e.executor,this.progressCalculator=e.progressCalculator,this.assetStrategy=new(r("MediaUploadAssetStrategy"))({implementation:this,executor:this.executor,params:this.sdk}),this.sessionStrategy=new(r("MediaUploadSessionStrategy"))({implementation:this,assetStrategy:this.assetStrategy,params:this.sdk})}var t=e.prototype;return t.runLocalAssetStategy=function(t){throw this.sdk.createThrowableError("Not implemented")},t.runNetworkAssetStategy=function(t){throw this.sdk.createThrowableError("Not implemented")},t.runClientLazyLoading=function(t){throw this.sdk.createThrowableError("Not implemented")},t.createSessionContext=function(t){throw this.sdk.createThrowableError("Not implemented")},t.createAssetContext=function(t,n){throw this.sdk.createThrowableError("Not implemented")},t.publish=function(t,n){throw this.sdk.createThrowableError("Not implemented")},t.subscribeToHooks=function(){throw this.sdk.createThrowableError("Not implemented")},t.createRetryState=function(){return new(r("MediaUploadRetryState"))(this.sdk.retryPolicyProvider(),this.sdk)},e})();l.default=e}),98);
__d("MediaUploadBytesSummary",["MediaUploadTime"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1=e}var t=e.prototype;return t.reset=function(){this.$2=null},t.updateForUploadStart=function(t){var e=this.$1.currentTimeProvider();this.$2={fullyCompleted:!1,startedAt:e,updatedAt:e,totalBytes:t,uploadedBytes:0,skippedUpload:!1}},t.updateForUploadSkip=function(t){var e=this.$1.currentTimeProvider();this.$2={fullyCompleted:!0,startedAt:e,updatedAt:e,finishedAt:e,totalBytes:t,uploadedBytes:t,skippedUpload:!0}},t.updateForProgress=function(t){var e=this.$2;if(e==null){this.$1.reportRecoverableError("Upload stats have not been initialized");return}e.uploadedBytes=t,e.updatedAt=this.$1.currentTimeProvider()},t.updateForUploadComplete=function(){var e=this.$2;if(e==null){this.$1.reportRecoverableError("Upload stats have not been initialized");return}this.updateForProgress(e.totalBytes),e.fullyCompleted=!0,e.uploadedBytes=e.totalBytes},t.updateForUploadAbandoned=function(){var e=this.$2;if(e==null){this.$1.reportRecoverableError("Upload stats have not been initialized");return}e.finishedAt=this.$1.currentTimeProvider()},t.computeSpeedBps=function(){var e=this.$2;if(e==null||e.skippedUpload)return null;var t=o("MediaUploadTime").timeToSeconds(o("MediaUploadTime").subtractTime(e.updatedAt,e.startedAt));return t>.1?e.uploadedBytes/t:0},t.computeUploadedPortion=function(){var e=this.$2;return e==null?null:e.fullyCompleted?1:e.totalBytes===0?0:1*e.uploadedBytes/e.totalBytes},t.computeSnapshot=function(){var e=this.$2;return e==null?null:{uploadedBytes:e.uploadedBytes,speedBps:this.computeSpeedBps(),skippedUpload:e.skippedUpload,startedAtMs:o("MediaUploadTime").timeToMilliseconds(e.startedAt),finishedAtMs:o("MediaUploadTime").maybeTimeToMilliseconds(e.finishedAt)}},e})();l.default=e}),98);
__d("MediaUploadAssetContext",["MediaUploadAssetEvent","MediaUploadAssetStatus","MediaUploadBytesSummary","MediaUploadOperationOutcome","MediaUploadStageEvent","MediaUploadTime"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){var t=e.sessionContext,n=e.assetRequest,o=e.emitter,a=e.progressCalculator,i=e.retryState,l=e.params;this.sessionContext=t,this.request=n,this.assetID=n.assetID,this.asset=n.asset,this.retryState=i,this.$2=o,this.$3=a,this.$1=l.currentTimeProvider,this.$4=r("MediaUploadAssetStatus").REQUESTED,this.createdAt=this.$1(),this.uploadSummary=new(r("MediaUploadBytesSummary"))(l),this.progress={completedStages:new Set,calculated:{rawValue:0,percentageComplete:0}}}var t=e.prototype;return t.emitAssetEvent=function(t){this.$2.emitAssetEvent(t,this),(t===r("MediaUploadAssetEvent").ASSET_SUCCEED||t===r("MediaUploadAssetEvent").ASSET_REMOVED)&&this.recalculateProgressAndEmit()},t.emitStageEvent=function(t,n){this.$2.emitStageEvent(t,this,n),t===r("MediaUploadStageEvent").STAGE_SUCCEED&&(this.progress.completedStages.add(n),this.recalculateProgressAndEmit()),t===r("MediaUploadStageEvent").STAGE_PROGRESS&&this.recalculateProgressAndEmit()},t.emitStageEventForOperationOutcome=function(t,n){t===r("MediaUploadOperationOutcome").SUCCESS?this.emitStageEvent(r("MediaUploadStageEvent").STAGE_SUCCEED,n):t===r("MediaUploadOperationOutcome").CANCELED?this.emitStageEvent(r("MediaUploadStageEvent").STAGE_CANCELED,n):this.emitStageEvent(r("MediaUploadStageEvent").STAGE_FAILED,n)},t.recalculateProgressAndEmit=function(){var e=this.$3.calculateAssetProgress(this);this.sessionContext.recalculateProgressAndEmit(),e&&this.emitAssetEvent(r("MediaUploadAssetEvent").ASSET_PROGRESS)},t.$5=function(){this.uploadSummary.reset(),this.progress.completedStages.clear(),this.recalculateProgressAndEmit()},t.updateStatusAndEmit=function(t){if(this.$4!==t)switch(this.$4=t,t){case r("MediaUploadAssetStatus").REMOVED:this.emitAssetEvent(r("MediaUploadAssetEvent").ASSET_REMOVED);break;case r("MediaUploadAssetStatus").FAILED:this.emitAssetEvent(r("MediaUploadAssetEvent").ASSET_FAILED);break;case r("MediaUploadAssetStatus").COMPLETED:this.emitAssetEvent(r("MediaUploadAssetEvent").ASSET_SUCCEED);break;case r("MediaUploadAssetStatus").PROCESSING:this.emitAssetEvent(r("MediaUploadAssetEvent").ASSET_STARTED);break;case r("MediaUploadAssetStatus").UPLOADING:this.progress.lastAttemptStartedAt=this.$1();break;case r("MediaUploadAssetStatus").REQUESTED:case r("MediaUploadAssetStatus").SCHEDULED:this.$5();break}},t.isCompleted=function(){return this.$4===r("MediaUploadAssetStatus").COMPLETED},t.isSchedulable=function(){return this.$4===r("MediaUploadAssetStatus").REQUESTED||this.$4===r("MediaUploadAssetStatus").FAILED},t.isRemoved=function(){return this.$4===r("MediaUploadAssetStatus").REMOVED},t.isFailed=function(){return this.$4===r("MediaUploadAssetStatus").FAILED},t.__composeBaseSnapshot=function(){return{asset:this.asset,assetID:this.assetID,status:this.$4,createdAtMs:o("MediaUploadTime").timeToMilliseconds(this.createdAt),lastUploadStartedAtMs:o("MediaUploadTime").maybeTimeToMilliseconds(this.progress.lastAttemptStartedAt),metadata:this.metadata==null?void 0:{width:this.metadata.width,height:this.metadata.height,isSpherical:this.metadata.isSpherical,durationMs:o("MediaUploadTime").maybeTimeToMilliseconds(this.metadata.duration)},retries:{totalRetryAttempts:this.retryState.getRetryAttempts()},uploadSummary:this.uploadSummary.computeSnapshot(),percentageComplete:this.progress.calculated.percentageComplete}},e})();l.default=e}),98);
__d("MediaUploadExtrasStorage",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e){this.$2=new Map,this.$1=e}var t=e.prototype;return t.setFromObject=function(t){for(var e of Object.keys(t))this.set(e,t[e]);return this},t.set=function(t,n){return this.$2.set(t,n),this},t.getNumber=function(t){var e=this.getUnsafe(t);return e==null||typeof e=="number"?e:(this.$1.reportRecoverableError("Requested key "+t+" as number, but it was "+typeof e),null)},t.getString=function(t){var e=this.getUnsafe(t);return e==null||typeof e=="string"?e:(this.$1.reportRecoverableError("Requested key "+t+" as string, but it was "+typeof e),null)},t.getBoolean=function(t){var e=this.getUnsafe(t);return e==null||typeof e=="boolean"?e:(this.$1.reportRecoverableError("Requested key "+t+" as boolean, but it was "+typeof e),null)},t.getUnsafe=function(t){return this.$2.get(t)},t.getClassInstance=function(t,n){var e=this.getUnsafe(t);return e==null||e instanceof n?e:(this.$1.reportRecoverableError("Requested key "+t+" as "+String(n)+", but it was something else"),null)},e})();i.default=e}),66);
__d("MediaUploadFBAssetContext",["ErrorNormalizeUtils","MediaUploadAssetContext","MediaUploadExtrasStorage","MediaUploadStageEvent","MediaUploadTime","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t){var n;return n=e.call(this,t)||this,n.request=t.assetRequest,n.sessionContext=t.sessionContext,n.processing={rawData:new(r("MediaUploadExtrasStorage"))(t.params)},n}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.recordStageOutcome=function(t){var e=t.stage,n=t.outcome,o=t.rawErrorCode,a=t.rawErrorObject,i=t.displayError,l=t.errorAttributes,s=t.networkRequestID,u=a==null?void 0:r("ErrorNormalizeUtils").normalizeError(r("getErrorSafe")(a));this.$MediaUploadFBAssetContext$p_1={stage:e,outcome:n,rawErrorCode:o,errorObject:u,displayError:i,errorAttributes:l,networkRequestID:s}},n.emitStageEvent=function(n,o){n===r("MediaUploadStageEvent").STAGE_STARTED&&(this.$MediaUploadFBAssetContext$p_1=null),e.prototype.emitStageEvent.call(this,n,o)},n.composeSnapshot=function(){var e=this.__composeBaseSnapshot();return babelHelpers.extends({},e,{videoID:this.videoID,request:this.request,uploadServiceDomain:this.processing.uploadServiceDomain,hash:this.processing.pseudoHash==null?null:{hashValue:this.processing.pseudoHash.hashValue,calculationTimeCostMs:o("MediaUploadTime").timeToMilliseconds(this.processing.pseudoHash.calculationTimeCost)},lastAction:this.$MediaUploadFBAssetContext$p_1})},t.castOrThrow=function(n,r){var e=r.createThrowableError;if(n instanceof t)return n;var o;throw e('Provided asset context has incorrect type of "'+((o=n.constructor)==null?void 0:o.name)+'"')},t})(r("MediaUploadAssetContext"));l.default=e}),98);
__d("MediaUploadClientEventContext",[],(function(t,n,r,o,a,i){"use strict";var e=function(t,n){this.startedAt=t.currentTimeProvider(),this.entryPoint=n};i.default=e}),66);
__d("MediaUploadSessionContext",["MediaUploadExtrasStorage","MediaUploadSessionEvent","MediaUploadSessionStatus","MediaUploadTime"],(function(t,n,r,o,a,i,l){"use strict";var e=new Set([r("MediaUploadSessionStatus").COMPLETED,r("MediaUploadSessionStatus").CANCELED,r("MediaUploadSessionStatus").FAILED]),s=(function(){function t(e){var t=e.sessionID,n=e.emitter,o=e.progressCalculator,a=e.params;this.assetsByID=new Map,this.sessionID=t,this.$1=n,this.$2=o,this.extras=new(r("MediaUploadExtrasStorage"))(a),this.$4=a.currentTimeProvider,this.$5=a.randomStringProvider,this.$6=r("MediaUploadSessionStatus").UNCONFIRMED,this.$3={createdAt:this.$4()},this.progress={retryID:this.$5(),publishingExtrasProvided:!1,publishingDone:!1,percentageComplete:0},this.releaseOnFinish=[]}var n=t.prototype;return n.emitSessionEvent=function(t){this.$1.emitSessionEvent(t,this),t===r("MediaUploadSessionEvent").PUBLISH_SUCCEED&&(this.progress.publishingDone=!0,this.recalculateProgressAndEmit()),t===r("MediaUploadSessionEvent").SESSION_FINISHED&&this.$7()},n.renewRetryID=function(){this.progress.retryID=this.$5()},n.updateLastError=function(t){this.__lastError=t},n.recalculateProgressAndEmit=function(){this.$2.calculateSessionProgress(this)&&this.emitSessionEvent(r("MediaUploadSessionEvent").SESSION_PROGRESS)},n.$7=function(){for(;this.releaseOnFinish.length>0;){var e=this.releaseOnFinish.pop();e.cancel()}},n.updateStatusAndEmit=function(n){if(this.$6!==n)switch(this.$6=n,this.progress.terminalStatus==null&&e.has(n)&&(this.progress.terminalStatus=n,this.emitSessionEvent(r("MediaUploadSessionEvent").SESSION_FINISHED)),n){case r("MediaUploadSessionStatus").CONFIRMED:this.progress.terminalStatus=void 0,this.$3.confirmedAt=this.$4(),this.emitSessionEvent(r("MediaUploadSessionEvent").SESSION_CONFIRMED);break;case r("MediaUploadSessionStatus").COMPLETED:this.emitSessionEvent(r("MediaUploadSessionEvent").SESSION_SUCCEED);break;case r("MediaUploadSessionStatus").CANCELED:this.emitSessionEvent(r("MediaUploadSessionEvent").SESSION_CANCELED);break;case r("MediaUploadSessionStatus").FAILED:this.emitSessionEvent(r("MediaUploadSessionEvent").SESSION_FAILED);break;case r("MediaUploadSessionStatus").PUBLISHING:this.emitSessionEvent(r("MediaUploadSessionEvent").PUBLISH_STARTED);break;default:}},n.getActiveAssets=function(){var e=[];for(var t of this.assetsByID.values())t.isRemoved()||e.push(t);return e},n.isCanceled=function(){return this.$6===r("MediaUploadSessionStatus").CANCELED},n.isPublished=function(){return this.$6===r("MediaUploadSessionStatus").COMPLETED},n.isPublishing=function(){return this.$6===r("MediaUploadSessionStatus").PUBLISHING},n.isConfirmed=function(){return this.$6===r("MediaUploadSessionStatus").CONFIRMED},n.isFailed=function(){return this.$6===r("MediaUploadSessionStatus").FAILED},n.__composeBaseSnapshot=function(){return{sessionID:this.sessionID,retryID:this.progress.retryID,status:this.$6,extras:this.extras,timing:{createdAtMs:o("MediaUploadTime").timeToMilliseconds(this.$3.createdAt),confirmedAtMs:o("MediaUploadTime").maybeTimeToMilliseconds(this.$3.confirmedAt)},terminalStatus:this.progress.terminalStatus,percentageComplete:this.progress.percentageComplete,publishingResponse:this.progress.publishingResponse,cancelReason:this.progress.cancelReason}},t})();l.default=s}),98);
__d("MediaUploadFBSessionContext",["ErrorNormalizeUtils","MediaUploadSessionContext","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t){var n;return n=e.call(this,{sessionID:t.sessionID,emitter:t.emitter,progressCalculator:t.progressCalculator,params:t.params})||this,n.entryPoint=t.entryPoint,n}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.composeSnapshot=function(){var e=this.__composeBaseSnapshot();return babelHelpers.extends({},e,{entryPoint:this.entryPoint,lastError:this.__lastError==null?null:{errorObject:this.__lastError.rawErrorObject==null?null:r("ErrorNormalizeUtils").normalizeError(r("getErrorSafe")(this.__lastError.rawErrorObject)),rawErrorCode:this.__lastError.rawErrorCode}})},t.castOrThrow=function(n,r){var e=r.createThrowableError;if(n instanceof t)return n;var o;throw e('Provided session context has incorrect type of "'+((o=n.constructor)==null?void 0:o.name)+'"')},t})(r("MediaUploadSessionContext"));l.default=e}),98);
__d("MediaUploadFBClientEventContext",["ErrorNormalizeUtils","MediaUploadClientEventContext","MediaUploadFBAssetContext","MediaUploadFBSessionContext","MediaUploadTime","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t){var n;return n=e.call(this,t.envParams,t.entryPoint)||this,n.entryPoint=t.entryPoint,t.context!=null&&t.context instanceof r("MediaUploadFBSessionContext")?n.sessionContext=t.context:t.context!=null&&t.context instanceof r("MediaUploadFBAssetContext")&&(n.sessionContext=t.context.sessionContext,n.assetContext=t.context),n}babelHelpers.inheritsLoose(t,e),t.castOrThrow=function(n,r){if(n instanceof t)return n;var e;throw r.createThrowableError('Provided client event context has incorrect type of "'+((e=n.constructor)==null?void 0:e.name)+'"')};var n=t.prototype;return n.composerSnapshot=function(){var e,t,n,a,i=((e=this.errorInfo)==null?void 0:e.rawErrorObject)==null?void 0:r("ErrorNormalizeUtils").normalizeError(r("getErrorSafe")((t=this.errorInfo)==null?void 0:t.rawErrorObject));return{entryPoint:this.entryPoint,startedAtMs:o("MediaUploadTime").timeToMilliseconds(this.startedAt),sessionSnapshot:(n=this.sessionContext)==null?void 0:n.composeSnapshot(),assetSnapshot:(a=this.assetContext)==null?void 0:a.composeSnapshot(),errorObject:i}},t})(r("MediaUploadClientEventContext"));l.default=e}),98);
__d("MediaUploadEventEmitterAdapter",["EventEmitter","MediaUploadFBAssetContext","MediaUploadFBClientEventContext","MediaUploadFBSessionContext","MediaUploadFBStage"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){return t},s=(function(){function t(e){this.$2=new(r("EventEmitter")),this.$1=e,this.emitter=this.$3(),this.subscriber=this.$4()}var n=t.prototype;return n.$3=function(){var t=this,n=function(n){var e=r("MediaUploadFBSessionContext").castOrThrow(n,t.$1);return e.composeSnapshot()},o=function(n){var e=r("MediaUploadFBAssetContext").castOrThrow(n,t.$1);return e.composeSnapshot()},a=this.$2,i=function(r){try{for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];a.emit.apply(a,[e(r)].concat(o))}catch(e){t.$1.reportRecoverableError("Session pub/sub chain failed for event "+String(r),e)}};return{emitClientEvent:function(n,o){i(n,r("MediaUploadFBClientEventContext").castOrThrow(o,t.$1).composerSnapshot())},emitSessionEvent:function(t,r){i(t,n(r))},emitAssetEvent:function(t,r){i(t,n(r.sessionContext),o(r))},emitStageEvent:function(a,l,s){var e=r("MediaUploadFBStage").cast(String(s));if(e==null){t.$1.reportRecoverableError("Invalid stage value, it must be MediaUploadFBStage, ignoring");return}i(a,n(l.sessionContext),o(l),e)}}},n.$4=function(){var t=this,n=function(n,r){try{n()}catch(e){t.$1.reportRecoverableError("Stage pub/sub chain failed for event "+r(),e)}};return{addClientEventListener:function(o,a){var r=t.$2.addListener(e(o),function(e){return n(function(){return a(e)},function(){return String(o)})});return{cancel:function(){return r.remove()}}},addSessionEventListener:function(o,a){var r=t.$2.addListener(e(o),function(e){return n(function(){return a(e)},function(){return String(o)})});return{cancel:function(){return r.remove()}}},addAssetEventListener:function(o,a){var r=t.$2.addListener(e(o),function(e,t){return n(function(){return a(e,t)},function(){return String(o)})});return{cancel:function(){return r.remove()}}},addStageEventListener:function(o,a,i){var r=t.$2.addListener(e(o),function(e,t,r){a===r&&n(function(){return i(e,t)},function(){return String(o)+"  "+String(r)})});return{cancel:function(){return r.remove()}}}}},t})();l.default=s}),98);
__d("MediaUploadExecutor",["Promise"],(function(t,n,r,o,a,i){"use strict";var e,l=(function(){function t(e){e===void 0&&(e=1),this.$1=[],this.$3=0,this.$2=e}var r=t.prototype;return r.schedule=function(r){var t=this;return new(e||(e=n("Promise")))(function(e){var n=function(){var t=r();return t.finally(e),t};t.$1.push(n),t.$4()})},r.$4=function(){var e=this;if(!(this.$3>=this.$2||this.$1.length===0)){var t=this.$1.shift();t().finally(function(){e.$3--,e.$4()}),this.$3++}},t})();i.default=l}),66);
__d("MediaUploadAssetRequest",[],(function(t,n,r,o,a,i){"use strict";var e=function(t){var e=t.assetID,n=t.asset,r=t.extras;this.assetID=e,this.asset=n,this.extras=r};i.default=e}),66);
__d("MediaUploadFBAssetRequest",["MediaUploadAssetRequest"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t){var n,r=t.assetID,o=t.asset,a=t.extras,i=t.attributes;return n=e.call(this,{assetID:r,asset:o,extras:a})||this,n.attributes={targetID:i.targetID,actorID:i.actorID,hasFileBeenReplaced:i.hasFileBeenReplaced,composerDialogVersion:i.composerDialogVersion,publisherActionSource:i.publisherActionSource,creatorProduct:i.creatorProduct,composerSessionID:i.composerSessionID},n}return babelHelpers.inheritsLoose(t,e),t.castOrThrow=function(n,r){var e=r.createThrowableError;if(n instanceof t)return n;var o;throw e('Provided asset request has incorrect type of "'+((o=n.constructor)==null?void 0:o.name)+'"')},t})(r("MediaUploadAssetRequest"));l.default=e}),98);
__d("MediaUploadClient",["MediaUploadClientResult"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$4=new Map,this.$1=e.implementation,this.$2=e.sessionStrategy,this.$3=e.envParams,this.$1.subscribeToHooks(),this.$3.isSupported()||this.$3.reportRecoverableError("This browser does not support this version of the Media Upload SDK")}var t=e.prototype;return t.cancelSession=function(t,n){if(!this.$3.isSupported())return r("MediaUploadClientResult").UNSUPPORTED_BROWSER;var e=this.$4.get(t);return e==null?r("MediaUploadClientResult").SESSION_NOT_FOUND:this.$2.cancel(e,n)},t.cleanSession=function(t){return this.$3.isSupported()?this.$4.delete(t)?r("MediaUploadClientResult").ACCEPTED:r("MediaUploadClientResult").SESSION_NOT_FOUND:r("MediaUploadClientResult").UNSUPPORTED_BROWSER},t.retrySession=function(t){if(!this.$3.isSupported())return r("MediaUploadClientResult").UNSUPPORTED_BROWSER;var e=this.$4.get(t);return e==null?r("MediaUploadClientResult").SESSION_NOT_FOUND:this.$2.retry(e)},t.$5=function(t){var e=this.$4.get(t);return e==null&&(e=this.$1.createSessionContext(t),this.$4.set(t,e)),e},t.updateSessionExtras=function(t,n){if(!this.$3.isSupported())return r("MediaUploadClientResult").UNSUPPORTED_BROWSER;var e=this.$5(t);return this.$2.updateSessionExtras(e,n,!1)},t.confirmSession=function(t,n,o){if(!this.$3.isSupported())return r("MediaUploadClientResult").UNSUPPORTED_BROWSER;var e=this.$5(t),a;return o!=null&&(a=this.$2.updateSessionExtras(e,o,!0),a!==r("MediaUploadClientResult").ACCEPTED)||(a=this.$2.syncAssetUploads(e,n),a!==r("MediaUploadClientResult").ACCEPTED)?a:this.$2.confirm(e)},t.startUploads=function(t,n){if(!this.$3.isSupported()){var e={};return n.forEach(function(t){return e[t.assetID]=r("MediaUploadClientResult").UNSUPPORTED_BROWSER}),e}var o=this.$5(t);return this.$2.uploadAssets(o,n)},t.removeUpload=function(t,n){if(!this.$3.isSupported())return r("MediaUploadClientResult").UNSUPPORTED_BROWSER;var e=this.$4.get(t);return e==null?r("MediaUploadClientResult").SESSION_NOT_FOUND:this.$2.removeAsset(e,n)},e})();l.default=e}),98);
__d("MediaUploadFBClient",["MediaUploadClient"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t){return e.call(this,t)||this}return babelHelpers.inheritsLoose(t,e),t})(r("MediaUploadClient"));l.default=e}),98);
__d("MediaUploadFBDefaultServerConfigurationRetrieverQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="24229633186643574"}),null);
__d("MediaUploadFBDefaultServerConfigurationRetrieverQuery.graphql",["MediaUploadFBDefaultServerConfigurationRetrieverQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"source_type"}],t=[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],r=[{alias:null,args:null,kind:"ScalarField",name:"service_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"service_domain",storageKey:null}],o=[{alias:null,args:null,concreteType:"MediaUploadConfiguration",kind:"LinkedField",name:"media_upload_config",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"source_type",variableName:"source_type"}],concreteType:"MediaUploadVideoMetadataValidation",kind:"LinkedField",name:"video_metadata_validation",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"min_size_kb",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_size_kb",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"min_duration_secs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_duration_secs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"min_width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"min_height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"min_aspect_ration",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_aspect_ration",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"allowed_extensions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"accept_dimensions_from_player",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"MediaUploadNetworkStart",kind:"LinkedField",name:"network_start",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"MediaUploadNetworkReceive",kind:"LinkedField",name:"network_receive",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"MediaUploadNetworkUploadService",kind:"LinkedField",name:"network_upload_service",plural:!1,selections:[{alias:null,args:null,concreteType:"MediaUploadNetworkUploadServiceTarget",kind:"LinkedField",name:"default",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"MediaUploadNetworkUploadServiceTarget",kind:"LinkedField",name:"targeted",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"MediaUploadNetworkUploadServiceTracing",kind:"LinkedField",name:"tracing",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"min_file_size_kb",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"MediaUploadNetworkMonitor",kind:"LinkedField",name:"network_monitor",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"network_probe_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"internet_probe_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"internet_probe_timeout_ms",storageKey:null},{alias:null,args:null,concreteType:"MediaUploadBackoffPolicy",kind:"LinkedField",name:"internet_probe_backoff",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"backoff_initial_ms",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backoff_jitter_ms",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backoff_exp_base_ms",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backoff_exp_multiplier",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backoff_max_ms",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"limits_total_retry_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"limits_total_time_ms",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"stall_detection_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"stall_detection_timeout_ms",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"MediaUploadFBDefaultServerConfigurationRetrieverQuery",selections:o,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"MediaUploadFBDefaultServerConfigurationRetrieverQuery",selections:o},params:{id:n("MediaUploadFBDefaultServerConfigurationRetrieverQuery_facebookRelayOperation"),metadata:{},name:"MediaUploadFBDefaultServerConfigurationRetrieverQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("isOndemandHost",[],(function(t,n,r,o,a,i){"use strict";var e=/(^|\.)(od[0-9]+\.\w{4}|\d{4,}\.od|my-od\.|my-od-[0-9]\.)/;function l(t){return e.test(t)}i.default=l}),66);
__d("MediaUploadFBDefaultServerConfigurationRetriever",["MediaUploadCancelablePromise","MediaUploadClientEvent","MediaUploadFBClientEventContext","MediaUploadFBDefaultServerConfigurationRetrieverQuery.graphql","MediaUploadOperationOutcome","MediaUploadTime","RelayFBEnvironment","RelayHooks","URI","isOndemandHost","justknobx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e!==void 0?e:e=n("MediaUploadFBDefaultServerConfigurationRetrieverQuery.graphql"),c={metadataValidation:{minSizeKB:1,maxSizeKB:10*1024*1024,minDuration:o("MediaUploadTime").secondsToTime(1),maxDuration:o("MediaUploadTime").hoursToTime(24),minWidth:100,minHeight:100,minAspectRatio:.5,maxAspectRatio:4,extensions:new Set(["3g2","3gp","3gpp","asf","avi","dat","divx","dv","f4v","flv","gif","m2ts","m4v","mkv","mod","mov","mp4","mpe","mpeg","mpeg4","mpg","mts","nsv","ogm","ogv","qt","rmvb","tmp","tod","ts","vob","webm","wmv"]),acceptDimensionsFromPlayer:!1},startRequest:{baseURI:new(s||(s=r("URI")))("https://vupload-edge.facebook.com/ajax/video/upload/requests/start/")},startRequestPath:"/ajax/video/upload/requests/start/",receiveRequest:{baseURI:new s("https://vupload-edge.facebook.com/ajax/video/upload/requests/receive/")},receiveRequestPath:"/ajax/video/upload/requests/receive/",uploadService:{defaultService:{serviceName:"rupload",serviceDomain:"facebook.com",serviceConsumer:"fb_video"},targetedService:null,tracing:{enabled:!1,minFileSizeKB:102400},oculusCreatorStudio:"meta_quest_media_studio"},networkMonitor:{networkProbe:{enabled:!0},internetProbe:{enabled:!1,timeout:o("MediaUploadTime").secondsToTime(2),backoffPolicy:{backoff:{initial:o("MediaUploadTime").secondsToTime(10),jitter:o("MediaUploadTime").secondsToTime(0),expBase:o("MediaUploadTime").secondsToTime(1),expMultiplier:2,max:o("MediaUploadTime").secondsToTime(60)},limits:{}}},stallDetector:{enabled:!1,timeout:o("MediaUploadTime").secondsToTime(30)}}},d=(function(){function e(e){this.$5=!0,this.$1=e.entryPoint,this.$3=e.emitter,this.$2=e.setters,this.$4=e.envParams}var t=e.prototype;return t.$6=function(){return o("RelayHooks").fetchQuery(r("RelayFBEnvironment"),u,{source_type:this.$1.sourceType})},t.run=function(t){var e=this,n=new(r("MediaUploadFBClientEventContext"))({entryPoint:this.$1,envParams:this.$4,context:t});return this.$5?(this.$3.emitClientEvent(r("MediaUploadClientEvent").CLIENT_CONFIG_REQUESTED,n),new(r("MediaUploadCancelablePromise"))(function(t){try{var o=e.$6().subscribe({error:(function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t})(function(o){e.$4.reportRecoverableError("Error getting client configuration",o),e.$3.emitClientEvent(r("MediaUploadClientEvent").CLIENT_CONFIG_FAILED,n),e.$7(null),t(r("MediaUploadOperationOutcome").SUCCESS)}),next:function(a){e.$3.emitClientEvent(r("MediaUploadClientEvent").CLIENT_CONFIG_RECEIVED,n),e.$7(a),e.$5=!1,t(r("MediaUploadOperationOutcome").SUCCESS)}});return{cancel:function(){o.unsubscribe()}}}catch(o){e.$4.reportRecoverableError("Error requesting client configuration",o),e.$7(null),e.$3.emitClientEvent(r("MediaUploadClientEvent").CLIENT_CONFIG_FAILED,n),t(r("MediaUploadOperationOutcome").SUCCESS)}})):(this.$3.emitClientEvent(r("MediaUploadClientEvent").CLIENT_CONFIG_CACHED,n),r("MediaUploadCancelablePromise").resolve(r("MediaUploadOperationOutcome").SUCCESS))},t.$8=function(t){var e,n,r,o,a,i,l;if((t==null||(e=t.default)==null?void 0:e.service_name)==null||(t==null||(n=t.default)==null?void 0:n.service_domain)==null)this.$4.reportRecoverableError("Invalid configuration for default endpoint of the Upload Service, falling back to default"),l=c.uploadService.defaultService;else{var s,u;l={serviceName:t==null||(s=t.default)==null?void 0:s.service_name,serviceDomain:t==null||(u=t.default)==null?void 0:u.service_domain,serviceConsumer:c.uploadService.defaultService.serviceConsumer}}var d;if((t==null||(r=t.targeted)==null?void 0:r.service_name)!=null&&(t==null||(o=t.targeted)==null?void 0:o.service_domain)!=null){var m,p;d={serviceName:t==null||(m=t.targeted)==null?void 0:m.service_name,serviceDomain:t==null||(p=t.targeted)==null?void 0:p.service_domain}}else(t==null?void 0:t.targeted)==null?d=null:(this.$4.reportRecoverableError("Invalid configuration for target endpoint of the Upload Service, falling back to default"),d=c.uploadService.targetedService);var _;if((t==null||(a=t.tracing)==null?void 0:a.enabled)!=null&&(t==null||(i=t.tracing)==null?void 0:i.min_file_size_kb)!=null){var f,g;_={enabled:t==null||(f=t.tracing)==null?void 0:f.enabled,minFileSizeKB:t==null||(g=t.tracing)==null?void 0:g.min_file_size_kb}}else this.$4.reportRecoverableError("Invalid configuration for tracing in the Upload Service, falling back to default"),_=c.uploadService.tracing;var h=!1;this.$1.sourceType==="vr_creator_studio"&&(h=!0,l.serviceConsumer=c.uploadService.oculusCreatorStudio),this.$2.uploadService({defaultService:l,targetedService:d,tracing:_,includeAccessToken:h})},t.$9=function(t){var e;if((t==null?void 0:t.min_size_kb)==null||(t==null?void 0:t.max_size_kb)==null||(t==null?void 0:t.min_width)==null||(t==null?void 0:t.min_height)==null||(t==null?void 0:t.min_duration_secs)==null||(t==null?void 0:t.max_duration_secs)==null||(t==null?void 0:t.min_aspect_ration)==null||(t==null?void 0:t.max_aspect_ration)==null||(t==null?void 0:t.allowed_extensions)==null||(t==null?void 0:t.accept_dimensions_from_player)==null)this.$4.reportRecoverableError("Invalid metadata validation, falling back to default"),e=babelHelpers.extends({sourceType:this.$1.sourceType},c.metadataValidation),this.$1.sourceType==="vr_creator_studio"&&(e.maxSizeKB=100*1024*1024);else{var n=t==null?void 0:t.max_duration_secs;e={sourceType:this.$1.sourceType,minSizeKB:t==null?void 0:t.min_size_kb,maxSizeKB:t==null?void 0:t.max_size_kb,minWidth:t==null?void 0:t.min_width,minHeight:t==null?void 0:t.min_height,minAspectRatio:t==null?void 0:t.min_aspect_ration,maxAspectRatio:t==null?void 0:t.max_aspect_ration,extensions:new Set(t==null?void 0:t.allowed_extensions),acceptDimensionsFromPlayer:t==null?void 0:t.accept_dimensions_from_player,minDuration:o("MediaUploadTime").secondsToTime(t==null?void 0:t.min_duration_secs),maxDuration:o("MediaUploadTime").secondsToTime(n)}}this.$2.metadataValidation(e)},t.$10=function(t){return(t==null?void 0:t.backoff_initial_ms)==null?null:{backoff:{initial:o("MediaUploadTime").millisecondsToTime(t==null?void 0:t.backoff_initial_ms),jitter:(t==null?void 0:t.backoff_jitter_ms)==null?null:o("MediaUploadTime").millisecondsToTime(t==null?void 0:t.backoff_jitter_ms),expBase:(t==null?void 0:t.backoff_exp_base_ms)==null?null:o("MediaUploadTime").millisecondsToTime(t==null?void 0:t.backoff_exp_base_ms),expMultiplier:t==null?void 0:t.backoff_exp_multiplier,max:(t==null?void 0:t.backoff_max_ms)==null?null:o("MediaUploadTime").millisecondsToTime(t==null?void 0:t.backoff_max_ms)},limits:{totalRetryCount:t==null?void 0:t.limits_total_retry_count,totalTime:(t==null?void 0:t.limits_total_time_ms)==null?null:o("MediaUploadTime").millisecondsToTime(t==null?void 0:t.limits_total_time_ms)}}},t.$11=function(t){var e,n=this.$10(t==null?void 0:t.internet_probe_backoff);if((t==null?void 0:t.network_probe_enabled)==null||(t==null?void 0:t.internet_probe_enabled)==null||(t==null?void 0:t.internet_probe_timeout_ms)==null||n==null||(t==null?void 0:t.stall_detection_enabled)==null||(t==null?void 0:t.stall_detection_timeout_ms)==null)this.$4.reportRecoverableError("Invalid network monitor configuration, falling back to default"),e=c.networkMonitor;else{var r=t.network_probe_enabled,a=t.internet_probe_enabled,i=t.internet_probe_timeout_ms,l=t.stall_detection_enabled,s=t.stall_detection_timeout_ms;e={networkProbe:{enabled:r},internetProbe:{enabled:a,timeout:o("MediaUploadTime").millisecondsToTime(i),backoffPolicy:n},stallDetector:{enabled:l,timeout:o("MediaUploadTime").millisecondsToTime(s)}}}this.$2.networkMonitor(e)},t.$12=function(t){var e;if((t==null?void 0:t.uri)==null)this.$4.reportRecoverableError("Invalid metadata validation, falling back to default"),this.$1.sourceType==="vr_creator_studio"?e={baseURI:new(s||(s=r("URI")))("https://"+window.location.hostname+c.startRequestPath)}:e=c.startRequest;else{var n=new(s||(s=r("URI")))(t==null?void 0:t.uri);e={baseURI:n}}this.$2.startRequest(e)},t.$13=function(t){var e;if((t==null?void 0:t.uri)==null)this.$4.reportRecoverableError("Invalid metadata validation, falling back to default"),this.$1.sourceType==="vr_creator_studio"?e={baseURI:new(s||(s=r("URI")))("https://"+window.location.hostname+c.receiveRequestPath)}:e=c.receiveRequest;else{var n=new(s||(s=r("URI")))(t==null?void 0:t.uri);e={baseURI:n}}this.$2.receiveRequest(e)},t.$7=function(t){var e,n,r,o,a;this.$12(t==null||(e=t.media_upload_config)==null?void 0:e.network_start),this.$13(t==null||(n=t.media_upload_config)==null?void 0:n.network_receive),this.$8(t==null||(r=t.media_upload_config)==null?void 0:r.network_upload_service),this.$9(t==null||(o=t.media_upload_config)==null?void 0:o.video_metadata_validation),this.$11(t==null||(a=t.media_upload_config)==null?void 0:a.network_monitor)},e})();function m(e){return e}l.default=d}),98);
__d("MediaUploadFBStageOutcome",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["SUCCESS","CANCEL","EXCEPTION","INTERNAL_FAILURE","UNSUPPORTED_FEATURE","ASSET_IS_NOT_FILE","ASSET_IS_NOT_SUPPORTED","REQUEST_ERROR","INVALID_SERVER_RESPONSE","MISSING_MANDATORY_DATA"]),l=e;i.default=l}),66);
__d("MediaUploadFBFileHasher",["MediaUploadFBStage","MediaUploadFBStageOutcome","MediaUploadOperationOutcome","MediaUploadStageEvent"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1=r("MediaUploadFBStage").HASHING,this.$2=e.pseudoHasher,this.$3=e.fullHasher}var t=e.prototype;return t.process=async function(t){t.emitStageEvent(r("MediaUploadStageEvent").STAGE_STARTED,this.$1);try{await this.$4(t)}catch(e){t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").EXCEPTION,rawErrorObject:e})}return t.emitStageEvent(r("MediaUploadStageEvent").STAGE_SUCCEED,this.$1),r("MediaUploadOperationOutcome").SUCCESS},t.$5=function(t,n,r){return n==null?Promise.resolve():n.hash(t.file).then(function(e){return e.outcome==="SUCCESS"&&r(e.value),e})},t.$4=async function(t){var e=this,n=t.asset.dataAsFile();if(n==null){t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").MISSING_MANDATORY_DATA});return}var o=await this.$5(n,this.$3,function(e){return t.processing.fullHash=e}).then(async function(r){return(r==null?void 0:r.outcome)==="SUCCESS"?(t.processing.pseudoHash=t.processing.fullHash,[r,r]):[r,await e.$5(n,e.$2,function(e){return t.processing.pseudoHash=e})]});for(var a of o)if((a==null?void 0:a.outcome)==="FILE_TOO_LARGE"){t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").ASSET_IS_NOT_SUPPORTED});return}else if((a==null?void 0:a.outcome)==="FAILURE"){t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").INTERNAL_FAILURE,rawErrorCode:a==null?void 0:a.rawErrorCode,rawErrorObject:a==null?void 0:a.rawErrorObject});return}t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").SUCCESS})},e})();l.default=e}),98);
__d("MediaUploadNetworkStatus",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({UNKNOWN:"Unknown",CONNECTED:"Connected",DISCONNECTED:"Disconnected",TIMEOUT:"TimedOut"}),l=e;i.default=l}),66);
__d("MediaUploadFBInternetProbe",["AsyncRequest","MediaUploadCancelablePromise","MediaUploadNetworkStatus","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e="https://rupload.facebook.com/fb_video/ping-",s=(function(){function t(t,n){this.$2=t,this.$1=n,this.$3=[""+e+r("uuidv4")()]}var n=t.prototype;return n.$4=function(t){return new(r("MediaUploadCancelablePromise"))(function(e){var n=new(r("AsyncRequest"))().setAllowCrossOrigin(!0).setAllowCredentials(!0).setMethod("GET").setURI(t).setReadOnly(!0).setOption("suppressEvaluation",!0).setHandler(function(t){var n,o=t==null||(n=t.payload)==null?void 0:n.status;e(o===200?r("MediaUploadNetworkStatus").CONNECTED:r("MediaUploadNetworkStatus").DISCONNECTED)}).setTransportErrorHandler(function(){e(r("MediaUploadNetworkStatus").DISCONNECTED)}).setErrorHandler(function(){e(r("MediaUploadNetworkStatus").DISCONNECTED)});return n.send()||e(r("MediaUploadNetworkStatus").DISCONNECTED),{cancel:function(){n.abort()}}})},n.$5=function(){var e=this;return new Promise(function(t){e.$1.delayedExecutor(e.$2.timeout,function(){return t(r("MediaUploadNetworkStatus").TIMEOUT)})})},n.probe=async function(){var e=this,t=this.$3.map(function(t){return e.$4(t)}),n=Promise.race([this.$5()].concat(t.map(function(e){return e.promise}))),r=await n;return t.forEach(function(e){return e.cancel()}),r},t})();l.default=s}),98);
__d("MediaUploadFBLocalAssetStrategy",["MediaUploadPipeline"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1=e.envParams,this.metadataParser=e.metadataParser,this.metadataValidator=e.metadataValidator,this.fileHasher=e.fileHasher}var t=e.prototype;return t.run=function(t){var e=this,n=new(r("MediaUploadPipeline"))(this.$1);n.addPlainStep(function(){return e.metadataParser.parse(t)}),n.addPlainStep(function(){return e.metadataValidator.validate(t,e.metadataParser.retriveRawMetadata(t))});var o=this.fileHasher;return o!=null&&n.addPlainStep(function(){return o.process(t)}),n.run()},e})();l.default=e}),98);
__d("ISOVideoBoxConstants",[],(function(t,n,r,o,a,i){"use strict";var e=8,l=[255,204,130,99,248,85,74,147,136,20,88,122,2,82,31,221],s=[174,36,178,77,60,143,79,24,138,123,224,9,193,56,53,193];i.BOX_BASE_SIZE=e,i.GSPHERICAL_UUID=l,i.FBSPHERICAL_UUID=s}),66);
__d("FBSphericalMetadataTags",[],(function(t,n,r,o,a,i){var e=Object.freeze({SPHERICAL:"FBSpherical:Spherical",INITIAL_VERTICAL_FOV_DEGREES:"FBSpherical:InitialVerticalFOVDegrees",GUIDE:"FBSpherical:Guide",HOTSPOT:"FBSpherical:HotspotMetadata",USED_360_DIRECTOR:"FBSpherical:Used360Director"});i.default=e}),66);
__d("GSphericalMetadataTags",[],(function(t,n,r,o,a,i){var e=Object.freeze({SPHERICAL:"GSpherical:Spherical",INITIAL_VIEW_HEADING_DEGREES:"GSpherical:InitialViewHeadingDegrees",INITIAL_VIEW_PITCH_DEGREES:"GSpherical:InitialViewPitchDegrees",PROJECTION_TYPE:"GSpherical:ProjectionType",STEREO_MODE:"GSpherical:StereoMode",STITCHED:"GSpherical:Stitched",STITCHING_SOFTWARE:"GSpherical:StitchingSoftware",CROPPED_AREA_IMAGE_WIDTH_PIXELS:"GSphercal:CroppedAreaImageWidthPixels",CROPPED_AREA_IMAGE_HEIGHT_PIXELS:"GSphercal:CroppedAreaImageHeightPixels",CROPPED_AREA_LEFT_PIXELS:"GSphercal:CroppedAreaLeftPixels",CROPPED_AREA_TOP_PIXELS:"GSphercal:CroppedAreaTopPixels",FULL_PANO_WIDTH_PIXELS:"GSphercal:FullPanoWidthPixels",FULL_PANO_HEIGHT_PIXELS:"GSphercal:FullPanoHeightPixels"});i.default=e}),66);
__d("SphericalVideoMetadataTags",["FBSphericalMetadataTags","GSphericalMetadataTags"],(function(t,n,r,o,a,i,l){"use strict";var e=Object.freeze({GSPHERICAL:r("GSphericalMetadataTags"),FBSPHERICAL:r("FBSphericalMetadataTags")});l.default=e}),98);
__d("VideoSphericalMetadataUtil",["SphericalVideoMetadataTags","VideoProjection","VideoStereoFormat"],(function(t,n,r,o,a,i,l){"use strict";function e(e){if(!e)return null;e=e.replace(/\0/g,"");var t;if(window.DOMParser){var n=new DOMParser;t=n.parseFromString(e,"text/xml")}else t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e);return t}function s(e){return Object.values(r("VideoProjection")).includes(e)?e:null}function u(e){return Object.values(r("VideoStereoFormat")).includes(e)?e:null}function c(e){for(var t=e.getElementsByTagNameNS("*","*"),n=null,o=0;o<t.length;o++){var a=t[o],i=a.nodeName,l=a.parentElement;if(i!=="parsererror"&&l&&l.nodeName!=="parsererror"&&Object.values(r("SphericalVideoMetadataTags").GSPHERICAL).indexOf(i)<0&&Object.values(r("SphericalVideoMetadataTags").GSPHERICAL).indexOf(l.nodeName)<0){n||(n="");var s=a.outerHTML;n+="<"+i+s.slice(i.length+1,-(i.length+1))+i+">"}}return n}function d(e,t,n,r,o){if(t!==null&&n!==null&&r!==null&&o!==null&&e.projectionType==="equirectangular"&&(e.stereoMode==="left-right"||e.stereoMode==="top-bottom")){var a=parseInt(t,10),i=parseInt(n,10),l=parseInt(r,10),s=parseInt(o,10);if(Math.abs(a-l/2)<=1&&Math.abs(i-s)<=1)return!0}return!1}function m(e,t,n){return new File([e],t,{type:n})}function p(e){for(var t=new ArrayBuffer(e.length),n=new DataView(t),r=0;r<e.length;r++)n.setUint8(r,e.charCodeAt(r));return t}function _(e,t,n){var r=e.buffer;return m(r,t,n)}function f(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}l.parseXMLToDocument=e,l.stringToProjectionType=s,l.stringToStereoMode=u,l.getUnsupportedGSphericalTagsXML=c,l.isGoogleVR180=d,l.arrayBufferToFile=m,l.stringToArrayBuffer=p,l.bufferToFile=_,l.uuidArrayEquals=f}),98);
__d("VideoUploadMetadataParserErrorCode",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["FILE_READING_NOT_SUPPORTED","UNKNOWN_FILE_EXTENSION","INTERNAL_FAILURE"]),l=e;i.default=l}),66);
__d("checkForSphericalTag",["VideoSphericalMetadataUtil"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=o("VideoSphericalMetadataUtil").parseXMLToDocument(e);if(!t)return!1;var n=t.getElementsByTagNameNS("*","Spherical");if(n.length===0)return!1;var r=n[0],a=r.childNodes[0].nodeValue;return a.toLowerCase()==="true"}l.default=e}),98);
__d("getVideo64BitAtomLength",["Int64"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n,o){var a=e.getUint32(t+o+n),i=e.getUint32(t+n+o+o);return new(r("Int64"))(i,a).toNumber()}l.default=e}),98);
__d("VideoUploadMetadataParser",["Bootloader","ErrorNormalizeUtils","ISOVideoBoxConstants","VideoSphericalMetadataUtil","VideoUploadFeatureDetector","VideoUploadMetadataParserErrorCode","checkForSphericalTag","err","fileSlice","getErrorSafe","getVideo64BitAtomLength","gkx","nullthrows","promiseDone"],(function(t,n,r,o,a,i,l){var e=4,s=4,u=r("gkx")("26232")?20482048:5242880,c=24,d=88,m=20,p=16,_=4,f=84,g=20,h=62,y=4,C=12,b=12,v=16,S=16,R={0:36,1:52,2:72},L=1,E=1,k=4,I=1,T=1,D=4,x=4,$=16,P=32,N=34,M=(function(){function t(e,t,n,r){this.$1=e,this.$2=t==null?function(){}:t,this.$4=n,this.$5=!0,this.$3=r}var n=t.prototype;return n.getHandler=function(){return this.$2},n.$6=function(t){this.$2(t),this.$3!=null&&this.$3({success:!0,metadata:t})},n.$7=function(t,n){if(this.$2(null),this.$3!=null){var e=n==null?void 0:r("ErrorNormalizeUtils").normalizeError(r("getErrorSafe")(n));this.$3({success:!1,errorCode:t,errorObject:e})}},n.parse=function(){if(!o("VideoUploadFeatureDetector").supportsFileReading())return this.$7(r("VideoUploadMetadataParserErrorCode").FILE_READING_NOT_SUPPORTED),null;switch(this.$1.getExtension()){case"mp4":case"mov":case"m4v":case"3gp":case"3g2":break;case"mkv":if(r("gkx")("26231"))break;default:return this.$7(r("VideoUploadMetadataParserErrorCode").UNKNOWN_FILE_EXTENSION),null}return this.$8()},n.$8=async function(){var e=this,t=this.$9(),n=this.$10(this.$1.getFile(),1e4);return new Promise(function(o,a){try{r("promiseDone")(Promise.all([t,n]).then(function(t){var n=t[0];if(n.completed){var r=t[1];n.videoPlayerData=r,e.$6(n)}o(n)},function(t){e.$7(r("VideoUploadMetadataParserErrorCode").INTERNAL_FAILURE,t),a(t)}))}catch(t){e.$7(r("VideoUploadMetadataParserErrorCode").INTERNAL_FAILURE,t),a(t)}})},n.$9=async function(){var e=this,t;switch(this.$1.getExtension()){case"mp4":case"mov":case"m4v":case"3gp":case"3g2":t=this.$11(0,Math.min(u,this.$1.getSize()||0),null);break;case"mkv":await new Promise(function(n,o){r("Bootloader").loadModules(["VideoUploadMetadataMKVParser"],function(r){var o=new r(e.$1);t=o.parse(),n()},"VideoUploadMetadataParser")});break;default:throw new Error("Unrecognized file extension in _parseImpl")}return r("nullthrows")(t)},n.$11=function(t,n,o){var e=this,a=new FileReader;return new Promise(function(i,l){a.onload=async function(r){try{if(!(a.result instanceof ArrayBuffer))throw new Error("reader.result is something other than ArrayBuffer");var s=e.$12(new DataView(a.result),0,n-t,t,o);if(s.completed){var c=e.$13(s);c.completed=!0,i(c)}else{var d=await e.$11(t+s.nextOffset,Math.min(e.$1.getSize()||0,t+s.nextOffset+u),s);i(d)}}catch(e){l(e)}};var s=e.$1.getFile();a.readAsArrayBuffer(r("fileSlice").call(s,t,n))})},n.$10=function(t,n){return!this.$4||!window.URL||!window.URL.createObjectURL||!t?null:new Promise(function(e,r){if(!t.type.startsWith("video/")){r("Incorrect file type, expected video");return}var o=document.createElement("video"),a=window.setTimeout(function(){i(),r("Video onloadedmetadata timed out")},n);function i(){URL.revokeObjectURL(o.src),window.clearTimeout(a),o.remove()}o.onloadedmetadata=function(){if(o.videoWidth===0||o.videoHeight===0){i(),r("Video onloadedmetadata corrupt metadata");return}var t={width:o.videoWidth,height:o.videoHeight};i(),e(t)},o.onerror=function(){var e;i(),r("Video error: "+(((e=o.error)==null?void 0:e.message)||"Unknown error"))},o.src=URL.createObjectURL(t)})},n.$14=function(t,n,r){for(var e=[],o=0;o<r;o++)e.push(String.fromCharCode(t.getUint8(n+o)));return e.join("")},n.$15=function(t,n,r){var e={version:null,ambisonic_type:null,ambisonic_order:null,ambisonic_channel_ordering:null,ambisonic_normalization:null,num_channels:null,channel_map:[]},o=0;e.version=t.getUint8(n+o),o=L,e.ambisonic_type=t.getUint8(n+o),o+=E,e.ambisonic_order=t.getUint32(n+o),o+=k,e.ambisonic_channel_ordering=t.getUint8(n+o),o+=I,e.ambisonic_normalization=t.getUint8(n+o),o+=T,e.num_channels=t.getUint32(n+o),o+=D;for(var a=0;a<e.num_channels;a++)if(e.channel_map.push(t.getUint32(n+o)),o+=x,o>r)return null;return JSON.stringify(e)},n.$16=function(n,a,i,l){try{var t=s+e,u=o("ISOVideoBoxConstants").GSPHERICAL_UUID.length;if(t+u<i){for(var c=[],d=0;d<u;d++)c.push(n.getUint8(a+t+d));var m=o("VideoSphericalMetadataUtil").uuidArrayEquals(c,o("ISOVideoBoxConstants").GSPHERICAL_UUID),p=o("VideoSphericalMetadataUtil").uuidArrayEquals(c,o("ISOVideoBoxConstants").FBSPHERICAL_UUID);if(t+=u,m||p){var _=this.$14(n,a+t,i-t);r("checkForSphericalTag")(_)&&(l.sphericalMetadata.spherical=!0,p?l.sphericalMetadata.FBSphericalMetadataXML=_:l.sphericalMetadata.sphericalMetadataXml=_)}}}catch(e){}},n.$12=function(n,o,a,i,l){for(var t=l||{widths:[],heights:[],streamTypes:[],streamDurations:[],spherical:!1,sphericalMetadata:{sphericalMetadataXml:null,FBSphericalMetadataXML:null,fbSpatialAudioMetadataXml:null,ytSa3dMetadataJson:null},isParsingInMediaInformationAtom:!1,endOfMediaInformationAtomOffset:null,streamSampleCounts:[],samples:[]},u=null;o<a;){var L=n.getUint32(o),E=this.$14(n,o+e,s);if(L===1&&(L=r("getVideo64BitAtomLength")(n,o,s,e)),o+L>a)return t.completed=!1,t.nextOffset=o,L>a&&(t.nextOffset+=L),t;if(t.isParsingInMediaInformationAtom&&o>=Number(t.endOfMediaInformationAtomOffset)&&(t.isParsingInMediaInformationAtom=!1,t.endOfMediaInformationAtomOffset=null),o+i===0&&E!=="ftyp")throw new Error("No ftyp atom");if(L===0)throw new Error("len is 0");var k=function(){var e=n.getUint32(o+m),t=n.getUint32(o+c);if(e===0)throw r("err")("mvhd timescale is 0");return t/e};switch(E){case"moov":case"trak":case"mdia":case"stbl":o+=e+s;break;case"mvhd":t.duration=k(),o+=L;break;case"tkhd":var I=n.getUint16(o+f),T=n.getUint16(o+d);t.widths.push(I),t.heights.push(T),t.samples.push({descriptions:[]}),u=n.getUint32(o+g),o+=L;break;case"hdlr":if(!t.isParsingInMediaInformationAtom){var D=this.$14(n,o+p,_);switch(D){case"vide":D="video";break;case"soun":D="audio";break;case"subt":D="subtitle";break;default:D="data"}t.streamTypes.push(D)}o+=L;break;case"mdhd":t.streamDurations.push(k()),o+=L;break;case"uuid":this.$16(n,o,L,t),o+=L;break;case"meta":var x=b+C+y,M=this.$14(n,o+x,4);if(M!=="face"){o+=L;break}var w=e+s+h,A=this.$14(n,o+w,L-w);A!==null&&(t.sphericalMetadata.fbSpatialAudioMetadataXml==null&&(t.sphericalMetadata.fbSpatialAudioMetadataXml="<fb360_spatial_audio>"),u?t.sphericalMetadata.fbSpatialAudioMetadataXml+=`
                <track id="`+u.toString()+`">
                  `+A+`
                </track>
              `:t.sphericalMetadata.fbSpatialAudioMetadataXml+=`
                <spatial_audio_formatting>
                  `+A+`
                </spatial_audio_formatting>
              `),o+=L;break;case"minf":var F=this.$14(n,o+2*e+s,s);F==="smhd"||F==="vmhd"?(o+=e+s,t.isParsingInMediaInformationAtom=!0,t.endOfMediaInformationAtomOffset=o+L):(t.streamSampleCounts.push(null),o+=L);break;case"stsd":o+=v;break;case"avc1":if(this.$5&&t.samples.length>0){var O=t.samples[t.samples.length-1];O.descriptions.push({width:n.getUint16(o+P),height:n.getUint16(o+N)})}o+=L;break;case"mp4a":case"sowt":case"raw ":case"twos":case"fl32":case"fl64":case"in24":case"in32":case"ulaw":case"alaw":case"lpcm":case"Opus":var B=n.getUint16(o+S).toString();Object.prototype.hasOwnProperty.call(R,B)?o+=R[B]:o+=L;break;case"SA3D":var W=this.$15(n,o+e+s,L);W!==null&&t.sphericalMetadata.ytSa3dMetadataJson===null&&(t.sphericalMetadata.ytSa3dMetadataJson=W),o+=L;break;case"stsz":case"stz2":t.streamSampleCounts.push(n.getUint32(o+$)),o+=L;break;default:o+=L}}return t.completed=!0,t.sphericalMetadata.fbSpatialAudioMetadataXml&&(t.sphericalMetadata.fbSpatialAudioMetadataXml+="</fb360_spatial_audio>"),t},n.$13=function(t){var e={streams:{numAudioTracks:0},format:{},metadata:{}},n=t.widths.length,r=t.heights.length,o=t.streamTypes.length,a=t.streamDurations.length,i=t.streamSampleCounts.length,l=t.samples.length;if(n!==r||n!==o||n!==a||n!==i||n!==l)throw new Error("Number of parsed widths, heights, durations or sample counts for video file are mismatched.");for(var s=0;s<n;s++){var u={width:t.widths[s],height:t.heights[s],duration:t.streamDurations[s],type:t.streamTypes[s],sampleCount:t.streamSampleCounts[s]};if(u.type==="video"){this.$5&&t.samples[s].descriptions.forEach(function(e){e.width>u.width&&e.height>u.height&&(u.width=e.width,u.height=e.height)});var c=u.width*u.height,d=e.streams.primaryVideo;(!d||d.width*d.height>c)&&(e.streams.primaryVideo=u)}else if(u.type==="audio"){var m=e.streams.primaryAudio;(!m||m.duration<u.duration)&&(e.streams.primaryAudio=u),e.streams.numAudioTracks++}}return e.format.duration=t.duration,e.format.isSpherical=t.sphericalMetadata.spherical,t.sphericalMetadata.spherical&&(e.metadata.sphericalMetadataXml=t.sphericalMetadata.sphericalMetadataXml,e.metadata.FBSphericalMetadataXML=t.sphericalMetadata.FBSphericalMetadataXML,e.metadata.fbSpatialAudioMetadataXml=t.sphericalMetadata.fbSpatialAudioMetadataXml,e.metadata.ytSa3dMetadataJson=t.sphericalMetadata.ytSa3dMetadataJson),e},t})();l.default=M}),98);
__d("MediaUploadFBMetadataParser",["MediaUploadFBStage","MediaUploadFBStageOutcome","MediaUploadOperationOutcome","MediaUploadStageEvent","MediaUploadTime","VideoUploadFile","VideoUploadMetadataParser"],(function(t,n,r,o,a,i,l){"use strict";var e="MediaUploadMetadataParser",s=(function(){function t(){this.$1=r("MediaUploadFBStage").METADATA_EXTRACTION}var n=t.prototype;return n.parse=async function(t){t.emitStageEvent(r("MediaUploadStageEvent").STAGE_STARTED,this.$1);try{await this.$2(t)}catch(e){t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").EXCEPTION,rawErrorObject:e})}return t.emitStageEvent(r("MediaUploadStageEvent").STAGE_SUCCEED,this.$1),r("MediaUploadOperationOutcome").SUCCESS},n.retriveRawMetadata=function(n){return n.processing.rawData.getUnsafe(e)},n.$2=function(t){var e=this,n=t.asset,o=n.dataAsFile();if(o==null)return t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").ASSET_IS_NOT_FILE}),Promise.resolve();var a=new(r("VideoUploadFile"))(null,o.file,o.size,o.extension);return new Promise(function(n){var o=new(r("VideoUploadMetadataParser"))(a,null,!1,function(o){o.success?e.$3(t,o.metadata):o.errorObject!=null?t.recordStageOutcome({stage:e.$1,outcome:r("MediaUploadFBStageOutcome").EXCEPTION,rawErrorCode:String(o.errorCode),rawErrorObject:o.errorObject}):t.recordStageOutcome({stage:e.$1,outcome:r("MediaUploadFBStageOutcome").INTERNAL_FAILURE,rawErrorCode:String(o.errorCode)}),n()});o.parse()})},n.$3=function(n,r){var t,a,i,l,s,u;n.processing.rawData.set(e,r);var c=(t=r.format)==null?void 0:t.duration,d=c==null?void 0:o("MediaUploadTime").secondsToTime(c),m=(a=r.streams)==null||(a=a.primaryVideo)==null?void 0:a.width,p=(i=r.streams)==null||(i=i.primaryVideo)==null?void 0:i.height;r.videoPlayerData!=null&&((l=r.videoPlayerData)==null?void 0:l.width)>0&&((s=r.videoPlayerData)==null?void 0:s.height)>0&&(m=r.videoPlayerData.width,p=r.videoPlayerData.height);var _=(u=r.format)==null?void 0:u.isSpherical;n.metadata={duration:d,width:m,height:p,isSpherical:_}},t})();l.default=s}),98);
__d("VideoUploadFileValidator",["errorCode","fbt","cr:909496","cr:909497","react","vulture"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=n("react")),c=[1363019,1363020,1363021,1363022,1363023,1363024,1363025,1363026,1363027,1363030,1363031,1363032,1363033,1363038,1363039,1363040,1363048],d=["VIDEO__INVALID_GUIDE_DATA"],m=(function(){"use strict";function e(e){this.$1=e}var t=e.prototype;return t.validate=function(t,n){return this.$2(t)&&this.$3(t)&&this.$4(t.getExtension()==="gif",n)},t.getValidationErrorMessage=function(t,n){return this.$5(t)||this.$6(t)||this.$7(t.getExtension()==="gif",n)},e.canReplaceVideoForError=function(t){return n("vulture")("GXIBEX7SKQtgztutRnjhZ9IvfSk="),t?d.indexOf(t)>-1?!1:c.indexOf(t)>-1:!0},t.$2=function(t){var e=this.$5(t);return e?(n("cr:909496")!==null&&n("cr:909496").show(e.summary,e.description),!1):!0},t.$5=function(t){var e;if(!this.$1.extensions[(e=t.getExtension())==null?void 0:e.toLowerCase()]){var r="http://www.facebook.com/help/218673814818907/",o=u.jsx(n("cr:909497"),{target:"_blank",href:r,children:s._(/*BTDS*/"recommended formats")});return{summary:s._(/*BTDS*/"Unsupported File Format"),description:s._(/*BTDS*/"Sorry, the file you selected is in a format that we don't support. Please use one of our {link} for video files.",[s._param("link",o)])}}},t.$3=function(t){var e=this.$6(t);return e?(n("cr:909496")!==null&&n("cr:909496").show(e.summary,e.description),!1):!0},t.$6=function(t){var e;if(t.getSize()!==null)return t.getSize()<this.$1.minSize&&(e=this.$8()),t.getSize()>this.$1.maxSize&&(e=this.$9()),e},t.$8=function(){var e=Math.round(this.$1.minSize/1024);return{summary:s._(/*BTDS*/"Video File Too Small"),description:s._(/*BTDS*/"The video file you tried to upload is too small. The minimum size for a video file is {min-size} KB. Please try again with a larger file.",[s._param("min-size",e)])}},t.$9=function(){var e=Math.floor(this.$1.maxSize/1024/1024);return{summary:s._(/*BTDS*/"Video File Too Large"),description:s._(/*BTDS*/"The video file you tried to upload is too large. The maximum size for a video file is {max-size} MB. Please try again with a smaller file.",[s._param("max-size",e)])}},t.$4=function(t,r){var e=this.$7(t,r);return e?(n("cr:909496")!==null&&n("cr:909496").show(e.summary,e.description),!1):!0},t.$7=function(t,n){var e;if(n){var r=n.format.duration;if(r&&(r>this.$1.maxLength&&(e=this.$10()),r<this.$1.minLength&&!t&&(e=this.$11())),!(!n.streams||!n.streams.primaryVideo)){var o=n.streams.primaryVideo.width,a=n.streams.primaryVideo.height,i=0,l=0;n.videoPlayerData!==null&&(i=n.videoPlayerData.height,l=n.videoPlayerData.width),this.$1.acceptDimensionsFromPlayer&&l!==0&&i!==0&&(o=l,a=i),!n.streams.primaryVideo&&n.streams.primaryAudio&&(e=this.$12()),o<this.$1.minWidth&&(e=this.$13()),a<this.$1.minHeight&&(e=this.$14());var s=o/a;return this.$1.require16to9AspectRatio&&(s>2||s<1.6)&&(e=this.$15()),this.$1.minAspectRatio&&s<this.$1.minAspectRatio&&(e=this.$16()),this.$1.maxAspectRatio&&s>this.$1.maxAspectRatio&&(e=this.$17()),e}}},t.$10=function(){return this.$1.source==="profile_video"?{summary:s._(/*BTDS*/"Profile Video Duration Too Long"),description:s._(/*BTDS*/"The maximum length is {max-length} seconds. Please upload a shorter video.",[s._param("max-length",this.$1.maxLength)])}:this.$1.source==="event_cover_video"?{summary:s._(/*BTDS*/"Event Cover Video Duration Too Long"),description:s._(/*BTDS*/"Videos can't be longer than {max-length} seconds.",[s._param("max-length",this.$1.maxLength)])}:{summary:s._(/*BTDS*/"Video Duration Too Long"),description:s._(/*BTDS*/"The duration of the video you tried to upload is too long. The maximum duration for a video is {max-length} minutes. Please upload a shorter video.",[s._param("max-length",Math.round(this.$1.maxLength/60))])}},t.$11=function(){return{summary:s._(/*BTDS*/"Video File Too Short"),description:s._(/*BTDS*/"_j{\"second\":\"The duration of the video you tried to upload is too short. The minimum length for a video is {min-length} second. Please upload a longer video.\",\"seconds\":\"The duration of the video you tried to upload is too short. The minimum length for a video is {min-length} seconds. Please upload a longer video.\"}",[s._enum(this.$1.minLength===1?"second":"seconds",{second:"second",seconds:"seconds"}),s._param("min-length",this.$1.minLength)])}},t.$12=function(){n("vulture")("INKG3L69H5R65NZ1WJ71126FvrI=");var e="http://www.facebook.com/help/?faq=218673814818907#What-formats-of-video-files-can-I-upload?",t=u.jsx(n("cr:909497"),{href:e,children:s._(/*BTDS*/"supported video format")});return{summary:s._(/*BTDS*/"No Video Detected"),description:s._(/*BTDS*/"It looks like you're trying to upload a file that isn't a video. Please try uploading a {supported-video-format link}",[s._param("supported-video-format link",t)])}},t.$13=function(){return{summary:s._(/*BTDS*/"Video Width Too Narrow"),description:s._(/*BTDS*/"The width of the video you tried to upload is too short. The minimum width for a video is {min-width}. Please upload a wider video.",[s._param("min-width",this.$1.minWidth)])}},t.$15=function(){return n("vulture")("uxlnhk-6pEg8Fk9bfORWCRp4alE="),{summary:s._(/*BTDS*/"Problem Uploading Video"),description:s._(/*BTDS*/"Videos look best when they have a 16:9 aspect ratio. Please edit your video and upload again.")}},t.$14=function(){return{summary:s._(/*BTDS*/"Video Height Too Short"),description:s._(/*BTDS*/"The height of the video you tried to upload is too short. The minimum height for a video is {min-height}. Please upload a taller video.",[s._param("min-height",this.$1.minHeight)])}},t.$17=function(){return{summary:s._(/*BTDS*/"Video Too Wide"),description:s._(/*BTDS*/"The video you selected is too wide. Aspect ratios for videos need to be between {max_aspect_ratio} and {min_aspect_ratio}. Please record and upload a taller video.",[s._param("max_aspect_ratio",this.$1.maxAspectRatio+":1"),s._param("min_aspect_ratio",this.$1.minAspectRatio+":1")])}},t.$16=function(){return{summary:s._(/*BTDS*/"Video Too Tall"),description:s._(/*BTDS*/"The video you selected is too tall. Aspect ratios for videos need to be between {max_aspect_ratio} and {min_aspect_ratio}. Please record and upload a narrower video.",[s._param("max_aspect_ratio",this.$1.maxAspectRatio+":1"),s._param("min_aspect_ratio",this.$1.minAspectRatio+":1")])}},e})();a.exports=m}),130);
__d("MediaUploadFBMetadataValidator",["MediaUploadFBStage","MediaUploadFBStageOutcome","MediaUploadOperationOutcome","MediaUploadStageEvent","MediaUploadTime","Promise","VideoUploadFile","VideoUploadFileValidator"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function t(e){this.$1=r("MediaUploadFBStage").METADATA_VALIDATION,this.$2=e}var a=t.prototype;return a.validate=function(o,a){o.emitStageEvent(r("MediaUploadStageEvent").STAGE_STARTED,this.$1);var t;try{t=this.$3(o,a)}catch(e){o.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").EXCEPTION,rawErrorObject:e}),t=r("MediaUploadOperationOutcome").SUCCESS}return o.emitStageEventForOperationOutcome(t,this.$1),(e||(e=n("Promise"))).resolve(t)},a.$4=function(t){var e={};return t.extensions.forEach(function(t){return e[t]=1}),{minSize:t.minSizeKB*1024,maxSize:t.maxSizeKB*1024,maxLength:o("MediaUploadTime").timeToSeconds(t.maxDuration),minLength:o("MediaUploadTime").timeToSeconds(t.minDuration),acceptDimensionsFromPlayer:t.acceptDimensionsFromPlayer,minWidth:t.minWidth,minHeight:t.minHeight,require16to9AspectRatio:!1,minAspectRatio:t.minAspectRatio,maxAspectRatio:t.maxAspectRatio,source:t.sourceType,extensions:e}},a.$3=function(t,n){var e=t.asset.dataAsFile();if(e==null)return t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").ASSET_IS_NOT_FILE}),r("MediaUploadOperationOutcome").SUCCESS;if(this.configuration==null)throw this.$2.createThrowableError("Missing configuration in the MediaUploadFBMetadataValidator");var o=new(r("VideoUploadFile"))(null,e.file,e.size,e.extension),a=this.$4(this.configuration),i=new(r("VideoUploadFileValidator"))(a),l=i.getValidationErrorMessage(o,n);return l!=null?(t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").INTERNAL_FAILURE,displayError:l}),r("MediaUploadOperationOutcome").FAILED_NON_TRANSIENT):(t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").SUCCESS}),r("MediaUploadOperationOutcome").SUCCESS)},t})();l.default=s}),98);
__d("MediaUploadOperationAttemptOutcome",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["SUCCESS","CANCELED","TRANSIENT_FAILURE","TRANSIENT_FAILURE_IMMEDIATE_RETRY","NON_TRANSIENT_FAILURE"]),l=e;i.default=l}),66);
__d("MediaUploadRetryableOperation",["MediaUploadCancelablePromise","MediaUploadOperationAttemptOutcome","MediaUploadOperationOutcome"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t,n){var o=this;this.$4=null,this.$1=e,this.$2=t,this.$3=n,this.cancelablePromise=new(r("MediaUploadCancelablePromise"))(function(e){return o.$5(e),{cancel:function(){var t;(t=o.$4)==null||t.cancel(),o.$4=null,e(r("MediaUploadOperationOutcome").CANCELED)}}})}e.createAsPromise=function(n,r,o){var t=new e(n,r,o);return t.cancelablePromise};var t=e.prototype;return t.$5=function(t){var e=this,n=this.$1();this.$4=n,this.$3.promiseTerminator(n.promise.then(function(n){e.$4=null,e.$6(t,n)},function(n){throw e.$4=null,e.$6(t,r("MediaUploadOperationAttemptOutcome").NON_TRANSIENT_FAILURE),n}))},t.$6=function(t,n){switch(n){case r("MediaUploadOperationAttemptOutcome").CANCELED:t(r("MediaUploadOperationOutcome").CANCELED);break;case r("MediaUploadOperationAttemptOutcome").SUCCESS:t(r("MediaUploadOperationOutcome").SUCCESS);break;case r("MediaUploadOperationAttemptOutcome").NON_TRANSIENT_FAILURE:t(r("MediaUploadOperationOutcome").FAILED_NON_TRANSIENT);break;case r("MediaUploadOperationAttemptOutcome").TRANSIENT_FAILURE:this.$7(t,!1);break;case r("MediaUploadOperationAttemptOutcome").TRANSIENT_FAILURE_IMMEDIATE_RETRY:this.$7(t,!0);break}},t.$7=function(t,n){var e=this;if(this.$2.increaseRetryAttemptCounter(),this.$2.exceedTotalDuration())t(r("MediaUploadOperationOutcome").FAILED_OUT_OF_TIME);else if(this.$2.exceedTotalRetries())t(r("MediaUploadOperationOutcome").FAILED_NO_MORE_RETRIES);else if(n)this.$5(t);else{var o=this.$2.calculateBackoffDelay();this.$4=this.$3.delayedExecutor(o,function(){return e.$5(t)},function(){return t(r("MediaUploadOperationOutcome").CANCELED)})}},e})();l.default=e}),98);
__d("MediaUploadFBNetworkAssetStrategy",["MediaUploadPipeline","MediaUploadRetryableOperation"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t,n,r){this.$1=e,this.startRequest=t,this.uploadServiceRequest=n,this.receiveRequest=r}var t=e.prototype;return t.run=function(t){var e=this,n=t.asset.dataAsFile();if(n==null)throw this.$1.createThrowableError("Browser is not compatible with current version of the SDK");var o=new(r("MediaUploadPipeline"))(this.$1);return o.addCancelableStep(function(){return r("MediaUploadRetryableOperation").createAsPromise(function(){return e.startRequest.send(t)},t.retryState,e.$1)}),o.addCancelableStep(function(){return r("MediaUploadRetryableOperation").createAsPromise(function(){return e.uploadServiceRequest.send(t,n,e.startRequest.retriveResponse(t))},t.retryState,e.$1)}),o.addCancelableStep(function(){return r("MediaUploadRetryableOperation").createAsPromise(function(){return e.receiveRequest.send(t,e.startRequest.retriveResponse(t),e.uploadServiceRequest.retriveResponse(t))},t.retryState,e.$1)}),o.run()},t.cancel=function(){},e})();l.default=e}),98);
__d("MediaUploadFBNetworkProbe",["MediaUploadNetworkStatus","Network"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){}var t=e.prototype;return t.probe=function(){return r("Network").isOnline()?r("MediaUploadNetworkStatus").CONNECTED:r("MediaUploadNetworkStatus").DISCONNECTED},e})();l.default=e}),98);
__d("MediaUploadFBEndpointRequest",["AsyncRequest","MediaUploadCancelablePromise","MediaUploadOperationAttemptOutcome","MediaUploadStageEvent"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){}var t=e.prototype;return t.send=function(t,n){var e=this;return new(r("MediaUploadCancelablePromise"))(function(o){n.emitStageEvent(r("MediaUploadStageEvent").STAGE_STARTED,t.stage);var a=t.createPayload();if(a==null){n.emitStageEvent(r("MediaUploadStageEvent").STAGE_FAILED,t.stage),o(r("MediaUploadOperationAttemptOutcome").NON_TRANSIENT_FAILURE);return}var i=new(r("AsyncRequest"))().setAllowCrossOrigin(!0).setURI(t.uri).setData(a).setRequestHeader("X_FB_VIDEO_WATERFALL_ID",n.sessionContext.sessionID).setProgressHandler(function(){t.networkNotifier.notifyOnProgress(n,t.stage)}).setHandler(function(r){o(e.$1(t,n,r))}).setErrorHandler(function(r){o(e.$2(t,n,r))});if(i.send())return t.networkNotifier.notifyOnNewRequest(n,t.stage),{cancel:function(){t.networkNotifier.notifyOnAbandon(n,t.stage),i.abort()}};o(r("MediaUploadOperationAttemptOutcome").NON_TRANSIENT_FAILURE)})},t.$1=function(t,n,o){var e;return t.networkNotifier.notifyOnResponse(n,t.stage),(e=n.retryState)==null||e.resetBackoff(),t.acceptSuccessfulResponse(o),n.emitStageEvent(r("MediaUploadStageEvent").STAGE_SUCCEED,t.stage),r("MediaUploadOperationAttemptOutcome").SUCCESS},t.$2=function(t,n,o){var e=o.error<1e3,a=o.error>9999;e||a?t.networkNotifier.notifyOnResponse(n,t.stage):t.networkNotifier.notifyOnTransportError(n,t.stage),t.acceptErrorResponse(o),n.emitStageEvent(r("MediaUploadStageEvent").STAGE_FAILED,t.stage);var i=e&&o.error>=400&&o.error<500||a&&!o.transientError;return i?r("MediaUploadOperationAttemptOutcome").NON_TRANSIENT_FAILURE:r("MediaUploadOperationAttemptOutcome").TRANSIENT_FAILURE},e})();l.default=e}),98);
__d("MediaUploadFBReceiveRequest",["ActorURI","MediaUploadCancelablePromise","MediaUploadFBEndpointRequest","MediaUploadFBStage","MediaUploadFBStageOutcome","MediaUploadOperationAttemptOutcome","MediaUploadStageEvent"],(function(t,n,r,o,a,i,l){"use strict";var e="MediaUploadFBReceiveRequest",s=(function(){function t(e){this.$1=r("MediaUploadFBStage").RECEIVE_REQUEST,this.$2=e.entryPoint,this.$3=e.payloadHook,this.$4=e.customHeadersHook,this.$5=e.envParams,this.$6=new(r("MediaUploadFBEndpointRequest")),this.$7=e.networkNotifier}var n=t.prototype;return n.send=function(n,a,i){var t=this;if(this.configuration==null)throw this.$5.createThrowableError("Missing configuration in the MediaUploadFBReceiveRequest");return(a==null?void 0:a.skip_upload)===!0?(n.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").SUCCESS}),n.emitStageEvent(r("MediaUploadStageEvent").STAGE_SUCCEED,this.$1),r("MediaUploadCancelablePromise").resolve(r("MediaUploadOperationAttemptOutcome").SUCCESS)):this.$6.send({stage:this.$1,networkNotifier:this.$7,uri:n.request.attributes.actorID==null?this.configuration.baseURI:o("ActorURI").create(this.configuration.baseURI,n.request.attributes.actorID),createPayload:function(){return t.$8(n,a,i)},createCustomHeaders:function(){return t.$9(n)},acceptSuccessfulResponse:function(a){n.processing.rawData.set(e,a.payload),n.recordStageOutcome({stage:t.$1,outcome:r("MediaUploadFBStageOutcome").SUCCESS})},acceptErrorResponse:function(o){var e;n.recordStageOutcome({stage:t.$1,outcome:r("MediaUploadFBStageOutcome").REQUEST_ERROR,rawErrorCode:o.error,displayError:{summary:o.errorSummary,description:o.errorDescription},errorAttributes:{silentError:o.silentError,transientError:o.transientError},networkRequestID:(e=o.payload)==null?void 0:e.__www_request_id__})}},n)},n.$9=function(t){var e=this.$4;return e?e({assetSnapshot:t.composeSnapshot(),sessionSnapshot:t.sessionContext.composeSnapshot()}):null},n.$8=function(t,n,o){if(n==null)return t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").MISSING_MANDATORY_DATA,rawErrorCode:"MISSING_START_CALL_RESPONSE"}),null;if(o==null)return t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").MISSING_MANDATORY_DATA,rawErrorCode:"MISSING_UPLOAD_SERVICE_RESPONSE"}),null;var e=t.asset.dataAsFile(),a={waterfall_id:t.sessionContext.sessionID,target_id:t.request.attributes.targetID,video_id:n.video_id,source:this.$2.sourceType,composer_entry_point_ref:this.$2.entryPointRef,supports_chunking:!0,supports_upload_service:!0,partition_start_offset:0,partition_end_offset:e==null?void 0:e.size,start_offset:0,end_offset:e==null?void 0:e.size,upload_speed:t.uploadSummary.computeSpeedBps(),fbuploader_video_file_chunk:o.everstoreHandle,has_file_been_replaced:t.request.attributes.hasFileBeenReplaced,composer_dialog_version:t.request.attributes.composerDialogVersion,composer_work_shared_draft_mode:t.request.attributes.workSharedDraftMode},i=this.$3;return i!=null&&i({assetSnapshot:t.composeSnapshot(),sessionSnapshot:t.sessionContext.composeSnapshot(),startCallResponse:n,payload:a}),a},t})();l.default=s}),98);
__d("MediaUploadFBStartRequest",["ActorURI","MediaUploadFBEndpointRequest","MediaUploadFBStage","MediaUploadFBStageOutcome"],(function(t,n,r,o,a,i,l){"use strict";var e="MediaUploadFBStartRequest",s=(function(){function t(e){this.$1=r("MediaUploadFBStage").START_REQUEST,this.$2=e.entryPoint,this.$3=e.payloadHook,this.$4=e.customHeadersHook,this.$5=e.envParams,this.$6=new(r("MediaUploadFBEndpointRequest")),this.$7=e.networkNotifier}var n=t.prototype;return n.retriveResponse=function(n){return n.processing.rawData.getUnsafe(e)},n.send=function(n){var t=this;if(this.configuration==null)throw this.$5.createThrowableError("Missing configuration in the MediaUploadFBStartRequest");return this.$6.send({stage:this.$1,networkNotifier:this.$7,uri:n.request.attributes.actorID==null?this.configuration.baseURI:o("ActorURI").create(this.configuration.baseURI,n.request.attributes.actorID),createPayload:function(){return t.$8(n)},createCustomHeaders:function(){return t.$9(n)},acceptSuccessfulResponse:function(a){var o=a.payload;if(o.video_id!=null)n.processing.rawData.set(e,o),n.videoID=o.video_id,n.recordStageOutcome({stage:t.$1,outcome:r("MediaUploadFBStageOutcome").SUCCESS});else{var i;n.recordStageOutcome({stage:t.$1,outcome:r("MediaUploadFBStageOutcome").INVALID_SERVER_RESPONSE,networkRequestID:(i=a.payload)==null?void 0:i.__www_request_id__})}},acceptErrorResponse:function(o){var e;n.recordStageOutcome({stage:t.$1,outcome:r("MediaUploadFBStageOutcome").REQUEST_ERROR,rawErrorCode:o.error,displayError:{summary:o.errorSummary,description:o.errorDescription},errorAttributes:{silentError:o.silentError,transientError:o.transientError},networkRequestID:(e=o.payload)==null?void 0:e.__www_request_id__})}},n)},n.$9=function(t){var e=this.$4;return e!=null?e({assetSnapshot:t.composeSnapshot(),sessionSnapshot:t.sessionContext.composeSnapshot()}):null},n.$8=function(t){var e,n=t.asset.dataAsFile(),r={waterfall_id:t.sessionContext.sessionID,target_id:t.request.attributes.targetID,source:this.$2.sourceType,composer_entry_point_ref:this.$2.entryPointRef,supports_chunking:n!=null,supports_file_api:n!=null,file_size:n==null?0:n.size,file_extension:String(t.asset.data.extension),spherical:(e=t.metadata)==null?void 0:e.isSpherical,partition_start_offset:0,partition_end_offset:n==null?void 0:n.size,has_file_been_replaced:t.request.attributes.hasFileBeenReplaced,composer_dialog_version:t.request.attributes.composerDialogVersion,video_publisher_action_source:t.request.attributes.publisherActionSource,composer_work_shared_draft_mode:t.request.attributes.workSharedDraftMode},o=this.$3;return o!=null&&o({assetSnapshot:t.composeSnapshot(),sessionSnapshot:t.sessionContext.composeSnapshot(),payload:r}),r},t})();l.default=s}),98);
__d("ResumableUploadService",["cr:720"],(function(t,n,r,o,a,i,l){l.default=n("cr:720")}),98);
__d("MediaUploadFBUploadServiceRequest",["AsyncResponse","MediaUploadCancelablePromise","MediaUploadFBStage","MediaUploadFBStageOutcome","MediaUploadOperationAttemptOutcome","MediaUploadStageEvent","RelayAPIConfig","ResumableUploadService","ResumableUploadServiceState.enum","md5"],(function(t,n,r,o,a,i,l){"use strict";var e="MediaUploadFBUploadServiceRequest",s=(function(){function t(e){this.$1=r("MediaUploadFBStage").BYTES_UPLOAD,this.$2=e.envParams,this.$3=e.networkNotifier}var n=t.prototype;return n.send=function(t,n,o){var e=this;return new(r("MediaUploadCancelablePromise"))(function(a){t.emitStageEvent(r("MediaUploadStageEvent").STAGE_STARTED,e.$1);var i=e.configuration;if(i==null)throw e.$2.createThrowableError("Missing configuration in the MediaUploadFBUploadServiceRequest");if(o==null){t.recordStageOutcome({stage:e.$1,outcome:r("MediaUploadFBStageOutcome").MISSING_MANDATORY_DATA,rawErrorCode:"MISSING_START_CALL_RESPONSE"}),t.emitStageEvent(r("MediaUploadStageEvent").STAGE_FAILED,e.$1),a(r("MediaUploadOperationAttemptOutcome").NON_TRANSIENT_FAILURE);return}if(o.skip_upload){t.uploadSummary.updateForUploadSkip(n.size),t.recordStageOutcome({stage:e.$1,outcome:r("MediaUploadFBStageOutcome").SUCCESS}),t.emitStageEvent(r("MediaUploadStageEvent").STAGE_SUCCEED,e.$1),a(r("MediaUploadOperationAttemptOutcome").SUCCESS);return}t.uploadSummary.updateForUploadStart(n.size),t.recalculateProgressAndEmit();var l=e.$4(t,n,i,o),s=r("ResumableUploadService").create(l);return t.processing.uploadServiceDomain=s.getServiceName(),e.$5(t,s,a),s.resume(n.file),e.$3.notifyOnNewRequest(t,e.$1),{cancel:function(){s.cancel()}}})},n.retriveResponse=function(n){return n.processing.rawData.getUnsafe(e)},n.$6=function(n,o,a){this.$3.notifyOnResponse(n,this.$1),typeof a=="string"?(n.processing.rawData.set(e,{everstoreHandle:a}),n.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").SUCCESS}),n.emitStageEvent(r("MediaUploadStageEvent").STAGE_SUCCEED,this.$1),o(r("MediaUploadOperationAttemptOutcome").SUCCESS)):(n.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").INVALID_SERVER_RESPONSE,rawErrorCode:"RECEIVED_HANDLE_IS_NOT_STRING"}),n.emitStageEvent(r("MediaUploadStageEvent").STAGE_FAILED,this.$1),o(r("MediaUploadOperationAttemptOutcome").NON_TRANSIENT_FAILURE))},n.$7=function(t,n,o){o.error<1e3?this.$3.notifyOnResponse(t,this.$1):this.$3.notifyOnTransportError(t,this.$1),t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").REQUEST_ERROR,rawErrorCode:o.error,displayError:{summary:o.errorSummary,description:o.errorDescription},errorAttributes:{silentError:o.silentError,transientError:o.transientError}}),t.emitStageEvent(r("MediaUploadStageEvent").STAGE_FAILED,this.$1);var e=o.error>=400&&o.error<500;n(e?r("MediaUploadOperationAttemptOutcome").NON_TRANSIENT_FAILURE:r("MediaUploadOperationAttemptOutcome").TRANSIENT_FAILURE)},n.$8=function(t,n,o){o instanceof r("AsyncResponse")?this.$7(t,n,o):(this.$3.notifyOnAbandon(t,this.$1),t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").REQUEST_ERROR,rawErrorObject:o}),t.emitStageEvent(r("MediaUploadStageEvent").STAGE_FAILED,this.$1),n(r("MediaUploadOperationAttemptOutcome").TRANSIENT_FAILURE))},n.$9=function(t,n){this.$3.notifyOnAbandon(t,this.$1),t.recordStageOutcome({stage:this.$1,outcome:r("MediaUploadFBStageOutcome").CANCEL}),t.emitStageEvent(r("MediaUploadStageEvent").STAGE_CANCELED,this.$1),n(r("MediaUploadOperationAttemptOutcome").CANCELED)},n.$10=function(t,n){this.$3.notifyOnProgress(t,this.$1),(n==null?void 0:n.loaded)!=null&&(t.uploadSummary.updateForProgress(n.loaded),t.emitStageEvent(r("MediaUploadStageEvent").STAGE_PROGRESS,this.$1))},n.$5=function(t,n,o){var e=this,a;n.addListener((a=r("ResumableUploadServiceState.enum")).SUCCESS,function(n){return e.$6(t,o,n)}),n.addListener(a.TRANSPORT_FAILURE,function(n){return e.$7(t,o,n)}),n.addListener(a.FAIL,function(n){return e.$8(t,o,n)}),n.addListener(a.CANCEL,function(){return e.$9(t,o)}),n.addListener(a.PROGRESS,function(n){return e.$10(t,n)})},n.$4=function(t,n,o,a){var e,i,l=n.file,s=[String(l.lastModified),l.name,l.type,String(l.size),(e=(i=t.processing.pseudoHash)==null?void 0:i.hashValue)!=null?e:[t.sessionContext.sessionID,t.assetID].join("-")].join("-"),u=[r("md5")(s),String(a.start_offset),String(a.end_offset)].join("-"),c=o.tracing.enabled&&o.tracing.minFileSizeKB<l.size/1024?["video_upload_www",[t.assetID,String(t.retryState.getRetryAttempts())].join("_"),[String(t.sessionContext.sessionID),String(a.video_id)].join("_")].join(":"):null,d=o.defaultService,m=d.serviceName,p=d.serviceDomain;t.retryState.getRetryAttemptsSinceLastReset()<10&&o.targetedService!=null&&(m=o.targetedService.serviceName,p=o.targetedService.serviceDomain);var _=null;return o.includeAccessToken&&(_=r("RelayAPIConfig").accessToken),{consumer:o.defaultService.serviceConsumer,accessToken:_,sessionKey:u,serviceName:m,serviceDomain:p,tracingHeaderValue:c,receiveParameters:{start_offset:String(a.start_offset),end_offset:String(a.end_offset),composer_session_id:t.sessionContext.sessionID,upload_session_id:String(a.upload_session_id),product_media_id:a.video_id,xpv_asset_id:a.xpv_asset_id,is_xpv_single_prod:a.is_xpv_single_prod,fb_region:a.fb_region,total_file_size:String(l.size),target_id:t.request.attributes.targetID,video_waterfall_id:t.sessionContext.sessionID}}},t})();l.default=s}),98);
__d("MediaUploadFalcoLogger",["CurrentUser","MediaUploadAssetEvent","MediaUploadClientEvent","MediaUploadFBStage","MediaUploadFBStageOutcome","MediaUploadSessionEvent","MediaUploadSessionStatus","MediaUploadStageEvent","MediaUploadTime","logVideoUploadViaFalco"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m=new Map([[(e=r("MediaUploadClientEvent")).CLIENT_CONFIG_REQUESTED,"upload.client.started_client_config_fetch"],[e.CLIENT_CONFIG_RECEIVED,"upload.client.finished_client_config_fetch"],[e.CLIENT_CONFIG_FAILED,"upload.client.failed_client_config_fetch"],[e.CLIENT_CONFIG_CACHED,"upload.client.cached_client_config_fetch"]]),p=new Map([[(s=r("MediaUploadSessionEvent")).SESSION_CONFIRMED,"upload.client.started_flow"],[s.PUBLISH_STARTED,"upload.client.started_sending_post_request"],[s.PUBLISH_SUCCEED,"upload.client.finished_sending_post_request"],[s.PUBLISH_FAILED,"upload.client.failed_sending_post_request"]]),_=new Map([[r("MediaUploadSessionStatus").FAILED,"upload.client.failed_flow"],[r("MediaUploadSessionStatus").CANCELED,"upload.client.canceled_flow"],[r("MediaUploadSessionStatus").COMPLETED,"upload.client.finished_flow"]]),f=new Map([[(u=r("MediaUploadAssetEvent")).ASSET_ADDED,"upload.client.requested_uploading"],[u.ASSET_STARTED,"upload.client.started_uploading"],[u.ASSET_FAILED,"upload.client.failed_uploading"],[u.ASSET_REMOVED,"upload.client.canceled_uploading"],[u.ASSET_SUCCEED,"upload.client.finished_uploading"],[u.ASSET_STALL,"upload.client.stall_detected"]]),g=new Map([[(c=r("MediaUploadStageEvent")).STAGE_STARTED,new Map([[(d=r("MediaUploadFBStage")).START_REQUEST,"upload.client.started_sending_start_request"],[d.BYTES_UPLOAD,"upload.client.started_sending_bytes"],[d.RECEIVE_REQUEST,"upload.client.started_sending_receive_request"]])],[c.STAGE_SUCCEED,new Map([[d.START_REQUEST,"upload.client.finished_sending_start_request"],[d.BYTES_UPLOAD,"upload.client.finished_sending_bytes"],[d.RECEIVE_REQUEST,"upload.client.finished_sending_receive_request"]])],[c.STAGE_FAILED,new Map([[d.START_REQUEST,"upload.client.failed_sending_start_request"],[d.RECEIVE_REQUEST,"upload.client.failed_sending_receive_request"],[d.BYTES_UPLOAD,"upload.client.failed_sending_bytes"],[d.METADATA_VALIDATION,"upload.client.invalidated_uploading"]])],[c.STAGE_CANCELED,new Map([[d.START_REQUEST,"upload.client.canceled_sending_start_request"],[d.BYTES_UPLOAD,"upload.client.canceled_sending_bytes"],[d.RECEIVE_REQUEST,"upload.client.canceled_sending_receive_request"]])]]),h=(function(){function e(e,t){this.$1=e,this.$2=t}var t=e.prototype;return t.subscribe=function(t,n){var e=this;m.forEach(function(r,o){t.addClientEventListener(o,function(t){return e.$3(n,r,t)})}),p.forEach(function(r,o){t.addSessionEventListener(o,function(t){return e.$4(n,r,t)})}),_.forEach(function(o,a){t.addSessionEventListener(r("MediaUploadSessionEvent").SESSION_FINISHED,function(t){t.terminalStatus===a&&t.timing.confirmedAtMs!=null&&e.$4(n,o,t)})}),f.forEach(function(r,o){t.addAssetEventListener(o,function(t,o){return e.$5(n,r,t,o)})}),g.forEach(function(r,o){r.forEach(function(r,a){t.addStageEventListener(o,a,function(t,o){e.$5(n,r,t,o)})})})},t.$6=function(t){return t==null?null:o("MediaUploadTime").timeToMilliseconds(this.$1.currentTimeProvider())-t},t.$7=function(t,n){var e,o;return{event:t,application_state:"www_v2",is_chunked_upload:!0,file_can_read:this.$1.features.supportFileManipulation,network_status:(e=this.$2)==null||(e=e.injectNetworkStatus)==null?void 0:e.getNetworkStatus(),internet_status:(o=this.$2)==null||(o=o.injectNetworkStatus)==null?void 0:o.getInternetStatus(),trigger_time:this.$1.currentTimeProvider(),app_id:r("CurrentUser").getAppID(),source:n.sourceType,composer_entry_point_ref:n.entryPointRef}},t.$8=function(t){var e,n,o,a,i,l=(t==null?void 0:t.rawErrorCode)!=null&&typeof(t==null?void 0:t.rawErrorCode)=="string"?t==null?void 0:t.rawErrorCode:void 0,s=(t==null?void 0:t.rawErrorCode)!=null&&typeof(t==null?void 0:t.rawErrorCode)=="number"?t==null?void 0:t.rawErrorCode:void 0;return{error:l!=null?l:t==null||(e=t.displayError)==null?void 0:e.summary,error_inner:(t==null?void 0:t.outcome)===r("MediaUploadFBStageOutcome").SUCCESS||t==null?void 0:t.outcome,error_description:(n=t==null||(o=t.errorObject)==null?void 0:o.message)!=null?n:t==null||(a=t.displayError)==null?void 0:a.description,error_trace:t==null||(i=t.errorObject)==null?void 0:i.stack,error_code:s}},t.$9=function(t){return{event_reason:t.cancelReason,elapsed_time:this.$6(t.timing.confirmedAtMs),waterfall_id:t.sessionID,retry_id:t.retryID}},t.$10=function(t){var e,n,r,o,a,i,l,s,u;return{elapsed_time:this.$6(t.lastUploadStartedAtMs),asset_id:t.assetID,video_id:t.videoID,composer_session_id:t.request.attributes.composerSessionID,target_id:t.request.attributes.targetID,composer_dialog_version:t.request.attributes.composerDialogVersion,has_file_been_replaced:t.request.attributes.hasFileBeenReplaced,source_width:(e=t.metadata)==null?void 0:e.width,source_height:(n=t.metadata)==null?void 0:n.height,is_spherical:(r=t.metadata)==null?void 0:r.isSpherical,duration:(o=t.metadata)==null?void 0:o.durationMs,file_size:(a=t.asset.dataAsFile())==null?void 0:a.size,video_original_file_path:t.asset.data.name,hash:(i=t.hash)==null?void 0:i.hashValue,hash_time:(l=t.hash)==null?void 0:l.calculationTimeCostMs,retries:t.retries.totalRetryAttempts,upload_domain:t.uploadServiceDomain,upload_speed:(s=t.uploadSummary)==null?void 0:s.speedBps,skip_upload:(u=t.uploadSummary)==null?void 0:u.skippedUpload}},t.$11=function(t){var e,n;return((e=this.$2)==null?void 0:e.injectExtraSessionFields)!=null?(n=this.$2)==null?void 0:n.injectExtraSessionFields(t):null},t.$12=function(t,n){var e,r;return((e=this.$2)==null?void 0:e.injectExtraAssetFields)!=null?(r=this.$2)==null?void 0:r.injectExtraAssetFields(t,n):null},t.$13=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.map(function(e){return e!=null?e:{}});return Object.assign.apply(Object,[{}].concat(r))},t.$3=function(t,n,r){var e=r.assetSnapshot,o=r.sessionSnapshot,a=this.$13(o==null?null:this.$11(o),o==null||e==null?null:this.$12(o,e),this.$7(n,t),o==null?null:this.$9(o),o==null||e==null?null:this.$10(e),this.$8(r),{elapsed_time:this.$6(r.startedAtMs)});this.$14(a)},t.$4=function(t,n,r){var e=this.$13(this.$11(r),this.$7(n,t),this.$9(r),this.$8(r.lastError));this.$14(e)},t.$5=function(t,n,r,o){var e=this.$13(this.$11(r),this.$12(r,o),this.$7(n,t),this.$9(r),this.$10(o),this.$8(o.lastAction));this.$14(e)},t.$14=function(t){r("logVideoUploadViaFalco")(t)},e})();l.default=h}),98);
__d("MediaUploadLinearProgressCalculator",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e){this.$1=e,this.$2=this.$4(),this.$3=this.$1.sessionWeights.assets+this.$1.sessionWeights.publishing}var t=e.prototype;return t.$4=function(){var e=this.$1.assetWeights.uploadBytes;return this.$1.assetWeights.singleOperations.forEach(function(t){return e+=t}),e},t.$5=function(t,n){var e=Math.floor(t*100/this.$1.percentagePrecision)*this.$1.percentagePrecision,r=Math.abs(e-n)>=this.$1.percentagePrecision;return{percentageProgress:e,isDifferent:r}},t.calculateAssetProgress=function(t){var e=this.$1.assetWeights,n=0;if(t.isCompleted())n=1;else{for(var r of t.progress.completedStages.values()){var o=e.singleOperations.get(r);o!=null&&(n+=o)}var a=t.uploadSummary.computeUploadedPortion();a!=null&&(n+=e.uploadBytes*a),n/=this.$2}var i=this.$5(n,t.progress.calculated.percentageComplete);return t.progress.calculated.rawValue=n,t.progress.calculated.percentageComplete=i.percentageProgress,t.progress.calculated.rawValue=n,i.isDifferent},t.calculateSessionProgress=function(t){var e=this.$1.sessionWeights,n=0;t.progress.publishingDone&&(n+=e.publishing);var r=t.getActiveAssets();if(r.length>0){var o=e.assets/r.length;t.getActiveAssets().forEach(function(e){n+=o*e.progress.calculated.rawValue})}else n+=e.assets;n/=this.$3;var a=this.$5(n,t.progress.percentageComplete);return t.progress.percentageComplete=a.percentageProgress,a.isDifferent},e})();i.default=e}),66);
__d("MediaUploadNetworkMonitor",["MediaUploadAssetEvent","MediaUploadClientEvent","MediaUploadNetworkStatus","MediaUploadRetryState","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e,s={probe:function(){return r("MediaUploadNetworkStatus").UNKNOWN}},u={probe:function(){return(e||(e=n("Promise"))).resolve(r("MediaUploadNetworkStatus").UNKNOWN)}},c=(function(){function e(e,t){this.$1=e,this.$3=s,this.$2=u,this.$4=r("MediaUploadNetworkStatus").UNKNOWN,this.$5=new Map,this.$6=null,this.$8=null,this.$9=t.emitClientEvent}var t=e.prototype;return t.updateConfiguration=function(t){var e,n;this.$3=(e=t.networkProbe)!=null?e:s,this.$2=(n=t.internetProbe)!=null?n:u,this.$7=t.internetProbeBackoffPolicy==null?null:new(r("MediaUploadRetryState"))(t.internetProbeBackoffPolicy,this.$1),this.$8=t.stallDetectorTimeout,this.$10()},t.getNetworkStatus=function(){return this.$3.probe()},t.getInternetStatus=function(){return this.$4},t.$11=function(t,n){return t.sessionContext.sessionID+"/"+t.assetID+"/"+String(n)},t.$12=function(t,n,o){var e,a;this.$13(r("MediaUploadNetworkStatus").CONNECTED),(e=this.$7)==null||e.resetBackoff(),(a=this.$6)==null||a.cancel(),this.$6=null;var i=this.$11(t,n);o&&this.$5.set(i,{assetContext:t}),this.$10(),this.$14(i)},t.$15=function(t,n){var e=this.$11(t,n),r=this.$5.get(e);if(r!=null){var o;(o=r.stallDetector)==null||o.cancel(),r.stallDetector=null}this.$5.delete(e)},t.$14=function(t){var e,n=this.$8;if(n!=null){var o=this.$5.get(t);o!=null&&((e=o.stallDetector)==null||e.cancel(),o.stallDetector=this.$1.delayedExecutor(n,function(){o.assetContext.emitAssetEvent(r("MediaUploadAssetEvent").ASSET_STALL),o.stallDetector=null}))}},t.$10=function(){var e=this,t=this.$7;t!=null&&this.$5.size!==0&&this.$6==null&&(this.$6=this.$1.delayedExecutor(t.calculateBackoffDelay(),function(){var t=e.$2.probe().then(function(t){return e.$13(t)}).finally(function(){e.$6=null,e.$10()});e.$1.promiseTerminator(t)}),t.increaseRetryAttemptCounter())},t.$13=function(t){if(this.$4!==t)switch(this.$4=t,this.$4){case r("MediaUploadNetworkStatus").CONNECTED:this.$9(r("MediaUploadClientEvent").CLIENT_INTERNET_ONLINE);break;case r("MediaUploadNetworkStatus").DISCONNECTED:this.$9(r("MediaUploadClientEvent").CLIENT_INTERNET_OFFLINE);break;case r("MediaUploadNetworkStatus").TIMEOUT:this.$9(r("MediaUploadClientEvent").CLIENT_INTERNET_UNKNOWN);break;case r("MediaUploadNetworkStatus").UNKNOWN:}},t.notifyOnNewRequest=function(t,n){this.$12(t,n,!0)},t.notifyOnProgress=function(t,n){this.$12(t,n,!1)},t.notifyOnAbandon=function(t,n){this.$15(t,n)},t.notifyOnTransportError=function(t,n){this.$15(t,n)},t.notifyOnResponse=function(t,n){this.$15(t,n),this.$12(t,n,!1)},e})();l.default=c}),98);
__d("MediaUploadFBDefaultClientContext",["MediaUploadClientContext","MediaUploadClientEvent","MediaUploadEventEmitterAdapter","MediaUploadExecutor","MediaUploadFBAssetContext","MediaUploadFBAssetRequest","MediaUploadFBClient","MediaUploadFBClientEventContext","MediaUploadFBDefaultServerConfigurationRetriever","MediaUploadFBFileHasher","MediaUploadFBInternetProbe","MediaUploadFBLocalAssetStrategy","MediaUploadFBMetadataParser","MediaUploadFBMetadataValidator","MediaUploadFBNetworkAssetStrategy","MediaUploadFBNetworkProbe","MediaUploadFBReceiveRequest","MediaUploadFBSessionContext","MediaUploadFBStage","MediaUploadFBStartRequest","MediaUploadFBUploadServiceRequest","MediaUploadFalcoLogger","MediaUploadLinearProgressCalculator","MediaUploadNetworkMonitor","cr:1856704"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t,n,o){var a,i=new(r("MediaUploadEventEmitterAdapter"))(t);return a=e.call(this,{sdk:t,emitter:i.emitter,executor:new(r("MediaUploadExecutor")),progressCalculator:new(r("MediaUploadLinearProgressCalculator"))({assetWeights:{uploadBytes:.9,singleOperations:new Map([[r("MediaUploadFBStage").START_REQUEST,.05],[r("MediaUploadFBStage").RECEIVE_REQUEST,.05]])},sessionWeights:{publishing:.1,assets:.9},percentagePrecision:1})})||this,a.entryPoint=n,a.eventAdapter=i,a.configuration=o,a.networkMonitor=new(r("MediaUploadNetworkMonitor"))(a.sdk,{emitClientEvent:function(o){return i.emitter.emitClientEvent(o,new(r("MediaUploadFBClientEventContext"))({entryPoint:n,envParams:t}))}}),a.localAssetStategy=a.$MediaUploadFBDefaultClientContext$p_1(),a.networkAssetStategy=a.$MediaUploadFBDefaultClientContext$p_2(),a.serverConfigurationRetriever=new(r("MediaUploadFBDefaultServerConfigurationRetriever"))({entryPoint:n,emitter:a.emitter,setters:{metadataValidation:function(t){a.localAssetStategy.metadataValidator.configuration=t},startRequest:function(t){a.networkAssetStategy.startRequest.configuration=t},receiveRequest:function(t){a.networkAssetStategy.receiveRequest.configuration=t},uploadService:function(t){a.networkAssetStategy.uploadServiceRequest.configuration=t},networkMonitor:function(t){a.networkMonitor.updateConfiguration({networkProbe:t.networkProbe.enabled?new(r("MediaUploadFBNetworkProbe")):null,internetProbe:t.internetProbe.enabled?new(r("MediaUploadFBInternetProbe"))({timeout:t.internetProbe.timeout},a.sdk):null,internetProbeBackoffPolicy:t.internetProbe.backoffPolicy,stallDetectorTimeout:t.stallDetector.enabled?t.stallDetector.timeout:null})}},envParams:a.sdk}),a.client=new(r("MediaUploadFBClient"))({implementation:a,sessionStrategy:a.sessionStrategy,envParams:a.sdk}),a.emitter.emitClientEvent(r("MediaUploadClientEvent").CLIENT_CREATED,new(r("MediaUploadFBClientEventContext"))({entryPoint:n,envParams:a.sdk})),a}babelHelpers.inheritsLoose(t,e);var o=t.prototype;return o.$MediaUploadFBDefaultClientContext$p_1=function(){return new(r("MediaUploadFBLocalAssetStrategy"))({envParams:this.sdk,metadataParser:new(r("MediaUploadFBMetadataParser")),metadataValidator:new(r("MediaUploadFBMetadataValidator"))(this.sdk),fileHasher:new(r("MediaUploadFBFileHasher"))({pseudoHasher:n("cr:1856704")==null?void 0:new(n("cr:1856704"))({maxChunkSize:1048576,takeFirstBytes:102400,hashingAlgorithm:"sha256",outputEncoding:"base64"},this.sdk)})})},o.$MediaUploadFBDefaultClientContext$p_2=function(){var e,t,n,o,a=new(r("MediaUploadFBStartRequest"))({entryPoint:this.entryPoint,payloadHook:(e=this.configuration.networkHooks)==null?void 0:e.startRequestPayload,customHeadersHook:(t=this.configuration.networkHooks)==null?void 0:t.startRequestCustomHeaders,envParams:this.sdk,networkNotifier:this.networkMonitor}),i=new(r("MediaUploadFBUploadServiceRequest"))({envParams:this.sdk,networkNotifier:this.networkMonitor}),l=new(r("MediaUploadFBReceiveRequest"))({entryPoint:this.entryPoint,payloadHook:(n=this.configuration.networkHooks)==null?void 0:n.receiveRequestPayload,customHeadersHook:(o=this.configuration.networkHooks)==null?void 0:o.receiveRequestCustomHeaders,envParams:this.sdk,networkNotifier:this.networkMonitor});return new(r("MediaUploadFBNetworkAssetStrategy"))(this.sdk,a,i,l)},o.runClientLazyLoading=function(t){return this.serverConfigurationRetriever.run(r("MediaUploadFBAssetContext").castOrThrow(t,this.sdk))},o.runLocalAssetStategy=function(t){return this.localAssetStategy.run(r("MediaUploadFBAssetContext").castOrThrow(t,this.sdk))},o.runNetworkAssetStategy=function(t){return this.networkAssetStategy.run(r("MediaUploadFBAssetContext").castOrThrow(t,this.sdk))},o.createSessionContext=function(t){return new(r("MediaUploadFBSessionContext"))({sessionID:t,entryPoint:this.entryPoint,emitter:this.emitter,progressCalculator:this.progressCalculator,params:this.sdk})},o.createAssetContext=function(t,n){return new(r("MediaUploadFBAssetContext"))({sessionContext:r("MediaUploadFBSessionContext").castOrThrow(t,this.sdk),assetRequest:r("MediaUploadFBAssetRequest").castOrThrow(n,this.sdk),emitter:this.emitter,progressCalculator:this.progressCalculator,retryState:this.createRetryState(),params:this.sdk})},o.publish=function(t,n){var e=this,o=r("MediaUploadFBSessionContext").castOrThrow(t,this.sdk).composeSnapshot(),a=n.map(function(t){return r("MediaUploadFBAssetContext").castOrThrow(t,e.sdk).composeSnapshot()});return this.configuration.eventHooks.publishCallback(o,a)},o.subscribeToHooks=function(){var e=this,t=new(r("MediaUploadFalcoLogger"))(this.sdk,{injectNetworkStatus:this.networkMonitor,injectExtraSessionFields:function(){return{composer_dialog_version:e.configuration.composerDialogVersion}}});t.subscribe(this.eventAdapter.subscriber,this.entryPoint),this.configuration.eventHooks.eventSubscriber!=null&&this.configuration.eventHooks.eventSubscriber(this.eventAdapter.subscriber)},t})(r("MediaUploadClientContext"));l.default=e}),98);
__d("MediaUploadSurface",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e,t){this.$1=t,this.sdk=e}var t=e.prototype;return t.isClientSupported=function(t){var e=this.$1.get(t.key);return e!=null},t.getClient=function(t){var e=this.$1.get(t.key);if(e==null)throw this.sdk.createThrowableError("Client configuration was not provided for the entry point "+t.key);return e()},e})();i.default=e}),66);
__d("MediaUploadFBSurface",["MediaUploadExtrasStorage","MediaUploadFBAssetRequest","MediaUploadSurface"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t,n){return e.call(this,t,n)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.createAssetRequest=function(t,n,o,a){var e=t(this.sdk.factories.assets),i;a!=null&&(i=new(r("MediaUploadExtrasStorage"))(this.sdk),a(i));var l;return typeof o=="function"?l=o(e):l=o,new(r("MediaUploadFBAssetRequest"))({asset:e,assetID:n,attributes:l,extras:i})},t})(r("MediaUploadSurface"));l.default=e}),98);
__d("MediaUploadSurfaceDefinition",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e){this.$1=e,this.$2=new Map,this.$3=new Map}var t=e.prototype;return t.$4=function(t,n){var e=this;return function(){var r=e.$3.get(t.key);return r==null&&(r=e.$1.client(t,n),e.$3.set(t.key,r)),r}},t.registerClientConfiguration=function(t){var e=this;return t.entryPoints.forEach(function(n){e.$2.set(n.key,e.$4(n,t))}),this},t.createSurface=function(){return this.$1.surface(this.$2)},e})();i.default=e}),66);
__d("MediaUploadFBDefaultSurfaceDefinition",["MediaUploadFBDefaultClientContext","MediaUploadFBEntryPointID","MediaUploadFBSurface","MediaUploadSurfaceDefinition"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t){return e.call(this,{client:function(n,o){var e=new(r("MediaUploadFBDefaultClientContext"))(t,r("MediaUploadFBEntryPointID").castOrThrow(n,t),o);return e.client},surface:function(n){return new(r("MediaUploadFBSurface"))(t,n)}})||this}return babelHelpers.inheritsLoose(t,e),t})(r("MediaUploadSurfaceDefinition"));l.default=e}),98);
__d("MediaUploadVUShimSurface",["MediaUploadFBDefaultSurfaceDefinition","MediaUploadFBEntryPointID","MediaUploadFBSDK","MediaUploadVUShim"],(function(t,n,r,o,a,i,l){"use strict";var e,s=new(r("MediaUploadFBDefaultSurfaceDefinition"))(r("MediaUploadFBSDK"));s.registerClientConfiguration({entryPoints:[new(e=r("MediaUploadFBEntryPointID"))("composer","pages_feed"),new e("composer","pages_feed_video_composer"),new e("newsfeed_composer","feed"),new e("composer","timeline")],eventHooks:{publishCallback:function(t,n){return r("MediaUploadVUShim").triggerPublish(t,n)},eventSubscriber:function(t){r("MediaUploadVUShim").setupEventSubscription(t)}}});var u=s.createSurface(),c=u;l.default=c}),98);
__d("VideoUploadCrashMonitor",["Bandicoot","VideoUploadLogger"],(function(t,n,r,o,a,i){var e=(function(e){"use strict";function t(t,n,r,o,a,i,l,s){var u;return u=e.call(this,"VideoUploadSession")||this,u.$VideoUploadCrashMonitor1={waterfallID:t,actorID:n,source:r,targetID:o,loggingDelay:a,supportsChunking:i,composerEntryPointRef:l,flowStarted:s},u}babelHelpers.inheritsLoose(t,e);var r=t.prototype;return r.flowStarted=function(){this.$VideoUploadCrashMonitor1.flowStarted=!0},r.getCrashTimeData=function(){return this.$VideoUploadCrashMonitor1},r.logCrash=function(t,r,o){if(r.waterfallID){var e=new(n("VideoUploadLogger"))({actor_id:r.actorID,source:r.source,waterfall_id:r.waterfallID,target_id:r.targetID,delay:r.loggingDelay,is_chunked_upload:r.supportsChunking,composer_entry_point_ref:r.composerEntryPointRef}),a={error:"Crash Detected",error_description:"Detected video upload did not complete due to a crash"};e.logEvent(n("VideoUploadLogger").EVENT_FAILED_UPLOADING,a),r.flowStarted&&e.logEvent(n("VideoUploadLogger").EVENT_RESIGNED_FLOW,{})}},t})(n("Bandicoot"));a.exports=e}),null);
__d("GraphQLVideoPublishUtils",["immutable"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n=r("immutable").List(["cs_ab_testing_video_upload","cs_content_library","cs_content_library_bulk_upload","cs_content_library_upload_videos","cs_content_show_episode_upload","cs_global_basic_post","cs_global_bulk_upload","cs_global_multipost","cs_global_upload_video","cs_home_basic_post","cs_home_bulk_video","cs_home_upload_video","cs_home_multipost","cs_instagram_content_library","media_manager","pages_feed_video_composer","pages_composer_bulk_upload_upsell","page_content_tab_drafts","page_content_tab_published_posts_opted_out","page_content_tab_scheduled_posts_opted_out","page_content_tab_video_library","page_content_tab_video_library_premiere","pages_posts","pages_video_tab","timeline","video_page_video_list","cs_unified_composer_optout","cs_content_show_trailer_upload","biz_web_testing_video_upload"]);n=n.push("feed_story");var o=n.contains(t);return(e==="composer"||e==="media_manager_instagram_video_composer"||e==="comment")&&o}l.isGraphQLPublish=e}),98);
__d("ResumableUploadAsyncService",["AsyncRequest","EventEmitter","ResumableUploadServiceState.enum","URI","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s="rupload",u="facebook.com",c=(function(t){function n(e,n,o,a,i,l,c,d,m){var p;return p=t.call(this)||this,p.consumer=e,p.accessToken=n,p.sessionKey=o||r("uuidv4")(),p.contentKey=a||"",p.contentValue=i||"",p.serviceName=l&&l!=""?l:s,p.serviceDomain=c&&c!=""?c:u,p.receiveParameters=d,p.tracingHeaderValue=m,p}babelHelpers.inheritsLoose(n,t),n.create=function(t){return new n(t.consumer,t.accessToken,t.sessionKey||"",t.contentKey,t.contentValue,t.serviceName,t.serviceDomain,t.receiveParameters,t.tracingHeaderValue)};var o=n.prototype;return o.resume=async function(t){try{var e=await this.sendOffsetRequest();this.emit(r("ResumableUploadServiceState.enum").START,{offset:e.offset});var n=await this.sendUploadRequest(t,e);this.emit(r("ResumableUploadServiceState.enum").SUCCESS,n.h)}catch(e){this.emit(r("ResumableUploadServiceState.enum").FAIL,e)}this.abortUpload=void 0},o.cancel=function(){this.abortUpload&&this.abortUpload(),this.emit(r("ResumableUploadServiceState.enum").CANCEL)},o.sendOffsetRequest=function(){var e=this;return new Promise(function(t,n){var o=new(r("AsyncRequest"))().setAllowCrossOrigin(!0).setAllowCredentials(!0).setMethod("GET").setURI(e.getUploadUri()).setReadOnly(!0).setRequestHeader("Authorization","OAuth "+e.accessToken).setHandler(function(e){return t(JSON.parse(e.payload.response))}).setErrorHandler(n).setOption("suppressEvaluation",!0).setTransportErrorHandler(function(t){e.emit(r("ResumableUploadServiceState.enum").TRANSPORT_FAILURE,t)});e.abortUpload=function(){return o.abort()},o.send()})},o.sendUploadRequest=function(t,n){var e=this,o=n||{},a=o.offset,i=o.duplicate,l=i?"":t.slice(a);return new Promise(function(n,o){var i=new(r("AsyncRequest"))().setAllowCrossOrigin(!0).setAllowCredentials(!0).setURI(e.getUploadUri()).setRawData(l).setHandler(function(e){return n(JSON.parse(e.payload.response))}).setErrorHandler(o).setRequestHeader("Authorization","OAuth "+e.accessToken).setRequestHeader("X-Entity-Name",encodeURIComponent(t.name)).setRequestHeader("X-Entity-Type",t.type).setRequestHeader("X-Entity-Length",String(t.size)).setRequestHeader("Offset",String(a)).setOption("suppressEvaluation",!0).setUploadProgressHandler(function(n){var o=new ProgressEvent("upload-service",{total:t.size,loaded:n.loaded+Number(a)});e.emit(r("ResumableUploadServiceState.enum").PROGRESS,o)}).setTransportErrorHandler(function(t){e.emit(r("ResumableUploadServiceState.enum").TRANSPORT_FAILURE,t)});e.abortUpload=function(){return i.abort()};var s=e.receiveParameters;s&&(i.setRequestHeader("start_offset",String(s.start_offset)).setRequestHeader("end_offset",String(s.end_offset)).setRequestHeader("composer_session_id",String(s.composer_session_id)).setRequestHeader("id",String(s.upload_session_id)),s.fb_region&&i.setRequestHeader("X-FB-Region",String(s.fb_region))),e.tracingHeaderValue&&i.setRequestHeader("x-fb-product-log",e.tracingHeaderValue),i.send()})},o.getUploadUri=function(){var t=this.getServiceName(),n=new(e||(e=r("URI")))("https://"+t+"/"+this.consumer+"/"+this.sessionKey);return this.contentKey&&this.contentValue&&(n=n.addQueryData(this.contentKey,this.contentValue)),n},o.getServiceName=function(){return this.serviceName+"."+this.serviceDomain},n})(r("EventEmitter"));l.default=c}),98);
__d("VideoUploadConnectionMonitor",["Network","VideoUploadFeatureDetector","cr:909282","debounce","mixin","setTimeout"],(function(t,n,r,o,a,i){var e=(function(e){"use strict";function t(){var t;return t=e.call(this)||this,t.$VideoUploadConnectionMonitor$p_1=!1,t.$VideoUploadConnectionMonitor$p_2=[],t.$VideoUploadConnectionMonitor$p_3=!1,t.$VideoUploadConnectionMonitor$p_4=!0,t.$VideoUploadConnectionMonitor$p_5=n("debounce")(function(){t.$VideoUploadConnectionMonitor$p_6(!1)},2e3),t}babelHelpers.inheritsLoose(t,e);var r=t.prototype;return r.notifyStart=function(){var e=this;this.$VideoUploadConnectionMonitor$p_3||(this.$VideoUploadConnectionMonitor$p_2.length===0&&(this.$VideoUploadConnectionMonitor$p_2.push(n("Network").addListener("online",function(){e.$VideoUploadConnectionMonitor$p_6(!0)})),this.$VideoUploadConnectionMonitor$p_2.push(n("Network").addListener("offline",function(){e.$VideoUploadConnectionMonitor$p_1?e.$VideoUploadConnectionMonitor$p_5():(e.$VideoUploadConnectionMonitor$p_5.reset(),n("setTimeout")(e.$VideoUploadConnectionMonitor$p_5,2e3))}))),this.$VideoUploadConnectionMonitor$p_3=!0)},r.notifyProgress=function(t){this.$VideoUploadConnectionMonitor$p_3&&t&&n("VideoUploadFeatureDetector").supportsFullProgress()&&(this.$VideoUploadConnectionMonitor$p_1=!0,t.total&&t.loaded===t.total?this.$VideoUploadConnectionMonitor$p_5.reset():this.$VideoUploadConnectionMonitor$p_5())},r.notifySuccess=function(){this.$VideoUploadConnectionMonitor$p_3&&(this.reset(),this.$VideoUploadConnectionMonitor$p_6(!0))},r.notifyTransportError=function(){this.$VideoUploadConnectionMonitor$p_3&&(this.$VideoUploadConnectionMonitor$p_3=!1,this.$VideoUploadConnectionMonitor$p_6(!1))},r.notifyError=function(){this.$VideoUploadConnectionMonitor$p_3&&(this.reset(),this.$VideoUploadConnectionMonitor$p_6(!0))},r.isOnline=function(){return this.$VideoUploadConnectionMonitor$p_4},r.reset=function(){for(;this.$VideoUploadConnectionMonitor$p_2.length;)this.$VideoUploadConnectionMonitor$p_2.pop().remove();this.$VideoUploadConnectionMonitor$p_5.reset(),this.$VideoUploadConnectionMonitor$p_3=!1},r.$VideoUploadConnectionMonitor$p_6=function(t){this.$VideoUploadConnectionMonitor$p_5.reset(),this.$VideoUploadConnectionMonitor$p_4!==t&&(this.$VideoUploadConnectionMonitor$p_4=t,this.$VideoUploadConnectionMonitor$p_4?this.inform("online"):this.inform("offline"))},t})(n("mixin")(n("cr:909282")));a.exports=e}),null);
__d("VideoUploadReceiveRequestManager",["fbt","ODS","ResumableUploadAsyncService","ResumableUploadService","ResumableUploadServiceState.enum","VideoUploadConnectionMonitor","VideoUploadRequest","clearTimeout","cr:909282","err","isEmpty","md5","mixin","setTimeout","uuidv4"],(function(t,n,r,o,a,i,l,s){var e,u,c=1363037,d={INITIAL:"initial",NEXT_CHUNK:"next chunk",INVALID_OFFSET_RETRY:"invalid offset retry",SERVER_FAILURE_RETRY:"server failure retry",TRANSPORT_FAILURE_RETRY:"transport failure retry",TIMEOUT_RETRY:"timeout retry",BACK_ONLINE:"back online"},m=(function(t){function n(e,n,o,a,i,l,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L){var E;return m===void 0&&(m=""),p===void 0&&(p=!1),_===void 0&&(_=!1),f===void 0&&(f=null),g===void 0&&(g=null),h===void 0&&(h=null),y===void 0&&(y=0),C===void 0&&(C=!1),b===void 0&&(b=!1),v===void 0&&(v=!1),S===void 0&&(S=!1),R===void 0&&(R=!1),L===void 0&&(L=0),E=t.call(this)||this,E.$VideoUploadReceiveRequestManager$p_1=e,E.$VideoUploadReceiveRequestManager$p_2=n,E.$VideoUploadReceiveRequestManager$p_3=o!=null?o:0,E.$VideoUploadReceiveRequestManager$p_4=a,E.$VideoUploadReceiveRequestManager$p_5=i,E.$VideoUploadReceiveRequestManager$p_6=l,E.$VideoUploadReceiveRequestManager$p_7=s,E.$VideoUploadReceiveRequestManager$p_8=u,E.$VideoUploadReceiveRequestManager$p_9=c,E.$VideoUploadReceiveRequestManager$p_10=d,E.$VideoUploadReceiveRequestManager$p_11=0,E.$VideoUploadReceiveRequestManager$p_14=0,E.$VideoUploadReceiveRequestManager$p_15=0,E.$VideoUploadReceiveRequestManager$p_16=null,E.$VideoUploadReceiveRequestManager$p_17=null,E.$VideoUploadReceiveRequestManager$p_18=0,E.$VideoUploadReceiveRequestManager$p_19="constructed",E.$VideoUploadReceiveRequestManager$p_13=null,E.$VideoUploadReceiveRequestManager$p_20=null,E.$VideoUploadReceiveRequestManager$p_21=null,E.$VideoUploadReceiveRequestManager$p_22=m,E.$VideoUploadReceiveRequestManager$p_24=_,E.$VideoUploadReceiveRequestManager$p_23=p,E.$VideoUploadReceiveRequestManager$p_25=f,E.$VideoUploadReceiveRequestManager$p_26=!1,E.$VideoUploadReceiveRequestManager$p_27=g,E.$VideoUploadReceiveRequestManager$p_30=C,E.$VideoUploadReceiveRequestManager$p_31=b,E.$VideoUploadReceiveRequestManager$p_32=v,E.$VideoUploadReceiveRequestManager$p_29=y,E.$VideoUploadReceiveRequestManager$p_33=S,E.$VideoUploadReceiveRequestManager$p_28=h,E.$VideoUploadReceiveRequestManager$p_12=r("uuidv4")(),E.$VideoUploadReceiveRequestManager$p_34=R,E.$VideoUploadReceiveRequestManager$p_35=L,E.$VideoUploadReceiveRequestManager$p_40=null,E.$VideoUploadReceiveRequestManager$p_41=null,E.$VideoUploadReceiveRequestManager$p_39=!1,E.$VideoUploadReceiveRequestManager$p_38=null,E.$VideoUploadReceiveRequestManager$p_36=new(r("VideoUploadConnectionMonitor")),E.$VideoUploadReceiveRequestManager$p_36.subscribe("online",E.$VideoUploadReceiveRequestManager$p_49.bind(E)),E.$VideoUploadReceiveRequestManager$p_36.subscribe("offline",E.$VideoUploadReceiveRequestManager$p_50.bind(E)),E}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.updateVideoID=function(t){this.$VideoUploadReceiveRequestManager$p_37.getVideoID()||(this.$VideoUploadReceiveRequestManager$p_37.setVideoID(t),this.$VideoUploadReceiveRequestManager$p_44&&this.$VideoUploadReceiveRequestManager$p_44.setData(this.__createRequestData(this.$VideoUploadReceiveRequestManager$p_37)),this.$VideoUploadReceiveRequestManager$p_51())},a.isResumabilityEnabled=function(){return this.$VideoUploadReceiveRequestManager$p_23},a.isResumableServiceProxyReceiveEnabled=function(){return this.$VideoUploadReceiveRequestManager$p_30},a.sendRequest=function(t){if(this.$VideoUploadReceiveRequestManager$p_19="sending request",this.$VideoUploadReceiveRequestManager$p_44){this.$VideoUploadReceiveRequestManager$p_19="request already in progress";return}this.$VideoUploadReceiveRequestManager$p_18=t.getEndOffset()-t.getStartOffset(),this.$VideoUploadReceiveRequestManager$p_37=t,this.$VideoUploadReceiveRequestManager$p_52(d.INITIAL)},a.cancelRequest=function(){this.$VideoUploadReceiveRequestManager$p_44&&(this.$VideoUploadReceiveRequestManager$p_44.abort(),this.$VideoUploadReceiveRequestManager$p_21!=null&&this.$VideoUploadReceiveRequestManager$p_21.cancel(),this.$VideoUploadReceiveRequestManager$p_53(),this.inform("request-canceled"))},a.appendStateLogData=function(t,n){t[n+"request_manager_state"]=this.$VideoUploadReceiveRequestManager$p_19,t[n+"upload_speed"]=this.$VideoUploadReceiveRequestManager$p_17,t[n+"transport_retries"]=this.$VideoUploadReceiveRequestManager$p_11,t[n+"server_retries"]=this.$VideoUploadReceiveRequestManager$p_14,t[n+"timeout_retries"]=this.$VideoUploadReceiveRequestManager$p_15,t[n+"last_timeout_value"]=this.$VideoUploadReceiveRequestManager$p_42,t[n+"last_request_start_time"]=this.$VideoUploadReceiveRequestManager$p_16,t[n+"pending_request"]=this.$VideoUploadReceiveRequestManager$p_44!=null,t[n+"pending_timer"]=this.$VideoUploadReceiveRequestManager$p_45!=null,t[n+"cached_chunk"]=this.$VideoUploadReceiveRequestManager$p_43!=null,t[n+"early_receive_start"]=this.$VideoUploadReceiveRequestManager$p_39,this.$VideoUploadReceiveRequestManager$p_37!=null&&(t[n+"start_offset"]=this.$VideoUploadReceiveRequestManager$p_37.getStartOffset(),t[n+"end_offset"]=this.$VideoUploadReceiveRequestManager$p_37.getEndOffset(),t[n+"partition_start_offset"]=this.$VideoUploadReceiveRequestManager$p_37.getPartitionStartOffset(),t[n+"partition_end_offset"]=this.$VideoUploadReceiveRequestManager$p_37.getPartitionEndOffset()),this.$VideoUploadReceiveRequestManager$p_36!=null&&(t[n+"connection_monitor_online"]=this.$VideoUploadReceiveRequestManager$p_36.isOnline())},a.getHostName=function(t){try{return new URL(t).hostname}catch(e){return null}},a.$VideoUploadReceiveRequestManager$p_53=function(){this.$VideoUploadReceiveRequestManager$p_44=null,this.$VideoUploadReceiveRequestManager$p_43=null,this.$VideoUploadReceiveRequestManager$p_11=0,this.$VideoUploadReceiveRequestManager$p_14=0,this.$VideoUploadReceiveRequestManager$p_12=r("uuidv4")(),this.$VideoUploadReceiveRequestManager$p_15=0,this.$VideoUploadReceiveRequestManager$p_16=null,this.$VideoUploadReceiveRequestManager$p_17=null,this.$VideoUploadReceiveRequestManager$p_18=0,this.$VideoUploadReceiveRequestManager$p_40=null,this.$VideoUploadReceiveRequestManager$p_41=null,this.$VideoUploadReceiveRequestManager$p_39=!1,this.$VideoUploadReceiveRequestManager$p_26=!1,this.$VideoUploadReceiveRequestManager$p_38=null,this.$VideoUploadReceiveRequestManager$p_37.reset(),this.$VideoUploadReceiveRequestManager$p_36.reset(),r("clearTimeout")(this.$VideoUploadReceiveRequestManager$p_45),this.$VideoUploadReceiveRequestManager$p_45=null},a.$VideoUploadReceiveRequestManager$p_52=function(t,n){if(r("clearTimeout")(this.$VideoUploadReceiveRequestManager$p_45),this.$VideoUploadReceiveRequestManager$p_45=null,this.$VideoUploadReceiveRequestManager$p_20=t,this.$VideoUploadReceiveRequestManager$p_13=r("uuidv4")(),this.$VideoUploadReceiveRequestManager$p_37.getSupportsChunking()&&this.$VideoUploadReceiveRequestManager$p_37.getStartOffset()>=this.$VideoUploadReceiveRequestManager$p_37.getPartitionEndOffset()){n?this.$VideoUploadReceiveRequestManager$p_19="request finished - not notified":(this.inform("request-finished",{start_offset:this.$VideoUploadReceiveRequestManager$p_37.getEndOffset()-1,end_offset:this.$VideoUploadReceiveRequestManager$p_37.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager$p_11,server_retries:this.$VideoUploadReceiveRequestManager$p_14,upload_speed:this.$VideoUploadReceiveRequestManager$p_17,request_manager_state:this.$VideoUploadReceiveRequestManager$p_19,upload_domain:this.$VideoUploadReceiveRequestManager$p_38,debug:{request_reason:this.$VideoUploadReceiveRequestManager$p_20,single_request_id:this.$VideoUploadReceiveRequestManager$p_13}}),this.$VideoUploadReceiveRequestManager$p_19="request finished - notified");return}this.$VideoUploadReceiveRequestManager$p_44=this.__getVideoUploadRequest(this.$VideoUploadReceiveRequestManager$p_1).setAllowCrossOrigin(!0).setData(this.__createRequestData(this.$VideoUploadReceiveRequestManager$p_37)).setWaterfallID(this.$VideoUploadReceiveRequestManager$p_37.getWaterfallID()).setSuccessHandler(this.__handleSuccessResponse.bind(this)).setErrorHandler(this.__handleServerFailureResponse.bind(this)).setTransportErrorHandler(this.$VideoUploadReceiveRequestManager$p_54.bind(this)),this.$VideoUploadReceiveRequestManager$p_23||this.$VideoUploadReceiveRequestManager$p_44.setUploadProgressHandler(this.$VideoUploadReceiveRequestManager$p_55.bind(this)),this.$VideoUploadReceiveRequestManager$p_16=Date.now(),this.$VideoUploadReceiveRequestManager$p_38=this.getHostName(this.$VideoUploadReceiveRequestManager$p_1);var e=!1;if(this.$VideoUploadReceiveRequestManager$p_37.getSupportsChunking()){if(this.$VideoUploadReceiveRequestManager$p_5){var o=this.$VideoUploadReceiveRequestManager$p_56(this.$VideoUploadReceiveRequestManager$p_37.getEndOffset()-this.$VideoUploadReceiveRequestManager$p_37.getStartOffset(),this.$VideoUploadReceiveRequestManager$p_17);this.$VideoUploadReceiveRequestManager$p_44.setTimeoutHandler(o,this.__handleResponseTimeout.bind(this)),this.$VideoUploadReceiveRequestManager$p_19="sending chunk with timeout = "+o,this.$VideoUploadReceiveRequestManager$p_42=o}else this.$VideoUploadReceiveRequestManager$p_19="sending chunk without timeout";var a=this.$VideoUploadReceiveRequestManager$p_57();if(a==null){var i="Provided chunk is null.",l=r("err")(i);l.is_js_error=!0,this.$VideoUploadReceiveRequestManager$p_58({error_description:i,error_is_transient:!1,error:l});return}else this.$VideoUploadReceiveRequestManager$p_23&&this.$VideoUploadReceiveRequestManager$p_29<this.$VideoUploadReceiveRequestManager$p_37.getFile().getSize()?(e=!0,this.$VideoUploadReceiveRequestManager$p_59(a)):this.$VideoUploadReceiveRequestManager$p_44.sendChunk(a)}else this.$VideoUploadReceiveRequestManager$p_19="sending file",this.$VideoUploadReceiveRequestManager$p_44.sendFile(this.$VideoUploadReceiveRequestManager$p_37.getFile().getFileInput());this.$VideoUploadReceiveRequestManager$p_60(e),this.$VideoUploadReceiveRequestManager$p_36.notifyStart(),this.inform("request-started",{start_offset:this.$VideoUploadReceiveRequestManager$p_37.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager$p_37.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager$p_11,server_retries:this.$VideoUploadReceiveRequestManager$p_14,upload_speed:this.$VideoUploadReceiveRequestManager$p_17,request_manager_state:this.$VideoUploadReceiveRequestManager$p_19,upload_domain:this.$VideoUploadReceiveRequestManager$p_38,debug:{request_reason:this.$VideoUploadReceiveRequestManager$p_20,single_request_id:this.$VideoUploadReceiveRequestManager$p_13}})},a.$VideoUploadReceiveRequestManager$p_60=function(t){(this.$VideoUploadReceiveRequestManager$p_37.getSource()==="create_flow"||this.$VideoUploadReceiveRequestManager$p_37.getSource()==="ads_interfaces")&&(u||(u=o("ODS"))).bumpEntityKey(2966,"video_ads_upload",t?"upload_service":"graph_api")},a.$VideoUploadReceiveRequestManager$p_61=function(t,n,r){this.$VideoUploadReceiveRequestManager$p_37.getVideoID()?t(n,r):(this.$VideoUploadReceiveRequestManager$p_40=t,this.$VideoUploadReceiveRequestManager$p_41=n)},a.$VideoUploadReceiveRequestManager$p_51=function(){this.$VideoUploadReceiveRequestManager$p_40&&(this.$VideoUploadReceiveRequestManager$p_40(this.$VideoUploadReceiveRequestManager$p_41),this.$VideoUploadReceiveRequestManager$p_40=null,this.$VideoUploadReceiveRequestManager$p_41=null)},a.$VideoUploadReceiveRequestManager$p_59=function(t){var e,n=this.$VideoUploadReceiveRequestManager$p_37.getFile(),o=n.getFile().lastModified+n.getFile().name+n.getFile().type+this.$VideoUploadReceiveRequestManager$p_62(),a=String(r("md5")(o))+"-"+this.$VideoUploadReceiveRequestManager$p_37.getStartOffset()+"-"+this.$VideoUploadReceiveRequestManager$p_37.getEndOffset(),i=((e=this.$VideoUploadReceiveRequestManager$p_37)==null?void 0:e.getRetryState())==null?this.$VideoUploadReceiveRequestManager$p_14+this.$VideoUploadReceiveRequestManager$p_11+this.$VideoUploadReceiveRequestManager$p_15:this.$VideoUploadReceiveRequestManager$p_37.getRetryState().getTotalRetryCount(),l=this.$VideoUploadReceiveRequestManager$p_34&&this.$VideoUploadReceiveRequestManager$p_35<n.getSize()?["video_upload_www",[this.$VideoUploadReceiveRequestManager$p_12,String(i)].join("_"),[String(this.$VideoUploadReceiveRequestManager$p_37.getWaterfallID()),String(this.$VideoUploadReceiveRequestManager$p_37.getVideoID())].join("_")].join(":"):null;this.isResumabilityEnabled()&&this.$VideoUploadReceiveRequestManager$p_25&&this.$VideoUploadReceiveRequestManager$p_11>this.$VideoUploadReceiveRequestManager$p_2/3&&(this.$VideoUploadReceiveRequestManager$p_26=!0);var s="fb_video";this.$VideoUploadReceiveRequestManager$p_30&&(s="fb_video2");var u=null;if(this.$VideoUploadReceiveRequestManager$p_30||this.$VideoUploadReceiveRequestManager$p_31){var c={};c.start_offset=this.$VideoUploadReceiveRequestManager$p_37.getStartOffset(),c.end_offset=this.$VideoUploadReceiveRequestManager$p_37.getEndOffset(),c.composer_session_id=this.$VideoUploadReceiveRequestManager$p_37.getWaterfallID(),c.upload_session_id=this.$VideoUploadReceiveRequestManager$p_37.getUploadSessionID(),c.product_media_id=this.$VideoUploadReceiveRequestManager$p_37.getVideoID(),c.xpv_asset_id=this.$VideoUploadReceiveRequestManager$p_37.getXPVAssetID(),c.is_xpv_single_prod=this.$VideoUploadReceiveRequestManager$p_37.getIsXPVSingleProd(),c.fb_region=this.$VideoUploadReceiveRequestManager$p_37.getFbRegion(),this.$VideoUploadReceiveRequestManager$p_32&&(c.total_file_size=this.$VideoUploadReceiveRequestManager$p_37.getFile().getSize()),u=c}var d={};d.consumer=s,d.sessionKey=a,d.serviceName=this.$VideoUploadReceiveRequestManager$p_26?null:this.$VideoUploadReceiveRequestManager$p_25,d.serviceDomain=this.$VideoUploadReceiveRequestManager$p_27,d.receiveParameters=u,d.tracingHeaderValue=l;var m;this.$VideoUploadReceiveRequestManager$p_24?m=r("ResumableUploadAsyncService").create(d):m=r("ResumableUploadService").create(d),this.$VideoUploadReceiveRequestManager$p_21=m,this.$VideoUploadReceiveRequestManager$p_38=m.getServiceName(),this.$VideoUploadReceiveRequestManager$p_63(),m.resume(t),this.inform("resumable-called",{debug:{single_request_id:this.$VideoUploadReceiveRequestManager$p_13,authority:this.$VideoUploadReceiveRequestManager$p_38}})},a.$VideoUploadReceiveRequestManager$p_63=function(){var e=this;this.$VideoUploadReceiveRequestManager$p_37.getVideoID()||(this.$VideoUploadReceiveRequestManager$p_39=!0);var t=this.$VideoUploadReceiveRequestManager$p_21;t!=null&&(t.addListener(r("ResumableUploadServiceState.enum").START,function(t){e.inform("resumable-started",{resume_from_offset:t.offset,debug:{single_request_id:e.$VideoUploadReceiveRequestManager$p_13,partition:e.$VideoUploadReceiveRequestManager$p_37.getPartitionNo(),authority:e.$VideoUploadReceiveRequestManager$p_38}})}),this.$VideoUploadReceiveRequestManager$p_46=function(t){e.inform("resumable-failed",{error_code:t.getError(),error_description:t.getErrorDescription(),error_summary:t.getErrorSummary(),error_is_transient:t.isTransient(),debug:{error_source:"service",single_request_id:e.$VideoUploadReceiveRequestManager$p_13,partition:e.$VideoUploadReceiveRequestManager$p_37.getPartitionNo(),authority:e.$VideoUploadReceiveRequestManager$p_38}}),e.__handleServerFailureResponse(t)},t.addListener(r("ResumableUploadServiceState.enum").FAIL,function(t){e.$VideoUploadReceiveRequestManager$p_61(e.$VideoUploadReceiveRequestManager$p_46,t)}),this.$VideoUploadReceiveRequestManager$p_47=function(t){e.$VideoUploadReceiveRequestManager$p_30?e.__handleSuccessResponsePayload({start_offset:e.$VideoUploadReceiveRequestManager$p_37.getEndOffset(),end_offset:e.$VideoUploadReceiveRequestManager$p_37.getPartitionEndOffset()}):(e.$VideoUploadReceiveRequestManager$p_44.setHandle(t),e.$VideoUploadReceiveRequestManager$p_44.sendChunk(null)),e.inform("resumable-success",{everstore_handle:t,debug:{single_request_id:e.$VideoUploadReceiveRequestManager$p_13,partition:e.$VideoUploadReceiveRequestManager$p_37.getPartitionNo(),authority:e.$VideoUploadReceiveRequestManager$p_38}})},t.addListener(r("ResumableUploadServiceState.enum").SUCCESS,function(t){e.$VideoUploadReceiveRequestManager$p_61(e.$VideoUploadReceiveRequestManager$p_47,t)}),this.$VideoUploadReceiveRequestManager$p_48=function(t,n){e.inform("resumable-failed",{error_code:t.getError(),error_description:t.getErrorDescription(),error_summary:t.getErrorSummary(),error_is_transient:t.isTransient(),resume_from_offset:n.offset,debug:{error_source:"transport",single_request_id:e.$VideoUploadReceiveRequestManager$p_13,partition:e.$VideoUploadReceiveRequestManager$p_37.getPartitionNo(),method:n.method,authority:e.$VideoUploadReceiveRequestManager$p_38}}),e.$VideoUploadReceiveRequestManager$p_54(t)},t.addListener(r("ResumableUploadServiceState.enum").TRANSPORT_FAILURE,function(t,n){e.$VideoUploadReceiveRequestManager$p_61(e.$VideoUploadReceiveRequestManager$p_48,t,n)}),t.addListener(r("ResumableUploadServiceState.enum").PROGRESS,function(t){e.$VideoUploadReceiveRequestManager$p_33&&(e.$VideoUploadReceiveRequestManager$p_11=0),e.$VideoUploadReceiveRequestManager$p_55(t)}))},a.__getVideoUploadRequest=function(t){return new(r("VideoUploadRequest"))(t)},a.$VideoUploadReceiveRequestManager$p_64=function(t,n){this.$VideoUploadReceiveRequestManager$p_19="setting request to send after"+n,r("clearTimeout")(this.$VideoUploadReceiveRequestManager$p_45),this.$VideoUploadReceiveRequestManager$p_45=r("setTimeout")(this.$VideoUploadReceiveRequestManager$p_52.bind(this,t),n)},a.$VideoUploadReceiveRequestManager$p_57=function(){if(this.$VideoUploadReceiveRequestManager$p_43)return this.$VideoUploadReceiveRequestManager$p_43;var e=this.$VideoUploadReceiveRequestManager$p_37.getFile();if(this.$VideoUploadReceiveRequestManager$p_23){var t=e.getFile();this.$VideoUploadReceiveRequestManager$p_43=t?t.slice(this.$VideoUploadReceiveRequestManager$p_37.getStartOffset(),this.$VideoUploadReceiveRequestManager$p_37.getEndOffset(),"application/octet-stream"):null}else this.$VideoUploadReceiveRequestManager$p_43=e.getChunk(this.$VideoUploadReceiveRequestManager$p_37.getStartOffset(),this.$VideoUploadReceiveRequestManager$p_37.getEndOffset());return this.$VideoUploadReceiveRequestManager$p_43},a.__createRequestData=function(t){return{composer_session_id:t.getComposerSessionID(),video_id:t.getVideoID(),start_offset:t.getStartOffset(),end_offset:t.getEndOffset(),source:t.getSource(),target_id:t.getTargetID(),waterfall_id:t.getWaterfallID(),composer_entry_point_ref:t.getComposerEntryPointRef&&t.getComposerEntryPointRef(),composer_work_shared_draft_mode:t.getComposerWorkSharedDraftMode(),composer_dialog_version:t.getComposerDialogVersion(),has_file_been_replaced:t.getHasFileBeenReplaced(),supports_chunking:t.getSupportsChunking(),upload_speed:this.$VideoUploadReceiveRequestManager$p_17,partition_start_offset:t.getPartitionStartOffset(),partition_end_offset:t.getPartitionEndOffset()}},a.__handleSuccessResponse=function(t){var e=t.getPayload();this.__handleSuccessResponsePayload(e)},a.__handleSuccessResponsePayload=function(t){this.$VideoUploadReceiveRequestManager$p_19="success response received";var e=Date.now()-(this.$VideoUploadReceiveRequestManager$p_16||0);if(e=e===0?1:e,t.start_offset===this.$VideoUploadReceiveRequestManager$p_37.getEndOffset()){var n=this.$VideoUploadReceiveRequestManager$p_37.getEndOffset()-this.$VideoUploadReceiveRequestManager$p_37.getStartOffset();this.$VideoUploadReceiveRequestManager$p_17=Math.floor(n/e)}else this.$VideoUploadReceiveRequestManager$p_17=null;this.$VideoUploadReceiveRequestManager$p_36.notifySuccess(),this.inform("request-finished",{start_offset:this.$VideoUploadReceiveRequestManager$p_37.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager$p_37.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager$p_11,server_retries:this.$VideoUploadReceiveRequestManager$p_14,upload_speed:this.$VideoUploadReceiveRequestManager$p_17,request_manager_state:this.$VideoUploadReceiveRequestManager$p_19,upload_domain:this.$VideoUploadReceiveRequestManager$p_38,debug:{request_reason:this.$VideoUploadReceiveRequestManager$p_20,single_request_id:this.$VideoUploadReceiveRequestManager$p_13}}),this.$VideoUploadReceiveRequestManager$p_37.setStartOffset(t.start_offset);var o=t.end_offset;this.$VideoUploadReceiveRequestManager$p_37.getClientChunkSize()&&(o=t.start_offset+Math.min(this.$VideoUploadReceiveRequestManager$p_37.getPartitionEndOffset()-t.start_offset,this.$VideoUploadReceiveRequestManager$p_37.getClientChunkSize())),this.$VideoUploadReceiveRequestManager$p_37.setEndOffset(o),this.$VideoUploadReceiveRequestManager$p_37.setLastKnownUploadSpeed(this.$VideoUploadReceiveRequestManager$p_17),this.$VideoUploadReceiveRequestManager$p_44=null,this.$VideoUploadReceiveRequestManager$p_43=null,this.$VideoUploadReceiveRequestManager$p_11=0,this.$VideoUploadReceiveRequestManager$p_14=0,this.$VideoUploadReceiveRequestManager$p_12=r("uuidv4")(),this.$VideoUploadReceiveRequestManager$p_15=0,this.$VideoUploadReceiveRequestManager$p_37.getSupportsChunking()&&this.$VideoUploadReceiveRequestManager$p_52(d.NEXT_CHUNK,!0)},a.$VideoUploadReceiveRequestManager$p_65=function(t){var e,n=this,r=t.getPayload();this.$VideoUploadReceiveRequestManager$p_19="invalid offset response received start="+r.start_offset+" end="+r.end_offset,(this.$VideoUploadReceiveRequestManager$p_37.getStartOffset()!=r.start_offset||this.$VideoUploadReceiveRequestManager$p_37.getEndOffset()!=r.end_offset)&&(this.$VideoUploadReceiveRequestManager$p_37.setStartOffset(r.start_offset),this.$VideoUploadReceiveRequestManager$p_37.setEndOffset(r.end_offset),this.$VideoUploadReceiveRequestManager$p_43=null),((e=this.$VideoUploadReceiveRequestManager$p_37)==null?void 0:e.getRetryState())==null?(this.$VideoUploadReceiveRequestManager$p_14++,this.$VideoUploadReceiveRequestManager$p_52(d.INVALID_OFFSET_RETRY)):this.$VideoUploadReceiveRequestManager$p_37.getRetryState().handleRetry({context:{location:"receive-invalid_offset"},retryHandler:function(t){return n.$VideoUploadReceiveRequestManager$p_64(d.INVALID_OFFSET_RETRY,t)},failureHandler:function(){return n.$VideoUploadReceiveRequestManager$p_66(t)}})},a.__handleServerFailureResponse=function(t){var e=this;if(this.$VideoUploadReceiveRequestManager$p_19="failure response received",this.$VideoUploadReceiveRequestManager$p_44=null,this.$VideoUploadReceiveRequestManager$p_11=0,this.$VideoUploadReceiveRequestManager$p_17=null,this.$VideoUploadReceiveRequestManager$p_15=0,this.$VideoUploadReceiveRequestManager$p_36.notifyError(),this.__hasInvalidStartOffsetAndHasRetries(t.getError()))this.$VideoUploadReceiveRequestManager$p_65(t);else{var n;((n=this.$VideoUploadReceiveRequestManager$p_37)==null?void 0:n.getRetryState())==null?(t.isTransient()||this.$VideoUploadReceiveRequestManager$p_10)&&this.$VideoUploadReceiveRequestManager$p_14<this.$VideoUploadReceiveRequestManager$p_4?(this.$VideoUploadReceiveRequestManager$p_19="transient server error",this.$VideoUploadReceiveRequestManager$p_14++,this.$VideoUploadReceiveRequestManager$p_64(d.SERVER_FAILURE_RETRY,this.$VideoUploadReceiveRequestManager$p_67(this.$VideoUploadReceiveRequestManager$p_9,this.$VideoUploadReceiveRequestManager$p_14,0))):this.$VideoUploadReceiveRequestManager$p_66(t):this.$VideoUploadReceiveRequestManager$p_37.getRetryState().handleRetry({context:{location:"receive-server_issue",error_code:t.getError()},predicate:function(){return t.isTransient()},retryHandler:function(n){e.$VideoUploadReceiveRequestManager$p_19="transient server error",e.$VideoUploadReceiveRequestManager$p_64(d.SERVER_FAILURE_RETRY,n)},failureHandler:function(){return e.$VideoUploadReceiveRequestManager$p_66(t)}})}},a.__handleResponseTimeout=function(t){var e=this,n;this.inform("request-timeout",{start_offset:this.$VideoUploadReceiveRequestManager$p_37.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager$p_37.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager$p_11,server_retries:this.$VideoUploadReceiveRequestManager$p_14,timeout_retries:this.$VideoUploadReceiveRequestManager$p_15,upload_speed:this.$VideoUploadReceiveRequestManager$p_17,request_manager_state:this.$VideoUploadReceiveRequestManager$p_19,debug:{upload_domain:this.$VideoUploadReceiveRequestManager$p_38,single_request_id:this.$VideoUploadReceiveRequestManager$p_13}}),this.$VideoUploadReceiveRequestManager$p_44.abort(),this.$VideoUploadReceiveRequestManager$p_44=null,this.$VideoUploadReceiveRequestManager$p_17=null,this.$VideoUploadReceiveRequestManager$p_36.notifyTransportError();var r=function(){var t=e.$VideoUploadReceiveRequestManager$p_37.getEndOffset()-e.$VideoUploadReceiveRequestManager$p_37.getStartOffset();t=Math.floor(t/2),t=Math.max(t,e.$VideoUploadReceiveRequestManager$p_18);var n=e.$VideoUploadReceiveRequestManager$p_37.getEndOffset();n=Math.min(n,e.$VideoUploadReceiveRequestManager$p_37.getStartOffset()+t),e.$VideoUploadReceiveRequestManager$p_37.setEndOffset(n),e.$VideoUploadReceiveRequestManager$p_43=null,e.$VideoUploadReceiveRequestManager$p_19="resending after timeout with chunksize="+t,e.$VideoUploadReceiveRequestManager$p_52(d.TIMEOUT_RETRY)},o=function(){e.$VideoUploadReceiveRequestManager$p_58({error_code:1006,error_description:s._(/*BTDS*/"Your browser appears to be offline. Please check your internet connection and try again."),error_summary:s._(/*BTDS*/"No Network Connection"),error_is_transient:!0,opes_mids:["fake_mid_network_connection"]})};((n=this.$VideoUploadReceiveRequestManager$p_37)==null?void 0:n.getRetryState())==null?++this.$VideoUploadReceiveRequestManager$p_15<=this.$VideoUploadReceiveRequestManager$p_6?r():o():this.$VideoUploadReceiveRequestManager$p_37.getRetryState().handleRetry({context:{location:"receive-timeout",error_code:1006},retryHandler:function(t){return r()},failureHandler:function(){return o()}})},a.__hasInvalidStartOffsetAndHasRetries=function(t){return t===c&&this.$VideoUploadReceiveRequestManager$p_14<this.$VideoUploadReceiveRequestManager$p_4},a.$VideoUploadReceiveRequestManager$p_54=function(t){var e,n=this;this.$VideoUploadReceiveRequestManager$p_36.notifyTransportError(),this.$VideoUploadReceiveRequestManager$p_17=null,((e=this.$VideoUploadReceiveRequestManager$p_37)==null?void 0:e.getRetryState())==null?(this.$VideoUploadReceiveRequestManager$p_15=0,this.$VideoUploadReceiveRequestManager$p_11<this.$VideoUploadReceiveRequestManager$p_2?(this.$VideoUploadReceiveRequestManager$p_19="resending after transport failure",this.$VideoUploadReceiveRequestManager$p_11++,this.$VideoUploadReceiveRequestManager$p_44=null,this.$VideoUploadReceiveRequestManager$p_64(d.TRANSPORT_FAILURE_RETRY,this.$VideoUploadReceiveRequestManager$p_67(this.$VideoUploadReceiveRequestManager$p_8,this.$VideoUploadReceiveRequestManager$p_11,this.$VideoUploadReceiveRequestManager$p_3))):this.$VideoUploadReceiveRequestManager$p_66(t)):this.$VideoUploadReceiveRequestManager$p_37.getRetryState().handleRetry({context:{location:"receive-transport_issue",error_code:t.getError()},retryHandler:function(t){n.$VideoUploadReceiveRequestManager$p_44=null,n.$VideoUploadReceiveRequestManager$p_19="resending after transport failure",n.$VideoUploadReceiveRequestManager$p_64(d.TRANSPORT_FAILURE_RETRY,t)},failureHandler:function(){return n.$VideoUploadReceiveRequestManager$p_66(t)}})},a.$VideoUploadReceiveRequestManager$p_66=function(n){var t,o,a=[].concat(n==null||(t=n.getPayload())==null||(t=t.error)==null?void 0:t.opes_mids,[n==null?void 0:n.errorMid]).filter(Boolean);this.$VideoUploadReceiveRequestManager$p_58({error_code:n.getError(),error_description:n.getErrorDescription(),error_summary:n.getErrorSummary(),error_is_transient:n.isTransient(),upload_domain:this.uploadDomain,www_request_id:(o=n.getPayload())==null?void 0:o.__www_request_id__,opes_mids:(e||(e=r("isEmpty")))(a)?null:a})},a.$VideoUploadReceiveRequestManager$p_58=function(t){this.$VideoUploadReceiveRequestManager$p_19="handling failure error",t.debug=babelHelpers.extends({},t.debug,{single_request_id:this.$VideoUploadReceiveRequestManager$p_13}),this.inform("request-failed",t),this.$VideoUploadReceiveRequestManager$p_53()},a.$VideoUploadReceiveRequestManager$p_55=function(t){this.$VideoUploadReceiveRequestManager$p_36.notifyProgress(t),this.$VideoUploadReceiveRequestManager$p_37&&this.$VideoUploadReceiveRequestManager$p_37.getFile()&&this.inform("request-progressed",{file_size:this.$VideoUploadReceiveRequestManager$p_37.getFile().getSize(),start_offset:this.$VideoUploadReceiveRequestManager$p_37.getStartOffset(),sent_bytes:t.loaded,transport_retries:this.$VideoUploadReceiveRequestManager$p_11,upload_domain:this.$VideoUploadReceiveRequestManager$p_38,debug:{single_request_id:this.$VideoUploadReceiveRequestManager$p_13}})},a.$VideoUploadReceiveRequestManager$p_49=function(){var e;this.inform("online"),this.$VideoUploadReceiveRequestManager$p_11=0,this.$VideoUploadReceiveRequestManager$p_15=0,(e=this.$VideoUploadReceiveRequestManager$p_37)==null||(e=e.getRetryState())==null||e.resetDelay(),this.$VideoUploadReceiveRequestManager$p_45&&this.$VideoUploadReceiveRequestManager$p_52(d.BACK_ONLINE)},a.$VideoUploadReceiveRequestManager$p_50=function(){this.inform("offline")},a.$VideoUploadReceiveRequestManager$p_67=function(t,n,r){var e=0;return this.$VideoUploadReceiveRequestManager$p_23?e=Math.min(Math.pow(t,n),8)*1e3:e=Math.pow(t,n)*1e3,r>0&&(e=Math.min(e,r)),e},a.$VideoUploadReceiveRequestManager$p_56=function(t,n){var e;n!=null&&n>0?e=n:e=10;var r=Math.floor(t/e*this.$VideoUploadReceiveRequestManager$p_7/100);return Math.max(r,3e4)},a.$VideoUploadReceiveRequestManager$p_62=function(){return this.$VideoUploadReceiveRequestManager$p_28?this.$VideoUploadReceiveRequestManager$p_28:this.$VideoUploadReceiveRequestManager$p_37.getWaterfallID()},n})(r("mixin")(n("cr:909282")));l.default=m}),226);
__d("FileHasher",["FileHashWorkerResource","WebWorker","emptyFunction","fileSliceName"],(function(t,n,r,o,a,i){var e=(function(){"use strict";function e(){var e=this,t=n("FileHashWorkerResource");n("WebWorker").prepareResource(t),this.$1=new(n("WebWorker"))(t).setMessageHandler(function(t){e.$2(t)}).execute()}e.isSupported=function(){return n("WebWorker").isSupported()};var t=e.prototype;return t.hash=function(t,r){return this.$2=r,this.$1.postMessage({file:t,fileSliceName:n("fileSliceName")}),this},t.destroy=function(){this.$2=n("emptyFunction"),this.$1.terminate()},e})();a.exports=e}),null);
__d("VideoUploadStartRequestManager",["Assert","FileHasher","VideoUploadRequest","clearTimeout","cr:909282","isEmpty","mixin","performanceNow","setTimeout"],(function(t,n,r,o,a,i,l){var e,s,u=(function(t){function n(e,n,r,o,a,i,l,s){var u;return u=t.call(this)||this,u.$VideoUploadStartRequestManager1=e,u.$VideoUploadStartRequestManager2=n,u.$VideoUploadStartRequestManager3=r,u.$VideoUploadStartRequestManager4=o,u.$VideoUploadStartRequestManager5=0,u.$VideoUploadStartRequestManager6=a,u.$VideoUploadStartRequestManager7=i,u.$VideoUploadStartRequestManager8=l,u.$VideoUploadStartRequestManager9=s,u.$VideoUploadStartRequestManager10=0,u}babelHelpers.inheritsLoose(n,t);var o=n.prototype;return o.getRequest=function(){return this.$VideoUploadStartRequestManager11},o.sendRequest=function(n){var t=this;this.$VideoUploadStartRequestManager12||this.$VideoUploadStartRequestManager11||(this.$VideoUploadStartRequestManager13=n,this.$VideoUploadStartRequestManager6&&this.$VideoUploadStartRequestManager13.getFile().getFile()&&this.$VideoUploadStartRequestManager13.getFile().getFile().size<this.$VideoUploadStartRequestManager7&&r("FileHasher").isSupported()?(this.$VideoUploadStartRequestManager14=(e||(e=r("performanceNow")))(),this.$VideoUploadStartRequestManager12=new(r("FileHasher")),this.$VideoUploadStartRequestManager12.hash(this.$VideoUploadStartRequestManager13.getFile().getFile(),function(n){t.$VideoUploadStartRequestManager14=(e||(e=r("performanceNow")))()-t.$VideoUploadStartRequestManager14,t.$VideoUploadStartRequestManager15=n.hash,t.$VideoUploadStartRequestManager12.destroy(),t.$VideoUploadStartRequestManager12=null,n.hash||(t.$VideoUploadStartRequestManager16=n.exception),t.$VideoUploadStartRequestManager17()})):this.$VideoUploadStartRequestManager17())},o.$VideoUploadStartRequestManager17=function(){this.$VideoUploadStartRequestManager18(),this.inform("request-started",{hash_time:this.$VideoUploadStartRequestManager14,hash_exception:this.$VideoUploadStartRequestManager16})},o.$VideoUploadStartRequestManager18=function(){r("clearTimeout")(this.$VideoUploadStartRequestManager19),this.$VideoUploadStartRequestManager19=null,this.$VideoUploadStartRequestManager11=this.__getVideoUploadRequest(this.$VideoUploadStartRequestManager1).setAllowCrossOrigin(!0).setData(this.__getDataToSend(this.$VideoUploadStartRequestManager13,this.$VideoUploadStartRequestManager15)).setWaterfallID(this.$VideoUploadStartRequestManager13.getWaterfallID()).setSuccessHandler(this.$VideoUploadStartRequestManager20.bind(this)).setErrorHandler(this.$VideoUploadStartRequestManager21.bind(this)).setTransportErrorHandler(this.$VideoUploadStartRequestManager22.bind(this)),this.$VideoUploadStartRequestManager11.send()},o.__getVideoUploadRequest=function(t){return new(r("VideoUploadRequest"))(t)},o.__getDataToSend=function(t,n){var e={file_size:t.getFile().getSize(),file_extension:t.getFile().getExtension(),target_id:t.getTargetID(),source:t.getSource(),composer_dialog_version:t.getComposerDialogVersion(),waterfall_id:t.getWaterfallID(),composer_session_id:t.getComposerSessionID(),composer_entry_point_ref:t.getComposerEntryPointRef&&t.getComposerEntryPointRef(),composer_work_shared_draft_mode:t.getComposerWorkSharedDraftMode(),has_file_been_replaced:t.getHasFileBeenReplaced(),supports_chunking:t.getSupportsChunking(),supports_file_api:t.getSupportsFileAPI(),partition_start_offset:t.getPartitionStartOffset(),partition_end_offset:t.getPartitionEndOffset(),creator_product:t.getCreatorProduct(),original_file_hash:n,spherical:t.getIsSphericalVideo(),spherical_metadata:t.getSphericalMetadata(),video_publisher_action_source:t.getVideoPublisherActionSource()};return t.getCreativeTools()!=null&&(e.creative_tools=t.getCreativeTools()),e},o.cancelRequest=function(){this.$VideoUploadStartRequestManager23(),this.inform("request-canceled")},o.$VideoUploadStartRequestManager24=function(t){r("clearTimeout")(this.$VideoUploadStartRequestManager19),this.$VideoUploadStartRequestManager19=r("setTimeout")(this.$VideoUploadStartRequestManager18.bind(this),t)},o.$VideoUploadStartRequestManager23=function(){this.$VideoUploadStartRequestManager12&&(this.$VideoUploadStartRequestManager12.destroy(),this.$VideoUploadStartRequestManager12=null),this.$VideoUploadStartRequestManager11&&(this.$VideoUploadStartRequestManager11.abort(),this.$VideoUploadStartRequestManager11=null),this.$VideoUploadStartRequestManager10=0,this.$VideoUploadStartRequestManager5=0,this.$VideoUploadStartRequestManager13=null,r("clearTimeout")(this.$VideoUploadStartRequestManager19),this.$VideoUploadStartRequestManager19=null},o.$VideoUploadStartRequestManager25=function(t,n,r){var e=Math.pow(t,n)*1e3;return r>0&&(e=Math.min(e,r)),e},o.$VideoUploadStartRequestManager20=function(t){var e;(e=this.$VideoUploadStartRequestManager13)==null||(e=e.getRetryState())==null||e.resetDelay();var n=t.getPayload();this.inform("request-finished",this.__getSuccessInformData(n)),this.$VideoUploadStartRequestManager11=null,r("Assert").isTrue(this.$VideoUploadStartRequestManager12==null,"Unexpected: if file hasher is not null, clean up is required.")},o.__getSuccessInformData=function(t){return{video_id:t.video_id,xpv_asset_id:t.xpv_asset_id,is_xpv_single_prod:t.is_xpv_single_prod,upload_session_id:t.upload_session_id,fb_region:t.region_hint,start_offset:t.start_offset,end_offset:t.end_offset,transport_retries:this.$VideoUploadStartRequestManager5,server_retries:this.$VideoUploadStartRequestManager10,skip_upload:t.skip_upload,hash_time:this.$VideoUploadStartRequestManager14}},o.$VideoUploadStartRequestManager26=function(t){this.inform("request-failed",this.$VideoUploadStartRequestManager27(t)),this.$VideoUploadStartRequestManager11=null,r("Assert").isTrue(this.$VideoUploadStartRequestManager12==null,"Unexpected: if file hasher is not null, clean up is required.")},o.$VideoUploadStartRequestManager21=function(t){var e,n=this;this.$VideoUploadStartRequestManager11=null;var r=(e=this.$VideoUploadStartRequestManager13)==null?void 0:e.getRetryState();r==null?(this.$VideoUploadStartRequestManager5=0,t.isTransient()&&this.$VideoUploadStartRequestManager10<this.$VideoUploadStartRequestManager8?(this.$VideoUploadStartRequestManager10++,this.$VideoUploadStartRequestManager24(this.$VideoUploadStartRequestManager25(this.$VideoUploadStartRequestManager9,this.$VideoUploadStartRequestManager10))):this.$VideoUploadStartRequestManager26(t)):r.handleRetry({context:{location:"start-server_issue",error_code:t.getError()},predicate:function(){return t.isTransient()},retryHandler:function(t){n.$VideoUploadStartRequestManager10=r.getTotalRetryCount(),n.$VideoUploadStartRequestManager24(t)},failureHandler:function(){return n.$VideoUploadStartRequestManager26(t)}})},o.$VideoUploadStartRequestManager22=function(t){var e,n=this;((e=this.$VideoUploadStartRequestManager13)==null?void 0:e.getRetryState())==null?this.$VideoUploadStartRequestManager2===0||this.$VideoUploadStartRequestManager5>=this.$VideoUploadStartRequestManager2?this.$VideoUploadStartRequestManager26(t):(this.$VideoUploadStartRequestManager5++,this.$VideoUploadStartRequestManager11=null,this.$VideoUploadStartRequestManager24(this.$VideoUploadStartRequestManager25(this.$VideoUploadStartRequestManager3,this.$VideoUploadStartRequestManager5,this.$VideoUploadStartRequestManager4))):this.$VideoUploadStartRequestManager13.getRetryState().handleRetry({context:{location:"start-transport_issue",error_code:t.getError()},retryHandler:function(t){n.$VideoUploadStartRequestManager11=null,n.$VideoUploadStartRequestManager24(t)},failureHandler:function(){return n.$VideoUploadStartRequestManager26(t)}})},o.$VideoUploadStartRequestManager27=function(t){var e,n,o=[].concat(t==null||(e=t.getPayload())==null||(e=e.error)==null?void 0:e.opes_mids,[t==null?void 0:t.errorMid]).filter(Boolean);return{error_code:t.getError(),error_description:t.getErrorDescription(),error_summary:t.getErrorSummary(),transport_retries:this.$VideoUploadStartRequestManager5,server_retries:this.$VideoUploadStartRequestManager10,error_is_transient:t.isTransient(),www_request_id:(n=t.getPayload())==null?void 0:n.__www_request_id__,opes_mids:(s||(s=r("isEmpty")))(o)?null:o}},n})(r("mixin")(n("cr:909282"))),c=u;l.default=c}),98);
__d("VideoUploadSession",["AsyncRequest","GraphQLVideoPublishUtils","SubscriptionsHandler","VideoUploadCrashMonitor","VideoUploadFeatureDetector","VideoUploadFileValidator","VideoUploadGraphQLPostRequestManager","VideoUploadLogger","VideoUploadMetadataParser","VideoUploadPostRequestManager","VideoUploadReceiveRequestManager","VideoUploadRequestContext","VideoUploadStartRequestManager","WaterfallIDGenerator","cr:909282","err","getByPath","mixin"],(function(t,n,r,o,a,i){var e={CANCELED:"canceled",ABANDONED:"abandoned",SHUTDOWN:"shutdown"},l=(function(t){"use strict";function r(e){var r;if(r=t.call(this)||this,r.$VideoUploadSession2=e.source,r.$VideoUploadSession3=e.composer_dialog_version,r.$VideoUploadSession4=e.target_id,r.$VideoUploadSession5=e.logging_delay,r.$VideoUploadSession6=e.silent_file_validation,r.$VideoUploadSession7=e.background_upload,r.$VideoUploadSession8=e.actor_id,r.$VideoUploadSession9=e.composer_entry_point_ref,r.$VideoUploadSession10=e.composer_work_shared_draft_mode,r.$VideoUploadSession11=e.video_publisher_action_source,r.$VideoUploadSession12=e.monitor_crashes,r.$VideoUploadSession13=e.isMultiMediaPost,r.$VideoUploadSession14=e.container_type,r.$VideoUploadSession15=e.number_of_partitions,r.$VideoUploadSession16=e.multi_partitioning_enabled,r.$VideoUploadSession17=e.change_default_chunk_size,r.$VideoUploadSession18=e.has_file_been_replaced?e.has_file_been_replaced:!1,r.$VideoUploadSession17&&(r.$VideoUploadSession19=e.client_chunk_size),r.$VideoUploadSession20=e.early_receive,r.$VideoUploadSession21=!1,r.$VideoUploadSession22=e.accept_dimensions_from_player,r.$VideoUploadSession23=e.ad_account_id,r.$VideoUploadSession24=e.waterfall_id,r.$VideoUploadSession25=null,r.$VideoUploadSession26=new(n("VideoUploadFileValidator"))({minSize:e.min_size,maxSize:e.max_size,minLength:e.min_length,maxLength:e.max_length,minWidth:e.min_width,minHeight:e.min_height,extensions:e.extensions,source:e.source,require16to9AspectRatio:e.require_16to9_aspect_ratio,minAspectRatio:e.min_aspect_ratio,maxAspectRatio:e.max_aspect_ratio,acceptDimensionsFromPlayer:e.accept_dimensions_from_player}),r.$VideoUploadSession27=n("VideoUploadFeatureDetector").supportsChunking(),r.$VideoUploadSession28=n("VideoUploadFeatureDetector").supportsFileAPI(),r.$VideoUploadSession27?(r.$VideoUploadSession29=e.parallel_chunk_uploads,r.$VideoUploadSession29&&(r.$VideoUploadSession30=e.parallel_chunk_upload_filesize,r.$VideoUploadSession31=e.default_chunk_size)):r.$VideoUploadSession29=!1,r.$VideoUploadSession32=e.shutdown_logging_enabled,r.$VideoUploadSession33=r.$VideoUploadSession$p_34(e),r.$VideoUploadSession35=r.$VideoUploadSession$p_36(e),r.$VideoUploadSession29)if(r.$VideoUploadSession16){var o=0;for(r.$VideoUploadSession37=[],o=0;o<r.$VideoUploadSession15-1;o++)r.$VideoUploadSession37[o]=r.$VideoUploadSession$p_36(e)}else r.$VideoUploadSession37=r.$VideoUploadSession$p_36(e);return r.$VideoUploadSession38=r.$VideoUploadSession$p_39(e),r.$VideoUploadSession40=r.$VideoUploadSession$p_41(e),r.$VideoUploadSession42=e.log_free_local_storage,r.$VideoUploadSession43=null,r}babelHelpers.inheritsLoose(r,t);var o=r.prototype;return o.$VideoUploadSession$p_44=function(){this.$VideoUploadSession45=[],this.$VideoUploadSession46=[],this.$VideoUploadSession47=[],this.$VideoUploadSession48=[],this.$VideoUploadSession49=[];var e=0;for(e=0;e<this.$VideoUploadSession1-1;e++)this.$VideoUploadSession45.push(!1)},o.$VideoUploadSession$p_50=function(){var e;this.$VideoUploadSession24==null&&(this.$VideoUploadSession24=n("WaterfallIDGenerator").generate()),this.$VideoUploadSession51=new(n("VideoUploadLogger"))({actor_id:this.$VideoUploadSession8,ad_account_id:this.$VideoUploadSession23,source:this.$VideoUploadSession2,composer_dialog_version:this.$VideoUploadSession3,waterfall_id:this.$VideoUploadSession24,target_id:this.$VideoUploadSession4,delay:this.$VideoUploadSession5,is_chunked_upload:this.$VideoUploadSession27,composer_entry_point_ref:this.$VideoUploadSession9,composer_work_shared_draft_mode:this.$VideoUploadSession10,container_type:this.$VideoUploadSession14,has_file_been_replaced:this.$VideoUploadSession18,composer_session_id:this.$VideoUploadSession52,asset_id:(e=this.$VideoUploadSession53)==null?void 0:e.getStableAssetID(),creative_tools:this.$VideoUploadSession54}),this.inform("set-waterfall-id",{waterfallID:this.$VideoUploadSession24})},o.createTestLogger=function(){this.$VideoUploadSession$p_50()},o.$VideoUploadSession$p_55=function(){return this.$VideoUploadSession51||this.$VideoUploadSession$p_50(),this.$VideoUploadSession51},o.getLogger=function(){return this.$VideoUploadSession51?this.$VideoUploadSession51:null},o.$VideoUploadSession$p_56=function(){return null},o.start=function(t){var e=this;this.$VideoUploadSession57=null,this.$VideoUploadSession58=null,this.$VideoUploadSession59=null,this.$VideoUploadSession60=!1,this.$VideoUploadSession61=!1,this.$VideoUploadSession62=null,this.$VideoUploadSession53=t,this.$VideoUploadSession63=0,this.$VideoUploadSession64=!1,this.$VideoUploadSession65={sphericalMetadataXml:null,fbSpatialAudioMetadataXml:null,ytSa3dMetadataJson:null},this.$VideoUploadSession66=!1,this.$VideoUploadSession43=this.$VideoUploadSession$p_56(),this.$VideoUploadSession$p_50(),this.$VideoUploadSession16&&(this.$VideoUploadSession1=Math.min(this.$VideoUploadSession15,Math.ceil(this.$VideoUploadSession53.getSize()/this.$VideoUploadSession30))),this.__logEvent(n("VideoUploadLogger").EVENT_REQUESTED_UPLOADING),this.inform("upload-requested");var r=new(n("VideoUploadMetadataParser"))(this.$VideoUploadSession53,this.$VideoUploadSession$p_67.bind(this),this.$VideoUploadSession22);r.parse(),this.$VideoUploadSession42&&navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota(function(t,r){e.__logEvent(n("VideoUploadLogger").EVENT_MEASURE_FREE_LOCAL_STORAGE,{free_space_in_device:r})})},o.setTargetID=function(t){this.$VideoUploadSession4=t},o.setComposerSessionID=function(t){this.$VideoUploadSession52=t},o.setCreativeTools=function(t){this.$VideoUploadSession54=t},o.post=function(t){this.__logEvent(n("VideoUploadLogger").EVENT_STARTED_POST_REQUEST,this.$VideoUploadSession25),this.inform("post-started",t);var e=this.__createPostRequestContext(t);if(n("GraphQLVideoPublishUtils").isGraphQLPublish(this.$VideoUploadSession2,this.$VideoUploadSession9)&&this.$VideoUploadSession40.hasAPISupport(t)){this.$VideoUploadSession40.sendRequest(e),this.$VideoUploadSession68=t;return}this.$VideoUploadSession38.sendRequest(e),this.$VideoUploadSession68=t},o.__createPostRequestContext=function(t){var e=new(n("VideoUploadRequestContext"));return this.__setupPostRequestContext(e,t),e},o.__setupPostRequestContext=function(t,n){t.setMetadata(n).setVideoID(this.$VideoUploadSession57).setTargetID(this.$VideoUploadSession4).setSource(this.$VideoUploadSession2).setComposerDialogVersion(this.$VideoUploadSession3).setComposerWorkSharedDraftMode(this.$VideoUploadSession10).setWaterfallID(this.$VideoUploadSession24).setComposerSessionID(this.$VideoUploadSession52).setSupportsChunking(this.$VideoUploadSession27).setCreatorProduct(this.$VideoUploadSession53.getCreatorProduct()).setFile(this.$VideoUploadSession53).setHasFileBeenReplaced(this.$VideoUploadSession18),n&&(n.spherical&&(this.$VideoUploadSession64=!0,t.setIsSphericalVideo(this.$VideoUploadSession64)),n.enable_omnistab&&(this.$VideoUploadSession66=!0,t.setEnableOmnistab(this.$VideoUploadSession66))),t.setComposerEntryPointRef&&t.setComposerEntryPointRef(this.$VideoUploadSession9)},o.$VideoUploadSession$p_69=function(o,a){if(this.$VideoUploadSession60){var t={event_reason:a,debug:babelHelpers.extends({},this.__fetchReceiveRequestManagerStateLogData(),{is_background_upload:this.$VideoUploadSession7})},i=a===e.CANCELED?n("VideoUploadLogger").EVENT_CANCELED_UPLOADING:n("VideoUploadLogger").EVENT_ABANDONED_UPLOADING;this.$VideoUploadSession$p_70(),this.$VideoUploadSession7?(this.$VideoUploadSession61||this.__logEvent(i),this.$VideoUploadSession71&&(this.__logEvent(n("VideoUploadLogger").EVENT_CANCELED_FLOW,t),this.$VideoUploadSession71=!1)):(this.__logEvent(i),this.__logEvent(n("VideoUploadLogger").EVENT_CANCELED_FLOW,t)),this.inform("upload-canceled")}else o&&this.$VideoUploadSession57&&r.deleteVideo(this.$VideoUploadSession57)},o.cancel=function(n){n===void 0&&(n=!1),this.$VideoUploadSession$p_69(n,e.CANCELED)},o.abandon=function(n){n===void 0&&(n=!1),this.$VideoUploadSession$p_69(n,e.ABANDONED)},o.isPostInProgress=function(){return this.$VideoUploadSession38.isInProgress()},o.isInProgress=function(){return this.$VideoUploadSession60},o.getHasUploadFinished=function(){return this.$VideoUploadSession61},o.getVideoID=function(){return this.$VideoUploadSession57},o.getUploadTime=function(){return this.$VideoUploadSession72},o.getExPartitionNumber=function(t){var e=0;for(e=0;e<this.$VideoUploadSession1-1&&!(t>=this.$VideoUploadSession46[e]&&t<this.$VideoUploadSession47[e]);e++);return e===this.$VideoUploadSession1?-1:e},o.getIsSphericalVideo=function(){return this.$VideoUploadSession64||!1},o.getVideoMetadata=function(){return this.$VideoUploadSession25||null},o.startFlow=function(){!this.$VideoUploadSession7||this.$VideoUploadSession71||(this.__logEvent(n("VideoUploadLogger").EVENT_STARTED_FLOW,{is_spherical:this.getIsSphericalVideo()?"true":null}),this.$VideoUploadSession71=!0,this.$VideoUploadSession73&&this.$VideoUploadSession73.flowStarted())},o.__extractVideoMetadata=function(t){var e,r=(e=n("getByPath"))(t,["streams","primaryVideo"]),o={source_height:e(r,["height"]),source_width:e(r,["width"]),duration:e(r,["duration"])*1e3};return o.original_video_duration=o.duration,o},o.$VideoUploadSession$p_67=function(t){var e,r;if(this.$VideoUploadSession6){var o=this.$VideoUploadSession26.getValidationErrorMessage(this.$VideoUploadSession53,t);if(o){var a=n("err")(o.summary);a.is_js_error=!0,r={error_summary:o.summary,error_description:o.description,error:a},e=!1}else e=!0}else e=this.$VideoUploadSession26.validate(this.$VideoUploadSession53,t);if(!e){this.__logEvent(n("VideoUploadLogger").EVENT_INVALIDATED_UPLOADING),this.inform("upload-failed",r);return}if(this.$VideoUploadSession25=this.__extractVideoMetadata(t),t&&t.format&&(this.$VideoUploadSession64=t.format.isSpherical,t.metadata&&(this.$VideoUploadSession65.sphericalMetadataXml=t.metadata.sphericalMetadataXml,this.$VideoUploadSession65.fbSpatialAudioMetadataXml=t.metadata.fbSpatialAudioMetadataXml,this.$VideoUploadSession65.ytSa3dMetadataJson=t.metadata.ytSa3dMetadataJson)),this.$VideoUploadSession7||this.__logEvent(n("VideoUploadLogger").EVENT_STARTED_FLOW,{is_spherical:this.getIsSphericalVideo()?"true":null}),this.$VideoUploadSession74=this.$VideoUploadSession29&&this.$VideoUploadSession53.getSize()>=this.$VideoUploadSession30,this.$VideoUploadSession75=!1,this.$VideoUploadSession76=0,this.$VideoUploadSession77=this.$VideoUploadSession76,this.$VideoUploadSession78=0,this.$VideoUploadSession16?this.$VideoUploadSession$p_44():this.$VideoUploadSession45=!1,this.$VideoUploadSession74)if(this.$VideoUploadSession16){var i=0;this.$VideoUploadSession79=Math.ceil(this.$VideoUploadSession53.getSize()/this.$VideoUploadSession1);var l=this.$VideoUploadSession79,s=this.$VideoUploadSession79;for(i=0;i<this.$VideoUploadSession1-1;i++)this.$VideoUploadSession46[i]=l,l=Math.min(this.$VideoUploadSession46[i]+s,this.$VideoUploadSession53.getSize()),this.$VideoUploadSession47[i]=l,this.$VideoUploadSession48[i]=this.$VideoUploadSession46[i],this.$VideoUploadSession49[i]=0}else this.$VideoUploadSession79=Math.floor(this.$VideoUploadSession53.getSize()/2),this.$VideoUploadSession46=this.$VideoUploadSession79,this.$VideoUploadSession48=this.$VideoUploadSession46,this.$VideoUploadSession49=0,this.$VideoUploadSession47=this.$VideoUploadSession53.getSize();else this.$VideoUploadSession79=this.$VideoUploadSession53.getSize();var u=new(n("VideoUploadRequestContext"))().setFile(this.$VideoUploadSession53).setTargetID(this.$VideoUploadSession4).setSource(this.$VideoUploadSession2).setComposerDialogVersion(this.$VideoUploadSession3).setComposerWorkSharedDraftMode(this.$VideoUploadSession10).setWaterfallID(this.$VideoUploadSession24).setComposerSessionID(this.$VideoUploadSession52).setHasFileBeenReplaced(this.$VideoUploadSession18).setSupportsChunking(this.$VideoUploadSession27).setSupportsFileAPI(this.$VideoUploadSession28).setCreatorProduct(this.$VideoUploadSession53.getCreatorProduct()).setPartitionStartOffset(this.$VideoUploadSession76).setPartitionEndOffset(this.$VideoUploadSession79).setRetryState(this.$VideoUploadSession43).setCreativeTools(this.$VideoUploadSession54);this.$VideoUploadSession29&&u.setUseParallelChunks(this.$VideoUploadSession29),this.$VideoUploadSession64&&(u.setIsSphericalVideo(this.$VideoUploadSession64),u.setSphericalMetadata(this.$VideoUploadSession65)),u.setComposerEntryPointRef&&u.setComposerEntryPointRef(this.$VideoUploadSession9),u.setVideoPublisherActionSource(this.$VideoUploadSession11),this.$VideoUploadSession$p_80(),this.$VideoUploadSession33.sendRequest(u),this.$VideoUploadSession20&&this.$VideoUploadSession17&&this.$VideoUploadSession35.isResumabilityEnabled()&&!this.$VideoUploadSession35.isResumableServiceProxyReceiveEnabled()&&this.$VideoUploadSession$p_81(),this.inform("metadata-parsed",t)},o.$VideoUploadSession$p_34=function(t){var e=this.$VideoUploadSession27?t.chunk_start_uri:t.start_uri,n=this.__getVideoUploadStartRequestManager(e,t.start_max_transport_retries,t.start_transport_retry_interval_base,t.start_max_transport_retry_timeout,t.skip_upload_enabled,t.skip_upload_file_size_limit,t.start_max_server_retries,t.start_server_retry_interval_base);return n.subscribe("request-started",this.$VideoUploadSession$p_82.bind(this)),n.subscribe("request-finished",this.$VideoUploadSession$p_83.bind(this)),n.subscribe("request-failed",this.$VideoUploadSession$p_84.bind(this)),n.subscribe("request-canceled",this.$VideoUploadSession$p_85.bind(this)),n},o.$VideoUploadSession$p_36=function(t){var e=this.$VideoUploadSession27?t.chunk_receive_uri:t.receive_uri,n=this.__getVideoUploadReceiveRequestManager(e,t);return n.subscribe("request-started",this.$VideoUploadSession$p_86.bind(this)),n.subscribe("request-progressed",this.$VideoUploadSession$p_87.bind(this)),n.subscribe("request-finished",this.$VideoUploadSession$p_88.bind(this)),n.subscribe("request-failed",this.$VideoUploadSession$p_89.bind(this)),n.subscribe("request-canceled",this.$VideoUploadSession$p_90.bind(this)),n.subscribe("request-timeout",this.$VideoUploadSession$p_91.bind(this)),n.subscribe("online",this.$VideoUploadSession$p_92.bind(this)),n.subscribe("offline",this.$VideoUploadSession$p_93.bind(this)),n.subscribe("resumable-called",this.$VideoUploadSession$p_94.bind(this)),n.subscribe("resumable-started",this.$VideoUploadSession$p_95.bind(this)),n.subscribe("resumable-success",this.$VideoUploadSession$p_96.bind(this)),n.subscribe("resumable-failed",this.$VideoUploadSession$p_97.bind(this)),n},o.$VideoUploadSession$p_39=function(t){var e=this.$VideoUploadSession27?t.chunk_post_uri:t.post_uri,n=this.__getVideoUploadPostRequestManager(e,t);return n.subscribe("request-finished",this.__handlePostRequestFinished.bind(this)),n.subscribe("request-failed",this.$VideoUploadSession$p_98.bind(this)),n},o.$VideoUploadSession$p_41=function(t){var e=new(n("VideoUploadGraphQLPostRequestManager"))(isNaN(t.post_max_transport_retries)?0:t.post_max_transport_retries,isNaN(t.post_transport_retry_interval_base)?0:t.post_transport_retry_interval_base,isNaN(t.post_max_server_retries)?0:t.post_max_server_retries,isNaN(t.post_server_retry_interval_base)?0:t.post_server_retry_interval_base);return e.subscribe("request-finished",this.__handlePostRequestFinished.bind(this)),e.subscribe("request-failed",this.$VideoUploadSession$p_98.bind(this)),e},o.$VideoUploadSession$p_82=function(t,r){this.__logEvent(n("VideoUploadLogger").EVENT_STARTED_UPLOADING,babelHelpers.extends({hash_time:r.hash_time,hash_exception:r.hash_exception},this.$VideoUploadSession25)),this.__logEvent(n("VideoUploadLogger").EVENT_STARTED_START_REQUEST,this.$VideoUploadSession25),this.$VideoUploadSession99=Date.now(),this.inform("upload-started")},o.$VideoUploadSession$p_81=function(t){if(this.$VideoUploadSession21)this.$VideoUploadSession$p_100();else{this.$VideoUploadSession21=!0,t||(t={video_id:null});var e=this.__createReceiveRequestContext(t,!1);if(this.$VideoUploadSession35.sendRequest(e),this.$VideoUploadSession74)if(this.$VideoUploadSession16){var n=0;for(n=0;n<this.$VideoUploadSession1-1;n++)e=this.__createReceiveRequestContext(t,!0,n),this.$VideoUploadSession37[n].sendRequest(e)}else e=this.__createReceiveRequestContext(t,!0),this.$VideoUploadSession37.sendRequest(e)}},o.$VideoUploadSession$p_100=function(){if(this.$VideoUploadSession35.updateVideoID(this.$VideoUploadSession57),this.$VideoUploadSession74)if(this.$VideoUploadSession16){var e=0;for(e=0;e<this.$VideoUploadSession1-1;e++)this.$VideoUploadSession37[e].updateVideoID(this.$VideoUploadSession57)}else this.$VideoUploadSession37.updateVideoID(this.$VideoUploadSession57)},o.$VideoUploadSession$p_101=function(t){return this.$VideoUploadSession43==null?((t==null?void 0:t.transport_retries)||0)+((t==null?void 0:t.server_retries)||0)+((t==null?void 0:t.timeout_retries)||0):this.$VideoUploadSession43.getTotalRetryCount()},o.$VideoUploadSession$p_83=function(t,r){this.__logEvent(n("VideoUploadLogger").EVENT_PROGRESS_UPLOADING_START_REQUEST,{retries:this.$VideoUploadSession$p_101(r),transport_retries:r.transport_retries,hash_time:r.hash_time,skip_upload:r.skip_upload?1:null}),this.__logEvent(n("VideoUploadLogger").EVENT_FINISHED_START_REQUEST,babelHelpers.extends({video_id:r.video_id},this.$VideoUploadSession25)),this.$VideoUploadSession57=r.video_id,this.$VideoUploadSession58=r.upload_session_id,this.$VideoUploadSession59=r.fb_region,this.$VideoUploadSession102=r.skip_upload,r.skip_upload?(this.$VideoUploadSession$p_103(),this.inform("upload-progressed",{start_offset:0,end_offset:this.$VideoUploadSession53.getSize(),file_size:this.$VideoUploadSession53.getSize(),sent_bytes:this.$VideoUploadSession53.getSize(),video_id:r.video_id,skip_upload:r.skip_upload}),this.$VideoUploadSession7&&this.__logFinishedUploading(),this.inform("upload-finished",{start_offset:0,end_offset:this.$VideoUploadSession53.getSize(),video_id:r.video_id,is_spherical_video:this.$VideoUploadSession64})):this.$VideoUploadSession$p_81(r)},o.__fetchReceiveRequestManagerStateLogData=function(){var e={};if(this.$VideoUploadSession35!=null&&(this.$VideoUploadSession35.appendStateLogData(e,"requestManager_"),e.request_manager_state=e.requestManager_last_log_state),this.$VideoUploadSession16){var t=0;for(t=0;t<this.$VideoUploadSession1-1;t++)this.$VideoUploadSession37[t]!=null&&this.$VideoUploadSession37[t].appendStateLogData(e,"requestManagerEx_"+t.toString())}else this.$VideoUploadSession37!=null&&this.$VideoUploadSession37.appendStateLogData(e,"requestManagerEx_");return e},o.__createReceiveRequestContext=function(t,r,o){r||(r=!1);var e=new(n("VideoUploadRequestContext"));return this.$VideoUploadSession16?this.__setupReceiveRequestContext(e,t,r,o):this.__setupReceiveRequestContext(e,t,r),e},o.__setupReceiveRequestContext=function(t,n,r,o){var e,a,i,l;r?this.$VideoUploadSession16?(this.$VideoUploadSession17&&(this.$VideoUploadSession31=this.$VideoUploadSession47[o]-this.$VideoUploadSession46[o],this.$VideoUploadSession31=this.$VideoUploadSession19?Math.min(this.$VideoUploadSession19,this.$VideoUploadSession31):this.$VideoUploadSession31),e=this.$VideoUploadSession46[o],a=this.$VideoUploadSession47[o],i=this.$VideoUploadSession46[o],l=this.$VideoUploadSession46[o]+this.$VideoUploadSession31>=this.$VideoUploadSession47[o]?this.$VideoUploadSession47[o]:this.$VideoUploadSession46[o]+this.$VideoUploadSession31):(this.$VideoUploadSession17&&(this.$VideoUploadSession31=this.$VideoUploadSession47-this.$VideoUploadSession46,this.$VideoUploadSession31=this.$VideoUploadSession19?Math.min(this.$VideoUploadSession19,this.$VideoUploadSession31):this.$VideoUploadSession31),e=this.$VideoUploadSession46,a=this.$VideoUploadSession47,i=this.$VideoUploadSession46,l=this.$VideoUploadSession46+this.$VideoUploadSession31>=this.$VideoUploadSession47?this.$VideoUploadSession47:this.$VideoUploadSession46+this.$VideoUploadSession31):(e=this.$VideoUploadSession76,a=this.$VideoUploadSession79,this.$VideoUploadSession17?(i=this.$VideoUploadSession76,l=this.$VideoUploadSession19?Math.min(this.$VideoUploadSession19,this.$VideoUploadSession79):this.$VideoUploadSession79):(i=n.start_offset,l=n.end_offset)),t.setFile(this.$VideoUploadSession53).setVideoID(n.video_id).setXPVAssetID(n.xpv_asset_id).setIsXPVSingleProd(n.is_xpv_single_prod).setUploadSessionID(n.upload_session_id).setFbRegion(n.fb_region).setStartOffset(i).setEndOffset(l).setPartitionStartOffset(e).setPartitionEndOffset(a).setPartitionNo(o).setTargetID(this.$VideoUploadSession4).setSource(this.$VideoUploadSession2).setComposerDialogVersion(this.$VideoUploadSession3).setComposerWorkSharedDraftMode(this.$VideoUploadSession10).setWaterfallID(this.$VideoUploadSession24).setComposerSessionID(this.$VideoUploadSession52).setSupportsChunking(this.$VideoUploadSession27).setHasFileBeenReplaced(this.$VideoUploadSession18).setRetryState(this.$VideoUploadSession43),this.$VideoUploadSession29&&t.setUseParallelChunks(this.$VideoUploadSession29),t.setComposerEntryPointRef&&t.setComposerEntryPointRef(this.$VideoUploadSession9),this.$VideoUploadSession19&&t.setClientChunkSize(this.$VideoUploadSession19)},o.$VideoUploadSession$p_84=function(t,r){var e=this.__getLogErrorData(r);this.__logEvent(n("VideoUploadLogger").EVENT_FAILED_START_REQUEST,e),this.__logEvent(n("VideoUploadLogger").EVENT_FAILED_UPLOADING,e);var o=r.error_is_transient?n("VideoUploadLogger").EVENT_RESIGNED_FLOW:n("VideoUploadLogger").EVENT_FAILED_FLOW;this.$VideoUploadSession7?this.$VideoUploadSession71&&(this.__logEvent(o),this.$VideoUploadSession71=!1):this.__logEvent(o),this.$VideoUploadSession$p_103(),this.$VideoUploadSession$p_104(),this.inform("upload-failed",r)},o.$VideoUploadSession$p_85=function(t){this.__logEvent(n("VideoUploadLogger").EVENT_CANCELED_START_REQUEST)},o.$VideoUploadSession$p_86=function(t,r){this.__logEvent(n("VideoUploadLogger").EVENT_STARTED_RECEIVE_REQUEST,{debug:r.debug}),!r.start_offset&&!r.transport_retries&&!r.server_retries&&this.__logEvent(n("VideoUploadLogger").EVENT_STARTED_SENDING_BYTES,{total_bytes:this.$VideoUploadSession53.getSize(),upload_domain:r.upload_domain,debug:r.debug}),this.$VideoUploadSession27&&this.__logEvent(n("VideoUploadLogger").EVENT_STARTED_SENDING_CHUNK_BYTES,{start_offset:r.start_offset,total_bytes:r.end_offset-r.start_offset,retries:this.$VideoUploadSession$p_101(r),transport_retries:r.transport_retries,server_retries:r.server_retries,upload_speed:r.upload_speed,request_manager_state:r.request_manager_state,upload_domain:r.upload_domain,debug:r.debug})},o.$VideoUploadSession$p_87=function(t,n){if(n.start_offset<this.$VideoUploadSession79)this.$VideoUploadSession77=n.start_offset,this.$VideoUploadSession78=n.sent_bytes;else if(this.$VideoUploadSession16){var e=0;e=this.getExPartitionNumber(n.start_offset),e>-1&&(this.$VideoUploadSession48[e]=n.start_offset,this.$VideoUploadSession49[e]=n.sent_bytes)}else this.$VideoUploadSession48=n.start_offset,this.$VideoUploadSession49=n.sent_bytes;if(n.start_offset=this.$VideoUploadSession77,n.sent_bytes=this.$VideoUploadSession78,this.$VideoUploadSession74)if(this.$VideoUploadSession16)for(e=0;e<this.$VideoUploadSession1-1;e++)n.start_offset+=this.$VideoUploadSession48[e]-this.$VideoUploadSession46[e],n.sent_bytes+=this.$VideoUploadSession49[e];else n.start_offset+=this.$VideoUploadSession48-this.$VideoUploadSession46,n.sent_bytes+=this.$VideoUploadSession49;var r=Math.min(n.start_offset+n.sent_bytes,n.file_size);r>this.$VideoUploadSession63&&(this.$VideoUploadSession63=r,this.inform("upload-progressed",n))},o.$VideoUploadSession$p_88=function(t,r){this.__logEvent(n("VideoUploadLogger").EVENT_FINISHED_RECEIVE_REQUEST,{debug:r.debug}),this.$VideoUploadSession27&&this.__logEvent(n("VideoUploadLogger").EVENT_FINISHED_SENDING_CHUNK_BYTES,{start_offset:r.start_offset,sent_bytes:r.end_offset-r.start_offset,retries:this.$VideoUploadSession$p_101(r),transport_retries:r.transport_retries,server_retries:r.server_retries,upload_speed:r.upload_speed,request_manager_state:r.request_manager_state,upload_domain:r.upload_domain,debug:r.debug});var e=!1;if(r.start_offset<this.$VideoUploadSession79)this.$VideoUploadSession75=r.end_offset>=this.$VideoUploadSession79;else if(this.$VideoUploadSession16){var o=0;if(o=this.getExPartitionNumber(r.start_offset),o===-1){var a="Invalid offset",i=n("err")(a);i.is_js_error=!0;var l={error_summary:a,error_description:"Offset doesn't fall in any exPartition range.",error:i};this.__logEvent(n("VideoUploadLogger").EVENT_FAILED_UPLOADING),this.inform("upload-failed",l);return}this.$VideoUploadSession45[o]=r.end_offset>=this.$VideoUploadSession47[o]}else this.$VideoUploadSession45=r.end_offset>=this.$VideoUploadSession47;if(this.$VideoUploadSession16)for(o=0;o<this.$VideoUploadSession1-1;o++)if(this.$VideoUploadSession45[o]===!1){e=!1;break}else e=!0;else e=this.$VideoUploadSession45;(!this.$VideoUploadSession28||this.$VideoUploadSession75&&(!this.$VideoUploadSession74||e))&&(this.__logEvent(n("VideoUploadLogger").EVENT_FINISHED_SENDING_BYTES,{sent_bytes:this.$VideoUploadSession53.getSize(),upload_domain:r.upload_domain,debug:r.debug}),this.$VideoUploadSession72=Date.now()-this.$VideoUploadSession99,this.$VideoUploadSession7&&this.__logFinishedUploading(),r.video_id=this.$VideoUploadSession57,r.is_spherical_video=this.$VideoUploadSession64,this.inform("upload-finished",r),this.$VideoUploadSession13&&(this.$VideoUploadSession7||this.__logFinishedUploading(),this.__logEvent(n("VideoUploadLogger").EVENT_FINISHED_FLOW,r),this.$VideoUploadSession71=!1,this.$VideoUploadSession$p_104(),this.inform("multimedia-upload-finished",r)))},o.$VideoUploadSession$p_89=function(t,r){var e=this.__getLogErrorData(r);if(this.__logEvent(n("VideoUploadLogger").EVENT_FAILED_RECEIVE_REQUEST,e),this.$VideoUploadSession27&&this.__logEvent(n("VideoUploadLogger").EVENT_FAILED_SENDING_CHUNK_BYTES,e),this.$VideoUploadSession60){this.__logEvent(n("VideoUploadLogger").EVENT_FAILED_SENDING_BYTES,e),this.__logEvent(n("VideoUploadLogger").EVENT_FAILED_UPLOADING,e);var o=r.error_is_transient?n("VideoUploadLogger").EVENT_RESIGNED_FLOW:n("VideoUploadLogger").EVENT_FAILED_FLOW;this.$VideoUploadSession7?this.$VideoUploadSession71&&(this.__logEvent(o,e),this.$VideoUploadSession71=!1):this.__logEvent(o,e)}this.$VideoUploadSession$p_104(),this.inform("upload-failed",r)},o.$VideoUploadSession$p_90=function(t){this.$VideoUploadSession27?this.__logEvent(n("VideoUploadLogger").EVENT_CANCELED_SENDING_CHUNK_BYTES):this.__logEvent(n("VideoUploadLogger").EVENT_CANCELED_SENDING_BYTES)},o.$VideoUploadSession$p_91=function(t,r){var e={start_offset:r.start_offset,sent_bytes:r.end_offset-r.start_offset,retries:this.$VideoUploadSession$p_101(r),transport_retries:r.transport_retries,server_retries:r.server_retries,timeout_retries:r.timeout_retries,upload_speed:r.upload_speed,request_manager_state:r.request_manager_state,debug:r.debug};this.__logEvent(n("VideoUploadLogger").EVENT_TIMEOUT_SENDING_CHUNK_BYTES,e)},o.$VideoUploadSession$p_92=function(t,n){this.inform("online",n)},o.$VideoUploadSession$p_93=function(t,n){this.inform("offline",n)},o.$VideoUploadSession$p_94=function(t,r){this.__logEvent(n("VideoUploadLogger").EVENT_RESUMABLE_CALLED,r)},o.$VideoUploadSession$p_95=function(t,r){this.__logEvent(n("VideoUploadLogger").EVENT_RESUMABLE_STARTED,r)},o.$VideoUploadSession$p_96=function(t,r){this.__logEvent(n("VideoUploadLogger").EVENT_RESUMABLE_SUCCESS,r)},o.$VideoUploadSession$p_97=function(t,r){this.__logEvent(n("VideoUploadLogger").EVENT_RESUMABLE_FAILED,r)},o.__handlePostRequestFinished=function(t,r){this.__logEvent(n("VideoUploadLogger").EVENT_FINISHED_POST_REQUEST,babelHelpers.extends({video_id:this.$VideoUploadSession57},this.$VideoUploadSession25)),r.video_id||(r.video_id=this.$VideoUploadSession57),this.$VideoUploadSession7||this.__logFinishedUploading(),this.__logEvent(n("VideoUploadLogger").EVENT_FINISHED_FLOW),this.$VideoUploadSession71=!1,this.$VideoUploadSession$p_104();var e=babelHelpers.extends({},r,this.$VideoUploadSession68);this.inform("post-finished",e)},o.__logFinishedUploading=function(){this.__logEvent(n("VideoUploadLogger").EVENT_FINISHED_UPLOADING,babelHelpers.extends({elapsed_time:this.$VideoUploadSession72,skip_upload:this.$VideoUploadSession102?1:null,video_id:this.$VideoUploadSession57},this.$VideoUploadSession25)),this.$VideoUploadSession61=!0},o.$VideoUploadSession$p_98=function(t,r){var e=this.__getLogErrorData(r);if(this.__logEvent(n("VideoUploadLogger").EVENT_FAILED_POST_REQUEST,e),this.$VideoUploadSession60){this.__logEvent(n("VideoUploadLogger").EVENT_FAILED_UPLOADING,e);var o=r.error_is_transient?n("VideoUploadLogger").EVENT_RESIGNED_FLOW:n("VideoUploadLogger").EVENT_FAILED_FLOW;this.__logEvent(o,e)}this.$VideoUploadSession$p_104(),this.inform("post-failed",r)},o.$VideoUploadSession$p_103=function(){if(this.$VideoUploadSession35.cancelRequest(),this.$VideoUploadSession74)if(this.$VideoUploadSession16){var e=0;for(e=0;e<this.$VideoUploadSession1-1;e++)this.$VideoUploadSession37[e].cancelRequest()}else this.$VideoUploadSession37.cancelRequest();this.$VideoUploadSession21=!1},o.$VideoUploadSession$p_70=function(){this.$VideoUploadSession33.cancelRequest(),this.$VideoUploadSession$p_103(),this.$VideoUploadSession$p_104(),this.$VideoUploadSession57&&(r.deleteVideo(this.$VideoUploadSession57),this.$VideoUploadSession57=null,this.$VideoUploadSession58=null,this.$VideoUploadSession59=null)},o.$VideoUploadSession$p_80=function(){var t=this;this.$VideoUploadSession60=!0,this.$VideoUploadSession32&&(this.$VideoUploadSession62=new(n("SubscriptionsHandler")),this.$VideoUploadSession62.addSubscriptions(this.$VideoUploadSession$p_55().postOnShutdown(function(){if(t.$VideoUploadSession60){var r={event_reason:e.SHUTDOWN,debug:babelHelpers.extends({},t.__fetchReceiveRequestManagerStateLogData(),{is_background_upload:t.$VideoUploadSession7})};t.$VideoUploadSession7?t.$VideoUploadSession71&&t.__logEvent(n("VideoUploadLogger").EVENT_CANCELED_FLOW,r):t.__logEvent(n("VideoUploadLogger").EVENT_CANCELED_FLOW,r),t.inform("upload-canceled")}}))),this.$VideoUploadSession12&&(this.$VideoUploadSession73=new(n("VideoUploadCrashMonitor"))(this.$VideoUploadSession24,this.$VideoUploadSession8,this.$VideoUploadSession2,this.$VideoUploadSession4,this.$VideoUploadSession5,this.$VideoUploadSession27,this.$VideoUploadSession9,!this.$VideoUploadSession7||this.$VideoUploadSession71),this.$VideoUploadSession73.startSession())},o.$VideoUploadSession$p_104=function(){this.$VideoUploadSession60=!1,this.$VideoUploadSession62&&(this.$VideoUploadSession62.release(),this.$VideoUploadSession62=null),this.$VideoUploadSession73&&(this.$VideoUploadSession73.endSession(),this.$VideoUploadSession73=null)},o.__getLogErrorData=function(t){return{error:t.error_summary,error_code:t.error_code,error_description:t.error_description,retries:this.$VideoUploadSession$p_101(t),transport_retries:t.transport_retries,server_retries:t.server_retries,request_manager_state:t.request_manager_state,debug:t.debug}},o.__logEvent=function(t,n){n=n||{},this.$VideoUploadSession53&&(n.file_size=this.$VideoUploadSession53.getSize(),n.file_extension=this.$VideoUploadSession53.getExtension(),n.sent_bytes=this.$VideoUploadSession63),this.$VideoUploadSession$p_55().logEvent(t,n)},o.__getVideoUploadStartRequestManager=function(t,r,o,a,i,l,s,u){return new(n("VideoUploadStartRequestManager"))(t,r,o,a,i,l,s,u)},o.__getVideoUploadReceiveRequestManager=function(t,r){return new(n("VideoUploadReceiveRequestManager"))(t,r.max_transport_retries,r.max_transport_retry_timeout,r.max_server_retries,r.response_timeout_enabled,r.max_response_timeout_retries,r.response_timeout_speed_variation_factor_ppt,r.transport_retry_interval_base,r.server_retry_interval_base,r.receive_errors_force_retry,r.access_token,r.resumability_enabled,r.resumability_async_enabled,r.resumable_service_name,r.resumable_service_domain,r.datr,r.resumability_min_file_size,r.resumable_service_proxy_receive,r.resumable_service_send_media_info,r.resumable_service_send_file_size,r.resumable_reset_transport_retries_on_progress,r.traffic_tracing_enabled,r.traffic_tracing_min_file_size)},o.__getVideoUploadPostRequestManager=function(t,r){return new(n("VideoUploadPostRequestManager"))(t,r.post_max_transport_retries,r.post_transport_retry_interval_base,r.post_max_server_retries,r.post_server_retry_interval_base)},r.deleteVideo=function(t){var e=new(n("AsyncRequest"))("/ajax/video/actions/delete").setData({fbid:t,redirect:!1});e.setErrorHandler(function(){}),e.send()},r})(n("mixin")(n("cr:909282")));a.exports=l}),null);
__d("VideoUploader",["FBLogger","MediaUploadVUShim","VideoUploadCrashMonitor","VideoUploadSession","cr:909282","mixin"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t){var n;return n=e.call(this)||this,n.abandon=function(e){e===void 0&&(e=!1);var t=n.getVideoID();n.$VideoUploader2?n.$VideoUploader2.abandon(e):e&&t&&r("VideoUploadSession").deleteVideo(t),n.reset()},n.$VideoUploader1=t,n.$VideoUploader2=null,n.$VideoUploader3=null,n.$VideoUploader4=t.waterfall_id==null?null:t.waterfall_id,n.$VideoUploader5=n.$VideoUploader1.ad_account_id,t.monitor_crashes&&(n.$VideoUploader6=new(r("VideoUploadCrashMonitor")),n.$VideoUploader6.logKnownCrashes()),n}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.setComposerSessionID=function(t){this.$VideoUploader7=t,this.$VideoUploader2&&this.$VideoUploader2.setComposerSessionID(t)},n.getLogger=function(){if(this.$VideoUploader2&&this.$VideoUploader2.getLogger)return this.$VideoUploader2.getLogger()},n.upload=function(t,n){var e=this;if(!this.$VideoUploader2){var r=this.__getVideoUploadSession(this.$VideoUploader1);r.setComposerSessionID(this.$VideoUploader7),(n==null?void 0:n.creativeTools)!=null&&r.setCreativeTools(JSON.stringify(n==null?void 0:n.creativeTools)),r.subscribe(this.__getEventsWhichShouldListenFromSession(),function(t,n){return e.$VideoUploader8(t,n)}),this.$VideoUploader2=r,r.start(t)}},n.__getVideoUploadSession=function(t){try{var e=r("MediaUploadVUShim").createSession(t);return e==null?new(r("VideoUploadSession"))(t):e}catch(e){return r("FBLogger")("media_upload").catching(e).warn("Failed to create shim video upload session"),new(r("VideoUploadSession"))(t)}},n.__getEventsWhichShouldListenFromSession=function(){return["upload-requested","upload-started","upload-progressed","upload-finished","upload-failed","upload-canceled","post-started","post-finished","post-failed","online","offline","metadata-parsed","set-waterfall-id"]},n.postUserRequest=function(){this.$VideoUploader2&&this.$VideoUploader2.startFlow&&this.$VideoUploader2.startFlow()},n.setTargetID=function(t){this.$VideoUploader2!=null&&this.$VideoUploader2.setTargetID(t)},n.setHasFileBeenReplaced=function(t){this.$VideoUploader1.has_file_been_replaced=t},n.post=function(t){this.$VideoUploader2&&this.$VideoUploader2.post(t)},n.getVideoID=function(){return this.$VideoUploader2&&(this.$VideoUploader3=this.$VideoUploader2.getVideoID()),this.$VideoUploader3},n.getVideoMetadataFromSession=function(){if(this.$VideoUploader2)return this.$VideoUploader2.getVideoMetadata()},n.cancel=function(t){t===void 0&&(t=!1);var e=this.getVideoID();this.$VideoUploader2?this.$VideoUploader2.cancel(t):t&&e&&r("VideoUploadSession").deleteVideo(e),this.reset()},n.reset=function(){this.$VideoUploader2&&(this.$VideoUploader3=this.getVideoID()),this.$VideoUploader2=null},n.getUploadSession=function(){return this.$VideoUploader2},n.getLoggerData=function(){return{waterfall_id:this.$VideoUploader2?this.$VideoUploader2.$VideoUploader4:null,actor_id:this.$VideoUploader1.actor_id,target_id:this.$VideoUploader1.target_id,target_type:this.$VideoUploader1.target_type,composer_entry_point_ref:this.$VideoUploader1.composer_entry_point_ref}},n.isPostInProgress=function(){return!!this.$VideoUploader2&&this.$VideoUploader2.isPostInProgress()},n.isSessionInProgress=function(){return!!this.$VideoUploader2&&this.$VideoUploader2.isInProgress()},n.isSessionExist=function(){return!!this.$VideoUploader2},n.getUploadParameters=function(){return this.$VideoUploader1},n.__getSession=function(){return this.$VideoUploader2},n.__getEventsForWhichSessionShouldBeSetToNull=function(){return["upload-failed","post-finished","multimedia-upload-finished"]},n.$VideoUploader8=function(t,n){this.__getEventsForWhichSessionShouldBeSetToNull().includes(t)&&this.reset(),this.__delegateEvent(t,n)},n.__delegateEvent=function(t,n){this.inform(t,n)},t})(r("mixin")(n("cr:909282")));l.default=e}),98);
__d("getMediaFile",[],(function(t,n,r,o,a,i){"use strict";function e(e){return e.file}i.default=e}),66);
__d("getVideoTrimSettings",[],(function(t,n,r,o,a,i){"use strict";function e(e){return e.extra.trimData}i.default=e}),66);
__d("ComposerMediaFileUploader",["fbt","ActorURI","QuickPerformanceLogger","ReactComposerMediaConfig","VideoUploadFile","VideoUploadFlowNotifier","VideoUploadSurface","VideoUploader","XComposerPhotoUploader","cometComposerMediaUploadLogger","getMediaFile","getVideoTrimSettings","qpl"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=(function(){function e(){this.subscribers=[]}var t=e.prototype;return t.subscribe=function(t){this.subscribers.push(t)},t.notify=function(t){this.subscribers.forEach(function(e){return e(t)})},t.unsubscribe=function(t){this.subscribers=this.subscribers.filter(function(e){return e!==t})},e})(),c=new Map,d=(function(){function t(e,t,n,r){var a,i;this.startedObserver=new u,this.progressObserver=new u,this.successObserver=new u,this.errorObserver=new u,this.sphericalImageDetectedObserver=new u,this.uploadStatuses=new Map,this.uploadStatusChangeObserver=new u,this.videoUploadsQueue=[],this.actorID=e,this.videoUploaderConfig=t,this.creationSessionID=n!=null?n:"",this.photoUploader=this.$1(this.actorID,r),this.videoUploader=this.$2(this.videoUploaderConfig,this.creationSessionID),this.videoUploadFlowNotifier=o("VideoUploadFlowNotifier").createVideoUploadFlowNotifier({cancel_on_leave:!1,composer_entry_point_ref:(a=this.videoUploaderConfig.composer_entry_point_ref)!=null?a:"unknown",composer_session_id:(i=this.creationSessionID)!=null?i:"",extended_flow_logging_enabled:!0,source:this.videoUploaderConfig.source}),o("VideoUploadSurface").VideoUploadSurface.getOrCreate(o("VideoUploadSurface").VideoUploadSurfaceIDs.FEED).notifiers().register(this.videoUploadFlowNotifier,this.creationSessionID)}var n=t.prototype;return n.$3=function(t,n){var e,r=(e=this.uploadStatuses.get(t))==null?void 0:e.bytesTotal;r!=null&&(this.uploadStatuses.set(t,{bytesLoaded:n!=null?n:r,bytesTotal:r}),this.uploadStatusChangeObserver.notify(this.uploadStatuses))},n.$1=function(n,a){var t=this;return new(r("XComposerPhotoUploader"))({concurrentLimit:r("ReactComposerMediaConfig").photo.concurrentLimit,onUploadFailure:function(n,r){var e,o;t.$4(n,"PHOTO",(e=r.response.getErrorDescriptionString())!=null?e:"",null,r.response.error.toString()),t.errorObserver.notify({entID:(o=r.response.payload)==null?void 0:o.photoID,error:r.response.getErrorSummary(),uploadID:n})},onUploadIsSpherical:function(n,r,o){n&&r&&t.sphericalImageDetectedObserver.notify({isSpherical:n,sphericalImage:r,uploadID:o})},onUploadProgress:function(n,r){var e=Math.min(1,Math.max(0,r.event.loaded/r.event.total));t.progressObserver.notify({percentComplete:e,uploadID:n}),t.$3(n,r.event.loaded)},onUploadStart:function(n,r){t.$5(n,"PHOTO"),t.startedObserver.notify({uploadID:n})},onUploadSuccess:function(o,a){var n=a.response.payload;if(n==null){var i;t.$4(o,"PHOTO",(i=a.response.getErrorDescriptionString())!=null?i:""),t.errorObserver.notify({entID:null,error:a.response.getErrorSummary(),uploadID:o})}else t.$6(o,n.photoID,"PHOTO"),t.successObserver.notify({attachmentType:"PHOTO",entID:n.photoID,imageURL:n.imageSrc,takenTime:n.mediaTakenTime?n.mediaTakenTime*1e3:null,uploadID:o}),t.$3(o),(e||(e=r("QuickPerformanceLogger"))).markerStart(r("qpl")._(741087294,"2028")),e.markerAnnotate(r("qpl")._(741087294,"2028"),{int:{height:n.height,width:n.width}}),e.markerEnd(r("qpl")._(741087294,"2028"),2)},retryLimit:r("ReactComposerMediaConfig").photo.retryLimit,uploadData:babelHelpers.extends({},r("ReactComposerMediaConfig").photo.uploadData,{source:8},a?{work_shared_draft_mode:"drafter_creating"}:{}),uploadEndpoint:o("ActorURI").create(r("ReactComposerMediaConfig").photo.uploadEndpoint,this.actorID)})},n.$2=function(t,n){var e=babelHelpers.extends({},t,{isMultiMediaPost:!0,waterfall_id:n});return new(r("VideoUploader"))(e)},n.upload=function(t,n){var e=this;t.forEach(function(t){var n=t.file,r=n.uploadID;r!=null&&e.uploadStatuses.get(r)==null&&e.uploadStatuses.set(r,{bytesLoaded:0,bytesTotal:n.size})}),this.uploadStatusChangeObserver.notify(this.uploadStatuses),this.$7(t.filter(function(e){var t=e.extra;return t.fileType==="PHOTO"}).map(function(e){var t=e.file;return t}),n),this.$8(t.filter(function(e){var t=e.extra;return t.fileType==="VIDEO"}))},n.$7=function(t,n){t.length>0&&this.photoUploader.getAsyncUploadRequest(t,{preventDefaultErrorHandler:n}).send()},n.$8=function(t){var e=this;if(t.length>0&&(this.videoUploadsQueue=this.videoUploadsQueue.concat(t)),this.videoUploadsQueue.length>0&&!this.videoUploader.isSessionExist()){var n=this.videoUploadsQueue.shift(),o=r("getMediaFile")(n);this.currentVideoUploadID=o.uploadID,this.videoUploader=this.$2(this.videoUploaderConfig,this.creationSessionID);var a=this.videoUploader;a.subscribe("upload-started",function(t,n){var r=o.uploadID;e.$5(r!=null?r:"","VIDEO"),r!=null&&e.startedObserver.notify({uploadID:r})}),a.subscribe("upload-progressed",function(t,n){var r=Math.min(1,Math.max(0,(n.start_offset+n.sent_bytes)/n.file_size)),i=o.uploadID;i!=null&&(e.progressObserver.notify({entID:a.getVideoID(),percentComplete:r,uploadID:i}),e.$3(i,n.start_offset+n.sent_bytes))}),a.subscribe("upload-finished",function(t,n){a.reset();var r=o.uploadID;e.$6(r!=null?r:"",n.video_id,"VIDEO"),r!=null&&(e.successObserver.notify({attachmentType:"VIDEO",entID:n.video_id,uploadID:r}),e.$3(r)),e.$8([])}),a.subscribe("upload-failed",function(t,n){var r=o.uploadID;if(e.$4(r!=null?r:"","VIDEO",n.error_description,n.video_id,n.error_code,n.error_summary),r!=null){var a;e.errorObserver.notify({entID:n.video_id,error:(a=n.error_description)!=null?a:s._(/*BTDS*/"Something went wrong and your video couldn't be uploaded. Please try again."),uploadID:r})}e.$8([])}),a.subscribe("upload-canceled",function(t){var n=o.uploadID;e.$9(n!=null?n:"","VIDEO")}),this.videoUploadFlowNotifier.registerVideoUpload(a,o.uploadID);var i=null,l=r("getVideoTrimSettings")(n);l!=null&&(i=[{params:{trim_end:l.videoTrimEnd,trim_start:l.videoTrimStart},type:"VideoTrim"}]),a.upload(r("VideoUploadFile").fromFile(o),{creativeTools:i})}},n.$5=function(t,n){r("cometComposerMediaUploadLogger")({fields:{media_id:t,media_type:n},type:"MEDIA_UPLOAD_TRANSFER_START"},this.creationSessionID)},n.$6=function(t,n,o){r("cometComposerMediaUploadLogger")({fields:{media_id:t,media_item_fbid:n,media_type:o},type:"MEDIA_UPLOAD_TRANSFER_SUCCESS"},this.creationSessionID),r("cometComposerMediaUploadLogger")({fields:{media_id:t,media_item_fbid:n,media_type:o},type:"MEDIA_UPLOAD_SUCCESS"},this.creationSessionID),r("cometComposerMediaUploadLogger")({fields:{media_id:t,media_item_fbid:n,media_type:o},type:"MEDIA_UPLOAD_FLOW_SUCCESS"},this.creationSessionID)},n.$4=function(t,n,o,a,i,l){r("cometComposerMediaUploadLogger")({fields:{error_code:i,error_description:o,error_summary:l,media_id:t,media_item_fbid:a,media_type:n},type:"MEDIA_UPLOAD_FAILURE"},this.creationSessionID)},n.$9=function(t,n){r("cometComposerMediaUploadLogger")({fields:{media_id:t,media_type:n},type:"MEDIA_UPLOAD_CANCEL"},this.creationSessionID)},n.getCreationSessionID=function(){return this.creationSessionID},n.cancelUpload=function(t,n){n==="VIDEO"&&(this.videoUploadsQueue=this.videoUploadsQueue.filter(function(e){return r("getMediaFile")(e).uploadID!==t}),this.currentVideoUploadID===t&&(this.videoUploader.cancel(),this.$8([])))},t})(),m={createOrGetInstance:function(t,n,r,a,i){a===void 0&&(a=!1),i===void 0&&(i=!1);var e=c.get(t)||new d(t,n,r,a);if(e.creationSessionID!==r||i){var l;e.creationSessionID=r!=null?r:"",e.videoUploaderConfig=n,e.videoUploadFlowNotifier=o("VideoUploadFlowNotifier").createVideoUploadFlowNotifier({cancel_on_leave:!1,composer_entry_point_ref:(l=e.videoUploaderConfig.composer_entry_point_ref)!=null?l:"unknown",composer_session_id:r!=null?r:"",extended_flow_logging_enabled:!0,source:e.videoUploaderConfig.source}),o("VideoUploadSurface").VideoUploadSurface.getOrCreate(o("VideoUploadSurface").VideoUploadSurfaceIDs.FEED).notifiers().register(e.videoUploadFlowNotifier,e.creationSessionID)}c.set(t,e);var s=function(){c.delete(t)};return[e,s]},getInstance:function(t){return c.get(t)}};l.default=m}),226);
__d("CometComposerDraftingUtils",["ComposerMediaFileUploader","FBLogger","Promise","ReactDOM","qex"],(function(t,n,r,o,a,i,l){"use strict";var e=["lexicalEditor","mediaUploadStatuses","onCloseUnderlyingDialog","videoComposerData"],s,u="comet_composer_drafts",c="drafts",d=1,m="draft_content",p=1;function _(){var e;return(e=r("qex")._("1805"))!=null?e:!1}function f(e){return new(s||(s=n("Promise")))(function(t,n){var r=window.indexedDB.open(u,d);r.onerror=function(){n(r.error)},r.onupgradeneeded=function(e){var t=e.target.result;if(!t.objectStoreNames.contains(c)){var n=t.createObjectStore(c,{keyPath:"id"});n.createIndex(m,[m],{unique:!1})}},r.onsuccess=function(n){var r=n.target.result,o=r.transaction(c,"readwrite"),a=o.objectStore(c);a.put({draftViewState:e,id:p}),o.oncomplete=function(){r.close(),t(!0)}}})}function g(){return new(s||(s=n("Promise")))(function(e,t){var n=window.indexedDB.open(u,d);n.onerror=function(){t(n.error)},n.onsuccess=function(n){var r=n.target.result;if(!r.objectStoreNames.contains(c))r.close(),window.indexedDB.deleteDatabase(u),t();else{var o=r.transaction(c,"readonly"),a=o.objectStore(c),i=a.get(p);o.oncomplete=function(){r.close(),e(i)},o.onerror=function(){r.close(),t(o.error)}}},n.onerror=function(){t(n.error)}})}function h(){return new(s||(s=n("Promise")))(function(e,t){var n=window.indexedDB.deleteDatabase(u);n.onsuccess=function(){e(!0)},n.onerror=function(){t(n.error)}})}function y(e,t,a,i){var l=r("ComposerMediaFileUploader").getInstance(t),u=[];if(e.mediaUploadStatuses){i==null||i();for(var c in e.mediaUploadStatuses)u.push(e.mediaUploadStatuses[c].onFileComplete)}else return(s||(s=n("Promise"))).resolve();if(u.length>0&&l!=null){var d=function(t){o("ReactDOM").flushSync(function(){return a({entID:t.entID,imageURL:t.attachmentType==="PHOTO"?t.imageURL:void 0,takenTime:t.attachmentType==="PHOTO"?t.takenTime:void 0,type:"MEDIA_UPLOAD_SUCCESSFUL",uploadID:t.uploadID})})};return l.successObserver.subscribe(d),(s||(s=n("Promise"))).all(u).then(function(){return(s||(s=n("Promise"))).resolve()}).catch(function(e){var t;return r("FBLogger")("comet_composer").mustfix("Media upload failed during draft save","Error: "+((t=e==null?void 0:e.message)!=null?t:"Unknown error")),(s||(s=n("Promise"))).reject(e)}).finally(function(){l.successObserver.unsubscribe(d)})}else return(s||(s=n("Promise"))).resolve()}function C(t,n,o,a){var i,l=(i=t.lexicalEditor)==null?void 0:i.getEditorState(),s=l==null?void 0:l.toJSON(),u=t.lexicalEditor,c=t.mediaUploadStatuses,d=t.onCloseUnderlyingDialog,m=t.videoComposerData,p=babelHelpers.objectWithoutPropertiesLoose(t,e),_=babelHelpers.extends({},p,{serializedLexicalEditorState:s});f(_).then(function(){n!=null&&n(),a==null||a(),o==null||o({ignoreIsSavingFlag:!0})}).catch(function(e){r("FBLogger")("comet_composer").mustfix(e)})}l.canDraftPosts=_,l.addDraftToIndexedDB=f,l.getDraftFromIndexedDB=g,l.deleteDraftFromIndexedDB=h,l.processMediaUpload=y,l.createSerializedDraft=C}),98);