;/*FB_PKG_DELIM*/

__d("LSUpdateTypingIndicator",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(r){return t.sequence([function(r){return t.i64.neq(e[3],void 0)?n[0]=e[3]:n[0]=t.i64.cast([0,5e3]),e[2]?(n[1]=t.i64.of_float(Date.now()),t.db.table(52).put({threadKey:e[0],senderId:e[1],expirationTimestampMs:t.i64.add(n[1],n[0])})):t.resolve()},function(n){return e[2]?t.resolve():t.forEach(t.filter(t.db.table(52).fetch([[[e[0],e[1]]]]),function(n){return t.i64.eq(n.threadKey,e[0])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))&&t.i64.eq(n.senderId,e[1])}),function(e){return e.delete()})}])},function(e){return t.resolve(r)}])}e.__sproc_name__="LSTypingUpdateTypingIndicatorStoredProcedure",e.__tables__=["typing_indicator"],a.exports=e}),null);