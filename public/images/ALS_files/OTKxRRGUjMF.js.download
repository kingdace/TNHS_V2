;/*FB_PKG_DELIM*/

__d("LSCleanupSession",["LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][cleanupSession] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.i64.eq(e[1],t.i64.cast([0,0]))?r[2]=t.i64.cast([0,21]):(t.i64.eq(e[1],t.i64.cast([0,1]))?r[10]=t.i64.cast([0,20]):r[10]=t.i64.cast([0,20]),r[2]=r[10]),t.filter(t.db.table(258).fetch(),function(n){return(n.initiatorId===e[0]||n.responderId===e[0])&&t.i64.eq(n.clientType,e[2])}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.filter(t.db.table(258).fetch(),function(n){return t.i64.eq(n.clientType,e[2])}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.db.table(258).add({sessionId:t.i64.cast([-1,4294967295]),responderId:e[0],initiatorId:e[0],messageType:r[2],clientType:e[2]}):(a=l.item,t.sequence([function(e){return r[19]=a.sessionId,r[20]=a.responderId,r[21]=a.initiatorId,r[17]=a.responderUserId,r[18]=a.initiatorUserId,t.forEach(t.db.table(258).fetch([[[r[19]]]]),function(e){var t=e.update,n=e.item;return t({messageType:r[2]})})},function(o){return e[0]===r[21]?(t.i64.eq(e[2],t.i64.cast([0,1]))?r[22]=r[17]:r[22]=void 0,r[11]=r[22]):(e[0]===r[20]?(t.i64.eq(e[2],t.i64.cast([0,1]))?r[23]=r[18]:r[23]=void 0,r[22]=r[23]):r[22]=void 0,r[11]=r[22]),t.i64.eq(e[2],t.i64.cast([0,1]))?r[12]=r[17]:r[12]=void 0,t.i64.eq(e[2],t.i64.cast([0,1]))?r[13]=r[18]:r[13]=void 0,r[14]=new t.Map,r[14].set("session_id",r[19]),r[14].set("responder_id",r[20]),r[14].set("initiator_id",r[21]),r[14].set("message_payload",a.messagePayload),r[14].set("pake_secret",a.pakeSecret),r[14].set("sender_id",e[0]),r[14].set("message_type",r[2]),r[14].set("client_type",e[2]),r[14].set("message_recipient_id",r[11]),r[14].set("initiator_user_id",r[13]),r[14].set("responder_user_id",r[12]),r[15]=t.toJSON(r[14]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"PakeMessages",t.i64.cast([0,717]),r[15],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[16]=t[0],t})}]))}):(a=l.item,r[13]=a.sessionId,r[14]=a.responderId,r[15]=a.initiatorId,r[10]=a.messageType,r[11]=a.responderUserId,r[12]=a.initiatorUserId,t.i64.eq(r[10],t.i64.cast([0,15]))||t.i64.eq(r[10],t.i64.cast([0,21]))||t.i64.eq(r[10],t.i64.cast([0,20]))?t.resolve(0):t.sequence([function(e){return t.forEach(t.db.table(258).fetch([[[r[13]]]]),function(e){var t=e.update,n=e.item;return t({messageType:r[2]})})},function(o){return e[0]===r[15]?(t.i64.eq(e[2],t.i64.cast([0,1]))?r[22]=r[11]:r[22]=void 0,r[16]=r[22]):(e[0]===r[14]?(t.i64.eq(e[2],t.i64.cast([0,1]))?r[23]=r[12]:r[23]=void 0,r[22]=r[23]):r[22]=void 0,r[16]=r[22]),t.i64.eq(e[2],t.i64.cast([0,1]))?r[17]=r[11]:r[17]=void 0,t.i64.eq(e[2],t.i64.cast([0,1]))?r[18]=r[12]:r[18]=void 0,r[19]=new t.Map,r[19].set("session_id",r[13]),r[19].set("responder_id",r[14]),r[19].set("initiator_id",r[15]),r[19].set("message_payload",a.messagePayload),r[19].set("pake_secret",a.pakeSecret),r[19].set("sender_id",e[0]),r[19].set("message_type",r[2]),r[19].set("client_type",e[2]),r[19].set("message_recipient_id",r[16]),r[19].set("initiator_user_id",r[18]),r[19].set("responder_user_id",r[17]),r[20]=t.toJSON(r[19]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"PakeMessages",t.i64.cast([0,717]),r[20],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[21]=t[0],t})}]))})},function(e){return r[4]=t.i64.of_float(Date.now()),r[5]=t.i64.random(),r[7]="Finishing execution. Execution time: ",r[8]=t.i64.to_string(t.i64.sub(r[4],r[0])),r[9]=" ms",r[6]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][cleanupSession] ",r[6],r[7],r[6],r[8],r[6],r[9]].join("")),t.i64.eq(t.i64.mod_(r[5],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[10]=",",r[11]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"cleanupSession",[r[7],r[10],r[8],r[10],r[9]].join(""),r[11],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSPakeMessagesCleanupSessionStoredProcedure",e.__tables__=["pake_messages"],a.exports=e}),null);
__d("LSCleanupSessionStoredProcedure",["LSCleanupSession","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSCleanupSession"),a.deviceId,a.cleanupReason,a.clientType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("CleanupPakeSession",["LSCleanupSessionStoredProcedure","LSFactory","LSIntEnum","MAWOneTimeCodeGating","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t){var a=t.cleanupReason,l=t.clientType,u=t.deviceId,c=t.storage;return o("MAWOneTimeCodeGating").isOneTimeCodeEnabled()?c.runInTransaction(function(t){return r("LSCleanupSessionStoredProcedure")(r("LSFactory")(t),{cleanupReason:(e||(e=o("LSIntEnum"))).ofNumber(a),clientType:e.ofNumber(l),deviceId:u})},"readwrite",void 0,void 0,i.id+":41"):(s||(s=n("Promise"))).resolve()}l.default=u}),98);
__d("FBIconCautionCircleOutline20.svg.react",["XPlatReactSVG","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs(o("XPlatReactSVG").Svg,babelHelpers.extends({viewBox:"0 0 20 20",width:"1em",height:"1em",fill:"currentColor",title:e.title},e,{children:[e.children!=null&&s.jsx(o("XPlatReactSVG").Defs,{children:e.children}),s.jsx(o("XPlatReactSVG").G,{fillRule:"evenodd",transform:"translate(-446 -398)",children:s.jsxs(o("XPlatReactSVG").G,{children:[s.jsx(o("XPlatReactSVG").Path,{d:"m101.5 200.17.5 4.83.5-4.83s0-.42-.5-.42-.5.42-.5.42",transform:"translate(354 204.5)"}),s.jsx(o("XPlatReactSVG").Path,{fillRule:"nonzero",d:"m100.754 200.247.5 4.83c.093.897 1.4.897 1.492 0l.5-4.83.004-.077c0-.176-.04-.38-.168-.594-.214-.36-.6-.576-1.082-.576-.481 0-.868.216-1.082.576a1.144 1.144 0 0 0-.168.594l.004.077zm.996-.077h.5c0 .07-.01.117-.043.174-.058.097-.163.156-.207.156-.044 0-.149-.059-.207-.156a.302.302 0 0 1-.043-.174z",transform:"translate(354 204.5)"}),s.jsx(o("XPlatReactSVG").Path,{d:"M103 207.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0",transform:"translate(354 204.5)"}),s.jsx(o("XPlatReactSVG").Path,{d:"M102 193.5c-5.523 0-10 4.477-10 10s4.477 10 10 10 10-4.477 10-10-4.477-10-10-10m0 1.304c4.795 0 8.696 3.901 8.696 8.696s-3.901 8.696-8.696 8.696-8.696-3.901-8.696-8.696 3.901-8.696 8.696-8.696",transform:"translate(354 204.5)"})]})})]}))}u.displayName=u.name+" [from "+i.id+"]",u._isSVG=!0;var c=u;l.default=c}),98);
__d("FBIconTabletOutline20.svg.react",["XPlatReactSVG","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs(o("XPlatReactSVG").Svg,babelHelpers.extends({viewBox:"0 0 20 20",width:"1em",height:"1em",fill:"currentColor",title:e.title},e,{children:[e.children!=null&&s.jsx(o("XPlatReactSVG").Defs,{children:e.children}),s.jsx(o("XPlatReactSVG").G,{fillRule:"evenodd",transform:"translate(-446 -398)",children:s.jsxs(o("XPlatReactSVG").G,{transform:"translate(355.5 191.5)",children:[s.jsx(o("XPlatReactSVG").Path,{fillRule:"nonzero",d:"M93.5 211.5 107.5 211.5 107.5 210 93.5 210z"}),s.jsx(o("XPlatReactSVG").Path,{fillRule:"nonzero",d:"M106.078 226.5H94.922a2.422 2.422 0 0 1-2.422-2.422v-15.156a2.422 2.422 0 0 1 2.422-2.422h11.156a2.422 2.422 0 0 1 2.422 2.422v15.156a2.422 2.422 0 0 1-2.422 2.422zm0-1.5c.51 0 .922-.413.922-.922v-15.156a.922.922 0 0 0-.922-.922H94.922a.922.922 0 0 0-.922.922v15.156c0 .51.413.922.922.922h11.156z"}),s.jsx(o("XPlatReactSVG").Path,{fillRule:"nonzero",d:"M93.5 222 107.5 222 107.5 220.5 93.5 220.5z"}),s.jsx(o("XPlatReactSVG").Path,{d:"M101.5 223.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"})]})})]}))}u.displayName=u.name+" [from "+i.id+"]",u._isSVG=!0;var c=u;l.default=c}),98);
__d("LSDecryptPakeSecret",["LSLogMebClientEvent.nop","LSQplInteractionHelper.nop","LSSymmetricEncryptionCreateDecryptedString.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][decryptPakeSecret] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[2])&&t.i64.eq(n.sessionId,e[0])}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_NO_SESSION_ONGOING_FAILURE",t.i64.cast([0,0]),void 0)},function(e){return r[12]="PAKE: Failed to decrypt PAKE secrets as no session was ongoing.",t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,7]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[2])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,7]),clientType:e[2]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,7])})}))})},function(e){return(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",r[12]].join("")),r[13]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[r[12]].join(""),r[13],t.i64.cast([0,3]))},function(e){var n;return n=[void 0,t.i64.cast([-1,4294967294])],r[2]=n[0],r[3]=n[1],n}]):(a=l.item,t.sequence([function(o){return r[13]=a.responderId,r[14]=a.initiatorId,r[15]=a.pakeSecret,r[13]!==void 0?t.sequence([function(o){return r[14]!==void 0?t.sequence([function(o){return r[15]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_GENERATE_PAKE_AAD_START",t.i64.cast([0,0]),void 0)},function(e){return r[20]="_",t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_NATIVE_OP_START",t.i64.cast([0,0]),void 0)},function(o){return t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[1],t.blobs.of_string(["v1",r[20],t.i64.to_string(e[0]),r[20],r[13],r[20],r[14],r[20],t.i64.to_string(a.clientType)].join("")),r[15]).then(function(e){var t;return t=e,r[21]=t[0],t})},function(o){var a;return r[21]!==void 0?t.resolve((a=[r[21],t.i64.cast([0,0])],r[22]=a[0],r[23]=a[1],a)):t.sequence([function(e){return r[25]="PAKE: Failed to decrypt PAKE secrets as key was incorrect.",t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,10]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[2])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,10]),clientType:e[2]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,10])})}))})},function(e){return(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",r[25]].join("")),r[26]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[r[25]].join(""),r[26],t.i64.cast([0,3]))},function(e){var n;return n=[void 0,t.i64.cast([-1,4294967295])],r[22]=n[0],r[23]=n[1],n}])},function(e){var t;return t=[r[22],r[23]],r[18]=t[0],r[19]=t[1],t}]):t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_PAKE_SECRET_NULL_FAILURE",t.i64.cast([0,0]),void 0)},function(e){return r[21]="PAKE: Failed to decrypt PAKE secrets as there was no secret to decrypt.",t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,8]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[2])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,8]),clientType:e[2]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,8])})}))})},function(e){return(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",r[21]].join("")),r[22]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[r[21]].join(""),r[22],t.i64.cast([0,3]))},function(e){var n;return n=[void 0,t.i64.cast([-1,4294967294])],r[18]=n[0],r[19]=n[1],n}])},function(e){var t;return t=[r[18],r[19]],r[16]=t[0],r[17]=t[1],t}]):t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_INITIATOR_ID_NULL_FAILURE",t.i64.cast([0,0]),void 0)},function(e){return r[19]="PAKE: Failed to decrypt PAKE secrets as initiator id was null.",t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,8]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[2])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,8]),clientType:e[2]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,8])})}))})},function(e){return(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",r[19]].join("")),r[20]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[r[19]].join(""),r[20],t.i64.cast([0,3]))},function(e){var n;return n=[void 0,t.i64.cast([-1,4294967294])],r[16]=n[0],r[17]=n[1],n}])},function(e){var t;return t=[r[16],r[17]],r[11]=t[0],r[12]=t[1],t}]):t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_RESPONDER_ID_NULL_FAILURE",t.i64.cast([0,0]),void 0)},function(e){return r[17]="PAKE: Failed to decrypt PAKE secrets as responder id was null.",t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,8]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[2])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,8]),clientType:e[2]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,8])})}))})},function(e){return(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",r[17]].join("")),r[18]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[r[17]].join(""),r[18],t.i64.cast([0,3]))},function(e){var n;return n=[void 0,t.i64.cast([-1,4294967294])],r[11]=n[0],r[12]=n[1],n}])},function(e){var t;return t=[r[11],r[12]],r[2]=t[0],r[3]=t[1],t}]))})},function(e){return r[5]=t.i64.of_float(Date.now()),r[6]=t.i64.random(),r[8]="Finishing execution. Execution time: ",r[9]=t.i64.to_string(t.i64.sub(r[5],r[0])),r[10]=" ms",r[7]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][decryptPakeSecret] ",r[7],r[8],r[7],r[9],r[7],r[10]].join("")),t.i64.eq(t.i64.mod_(r[6],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[11]=",",r[12]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"decryptPakeSecret",[r[8],r[11],r[9],r[11],r[10]].join(""),r[12],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[2],r[3]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSPakeMessagesDecryptPakeSecretStoredProcedure",e.__tables__=["pake_messages"],a.exports=e}),null);
__d("LSDecryptPakeSecretStoredProcedure",["LSDecryptPakeSecret","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSDecryptPakeSecret"),a.sessionId,a.encryptionKey,a.clientType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSFetchOTCEligibleEBDevicesV2",["LSIssueNewEbTaskAndGetTaskIDV2"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(e){return t.sequence([function(e){return t.forEach(t.db.table(261).fetch(),function(e){return e.delete()})},function(e){return r[0]="",t.forEach(t.filter(t.db.table(261).fetch([[[r[0]]]]),function(e){return e.deviceId===r[0]&&t.i64.lt(e.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(e){return t.db.table(261).add({deviceId:r[0],authorityLevel:t.i64.cast([0,20])})},function(e){return r[1]=new t.Map,r[2]=t.toJSON(r[1]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"meb_fetch_otc_eligible_devices",t.i64.cast([0,50028]),r[2],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[3]=t[0],t})}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsFetchOTCEligibleEBDevicesV2StoredProcedure",e.__tables__=["encrypted_backups_otc_devices"],a.exports=e}),null);
__d("LSFetchOTCEligibleEBDevicesV2StoredProcedure",["LSFetchOTCEligibleEBDevicesV2","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t){var a=t.storedProcedure(r("LSFetchOTCEligibleEBDevicesV2"));return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}l.default=s}),98);
__d("LSGetActiveSession",["LSLogMebClientEvent.nop","LSQplInteractionHelper.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(n){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][getActiveSession] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.count(t.filter(t.db.table(258).fetch(),function(n){return t.i64.eq(n.messageType,t.i64.cast([0,0]))&&t.i64.eq(n.clientType,e[1])&&n.initiatorId===void 0||t.i64.eq(n.clientType,e[1])&&n.initiatorId===e[0]&&![t.i64.cast([0,1]),t.i64.cast([0,2]),t.i64.cast([0,3]),t.i64.cast([0,4]),t.i64.cast([0,21]),t.i64.cast([0,15]),t.i64.cast([0,23])].some(function(e){return t.i64.eq(n.messageType,e)})&&t.i64.neq(n.sessionId,t.i64.cast([-1,4294967295]))})).then(function(e){return r[2]=e})},function(o){return t.i64.le(r[2],t.i64.cast([0,1]))?t.sequence([function(o){return t.filter(t.db.table(258).fetch(),function(n){return t.i64.eq(n.messageType,t.i64.cast([0,0]))&&t.i64.eq(n.clientType,e[1])&&n.initiatorId===void 0||t.i64.eq(n.clientType,e[1])&&n.initiatorId===e[0]&&![t.i64.cast([0,1]),t.i64.cast([0,2]),t.i64.cast([0,3]),t.i64.cast([0,4]),t.i64.cast([0,21]),t.i64.cast([0,15]),t.i64.cast([0,23])].some(function(e){return t.i64.eq(n.messageType,e)})&&t.i64.neq(n.sessionId,t.i64.cast([-1,4294967295]))}).next().then(function(e,o){var a=e.done,i=e.value;return a?t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,17]))},function(e){var n;return n=[t.i64.cast([-1,4294967295]),void 0,void 0],r[12]=n[0],r[13]=n[1],r[14]=n[2],n}]):(o=i.item,t.sequence([function(e){var a;return r[19]=o.responderId,r[19]!==void 0?t.resolve((a=[t.i64.cast([0,0]),o.sessionId,r[19]],r[16]=a[0],r[17]=a[1],r[18]=a[2],a)):t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_SESSION_ONGOING_RESPONDER_ID_NULL_FAILURE",t.i64.cast([0,0]),void 0)},function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,8]))},function(e){var n;return n=[t.i64.cast([-1,4294967294]),void 0,void 0],r[16]=n[0],r[17]=n[1],r[18]=n[2],n}])},function(e){var t;return t=[r[16],r[17],r[18]],r[12]=t[0],r[13]=t[1],r[14]=t[2],t}]))})},function(e){var t;return t=[r[12],r[13],r[14]],r[3]=t[0],r[4]=t[1],r[5]=t[2],t}]):t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,18]))},function(e){var n;return n=[t.i64.cast([-1,4294967294]),void 0,void 0],r[3]=n[0],r[4]=n[1],r[5]=n[2],n}])},function(e){return r[6]=t.i64.of_float(Date.now()),r[7]=t.i64.random(),r[9]="Finishing execution. Execution time: ",r[10]=t.i64.to_string(t.i64.sub(r[6],r[0])),r[11]=" ms",r[8]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][getActiveSession] ",r[8],r[9],r[8],r[10],r[8],r[11]].join("")),t.i64.eq(t.i64.mod_(r[7],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[12]=",",r[13]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"getActiveSession",[r[9],r[12],r[10],r[12],r[11]].join(""),r[13],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[3],r[4],r[5]],o[0]=t[0],o[1]=t[1],o[2]=t[2],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSPakeMessagesGetActiveSessionStoredProcedure",e.__tables__=["pake_messages"],a.exports=e}),null);
__d("LSGetActiveSessionStoredProcedure",["LSGetActiveSession","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSGetActiveSession"),a.initiatorId,a.clientType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSSendPakeMessage",["LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][sendPakeMessage] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[4])&&t.i64.eq(n.sessionId,e[0])}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[4])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,7]),clientType:e[4]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,7])})}))}):(a=l.item,r[17]=a.responderId,r[18]=a.initiatorId,r[15]=a.responderUserId,r[16]=a.initiatorUserId,e[1]===r[18]?(t.i64.eq(e[4],t.i64.cast([0,1]))?r[19]=r[15]:r[19]=void 0,r[9]=r[19]):(e[1]===r[17]?(t.i64.eq(e[4],t.i64.cast([0,1]))?r[20]=r[16]:r[20]=void 0,r[19]=r[20]):r[19]=void 0,r[9]=r[19]),t.i64.eq(e[4],t.i64.cast([0,1]))?r[10]=r[15]:r[10]=void 0,t.i64.eq(e[4],t.i64.cast([0,1]))?r[11]=r[16]:r[11]=void 0,r[12]=new t.Map,r[12].set("session_id",e[0]),r[12].set("responder_id",r[17]),r[12].set("initiator_id",r[18]),r[12].set("message_payload",e[2]==null?a.messagePayload:e[2]),r[12].set("pake_secret",a.pakeSecret),r[12].set("sender_id",e[1]),r[12].set("message_type",e[3]),r[12].set("client_type",e[4]),r[12].set("message_recipient_id",r[9]),r[12].set("initiator_user_id",r[11]),r[12].set("responder_user_id",r[10]),r[13]=t.toJSON(r[12]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"PakeMessages",t.i64.cast([0,717]),r[13],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[14]=t[0],t}))})},function(e){return r[3]=t.i64.of_float(Date.now()),r[4]=t.i64.random(),r[6]="Finishing execution. Execution time: ",r[7]=t.i64.to_string(t.i64.sub(r[3],r[0])),r[8]=" ms",r[5]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][sendPakeMessage] ",r[5],r[6],r[5],r[7],r[5],r[8]].join("")),t.i64.eq(t.i64.mod_(r[4],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[9]=",",r[10]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"sendPakeMessage",[r[6],r[9],r[7],r[9],r[8]].join(""),r[10],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSPakeMessagesSendPakeMessageStoredProcedure",e.__tables__=["pake_messages"],a.exports=e}),null);
__d("LSSendPakeMessageOne",["LSBase64Encode.nop","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSQplInteractionHelper.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][sendPakeMessageOne] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.nativeOperation(n("LSBase64Encode.nop"),e[2]).then(function(e){var t;return t=e,r[2]=t[0],t})},function(o){return t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[3])&&t.i64.eq(n.sessionId,e[0])}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,7]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[3])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,7]),clientType:e[3]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,7])})}))})}]):(a=l.item,r[10]=a.responderId,r[10]!==void 0?(t.i64.eq(e[3],t.i64.cast([0,1]))?r[11]=a.responderUserId:r[11]=void 0,t.i64.eq(e[3],t.i64.cast([0,1]))?r[12]=a.initiatorUserId:r[12]=void 0,r[13]=new t.Map,r[13].set("session_id",e[0]),r[13].set("responder_id",r[10]),r[13].set("initiator_id",e[1]),r[13].set("message_payload",r[2]==null?"":r[2]),r[13].set("message_payload_v2",void 0),r[13].set("pake_secret",void 0),r[13].set("sender_id",e[1]),r[13].set("message_type",t.i64.cast([0,1])),r[13].set("client_type",e[3]),r[13].set("message_recipient_id",r[11]),r[13].set("initiator_user_id",r[12]),r[13].set("responder_user_id",r[11]),r[14]=t.toJSON(r[13]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"PakeMessages",t.i64.cast([0,717]),r[14],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[15]=t[0],t})):t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,8]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[3])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,8]),clientType:e[3]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,8])})}))})}]))})},function(e){return r[4]=t.i64.of_float(Date.now()),r[5]=t.i64.random(),r[7]="Finishing execution. Execution time: ",r[8]=t.i64.to_string(t.i64.sub(r[4],r[0])),r[9]=" ms",r[6]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][sendPakeMessageOne] ",r[6],r[7],r[6],r[8],r[6],r[9]].join("")),t.i64.eq(t.i64.mod_(r[5],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[10]=",",r[11]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"sendPakeMessageOne",[r[7],r[10],r[8],r[10],r[9]].join(""),r[11],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSPakeMessagesSendPakeMessageOneStoredProcedure",e.__tables__=["pake_messages"],a.exports=e}),null);
__d("LSSendPakeMessageOneStoredProcedure",["LSSendPakeMessageOne","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSSendPakeMessageOne"),a.sessionId,a.initiatorId,a.messagePayload,a.clientType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSSendPakeMessageStoredProcedure",["LSSendPakeMessage","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSSendPakeMessage"),a.sessionId,a.senderId,a.messagePayload,a.messageType,a.clientType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("MWChatEncryptedBackupsAccessCodeInput.react",["fbt","BaseTextArea.react","MWXText.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useRef,d={input:{backgroundColor:"xjbqb8w",borderTopStyle:"x1ejq31n",borderInlineEndStyle:"x18oe1m7",borderBottomStyle:"x1sy0etr",borderInlineStartStyle:"xstzfhl",color:"xzsf02u",fontSize:"x1lkfr7t",fontWeight:"x1s688f",height:"x5yr21d",insetInlineEnd:"xtijo5x",insetInlineStart:"x1o0tod",left:null,right:null,letterSpacing:null,lineHeight:"x11m8ghp",overflowX:"x6ikm8r",overflowY:"x10wlt62",paddingBottom:"x18d9i69",paddingTop:"x1y1aw1k",top:"x1jzctok",width:"xh8yej3","::placeholder_color":"xha3pab",$$css:!0}},m="---- ---- ---- ---- ----\n---- ---- ---- ---- ----",p=40;function _(e){var t=o("react-compiler-runtime").c(30),n=e.autoSubmit,a=e.disabled,i=e.onComplete,l=e.onValueChange,_=e.smallInput,y=e.value,C=n===void 0?!1:n,b=a===void 0?!1:a,v=c(),S=f,R;t[0]!==C||t[1]!==i||t[2]!==l||t[3]!==y?(R=function(t){var e=S(t).substring(0,p),n=S(y);e!==n&&(l(e),e.length===p&&C&&(i==null||i(e)))},t[0]=C,t[1]=i,t[2]=l,t[3]=y,t[4]=R):R=t[4];var L=R,E;t[5]!==_?(E={0:{className:"x443n21 x16qb05n xi7iut8 x1dm3dyd x1pv694p x1g2khh7 xyamay9 x2b8uid x10bruuh x1xmf6yo x67w97k xx281p9"},1:{className:"x443n21 x16qb05n xi7iut8 x1dm3dyd x1pv694p xyamay9 x2b8uid x10bruuh x12nagc x18d9i69 x1s1gtqi"}}[!!_<<0],t[5]=_,t[6]=E):E=t[6];var k,I,T,D;t[7]===Symbol.for("react.memo_cache_sentinel")?(k=u.jsx(r("MWXText.react"),{type:"meta3",children:s._(/*BTDS*/"Includes numbers and letters")}),I={className:"xwzfr38 xr1yuqi x11t971q x4ii5y1 xvc5jky x1n2onr6 x1hfn5x7"},T="x5yr21d x10l6tqk xh8yej3",D={fontFamily:"var(--font-family-code)"},t[7]=k,t[8]=I,t[9]=T,t[10]=D):(k=t[7],I=t[8],T=t[9],D=t[10]);var x;t[11]!==y?(x=y===""?m:h(y),t[11]=y,t[12]=x):x=t[12];var $;t[13]!==b||t[14]!==x?($=u.jsx("div",{className:T,style:D,children:u.jsx(r("BaseTextArea.react"),{disabled:b,maxRows:2,placeholder:m,readOnly:!0,suppressFocusRing:!0,unresizable:!0,value:x,xstyle:d.input})}),t[13]=b,t[14]=x,t[15]=$):$=t[15];var P,N;t[16]===Symbol.for("react.memo_cache_sentinel")?(P="x5yr21d x10l6tqk xh8yej3",N={fontFamily:"var(--font-family-code)"},t[16]=P,t[17]=N):(P=t[16],N=t[17]);var M;t[18]!==y?(M=y===""?y:g(y),t[18]=y,t[19]=M):M=t[19];var w;t[20]!==b||t[21]!==L||t[22]!==M?(w=u.jsx("div",{className:P,style:N,children:u.jsx(r("BaseTextArea.react"),{disabled:b,maxRows:2,onValueChange:L,ref:v,suppressFocusRing:!0,testid:void 0,unresizable:!0,value:M,xstyle:d.input})}),t[20]=b,t[21]=L,t[22]=M,t[23]=w):w=t[23];var A;t[24]!==$||t[25]!==w?(A=u.jsxs("div",babelHelpers.extends({},I,{children:[$,w]})),t[24]=$,t[25]=w,t[26]=A):A=t[26];var F;return t[27]!==A||t[28]!==E?(F=u.jsxs("div",babelHelpers.extends({},E,{children:[k,A]})),t[27]=A,t[28]=E,t[29]=F):F=t[29],F}function f(e){return e.toUpperCase().replace(/[^A-Z0-9]/g,"")}function g(e){var t=e.split(""),n=0,r=[];for(var o of t)r.length===24?r.push("\n"):n>0&&n%4===0&&r.push(" "),r.push(o),n+=1;return r.join("")}function h(e){var t=e.split("");return m.split("").map(function(e){return e===" "||e==="\n"||t.length===0?e:(t.pop()," ")}).join("")}l.default=_}),226);
__d("MWChatEncryptedBackupsLayout.react",["FocusRegion.react","MWXColumn.react","MWXColumnItem.react","MWXRow.react","MWXRowItem.react","MWXText.react","react","xplatToDOMRef"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=e.actionsDirection,n=t===void 0?"row":t,a=e.children,i=e.focusRegionId,l=e.icon,u=e.innerContentPaddingHorizontal,c=u===void 0?20:u,d=e.innerContentPaddingVertical,m=d===void 0?20:d,p=e.outerContentPaddingHorizontal,_=p===void 0?20:p,f=e.outerContentPaddingVertical,g=f===void 0?20:f,h=e.primaryAction,y=e.ref,C=e.secondaryAction,b=e.showTopMargin,v=b===void 0?!0:b,S=e.showTopMarginSmall,R=S===void 0?!1:S,L=e.tertiaryAction,E=e.title,k=e.useBigTitle,I=k===void 0?!1:k,T=e.useCompressedIcon,D=T===void 0?!1:T,x=e.useScrollBar,$=x===void 0?!1:x,P=e.useStretchContent,N=P===void 0?!1:P,M=e.useTightTitle,w=M===void 0?!1:M,A=i==null?h:s.jsx(o("FocusRegion.react").FocusRegion,{id:i,children:h}),F=l!=null||I?"headlineEmphasized2":"headlineEmphasized3",O=s.jsx("div",babelHelpers.extends({},{0:{},1:{className:"x106a9eq x1xnnf8n"}}[!!w<<0],{children:s.jsx(r("MWXText.react"),{align:"center",isSemanticHeading:!0,type:F,children:E})}));return s.jsxs(r("MWXColumn.react"),{align:"center",paddingHorizontal:_,paddingVertical:g,ref:o("xplatToDOMRef").xplatToDOMRef(y),spacing:16,children:[l&&s.jsx(r("MWXColumnItem.react"),{children:s.jsx("div",babelHelpers.extends({},{0:{className:"x1sy10c2 x1y1aw1k xwib8y2"},1:{className:"x4arcmf x1cxtvei x6mlq2k x4m0w28"}}[!!D<<0],{children:l}))}),E!=null&&s.jsx(r("MWXColumnItem.react"),{align:"center",children:l!=null?O:s.jsx("div",babelHelpers.extends({},{0:{className:"x1iorvi4 x1lr1uin"},2:{className:"x4i7bpe x1lr1uin"},1:{className:"x1xy6bms x1lr1uin"},3:{className:"x1xy6bms x1lr1uin"}}[!!v<<1|!!R<<0],{children:O}))}),s.jsx(r("MWXColumnItem.react"),{align:N?"stretch":"center",paddingHorizontal:c,paddingVertical:m,children:s.jsx("div",babelHelpers.extends({},{0:{className:"xvc51xn x1dqj196 x2b8uid"},2:{className:"x1lziwak x14z9mp"},1:{className:"xvc51xn x1dqj196 x2b8uid x1jcbksy x1odjw0f"},3:{className:"x1lziwak x14z9mp x1jcbksy x1odjw0f"}}[!!N<<1|!!$<<0],{children:a}))}),(h!=null||C!=null||L!=null)&&s.jsx(r("MWXColumnItem.react"),{align:"stretch",children:n==="row"?s.jsxs(r("MWXRow.react"),{expanding:!0,paddingHorizontal:0,paddingVertical:0,spacing:8,children:[L!=null&&s.jsx(r("MWXRowItem.react"),{expanding:!0,children:L}),C!=null&&s.jsx(r("MWXRowItem.react"),{expanding:!0,children:C}),s.jsx(r("MWXRowItem.react"),{expanding:!0,children:A})]}):s.jsxs(r("MWXColumn.react"),{paddingHorizontal:0,paddingVertical:0,spacing:8,children:[s.jsx(r("MWXColumnItem.react"),{children:A}),C!=null&&s.jsx(r("MWXColumnItem.react"),{children:C}),L!=null&&s.jsx(r("MWXColumnItem.react"),{align:"center",children:L})]})})]})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("MWChatEncryptedBackupsAccessCodeInputStep.react",["fbt","EBSMGatingUI","FDSProgressButtonIndeterminate.react","MWChatEncryptedBackupsAccessCodeInput.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsSetIsDialogPersistedContext","MWEBNoMobileEOTRInformationalDialog.entrypoint","MWEBODSEntityKey.enum","MWEBODSEntityName.enum","MWEBUntrustedMobileEOTRInformationalDialog.entrypoint","MWEBVirtualDevicesContext.react","MWEncryptedBackupsLocalStorageEntryEnum","MWEncryptedBackupsOtcRestoreSteps","MWXButton.react","MWXText.react","QPLUserFlow","RelayHooks","UserMobileEBState","promiseDone","react","react-compiler-runtime","requireDeferred","useEncryptedBackupsQplImpressionRef","useGetUserMobileEBState","useLabyrinthLogging","useMAWEncryptedBackupsRestoreToast","useMWChatEncryptedBackupsAddDevice","useMWEBFlowSourceContext","usePushPage","useReStore"],(function(t,n,r,o,a,i,l,s){"use strict";var e=["onHighIntent"],u,c,d=c||(c=o("react")),m=c,p=m.useCallback,_=m.useContext,f=m.useState,g=r("requireDeferred")("MWEBUseLocalStorage").__setRef("MWChatEncryptedBackupsAccessCodeInputStep.react"),h=r("requireDeferred")("MWEncryptedBackupsSharedState").__setRef("MWChatEncryptedBackupsAccessCodeInputStep.react"),y=s._(/*BTDS*/"Submit");function C(t){var n=o("react-compiler-runtime").c(55),a=t.onClose,i=t.onComplete,l=t.onForgotRC,c=t.onSkip,m=t.pushPage,p=t.shouldShowForgotButton,C=p===void 0?!0:p,v;n[0]===Symbol.for("react.memo_cache_sentinel")?(v={},n[0]=v):v=n[0];var S=r("usePushPage")(r("MWEBNoMobileEOTRInformationalDialog.entrypoint"),v),R=S[0],L=S[1],E;if(n[1]!==L){var k=L.onHighIntent,I=babelHelpers.objectWithoutPropertiesLoose(L,e);E=I,n[1]=L,n[2]=E}else E=n[2];var T=r("useGetUserMobileEBState")(),D;n[3]===Symbol.for("react.memo_cache_sentinel")?(D={},n[3]=D):D=n[3];var x=r("usePushPage")(r("MWEBUntrustedMobileEOTRInformationalDialog.entrypoint"),D),$=x[0],P=(u||(u=r("useReStore")))(),N;n[4]===Symbol.for("react.memo_cache_sentinel")?(N=s._(/*BTDS*/"Enter your 40-character code to restore messages on this device."),n[4]=N):N=n[4];var M=N,w=f(""),A=w[0],F=w[1],O=f(!1),B=O[0],W=O[1],q=o("useLabyrinthLogging").useLabyrinthLoggingFlow(),U=q.startFlow,V=_(r("MWChatEncryptedBackupsSetIsDialogPersistedContext")).setIsDialogPersisted,H;n[5]!==V?(H=function(){o("MWChatEncryptedBackupsLogging").endFailure({errorName:"wrong_recovery_code",event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityKey:r("MWEBODSEntityKey.enum").INCORRECT_RECOVERY_CODE,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_RC_RESTORE_AUTH}),r("QPLUserFlow").markError(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"invalid_recovery_code_input"),W(!0),V==null||V(!1)},n[5]=V,n[6]=H):H=n[6];var G=H,z=r("useMAWEncryptedBackupsRestoreToast")(),j=z.showErrorToast,K=r("useMWEBFlowSourceContext")(),Q;n[7]!==B?(Q=function(t){B&&W(!1),F(t)},n[7]=B,n[8]=Q):Q=n[8];var X=Q,Y=o("RelayHooks").useRelayEnvironment(),J;n[9]!==P||n[10]!==i?(J=function(){var e;r("QPLUserFlow").addPoint((e=o("MWChatEncryptedBackupsQPLEvents")).restoreDeviceAuthQplEvent,"add_device_success"),r("QPLUserFlow").addPoint(e.restoreQplEvent,"restore_auth_finished_and_dismissed"),h.onReady(function(e){var t=e.upsertEBSharedStateEntry;r("promiseDone")(t({db:P,stateKey:r("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}))}),g.onReady(b),o("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:o("EBSMGatingUI").isBackendSetupSuccessfulForEBSM()}},event:e.restoreQplEvent}),o("MWChatEncryptedBackupsLogging").endSuccess({event:e.restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_RC_RESTORE_AUTH}),i()},n[9]=P,n[10]=i,n[11]=J):J=n[11];var Z=J,ee;n[12]!==V||n[13]!==j?(ee=function(t){o("MWChatEncryptedBackupsLogging").endFailure({errorName:t,event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),o("MWChatEncryptedBackupsLogging").endFailure({errorName:t,event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_RC_RESTORE_AUTH}),j(),V==null||V(!1)},n[12]=V,n[13]=j,n[14]=ee):ee=n[14];var te=ee,ne;n[15]!==G||n[16]!==Z||n[17]!==te||n[18]!==Y?(ne={environment:Y,onComplete:Z,onFailure:te,onInvalidRecoveryCode:G},n[15]=G,n[16]=Z,n[17]=te,n[18]=Y,n[19]=ne):ne=n[19];var re=r("useMWChatEncryptedBackupsAddDevice")(ne),oe=re[0],ae=re[1],ie=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_ENTER_RECOVERY_CODE_SCREEN_IMPRESSION",void 0,function(){pe!=null&&r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_OPTION_DISPLAYED_RESTORE_SCREEN")}),le;n[20]!==a||n[21]!==i||n[22]!==l||n[23]!==E||n[24]!==m||n[25]!==R||n[26]!==$||n[27]!==C||n[28]!==T?(le=C?d.jsx(r("MWXButton.react"),babelHelpers.extends({},T.state===o("UserMobileEBState").UserMobileEBState.NO_MOBILE?E:null,{label:s._(/*BTDS*/"Don\u2019t have your code?"),onPress:function(){T.state===o("UserMobileEBState").UserMobileEBState.NO_MOBILE?R({onClose:a,onComplete:i}):T.state===o("UserMobileEBState").UserMobileEBState.UNTRUSTED_MOBILE?$({onClose:a,onComplete:i,pushPage:m}):(r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_ENTER_RECOVERY_CODE_SCREEN_ACTION_DONT_HAVE_RC"),l())},testid:void 0,type:"secondary"})):null,n[20]=a,n[21]=i,n[22]=l,n[23]=E,n[24]=m,n[25]=R,n[26]=$,n[27]=C,n[28]=T,n[29]=le):le=n[29];var se=le,ue;n[30]!==a||n[31]!==i||n[32]!==c||n[33]!==m?(ue=function(){o("MWEncryptedBackupsOtcRestoreSteps").pushByOneTimeCodePage({onClose:a,onOtcComplete:i,onSkip:c,pushPage:m})},n[30]=a,n[31]=i,n[32]=c,n[33]=m,n[34]=ue):ue=n[34];var ce=ue,de=o("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices(),me=de.virtualDeviceInfo,pe=me.doesUserHaveOtcEligibleDevices?d.jsx(r("MWXButton.react"),{label:s._(/*BTDS*/"Use a one-time code instead"),onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_USE_ONE_TIME_CODE_CLICK"),ce()},reduceEmphasis:!1,testid:void 0,type:"secondary"}):null,_e=pe!=null?pe:se,fe;n[35]!==A||n[36]!==oe||n[37]!==K||n[38]!==ae||n[39]!==V||n[40]!==U?(fe=ae?d.jsx(r("FDSProgressButtonIndeterminate.react"),{label:y}):d.jsx(r("MWXButton.react"),{disabled:A.length<40,label:y,onPress:function(){var e;r("QPLUserFlow").addPoint((e=o("MWChatEncryptedBackupsQPLEvents")).restoreQplEvent,"RESTORE_ENTER_RECOVERY_CODE_SCREEN_ACTION_SUBMIT");var t=K();r("QPLUserFlow").addAnnotations(e.restoreQplEvent,{string:{restore_type:"recovery_code",source:t}}),U({additionalAnnotations:{device_type:"OFFLINE"},event:e.restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_RC_RESTORE_AUTH,source:t}),r("QPLUserFlow").addPoint(e.restoreDeviceAuthQplEvent,"add_device_begin"),V==null||V(!0),oe(A)},testid:void 0}),n[35]=A,n[36]=oe,n[37]=K,n[38]=ae,n[39]=V,n[40]=U,n[41]=fe):fe=n[41];var ge=ae?null:_e,he,ye;n[42]===Symbol.for("react.memo_cache_sentinel")?(he=s._(/*BTDS*/"Restore your chat history"),ye=d.jsx("div",{className:"xwib8y2",children:d.jsx(r("MWXText.react"),{type:"meta3",children:M})}),n[42]=he,n[43]=ye):(he=n[42],ye=n[43]);var Ce;n[44]!==A||n[45]!==X?(Ce=d.jsx(r("MWChatEncryptedBackupsAccessCodeInput.react"),{onValueChange:X,smallInput:!1,value:A}),n[44]=A,n[45]=X,n[46]=Ce):Ce=n[46];var be;n[47]!==B?(be=B?d.jsx("div",{className:"x106a9eq x1xnnf8n xz9dl7a",children:d.jsx(r("MWXText.react"),{align:"center",color:"negative",testid:void 0,type:"meta3",children:s._(/*BTDS*/"Incorrect 40-character code. Try again.")})}):null,n[47]=B,n[48]=be):be=n[48];var ve;return n[49]!==ie||n[50]!==fe||n[51]!==ge||n[52]!==Ce||n[53]!==be?(ve=d.jsxs(r("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",primaryAction:fe,ref:ie,secondaryAction:ge,showTopMargin:!1,title:he,children:[ye,Ce,be]}),n[49]=ie,n[50]=fe,n[51]=ge,n[52]=Ce,n[53]=be,n[54]=ve):ve=n[54],ve}function b(e){var t=e.mwEBCreateLocalStorageEntry,n=e.mwEBDeleteLocalStorageEntry;t(r("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION),t(r("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION_2),n(r("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE)}l.default=C}),226);
__d("MWChatEncryptedBackupsChevronRightIconMedium.react",["MWXIconChevronRight","MWXIconStrict.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(2),n=e.disabled,a=n===void 0?!1:n,i=a?"disabled":"primary",l;return t[0]!==i?(l=s.jsx(r("MWXIconStrict.react"),{color:i,icon:r("MWXIconChevronRight"),size:24}),t[0]=i,t[1]=l):l=t[1],l}l.default=u}),98);
__d("MWChatEncryptedBackupsRecoveryCodeIcon.react",["ix","CometImageFromIXValue.react","react","react-compiler-runtime","stylex","useCurrentDisplayMode"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react"));function d(t){var n=o("react-compiler-runtime").c(9),a=t.alt,i=t.ref,l=t.xstyle,u=r("useCurrentDisplayMode")(),d=u==="dark",m;n[0]!==d?(m=s(d?"232768":"232770"),n[0]=d,n[1]=m):m=n[1];var p=m,_;n[2]!==a||n[3]!==i||n[4]!==p?(_=c.jsx(r("CometImageFromIXValue.react"),{alt:a,ref:i,source:p}),n[2]=a,n[3]=i,n[4]=p,n[5]=_):_=n[5];var f=_,g;return n[6]!==f||n[7]!==l?(g=l==null?f:c.jsx("div",babelHelpers.extends({},(e||(e=r("stylex"))).props(l),{children:f})),n[6]=f,n[7]=l,n[8]=g):g=n[8],g}l.default=d}),98);
__d("MWChatEncryptedBackupsInterstitialIcon.react",["ix","CometImageFromIXValue.react","gkx","react","react-compiler-runtime","stylex","useCurrentDisplayMode"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react"));function d(t){var n=o("react-compiler-runtime").c(9),a=t.alt,i=t.ref,l=t.xstyle,u=r("useCurrentDisplayMode")(),d=u==="dark",m;n[0]!==d?(m=r("gkx")("23219")?s(d?"230225":"230227"):s("835202"),n[0]=d,n[1]=m):m=n[1];var p=m,_;n[2]!==a||n[3]!==i||n[4]!==p?(_=c.jsx(r("CometImageFromIXValue.react"),{alt:a,ref:i,source:p}),n[2]=a,n[3]=i,n[4]=p,n[5]=_):_=n[5];var f=_,g;return n[6]!==f||n[7]!==l?(g=l==null?f:c.jsx("div",babelHelpers.extends({},(e||(e=r("stylex"))).props(l),{children:f})),n[6]=f,n[7]=l,n[8]=g):g=n[8],g}l.default=d}),98);
__d("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react",["fbt","MWChatEncryptedBackupsInterstitialIcon.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWXButton.react","MWXIconCalendar","MWXIconDocument","MWXIconStrict.react","MWXLink.react","MWXListCell.react","MWXTextPairing.react","QPLUserFlow","react","react-compiler-runtime","useEncryptedBackupsQplImpressionRef"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c="https://www.facebook.com/help/messenger-app/431055522328649?ref=learn_more";function d(e){var t=o("react-compiler-runtime").c(16),n=e.onClose,a=e.onDontRestore,i=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_END_OF_ROAD_IMPRESSION"),l;t[0]===Symbol.for("react.memo_cache_sentinel")?(l=u.jsx(r("MWChatEncryptedBackupsInterstitialIcon.react"),{}),t[0]=l):l=t[0];var d;t[1]===Symbol.for("react.memo_cache_sentinel")?(d=s._(/*BTDS*/"Go to chats"),t[1]=d):d=t[1];var p;t[2]!==n||t[3]!==a?(p=u.jsx(r("MWXButton.react"),{label:d,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_END_OF_THE_ROAD_ACTION_GO_TO_CHATS"),a==null||a(),o("MWChatEncryptedBackupsLogging").cancelFlow({cancelEndPoint:"END_OF_THE_ROAD_GO_TO_CHATS",event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),n()}}),t[2]=n,t[3]=a,t[4]=p):p=t[4];var _,f;t[5]===Symbol.for("react.memo_cache_sentinel")?(_=s._(/*BTDS*/"Other steps you can take to restore your messages"),f={className:"xfdjxqc"},t[5]=_,t[6]=f):(_=t[5],f=t[6]);var g;t[7]===Symbol.for("react.memo_cache_sentinel")?(g=u.jsx(r("MWXIconStrict.react"),{backgroundEnabled:!0,color:"primary",icon:r("MWXIconCalendar"),size:36}),t[7]=g):g=t[7];var h;t[8]===Symbol.for("react.memo_cache_sentinel")?(h=s._(/*BTDS*/"Skip restoring for now and try again later from Settings."),t[8]=h):h=t[8];var y;t[9]===Symbol.for("react.memo_cache_sentinel")?(y=u.jsx(r("MWXListCell.react"),{addOnStart:g,content:u.jsx(r("MWXTextPairing.react"),{body:h,bodyColor:"secondary",headline:s._(/*BTDS*/"Restore messages later"),headlineColor:"primary",level:4})}),t[9]=y):y=t[9];var C;t[10]===Symbol.for("react.memo_cache_sentinel")?(C=u.jsx(r("MWXIconStrict.react"),{backgroundEnabled:!0,color:"primary",icon:r("MWXIconDocument"),size:36}),t[10]=C):C=t[10];var b;t[11]===Symbol.for("react.memo_cache_sentinel")?(b=s._(/*BTDS*/"Find other ways to restore your messages in the {helpCenterLink}.",[s._param("helpCenterLink",u.jsx(r("MWXLink.react"),{display_DEPRECATED:"inline",href:c,onClick:m,rel:"noreferrer",target:"_blank",children:u.jsx("b",{children:s._(/*BTDS*/"Help Center")})}))]),t[11]=b):b=t[11];var v;t[12]===Symbol.for("react.memo_cache_sentinel")?(v=u.jsxs("div",babelHelpers.extends({},f,{children:[y,u.jsx(r("MWXListCell.react"),{addOnEndVerticalAlign:"center",addOnStart:C,addOnStartVerticalAlign:"center",content:u.jsx(r("MWXTextPairing.react"),{body:b,bodyColor:"secondary",headline:s._(/*BTDS*/"See all restore options"),headlineColor:"primary",level:4})})]})),t[12]=v):v=t[12];var S;return t[13]!==i||t[14]!==p?(S=u.jsx(r("MWChatEncryptedBackupsLayout.react"),{icon:l,primaryAction:p,ref:i,title:_,children:v}),t[13]=i,t[14]=p,t[15]=S):S=t[15],S}function m(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_END_OF_THE_ROAD_ACTION_OPEN_HELP_CENTER_LINK")}l.default=d}),226);
__d("MWChatEncryptedBackupsCreatePinInstruction.react",["fbt","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsRecoveryCodeIcon.react","MWChatEncryptedBackupsRestoreEndOfRoadDialog.react","MWXButton.react","MWXLink.react","MWXListCell.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","deferredLoadComponent","react","react-compiler-runtime","requireDeferred","useEncryptedBackupsQplImpressionRef","useMWEncryptedBackupsListenForChangesToVirtualDevicesV2"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useCallback,m=c.useState,p=r("deferredLoadComponent")(r("requireDeferred")("MWChatEncryptedBackupsPinCodeRestoreStep.react").__setRef("MWChatEncryptedBackupsCreatePinInstruction.react")),_="https://www.facebook.com/help/messenger-app/3357856081116516?ref=learn_more";function f(e){var t=o("react-compiler-runtime").c(31),n=e.onClose,a=e.onComplete,i=e.pushPage,l=m(!0),c=l[0],d=l[1],f=r("useMWEncryptedBackupsListenForChangesToVirtualDevicesV2")(),h=f.vestaClientID;c&&h!=null&&d(!1);var y;t[0]!==n||t[1]!==i?(y=function(){return i(function(){return u.jsx(r("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react"),{onClose:n})})},t[0]=n,t[1]=i,t[2]=y):y=t[2];var C=y,b;t[3]!==n||t[4]!==a||t[5]!==i||t[6]!==h?(b=function(){return i(function(){return h==null?null:u.jsx(p,{onClose:n,onComplete:a,onSkip:n,pushPage:i})})},t[3]=n,t[4]=a,t[5]=i,t[6]=h,t[7]=b):b=t[7];var v=b,S=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_PIN_SCREEN_IMPRESSION"),R;t[8]===Symbol.for("react.memo_cache_sentinel")?(R=u.jsx(r("MWChatEncryptedBackupsRecoveryCodeIcon.react"),{}),t[8]=R):R=t[8];var L;t[9]===Symbol.for("react.memo_cache_sentinel")?(L=s._(/*BTDS*/"Enter PIN"),t[9]=L):L=t[9];var E;t[10]!==v?(E=function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_PIN_SCREEN_ENTER_PIN_CLICK"),v()},t[10]=v,t[11]=E):E=t[11];var k;t[12]!==c||t[13]!==E?(k=u.jsx(r("MWXButton.react"),{disabled:c,label:L,onPress:E}),t[12]=c,t[13]=E,t[14]=k):k=t[14];var I;t[15]===Symbol.for("react.memo_cache_sentinel")?(I=s._(/*BTDS*/"Can\u2019t create PIN?"),t[15]=I):I=t[15];var T;t[16]!==C?(T=u.jsx(r("MWXButton.react"),{label:I,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_PIN_SCREEN_CANT_CREATE_PIN_CLICK"),C()},type:"secondary"}),t[16]=C,t[17]=T):T=t[17];var D;t[18]===Symbol.for("react.memo_cache_sentinel")?(D={className:"xewm4ob"},t[18]=D):D=t[18];var x,$;t[19]===Symbol.for("react.memo_cache_sentinel")?(x=u.jsx("div",babelHelpers.extends({},D,{children:u.jsx(r("MWXText.react"),{align:"center",type:"headlineEmphasized2",children:s._(/*BTDS*/"Create a PIN to restore your chats")})})),$={className:"x162z183 xd9ej83 xm77wn2 xvue9z"},t[19]=x,t[20]=$):(x=t[19],$=t[20]);var P;t[21]===Symbol.for("react.memo_cache_sentinel")?(P=s._(/*BTDS*/"Step 1 \u00b7 Find your mobile device"),t[21]=P):P=t[21];var N;t[22]===Symbol.for("react.memo_cache_sentinel")?(N=s._(/*BTDS*/"It needs to have secure storage turned on."),t[22]=N):N=t[22];var M,w;t[23]===Symbol.for("react.memo_cache_sentinel")?(M=u.jsx(r("MWXListCell.react"),{content:u.jsx(r("MWXTextPairing.react"),{headline:P,level:4,meta:u.jsxs(u.Fragment,{children:[N," ",u.jsx(r("MWXLink.react"),{href:_,onClick:g,rel:"noreferrer",target:"_blank",children:u.jsx("b",{children:s._(/*BTDS*/"Learn more")})})]})})}),w=u.jsx("br",{}),t[23]=M,t[24]=w):(M=t[23],w=t[24]);var A;t[25]===Symbol.for("react.memo_cache_sentinel")?(A=s._(/*BTDS*/"Step 2 \u00b7 Create a PIN on that device"),t[25]=A):A=t[25];var F;t[26]===Symbol.for("react.memo_cache_sentinel")?(F=u.jsxs("div",babelHelpers.extends({},$,{children:[M,w,u.jsx(r("MWXListCell.react"),{content:u.jsx(r("MWXTextPairing.react"),{headline:A,level:4,meta:u.jsxs(r("MWXText.react"),{type:"meta4",children:[s._(/*BTDS*/"1. Go to Messenger Settings"),u.jsx("br",{}),s._(/*BTDS*/"2. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Privacy & safety")}))]),u.jsx("br",{}),s._(/*BTDS*/"3. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"End-to-end encrypted chats")}))]),u.jsx("br",{}),s._(/*BTDS*/"4. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Message storage")}))]),u.jsx("br",{}),s._(/*BTDS*/"5. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Create PIN")}))])]})})})]})),t[26]=F):F=t[26];var O;return t[27]!==S||t[28]!==k||t[29]!==T?(O=u.jsxs(r("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:R,primaryAction:k,ref:S,secondaryAction:T,children:[x,F]}),t[27]=S,t[28]=k,t[29]=T,t[30]=O):O=t[30],O}function g(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_PIN_SCREEN_LEARN_MORE_LINK_CLICK")}l.default=f}),226);
__d("pushRCRestoreStep",["MWEncryptedBackupsForgotRCStep","deferredLoadComponent","react","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=r("deferredLoadComponent")(r("requireDeferred")("MWChatEncryptedBackupsAccessCodeInputStep.react").__setRef("pushRCRestoreStep"));function c(e){var t=e.onClose,n=e.onComplete,r=e.onForgotRC,a=e.pushPage,i=e.shouldShowForgotButton,l=function(){o("MWEncryptedBackupsForgotRCStep").pushForgotRCPage({onClose:t,onComplete:n,pushPage:a})},c=r!=null?r:l;a(function(){return s.jsx(u,{onClose:t,onComplete:n,onForgotRC:c,onSkip:t,pushPage:a,shouldShowForgotButton:i})})}l.default=c}),98);
__d("MWChatEncryptedBackupsGenerateNewRecoveryCodeInstruction.react",["fbt","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsRecoveryCodeIcon.react","MWChatEncryptedBackupsRestoreEndOfRoadDialog.react","MWEBHasSeenAutoRestoreNoticeContext","MWXButton.react","MWXLink.react","MWXListCell.react","MWXMultiStepDialogHeader.react","MWXTextPairing.react","QPLUserFlow","pushRCRestoreStep","react","react-compiler-runtime","useEncryptedBackupsQplImpressionRef","useMWEBAutoRestoreNoticeStep"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useContext,d="https://www.facebook.com/help/messenger-app/3357856081116516?ref=learn_more";function m(e){var t=o("react-compiler-runtime").c(28),n=e.onClose,a=e.onCloseDialogWithConfirmation,i=e.onComplete,l=e.onDontRestore,m=e.pushPage,_=a!=null,f=c(r("MWEBHasSeenAutoRestoreNoticeContext")),g=f.hasSeenNotice,h=r("useMWEBAutoRestoreNoticeStep")(),y;t[0]!==_||t[1]!==a||t[2]!==i||t[3]!==l||t[4]!==m?(y=function(){m(function(){return u.jsxs(u.Fragment,{children:[_?u.jsx(r("MWXMultiStepDialogHeader.react"),{onClose:a,title:null,withCloseButton:!0,withoutBackButton:!0}):null,u.jsx(r("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react"),{onClose:i,onDontRestore:l})]})})},t[0]=_,t[1]=a,t[2]=i,t[3]=l,t[4]=m,t[5]=y):y=t[5];var C=y,b=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_RC_SCREEN_IMPRESSION"),v;t[6]===Symbol.for("react.memo_cache_sentinel")?(v=u.jsx(r("MWChatEncryptedBackupsRecoveryCodeIcon.react"),{}),t[6]=v):v=t[6];var S;t[7]===Symbol.for("react.memo_cache_sentinel")?(S=s._(/*BTDS*/"Enter new code"),t[7]=S):S=t[7];var R;t[8]!==h||t[9]!==g||t[10]!==n||t[11]!==i||t[12]!==m?(R=u.jsx(r("MWXButton.react"),{label:S,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_RC_SCREEN_ACTION_ENTER_CODE"),r("pushRCRestoreStep")({onClose:n,onComplete:function(){h({hasSeenNotice:g,onNextStep:i,pushPage:m})},pushPage:m,shouldShowForgotButton:!1})},testid:void 0}),t[8]=h,t[9]=g,t[10]=n,t[11]=i,t[12]=m,t[13]=R):R=t[13];var L;t[14]===Symbol.for("react.memo_cache_sentinel")?(L=s._(/*BTDS*/"Can\u2019t generate code?"),t[14]=L):L=t[14];var E;t[15]!==C?(E=u.jsx(r("MWXButton.react"),{label:L,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_RC_SCREEN_ACTION_CANT_GENERATE_CODE"),C()},type:"secondary"}),t[15]=C,t[16]=E):E=t[16];var k,I;t[17]===Symbol.for("react.memo_cache_sentinel")?(k=s._(/*BTDS*/"Generate a new code to restore your chats"),I={className:"xvue9z"},t[17]=k,t[18]=I):(k=t[17],I=t[18]);var T;t[19]===Symbol.for("react.memo_cache_sentinel")?(T=s._(/*BTDS*/"It needs to have secure storage turned on. It\u2019s likely to be the device you used to create your original 40-character code."),t[19]=T):T=t[19];var D;t[20]===Symbol.for("react.memo_cache_sentinel")?(D=u.jsxs(u.Fragment,{children:[T," ",u.jsx(r("MWXLink.react"),{display_DEPRECATED:"inline",href:d,onClick:p,rel:"noreferrer",target:"_blank",children:u.jsx("b",{children:s._(/*BTDS*/"Learn more")})})]}),t[20]=D):D=t[20];var x;t[21]===Symbol.for("react.memo_cache_sentinel")?(x=u.jsx(r("MWXListCell.react"),{content:u.jsx(r("MWXTextPairing.react"),{body:D,bodyColor:"secondary",headline:s._(/*BTDS*/"Step 1 \u00b7 Find your other device"),level:4})}),t[21]=x):x=t[21];var $;t[22]===Symbol.for("react.memo_cache_sentinel")?($=u.jsxs(u.Fragment,{children:[s._(/*BTDS*/"1. Go to Messenger Settings"),u.jsx("br",{}),s._(/*BTDS*/"2. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Privacy & safety")}))]),u.jsx("br",{}),s._(/*BTDS*/"3. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"End-to-end encrypted chats")}))]),u.jsx("br",{}),s._(/*BTDS*/"4. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Message storage")}))]),u.jsx("br",{}),s._(/*BTDS*/"5. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Generate recovery code")}))])]}),t[22]=$):$=t[22];var P;t[23]===Symbol.for("react.memo_cache_sentinel")?(P=u.jsxs("div",babelHelpers.extends({},I,{children:[x,u.jsx(r("MWXListCell.react"),{content:u.jsx(r("MWXTextPairing.react"),{body:$,bodyColor:"secondary",headline:s._(/*BTDS*/"Step 2 \u00b7 Generate a new code on that device"),level:4})})]})),t[23]=P):P=t[23];var N;return t[24]!==b||t[25]!==R||t[26]!==E?(N=u.jsx(r("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:v,primaryAction:R,ref:b,secondaryAction:E,title:k,children:P}),t[24]=b,t[25]=R,t[26]=E,t[27]=N):N=t[27],N}function p(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_SCREEN_ACTION_OPEN_LEARN_MORE_LINK")}l.default=m}),226);
__d("MWChatEncryptedBackupsCreateRecoveryCodeInstruction.react",["fbt","MWChatEncryptedBackupsGenerateNewRecoveryCodeInstruction.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsRecoveryCodeIcon.react","MWChatEncryptedBackupsRestoreEndOfRoadDialog.react","MWEBHasSeenAutoRestoreNoticeContext","MWXButton.react","MWXLink.react","MWXListCell.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","pushRCRestoreStep","react","react-compiler-runtime","useEncryptedBackupsQplImpressionRef","useMWEBAutoRestoreNoticeStep","useMWEncryptedBackupsListenForChangesToVirtualDevicesV2"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useCallback,m=c.useContext,p=c.useState,_="https://www.facebook.com/help/messenger-app/3357856081116516?ref=learn_more";function f(e){var t=o("react-compiler-runtime").c(34),n=e.onClose,a=e.onComplete,i=e.pushPage,l=p(!0),c=l[0],d=l[1],f=r("useMWEncryptedBackupsListenForChangesToVirtualDevicesV2")(),h=f.offlineDevicesCount,y=r("useMWEBAutoRestoreNoticeStep")(),C=m(r("MWEBHasSeenAutoRestoreNoticeContext")),b=C.hasSeenNotice;c&&h>0&&d(!1);var v;t[0]!==n||t[1]!==i?(v=function(){return i(function(){return u.jsx(r("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react"),{onClose:n})})},t[0]=n,t[1]=i,t[2]=v):v=t[2];var S=v,R;t[3]!==n||t[4]!==a||t[5]!==i?(R=function(){return i(function(){return u.jsx(r("MWChatEncryptedBackupsGenerateNewRecoveryCodeInstruction.react"),{onClose:n,onComplete:a,pushPage:i})})},t[3]=n,t[4]=a,t[5]=i,t[6]=R):R=t[6];var L=R,E=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_RC_SCREEN_IMPRESSION"),k;t[7]===Symbol.for("react.memo_cache_sentinel")?(k=u.jsx(r("MWChatEncryptedBackupsRecoveryCodeIcon.react"),{}),t[7]=k):k=t[7];var I;t[8]===Symbol.for("react.memo_cache_sentinel")?(I=s._(/*BTDS*/"Enter 40-character code"),t[8]=I):I=t[8];var T;t[9]!==y||t[10]!==b||t[11]!==n||t[12]!==L||t[13]!==i?(T=function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_RC_SCREEN_ENTER_CODE_CLICK"),r("pushRCRestoreStep")({onClose:n,onComplete:function(){y({hasSeenNotice:b,onNextStep:n,pushPage:i})},onForgotRC:L,pushPage:i,shouldShowForgotButton:!1})},t[9]=y,t[10]=b,t[11]=n,t[12]=L,t[13]=i,t[14]=T):T=t[14];var D;t[15]!==c||t[16]!==T?(D=u.jsx(r("MWXButton.react"),{disabled:c,label:I,onPress:T}),t[15]=c,t[16]=T,t[17]=D):D=t[17];var x;t[18]===Symbol.for("react.memo_cache_sentinel")?(x=s._(/*BTDS*/"Can\u2019t generate code?"),t[18]=x):x=t[18];var $;t[19]!==S?($=u.jsx(r("MWXButton.react"),{label:x,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_RC_SCREEN_CANT_GENERATE_CODE_CLICK"),S()},type:"secondary"}),t[19]=S,t[20]=$):$=t[20];var P;t[21]===Symbol.for("react.memo_cache_sentinel")?(P={className:"xewm4ob"},t[21]=P):P=t[21];var N,M;t[22]===Symbol.for("react.memo_cache_sentinel")?(N=u.jsx("div",babelHelpers.extends({},P,{children:u.jsx(r("MWXText.react"),{align:"center",type:"headlineEmphasized2",children:s._(/*BTDS*/"Generate a 40-character code to restore your chats")})})),M={className:"x162z183 xd9ej83 xm77wn2 xvue9z"},t[22]=N,t[23]=M):(N=t[22],M=t[23]);var w;t[24]===Symbol.for("react.memo_cache_sentinel")?(w=s._(/*BTDS*/"Step 1 \u00b7 Find your mobile device"),t[24]=w):w=t[24];var A;t[25]===Symbol.for("react.memo_cache_sentinel")?(A=s._(/*BTDS*/"It needs to have secure storage turned on."),t[25]=A):A=t[25];var F,O;t[26]===Symbol.for("react.memo_cache_sentinel")?(F=u.jsx(r("MWXListCell.react"),{content:u.jsx(r("MWXTextPairing.react"),{headline:w,level:4,meta:u.jsxs(u.Fragment,{children:[A," ",u.jsx(r("MWXLink.react"),{display_DEPRECATED:"inline",href:_,onClick:g,rel:"noreferrer",target:"_blank",children:u.jsx("b",{children:s._(/*BTDS*/"Learn more")})})]})})}),O=u.jsx("br",{}),t[26]=F,t[27]=O):(F=t[26],O=t[27]);var B;t[28]===Symbol.for("react.memo_cache_sentinel")?(B=s._(/*BTDS*/"Step 2 \u00b7 Generate a 40-character code on that device"),t[28]=B):B=t[28];var W;t[29]===Symbol.for("react.memo_cache_sentinel")?(W=u.jsxs("div",babelHelpers.extends({},M,{children:[F,O,u.jsx(r("MWXListCell.react"),{content:u.jsx(r("MWXTextPairing.react"),{headline:B,level:4,meta:u.jsxs(r("MWXText.react"),{type:"meta4",children:[s._(/*BTDS*/"1. Go to Messenger Settings"),u.jsx("br",{}),s._(/*BTDS*/"2. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Privacy & safety")}))]),u.jsx("br",{}),s._(/*BTDS*/"3. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"End-to-end encrypted chats")}))]),u.jsx("br",{}),s._(/*BTDS*/"4. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Message storage")}))]),u.jsx("br",{}),s._(/*BTDS*/"5. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Generate recovery code")}))])]})})})]})),t[29]=W):W=t[29];var q;return t[30]!==E||t[31]!==D||t[32]!==$?(q=u.jsxs(r("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:k,primaryAction:D,ref:E,secondaryAction:$,children:[N,W]}),t[30]=E,t[31]=D,t[32]=$,t[33]=q):q=t[33],q}function g(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_RC_SCREEN_LEARN_MORE_LINK_CLICK")}l.default=f}),226);
__d("MWChatEncryptedBackupsDots3HorizontalIconSmall.react",["ix","FDSDots3HorizontalFilled20Icon","MWXIcon_DEPRECATED.react","cr:1376","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(){var e=o("react-compiler-runtime").c(1),t;if(e[0]===Symbol.for("react.memo_cache_sentinel")){var a=n("cr:1376")!=null?new(n("cr:1376"))(s("275834"),24,24):r("FDSDots3HorizontalFilled20Icon");t=u.jsx(r("MWXIcon_DEPRECATED.react"),{color:"primary",icon:a}),e[0]=t}else t=e[0];return t}l.default=c}),98);
__d("MWChatEncryptedBackupsTextIconSmall.react",["ix","FDSTextFilled20Icon","MWXIcon_DEPRECATED.react","cr:1376","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(){var e=o("react-compiler-runtime").c(1),t;if(e[0]===Symbol.for("react.memo_cache_sentinel")){var a=n("cr:1376")!=null?new(n("cr:1376"))(s("275886"),24,24):r("FDSTextFilled20Icon");t=u.jsx(r("MWXIcon_DEPRECATED.react"),{color:"primary",icon:a}),e[0]=t}else t=e[0];return t}l.default=c}),98);
__d("MWChatEncryptedBackupsEOTRPhaseOne",["fbt","MWChatEncryptedBackupsAddonIcon.react","MWChatEncryptedBackupsChevronRightIconMedium.react","MWChatEncryptedBackupsCreatePinInstruction.react","MWChatEncryptedBackupsCreateRecoveryCodeInstruction.react","MWChatEncryptedBackupsDots3HorizontalIconSmall.react","MWChatEncryptedBackupsInterstitialIcon.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsTextIconSmall.react","MWXListCellPressable.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","react","react-compiler-runtime","useEncryptedBackupsQplImpressionRef"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useCallback;function d(e){var t=o("react-compiler-runtime").c(28),n=e.onClose,a=e.onComplete,i=e.pushPage,l;t[0]!==n||t[1]!==a||t[2]!==i?(l=function(){return i(function(){return u.jsx(r("MWChatEncryptedBackupsCreatePinInstruction.react"),{onClose:n,onComplete:a,pushPage:i})})},t[0]=n,t[1]=a,t[2]=i,t[3]=l):l=t[3];var c=l,d;t[4]!==n||t[5]!==a||t[6]!==i?(d=function(){return i(function(){return u.jsx(r("MWChatEncryptedBackupsCreateRecoveryCodeInstruction.react"),{onClose:n,onComplete:a,pushPage:i})})},t[4]=n,t[5]=a,t[6]=i,t[7]=d):d=t[7];var m=d,p=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_OPTIONS_IMPRESSION"),_;t[8]===Symbol.for("react.memo_cache_sentinel")?(_=u.jsx(r("MWChatEncryptedBackupsInterstitialIcon.react"),{}),t[8]=_):_=t[8];var f;t[9]===Symbol.for("react.memo_cache_sentinel")?(f=s._(/*BTDS*/"Restore your end-to-end encrypted chats with your mobile device"),t[9]=f):f=t[9];var g,h;t[10]===Symbol.for("react.memo_cache_sentinel")?(g=u.jsx(r("MWXText.react"),{color:"secondary",type:"body4",children:s._(/*BTDS*/"Try one of these methods to get your chats on this device.")}),h={className:"x1miatn0 x2b8uid xk68kj7"},t[10]=g,t[11]=h):(g=t[10],h=t[11]);var y;t[12]===Symbol.for("react.memo_cache_sentinel")?(y=u.jsx(r("MWChatEncryptedBackupsChevronRightIconMedium.react"),{}),t[12]=y):y=t[12];var C;t[13]===Symbol.for("react.memo_cache_sentinel")?(C=u.jsx(r("MWChatEncryptedBackupsAddonIcon.react"),{icon:u.jsx(r("MWChatEncryptedBackupsDots3HorizontalIconSmall.react"),{})}),t[13]=C):C=t[13];var b;t[14]===Symbol.for("react.memo_cache_sentinel")?(b=u.jsx(r("MWXTextPairing.react"),{headline:s._(/*BTDS*/"Learn how to create a PIN"),level:4}),t[14]=b):b=t[14];var v;t[15]!==c?(v=u.jsx(r("MWXListCellPressable.react"),{addOnEnd:y,addOnEndVerticalAlign:"center",addOnStart:C,addOnStartVerticalAlign:"center",content:b,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_PIN_CODE_CLICK"),c()}}),t[15]=c,t[16]=v):v=t[16];var S;t[17]===Symbol.for("react.memo_cache_sentinel")?(S=u.jsx(r("MWChatEncryptedBackupsChevronRightIconMedium.react"),{}),t[17]=S):S=t[17];var R;t[18]===Symbol.for("react.memo_cache_sentinel")?(R=u.jsx(r("MWChatEncryptedBackupsAddonIcon.react"),{icon:u.jsx(r("MWChatEncryptedBackupsTextIconSmall.react"),{})}),t[18]=R):R=t[18];var L;t[19]===Symbol.for("react.memo_cache_sentinel")?(L=u.jsx(r("MWXTextPairing.react"),{headline:s._(/*BTDS*/"Learn how to generate a 40-character code"),level:4}),t[19]=L):L=t[19];var E;t[20]!==m?(E=u.jsx(r("MWXListCellPressable.react"),{addOnEnd:S,addOnEndVerticalAlign:"center",addOnStart:R,addOnStartVerticalAlign:"center",content:L,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_RECOVERY_CODE_CLICK"),m()}}),t[20]=m,t[21]=E):E=t[21];var k;t[22]!==v||t[23]!==E?(k=u.jsxs("div",babelHelpers.extends({},h,{children:[v,E]})),t[22]=v,t[23]=E,t[24]=k):k=t[24];var I;return t[25]!==p||t[26]!==k?(I=u.jsxs(r("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"row",icon:_,ref:p,title:f,children:[g,k]}),t[25]=p,t[26]=k,t[27]=I):I=t[27],I}l.default=d}),226);
__d("MWChatEncryptedBackupsKVSOnlyRestoreStep.react",["MWChatEncryptedBackupsEOTRPhaseOne","UserMobileEBState","cr:27431","cr:7116","react","react-compiler-runtime","useGetUserMobileEBState"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c=(e=n("cr:27431"))!=null?e:n("cr:7116");function d(e){var t=o("react-compiler-runtime").c(8),n=e.onClose,a=e.onComplete,i=e.pushPage,l=r("useGetUserMobileEBState")(),s=l.state===o("UserMobileEBState").UserMobileEBState.UNTRUSTED_MOBILE||l.state===o("UserMobileEBState").UserMobileEBState.NO_MOBILE;if(s&&c!=null){var d;return t[0]!==n||t[1]!==a||t[2]!==i?(d=u.jsx(c,{onClose:n,onComplete:a,pushPage:i}),t[0]=n,t[1]=a,t[2]=i,t[3]=d):d=t[3],d}var m;return t[4]!==n||t[5]!==a||t[6]!==i?(m=u.jsx(r("MWChatEncryptedBackupsEOTRPhaseOne"),{onClose:n,onComplete:a,pushPage:i}),t[4]=n,t[5]=a,t[6]=i,t[7]=m):m=t[7],m}l.default=d}),98);
__d("MWEBAutoRestoreNoticeDialogStep.react",["fbt","CometRelay","MWChatEncryptedBackupsDismissalDialogContext","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsSettingsDialog.entrypoint","MWXButton.react","MWXColumn.react","MWXColumnItem.react","MWXDialogHeader.react","MWXDialogPage.react","MWXLink.react","MWXRow.react","MWXRowItem.react","MWXText.react","gkx","qex","react","react-compiler-runtime","useCometRelayEntrypointContextualEnvironmentProvider","useEncryptedBackupsQplImpressionRef","useMergeRefs","useVisibilityObserver"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useCallback,m=c.useContext,p=c.useRef,_=r("gkx")("23219");function f(){var e=o("react-compiler-runtime").c(2),t=m(r("MWChatEncryptedBackupsDismissalDialogContext")),n=t.isDismissedDisabled,a=t.setIsDismissedDisabled,i=p(n),l;return e[0]!==a?(l={onHidden:function(){a(i.current)},onVisible:function(){a(!0)}},e[0]=a,e[1]=l):l=e[1],r("useVisibilityObserver")(l)}function g(){}function h(e){var t=e.onComplete,n=e.pushPage,a=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,"AUTO_RESTORE_NOTICE_SCREEN_IMPRESSION"),i=r("useCometRelayEntrypointContextualEnvironmentProvider")(),l=d(function(){var e=o("CometRelay").loadEntryPoint(i,r("MWChatEncryptedBackupsSettingsDialog.entrypoint"),{});n(function(){return u.jsx(o("CometRelay").EntryPointContainer,{entryPointReference:e,props:{onClose:t,pushPageFromParent:n}})},{withoutBackButton:!0})},[i,t,n]),c=r("gkx")("14456")||r("qex")._("2123")||!1,m=c?f:g,p=m(),h=r("useMergeRefs")(a,p);return u.jsx(r("MWXDialogPage.react"),{footer:null,header:u.jsx(r("MWXDialogHeader.react"),{onClose:t,title:s._(/*BTDS*/"Changes to secure storage settings"),withBackButton:!1,withCloseButton:!0}),children:u.jsx("div",{ref:h,children:u.jsxs(r("MWXColumn.react"),{paddingVertical:8,testid:void 0,children:[u.jsx(r("MWXColumnItem.react"),{paddingHorizontal:_?8:0,paddingTop:12,children:u.jsx(r("MWXText.react"),{align:"start",type:"body3",children:s._(/*BTDS*/"After you restore chat history, messages will continue to sync automatically even if you log out and log back in. You can turn this off in {[Armadillo] Inline settings link parameter.}.",[s._param("[Armadillo] Inline settings link parameter.",u.jsx(r("MWXText.react"),{color:"blueLink",type:"bodyLink3",children:u.jsx(r("MWXLink.react"),{onClick:l,children:s._(/*BTDS*/"Settings")})}))])})}),u.jsx(r("MWXColumnItem.react"),{paddingTop:16,children:u.jsx(r("MWXRow.react"),{align:"end",paddingHorizontal:0,paddingTop:16,children:u.jsx(r("MWXRowItem.react"),{expanding:_,children:u.jsx(r("MWXButton.react"),{label:s._(/*BTDS*/"OK"),onPress:t,padding:"wide",testid:void 0})})})})]})})})}h.displayName=h.name+" [from "+i.id+"]",l.default=h}),226);
__d("MWEBRestoreOTCFirstStep.react",["fbt","MWChatEncryptedBackupsQPLEvents","MWEBOTCInterstitialIllustration.react","MWXColumn.react","MWXColumnItem.react","MWXDialogFooter.react","MWXDialogPage.react","MWXText.react","QPLUserFlow","react","react-compiler-runtime","requireDeferredForDisplay","useVisibilityObserver"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=r("requireDeferredForDisplay")("MWEncryptedBackupsOtcRestoreSteps").__setRef("MWEBRestoreOTCFirstStep.react");function d(e){var t=o("react-compiler-runtime").c(16),n=e.onCloseDialog,a=e.onComplete,i=e.onSkip,l=e.pushPage,d;t[0]===Symbol.for("react.memo_cache_sentinel")?(d={onVisible:m},t[0]=d):d=t[0];var p=r("useVisibilityObserver")(d),_;t[1]===Symbol.for("react.memo_cache_sentinel")?(_=s._(/*BTDS*/"Send code"),t[1]=_):_=t[1];var f;t[2]!==n||t[3]!==a||t[4]!==i||t[5]!==l?(f=u.jsx(r("MWXDialogFooter.react"),{callToActionGroupDirection:"backward",primaryCallToAction:{label:_,onPress:function(){c.onReadyImmediately(function(e){var t=e.pushByOneTimeCodePage;r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_FIRST_RESTORE_SEND_CODE_CLICK"),t({onClose:n,onOtcComplete:a,onSkip:i,pushPage:l})})}}}),t[2]=n,t[3]=a,t[4]=i,t[5]=l,t[6]=f):f=t[6];var g;t[7]===Symbol.for("react.memo_cache_sentinel")?(g=u.jsx(r("MWXColumnItem.react"),{align:"center",paddingTop:20,paddingVertical:4}),t[7]=g):g=t[7];var h;t[8]===Symbol.for("react.memo_cache_sentinel")?(h=u.jsx(r("MWXColumnItem.react"),{align:"center",paddingTop:0,paddingVertical:8,children:u.jsx(r("MWEBOTCInterstitialIllustration.react"),{})}),t[8]=h):h=t[8];var y;t[9]===Symbol.for("react.memo_cache_sentinel")?(y=u.jsx(r("MWXColumnItem.react"),{align:"center",children:u.jsx(r("MWXText.react"),{align:"center",color:"primary",type:"headlineEmphasized2",children:s._(/*BTDS*/"Send a one-time code to restore your chat history")})}),t[9]=y):y=t[9];var C;t[10]===Symbol.for("react.memo_cache_sentinel")?(C=u.jsx(r("MWXColumnItem.react"),{align:"center",children:u.jsx(r("MWXText.react"),{align:"center",color:"secondary",type:"body3",children:s._(/*BTDS*/"Get a one-time code from the Messenger or Facebook mobile app to restore your chat history on this device.")})}),t[10]=C):C=t[10];var b;t[11]!==p?(b=u.jsxs(r("MWXColumn.react"),{align:"center",paddingHorizontal:16,paddingVertical:8,ref:p,spacing:16,children:[g,h,y,C]}),t[11]=p,t[12]=b):b=t[12];var v;return t[13]!==f||t[14]!==b?(v=u.jsx(r("MWXDialogPage.react"),{footer:f,header:null,children:b}),t[13]=f,t[14]=b,t[15]=v):v=t[15],v}function m(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_FIRST_RESTORE_DIALOG_STEP_IMPRESSION")}l.default=d}),226);
__d("MWEncryptedBackupsDeviceUtils",[],(function(t,n,r,o,a,i){"use strict";var e=[6628568379,0x9e1d0efc8522,350685531728],l=[0x9e1d0efc8522];i.FB_APP_IDS=e,i.TABLET_APP_IDS=l}),66);
__d("MWXIconTablet",["MWXSvgIcon","SVGIcon","cr:22506","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgIcon(o("SVGIcon").svgIcon(n("cr:22506")),r("gkx")("23219"));l.default=e}),98);
__d("MWEncryptedBackupsDeviceListCell.react",["fbt","AddOnStartOverride.react","BaseMiddot.react","FDSRelativeTimestamp.react","I64","MWEncryptedBackupsDeviceUtils","MWXIconForListCell.react","MWXIconMobile","MWXIconTablet","MWXListCell.react","MWXTextPairing.react","react"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=e||(e=o("react")),d=e.useMemo;function m(e){var t=e.device,n=d(function(){return t.appId!=null?(u||(u=o("I64"))).to_float(t.appId):null},[t.appId]),a=o("MWEncryptedBackupsDeviceUtils").TABLET_APP_IDS.includes(n),i=o("MWEncryptedBackupsDeviceUtils").FB_APP_IDS.includes(n)?s._(/*BTDS*/"Facebook"):s._(/*BTDS*/"Messenger");return c.jsx(r("MWXListCell.react"),{addOnStart:c.jsx(r("AddOnStartOverride.react"),{children:c.jsx(r("MWXIconForListCell.react"),{icon:r(a?"MWXIconTablet":"MWXIconMobile"),size:"large"})}),content:c.jsx(r("MWXTextPairing.react"),{body:t.lastUploadTime!=null&&s._(/*BTDS*/"Last seen {last_seen}",[s._param("last_seen",c.jsx(r("FDSRelativeTimestamp.react"),{date:new Date(Number(t.lastUploadTime)*1e3)}))]),bodyColor:"secondary",headline:t.model!=null?c.jsxs(c.Fragment,{children:[i,c.jsx(r("BaseMiddot.react"),{}),t.model]}):i,level:4})})}m.displayName=m.name+" [from "+i.id+"]",l.default=m}),226);
__d("MWXIconExclamationMarkCircleOutline",["MWXSvgIcon","SVGIcon","cr:22308","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgIcon(o("SVGIcon").svgIcon(n("cr:22308")),r("gkx")("23219"));l.default=e}),98);
__d("useFetchOTCEligibleEBDevices",["FBLogger","LSAuthorityLevel","LSFactory","LSFetchOTCEligibleEBDevicesV2StoredProcedure","LSIntEnum","ReQL","ReQLSuspense","promiseDone","react","react-compiler-runtime","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=u||(u=o("react")),d=c.useCallback,m=c.useEffect,p=c.useMemo,_=c.useRef;function f(t){var n=o("react-compiler-runtime").c(30),a=t===void 0?"store-or-network":t,l=(e||(e=r("useReStore")))(),u=_(!1),c;n[0]!==l.tables.encrypted_backups_otc_devices?(c=function(){return o("ReQL").fromTableAscending(l.tables.encrypted_backups_otc_devices)},n[0]=l.tables.encrypted_backups_otc_devices,n[1]=c):c=n[1];var d;n[2]!==l?(d=[l],n[2]=l,n[3]=d):d=n[3];var p=o("ReQLSuspense").useArray(c,d,i.id+":39"),f;n[4]!==l?(f=function(){return l.runInTransaction(y,"readwrite",void 0,void 0,i.id+":45")},n[4]=l,n[5]=f):f=n[5];var C=f,b;n[6]!==C?(b=function(){r("promiseDone")(C(),null,h)},n[6]=C,n[7]=b):b=n[7];var v=b,S,R;n[8]!==a||n[9]!==p.length||n[10]!==v?(S=function(){u.current!==!0&&(p.length===0||a==="network-only")&&(u.current=!0,v())},R=[a,p.length,v],n[8]=a,n[9]=p.length,n[10]=v,n[11]=S,n[12]=R):(S=n[11],R=n[12]),m(S,R);var L;L=p.length>0&&(s||(s=o("LSIntEnum"))).toNumber(p[0].authorityLevel)===r("LSAuthorityLevel").OPTIMISTIC;var E=L,k;k=!E&&p.length>0&&p[0].deviceId==="-1";var I=k,T;n[13]!==I?(T=function(){I&&r("FBLogger")("wmi_eb").mustfix("Encrypted Backups OTC: Failed to fetch otc eligible devices.")},n[13]=I,n[14]=T):T=n[14];var D;n[15]!==I||n[16]!==C||n[17]!==a||n[18]!==E||n[19]!==p||n[20]!==v?(D=[I,C,a,E,p,v],n[15]=I,n[16]=C,n[17]=a,n[18]=E,n[19]=p,n[20]=v,n[21]=D):D=n[21],m(T,D);var x,$;n[22]!==p?($=p.filter(g),n[22]=p,n[23]=$):$=n[23],x=$;var P=x,N=P.length>0,M;return n[24]!==I||n[25]!==E||n[26]!==P||n[27]!==N||n[28]!==v?(M={doesUserHaveOtcEligibleDevices:N,failedToFetchOtcDevices:I,isFetchOtcDevicesInFlight:E,otcEligibleDevices:P,triggerFetchOtcEligibleDevices:v},n[24]=I,n[25]=E,n[26]=P,n[27]=N,n[28]=v,n[29]=M):M=n[29],M}function g(e){return(s||(s=o("LSIntEnum"))).toNumber(e.authorityLevel)!==r("LSAuthorityLevel").OPTIMISTIC&&e.deviceId!==""}function h(){r("FBLogger")("wmi_eb").mustfix("Failed to fetch OTC eligible devices")}async function y(e){var t=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.encrypted_backups_otc_devices)),n=t!=null&&(s||(s=o("LSIntEnum"))).toNumber(t.authorityLevel)===r("LSAuthorityLevel").OPTIMISTIC;if(!n)return r("LSFetchOTCEligibleEBDevicesV2StoredProcedure")(r("LSFactory")(e))}l.default=f}),98);
__d("MWEncryptedBackupsOTCEligibleDevicesList.react",["fbt","AddOnStartOverride.react","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsDeviceListCell.react","MWXGlimmer.react","MWXIconExclamationMarkCircleOutline","MWXIconForListCell.react","MWXLink.react","MWXList.react","MWXListCell.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","react","react-compiler-runtime","useFetchOTCEligibleEBDevices"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useEffect,m=c.useRef,p={glimmerBody:{borderStartStartRadius:"x10c0hgg",borderStartEndRadius:"x17hxvv9",borderEndEndRadius:"xys2atg",borderEndStartRadius:"x18dcsfh",height:"xlzyvqe",width:"x3hqpx7",$$css:!0},glimmerHeadline:{borderStartStartRadius:"x10c0hgg",borderStartEndRadius:"x17hxvv9",borderEndEndRadius:"xys2atg",borderEndStartRadius:"x18dcsfh",height:"xlzyvqe",width:"xktia5q",$$css:!0},glimmerIcon:{borderStartStartRadius:"xvs2etk",borderStartEndRadius:"xg3wpu6",borderEndEndRadius:"x1jwbhkm",borderEndStartRadius:"xgg4q86",height:"xc9qbxq",width:"x14qfxbe",$$css:!0}};function _(){var e=o("react-compiler-runtime").c(2),t;e[0]===Symbol.for("react.memo_cache_sentinel")?(t=u.jsx(r("AddOnStartOverride.react"),{children:u.jsx(r("MWXGlimmer.react"),{index:0,xstyle:p.glimmerIcon})}),e[0]=t):t=e[0];var n;return e[1]===Symbol.for("react.memo_cache_sentinel")?(n=u.jsx(r("MWXListCell.react"),{addOnStart:t,content:u.jsx(r("MWXTextPairing.react"),{body:u.jsx(r("MWXGlimmer.react"),{index:2,xstyle:p.glimmerBody}),headline:u.jsx(r("MWXGlimmer.react"),{index:1,xstyle:p.glimmerHeadline}),level:4})}),e[1]=n):n=e[1],n}function f(){var e=o("react-compiler-runtime").c(13),t=r("useFetchOTCEligibleEBDevices")(),n=t.failedToFetchOtcDevices,a=t.isFetchOtcDevicesInFlight,i=t.otcEligibleDevices,l=t.triggerFetchOtcEligibleDevices,c=m(!1),p,f;if(e[0]!==n||e[1]!==a||e[2]!==i.length?(p=function(){a||(r("QPLUserFlow").addAnnotations(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,{int:{otc_eligible_devices:i.length}}),n?c.current||(c.current=!0,r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_DEVICES_LIST_FAILURE")):!c.current&&i.length>0&&(c.current=!0,r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_DEVICES_LIST_LOADED")))},f=[n,a,i.length],e[0]=n,e[1]=a,e[2]=i.length,e[3]=p,e[4]=f):(p=e[3],f=e[4]),d(p,f),a){var y;return e[5]===Symbol.for("react.memo_cache_sentinel")?(y=u.jsx(_,{}),e[5]=y):y=e[5],y}else if(n){var C;e[6]===Symbol.for("react.memo_cache_sentinel")?(C=u.jsx(r("AddOnStartOverride.react"),{children:u.jsx(r("MWXIconForListCell.react"),{icon:r("MWXIconExclamationMarkCircleOutline"),size:"large"})}),e[6]=C):C=e[6];var b;return e[7]!==l?(b=u.jsx(r("MWXListCell.react"),{addOnStart:C,content:u.jsx(r("MWXText.react"),{type:"headlineEmphasized4",children:s._(/*BTDS*/"Unable to show your devices. {try_again}",[s._param("try_again",u.jsx(r("MWXText.react"),{color:"blueLink",type:"headlineEmphasized4",children:u.jsx(r("MWXLink.react"),{onClick:l,children:s._(/*BTDS*/"Refresh")})}))])})}),e[7]=l,e[8]=b):b=e[8],b}else{var v;e[9]!==i?(v=i.toSorted(h).map(g),e[9]=i,e[10]=v):v=e[10];var S;return e[11]!==v?(S=u.jsx(r("MWXList.react"),{testid:void 0,children:v}),e[11]=v,e[12]=S):S=e[12],S}}function g(e){return u.jsx(r("MWEncryptedBackupsDeviceListCell.react"),{device:e},e.deviceId)}g.displayName=g.name+" [from "+i.id+"]";function h(e,t){return Number(t.lastUploadTime)-Number(e.lastUploadTime)}l.default=f}),226);
__d("MWEncryptedBackupsOTCEligibleDevicesPopover.react",["MWEncryptedBackupsOTCEligibleDevicesList.react","MWXPopover.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(1),n;return t[0]===Symbol.for("react.memo_cache_sentinel")?(n=s.jsx(r("MWXPopover.react"),{withArrow:!0,children:s.jsx("div",{className:"x1xiyphd x1odjw0f x1y1aw1k xf159sx xwib8y2 xmzvs34 x168biu4",children:s.jsx(r("MWEncryptedBackupsOTCEligibleDevicesList.react"),{})})}),t[0]=n):n=t[0],n}l.default=u}),98);
__d("MWFDSExclamationMarkCircleOutline.svg.react",["cr:21639"],(function(t,n,r,o,a,i,l){"use strict";l.default=n("cr:21639")}),98);
__d("MWFDSTablet.svg.react",["FBIconTabletOutline20.svg.react"],(function(t,n,r,o,a,i,l){"use strict";l.default=r("FBIconTabletOutline20.svg.react")}),98);
__d("PAKEDecryptSecretSprocStatusEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUCCESS:0,WRONG_KEYS:-1,FAILURE:-2});i.default=e}),66);
__d("PAKEGetActiveSessionSprocStatusEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUCCESS:0,NO_SESSION:-1,FAILURE:-2});i.default=e}),66);
__d("PAKEMessageTypeEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({AWAITING_CLIENT:0,PAKE_MESSAGE_1:1,PAKE_MESSAGE_2_AND_SECRET:2,SESSION_EXPIRED_ERROR:3,MAX_ATTEMPTS_ERROR:4,GENERIC_ERROR:5,MESSAGE_SENT_ERROR:6,PREVIOUS_MESSAGE_MISSING_ERROR:7,INVALID_PREVIOUS_MESSAGE_ERROR:8,ENCRYPTION_ERROR:9,DECRYPTION_ERROR:10,CPACE_STEP_2_ERROR:11,FETCH_SECRETS_ERROR:12,CPACE_STEP_1_ERROR:13,CPACE_STEP_3_ERROR:14,PAKE_HANDSHAKE_SUCCESS:15,SERIALIZATION_ERROR:16,NO_ACTIVE_SESSION:17,MULTIPLE_ACTIVE_SESSIONS_ERROR:18,PROCESS_SECRETS_ERROR:19,TIMEOUT_ERROR:20,FLOW_ABANDONED_ERROR:21,DESERIALIZE_SECRETS_ERROR:22,CODE_REQUESTED:23,PQ_PAKE_MESSAGE_2:24,PQ_PAKE_MESSAGE_3:25,PQ_PAKE_SECRETS:26});i.default=e}),66);
__d("PakeInitiatorSprocCalls",["LSDecryptPakeSecretStoredProcedure","LSFactory","LSGetActiveSessionStoredProcedure","LSIntEnum","LSSendPakeMessageOneStoredProcedure","LSSendPakeMessageStoredProcedure","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var n=t.clientType,a=t.initiatorId,l=t.messagePayload,s=t.sessionId,u=t.storage;r("promiseDone")(u.runInTransaction(function(t){return r("LSSendPakeMessageOneStoredProcedure")(r("LSFactory")(t),{clientType:(e||(e=o("LSIntEnum"))).ofNumber(n),initiatorId:a,messagePayload:l,sessionId:s})},"readwrite",void 0,void 0,i.id+":45"))}function u(t){var n=t.clientType,a=t.initiatorId,l=t.storage;return l.runInTransaction(function(t){return r("LSGetActiveSessionStoredProcedure")(r("LSFactory")(t),{clientType:(e||(e=o("LSIntEnum"))).ofNumber(n),initiatorId:a})},"readwrite",void 0,void 0,i.id+":71")}function c(t){var n=t.clientType,a=t.encryptionKey,l=t.sessionId,s=t.storage;return s.runInTransaction(function(t){return r("LSDecryptPakeSecretStoredProcedure")(r("LSFactory")(t),{clientType:(e||(e=o("LSIntEnum"))).ofNumber(n),encryptionKey:a,sessionId:l})},"readwrite",void 0,void 0,i.id+":92")}function d(t){var n=t.clientType,a=t.messagePayload,l=t.messageType,s=t.senderId,u=t.sessionId,c=t.storage;return c.runInTransaction(function(t){return r("LSSendPakeMessageStoredProcedure")(r("LSFactory")(t),{clientType:(e||(e=o("LSIntEnum"))).ofNumber(n),messagePayload:a,messageType:e.ofNumber(l),senderId:s,sessionId:u})},"readwrite",void 0,void 0,i.id+":116")}l.sendPakeMessageOne=s,l.joinPakeSession=u,l.decryptPakeSecret=c,l.sendPakeMessage=d}),98);
__d("PakeQplLogging",["MWEBODSCategory","MWEBODSEntityKey.enum","MWEBODSEntityName.enum","ODS","QPLEvent","QPLUserFlow"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t,n){r("QPLUserFlow").getActiveFlowIDs().includes((e||(e=o("QPLEvent"))).getMarkerId(t))||((s||(s=o("ODS"))).bumpEntityKey(r("MWEBODSCategory"),r("MWEBODSEntityName.enum").MW_EB_OTC_AUTH,r("MWEBODSEntityKey.enum").START),r("QPLUserFlow").start(t,{annotations:{string:babelHelpers.extends({},n)}}))}function c(e){var t=e.annotations,n=e.errorName,a=e.event,i=e.isUserError;r("QPLUserFlow").endFailure(a,n,{annotations:t});var l=i===!0?r("MWEBODSEntityKey.enum").SUCCESS:r("MWEBODSEntityKey.enum").FAIL;(s||(s=o("ODS"))).bumpEntityKey(r("MWEBODSCategory"),r("MWEBODSEntityName.enum").MW_EB_OTC_AUTH,l)}function d(e,t){r("QPLUserFlow").endSuccess(e,{annotations:t}),(s||(s=o("ODS"))).bumpEntityKey(r("MWEBODSCategory"),r("MWEBODSEntityName.enum").MW_EB_OTC_AUTH,r("MWEBODSEntityKey.enum").SUCCESS)}l.startPakeQPLFlow=u,l.endPakeQPLFlowFailure=c,l.endPakeQPLFlowSuccess=d}),98);
__d("deserializeSecretsAndAddDevice",["EBLogger","EBSMAPI","MWEncryptedBackupsInitializeRestoreDeferred","MWPakeQPLEvents","PAKEMessageTypeEnum","PakeQplLogging","QPLUserFlow"],(function(t,n,r,o,a,i,l){"use strict";async function e(e){var t=e.db,n=e.initiatorId,a=e.onAddDeviceFailure,i=e.onAddDeviceFinish,l=e.secrets;r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"MEB_DESERIALIZE_SECRETS_AND_ADD_DEVICE_START");var s=await r("EBSMAPI").otcAddDevice({initiatorId:n,secrets:l});if(s.success){var u;r("QPLUserFlow").addPoint((u=o("MWPakeQPLEvents")).pakeInitiatorQplEvent,"MEB_DESERIALIZE_SECRETS_AND_ADD_DEVICE_END"),i(),r("QPLUserFlow").addPoint(u.pakeInitiatorQplEvent,"MEB_INITIALIZE_RESTORE_START"),o("MWEncryptedBackupsInitializeRestoreDeferred").encryptedBackupsInitializeRestoreDeferred({db:t,onFailure:function(){o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1}},errorName:"MEB_INITIALIZE_RESTORE_FAILURE",event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1})}}),r("QPLUserFlow").addPoint(u.pakeInitiatorQplEvent,"MEB_INITIALIZE_RESTORE_END"),o("PakeQplLogging").endPakeQPLFlowSuccess(u.pakeInitiatorQplEvent)}else if(s.error.status==="OTC_ADD_DEVICE_SPROC_FAILURE")o("EBLogger").EBLogger().mustfix("PAKE: deserializeSecretsAndAddDevice sproc failed"),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").DESERIALIZE_SECRETS_ERROR}},errorName:"MEB_DESERIALIZE_SECRETS_AND_ADD_DEVICE_FAILURE",event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),a();else if(s.error.status==="OTC_ADD_DEVICE_SYSTEM_ERROR")o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").DESERIALIZE_SECRETS_ERROR}},errorName:"MEB_FINISH_ADD_PEER_DEVICE_FAILURE",event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),a();else if(s.error.status==="OTC_ADD_DEVICE_UNEXPECTED_RECOVERY_CODE_STATUS"){var c=s.error.errorMessage;c!=null&&o("EBLogger").EBLogger().mustfix(c)}else if(s.error.status==="OTC_ADD_DEVICE_SPROC_ERROR"){var d=s.error.errorMessage;d!=null&&o("EBLogger").EBLogger().mustfix(d),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").DESERIALIZE_SECRETS_ERROR},string:{exceptionMessage:d!=null?d:"<null>"}},errorName:"MEB_DESERIALIZE_SECRETS_AND_ADD_DEVICE_EXCEPTION",event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),a()}return function(){}}l.default=e}),98);
__d("establishPakeHandshakeAsInitiator",["Base64Utils","FBLogger","I64","MWEncryptedBackupsDeviceRegistrationId","MWPakeQPLEvents","PAKECleanupSessionReasonEnum","PAKEDecryptSecretSprocStatusEnum","PAKEGetActiveSessionSprocStatusEnum","PAKEMessageTypeEnum","PakeCpaceUtils","PakeCpaceWasm","PakeQplLogging","QPLUserFlow","ReQL","clearTimeout","promiseDone","requireDeferred","setTimeout"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("CleanupPakeSession").__setRef("establishPakeHandshakeAsInitiator"),u=r("requireDeferred")("PakeInitiatorSprocCalls").__setRef("establishPakeHandshakeAsInitiator"),c=(e||(e=o("I64"))).of_int32(-1),d=3e3,m="PAKE_INITIATOR_FAILURE";async function p(t){var n=t.clientType,a=t.onGeneralFailure,i=t.onMaxAttemptsReached,l=t.onNoSessionExists,p=t.onSessionExpired,_=t.onSuccessfulSecretDecryption,f=t.onWrongOtc,g=t.otc,h=t.pakeCpaceModule,y=t.storage,C=t.timeout,b=function(){},v=function(){E&&r("clearTimeout")(E)},S=o("MWEncryptedBackupsDeviceRegistrationId").getDeviceRegistrationId();if(S==="")return o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").GENERIC_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),{pakeClient:null,stopTimeout:v,unsubFromMessagesTable:b};var R=h!=null?h:await o("PakeCpaceWasm").PakeCPaceWasm(),L=R.createCPaceClient(S),E=null,k=null,I=!1,T=o("ReQL").fromTableAscending(y.tables.pake_messages),D=function(){E&&r("clearTimeout")(E),E=r("setTimeout")(function(){a(),b(),s.onReady(function(e){r("promiseDone")(e({cleanupReason:r("PAKECleanupSessionReasonEnum").TIMEOUT,clientType:n,deviceId:S,storage:y}))}),r("FBLogger")("wmi_eb").mustfix("PAKE handshake failed by timeout")},C)},x=function(){k&&r("clearTimeout")(k),k=r("setTimeout")(function(){r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_CPACE_RETRY_JOIN_SESSION"),I=!0,O()},d)},$=function(t){var e=t.messageType,o=t.sessionId;a(),u.onReady(function(t){r("promiseDone")(t.sendPakeMessage({clientType:n,messageType:e,senderId:S,sessionId:o,storage:y}))})},P=function(a){var t=a.messagePayload,i=a.responderId,l=a.sessionId;if(r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_CPACE_STEP_THREE_START"),t==null){r("FBLogger")("wmi_eb").mustfix("PAKE: When executing step 3 of CPace Handshake messagePayload was null"),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").INVALID_PREVIOUS_MESSAGE_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1});return}if(i==null){r("FBLogger")("wmi_eb").mustfix("PAKE: When executing step 3 of CPace Handshake responderId was null"),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").INVALID_PREVIOUS_MESSAGE_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1});return}var s=o("Base64Utils").toArrayBuffer(t),c;try{var d=R.clientFinalize(L,new Uint8Array(s));c=d.clientKey1}catch(e){throw $({messageType:r("PAKEMessageTypeEnum").CPACE_STEP_3_ERROR,sessionId:l}),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").CPACE_STEP_3_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),r("FBLogger")("wmi_eb").mustfixThrow("PAKE: Error executing CPace step 3")}r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_DECRYPT_SECRET_START"),u.onReady(function(t){r("promiseDone")(t.decryptPakeSecret({clientType:n,encryptionKey:o("PakeCpaceUtils").typedArrayToBuffer(c),sessionId:l,storage:y}),function(a){var i=a[0],s=a[1];switch(v(),(e||(e=o("I64"))).to_int32(s)){case r("PAKEDecryptSecretSprocStatusEnum").SUCCESS:if(i==null)throw o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").GENERIC_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),r("FBLogger")("wmi_eb").mustfixThrow("PAKE: decryptedSecret is null despite SPROC success");r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_DECRYPT_SECRET_END"),r("promiseDone")(t.sendPakeMessage({clientType:n,messageType:r("PAKEMessageTypeEnum").PAKE_HANDSHAKE_SUCCESS,senderId:S,sessionId:l,storage:y})),_({decryptedSecret:i,initiatorId:S});break;case r("PAKEDecryptSecretSprocStatusEnum").WRONG_KEYS:o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!0}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!0}),f();break;case r("PAKEDecryptSecretSprocStatusEnum").FAILURE:o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),$({messageType:r("PAKEMessageTypeEnum").DECRYPTION_ERROR,sessionId:l});break}},function(e){o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},string:{exceptionMessage:e}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),$({messageType:r("PAKEMessageTypeEnum").DECRYPTION_ERROR,sessionId:l})})})},N=function(t){var e=t.annotations,n=t.fbLoggerMessage,a=t.isUserError,i=t.messageType,l=t.onFinish,s=t.unsubFromTable;v(),s(),l(),n!=null&&r("FBLogger")("wmi_eb").mustfix(n,i),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:e,errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:a})},M=function(n){var t=n.onPakeStepOneSuccess;b=T.subscribe(function(n,i){if(!(i.operation!=="put"&&i.operation!=="add")){var l=i.value,s=(e||(e=o("I64"))).to_int32(l.messageType);switch(s){case r("PAKEMessageTypeEnum").PAKE_MESSAGE_1:r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_SEND_PAKE_MESSAGE_ONE_END"),b(),t();break;case r("PAKEMessageTypeEnum").INVALID_PREVIOUS_MESSAGE_ERROR:case r("PAKEMessageTypeEnum").PREVIOUS_MESSAGE_MISSING_ERROR:return N({annotations:{bool:{isUserError:!1},int:{errorCode:s}},fbLoggerMessage:"PAKE: Failed to send PAKE message one due to invalid state",isUserError:!1,messageType:s,onFinish:function(){return a()},unsubFromTable:function(){b()}});case r("PAKEMessageTypeEnum").MESSAGE_SENT_ERROR:return N({annotations:{bool:{isUserError:!1},int:{errorCode:s}},fbLoggerMessage:"PAKE: Failed to send PAKE message one",isUserError:!1,messageType:s,onFinish:function(){return a()},unsubFromTable:function(){b()}});default:break}}})},w=function(n){var t=n.sessionId;b=T.subscribe(function(n,l){if(!(l.operation!=="put"&&l.operation!=="add")){var s=l.value,u=(e||(e=o("I64"))).to_int32(s.messageType);switch(u){case r("PAKEMessageTypeEnum").PAKE_MESSAGE_2_AND_SECRET:b(),P({messagePayload:s.messagePayload,responderId:s.responderId,sessionId:t});break;case r("PAKEMessageTypeEnum").MAX_ATTEMPTS_ERROR:return N({annotations:{bool:{isUserError:!0},int:{errorCode:u}},isUserError:!0,messageType:u,onFinish:function(){return i()},unsubFromTable:function(){b()}});case r("PAKEMessageTypeEnum").SESSION_EXPIRED_ERROR:return N({annotations:{bool:{isUserError:!0},int:{errorCode:u}},isUserError:!0,messageType:u,onFinish:function(){return p()},unsubFromTable:function(){b()}});case r("PAKEMessageTypeEnum").GENERIC_ERROR:return N({annotations:{bool:{isUserError:!1},int:{errorCode:u}},fbLoggerMessage:"PAKE: Something went wrong in the responder device",isUserError:!1,messageType:u,onFinish:function(){return a()},unsubFromTable:function(){b()}});case r("PAKEMessageTypeEnum").FETCH_SECRETS_ERROR:return N({annotations:{bool:{isUserError:!1},int:{errorCode:u}},fbLoggerMessage:"PAKE: Responder device failed to fetch secrets.",isUserError:!1,messageType:u,onFinish:function(){return a()},unsubFromTable:function(){b()}});case r("PAKEMessageTypeEnum").FLOW_ABANDONED_ERROR:return N({annotations:{bool:{isUserError:!1},int:{errorCode:u}},fbLoggerMessage:"PAKE: Responder device flow was abandoned.",isUserError:!1,messageType:u,onFinish:function(){return a()},unsubFromTable:function(){b()}});default:return N({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").GENERIC_ERROR}},fbLoggerMessage:"PAKE: Unexpected Message Type when listening for pake step two success "+u,isUserError:!1,messageType:u,onFinish:function(){return a()},unsubFromTable:function(){b()}})}}})},A=function(i){var t=i.onJoinSessionSuccess;r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_GET_ACTIVE_SESSION_START"),u.onReady(function(i){r("promiseDone")(i.joinPakeSession({clientType:n,initiatorId:S,storage:y}),function(n){var i=n[0],s=n[1],u=n[2],d=s!=null?s:c;switch((e||(e=o("I64"))).to_int32(i)){case r("PAKEGetActiveSessionSprocStatusEnum").SUCCESS:if(u==null||d===c){r("FBLogger")("wmi_eb").mustfix("PAKE: When joining session, responderId or joinedSessionId were unexpectedly null"),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").GENERIC_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),a();return}t(u,d),r("QPLUserFlow").addAnnotations(o("MWPakeQPLEvents").pakeInitiatorQplEvent,{string:{session_id:(e||(e=o("I64"))).to_string(d)}});break;case r("PAKEGetActiveSessionSprocStatusEnum").NO_SESSION:if(I===!1){x();return}o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!0},int:{errorCode:r("PAKEMessageTypeEnum").NO_ACTIVE_SESSION}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!0}),l(),v();break;case r("PAKEGetActiveSessionSprocStatusEnum").FAILURE:o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").GENERIC_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),r("FBLogger")("wmi_eb").mustfix("PAKE: When joining session, sproc failed"),a(),v();break}},function(){o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").GENERIC_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),r("FBLogger")("wmi_eb").mustfix("PAKE: When joining session, sproc failed"),a(),v()})})},F=function(t){var e=t.responderId,a=t.sessionId,i;r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_CPACE_STEP_ONE_START");try{i=R.clientBegin(L,g,e)}catch(e){throw $({messageType:r("PAKEMessageTypeEnum").CPACE_STEP_1_ERROR,sessionId:a}),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").CPACE_STEP_1_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),r("FBLogger")("wmi_eb").mustfixThrow("PAKE: Error executing CPace step 1")}r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_SEND_MESSAGE_ONE_START"),u.onReady(function(e){e.sendPakeMessageOne({clientType:n,initiatorId:S,messagePayload:o("PakeCpaceUtils").typedArrayToBuffer(i),sessionId:a,storage:y})}),M({onPakeStepOneSuccess:function(){w({sessionId:a})}})},O=function(){return D(),o("PakeQplLogging").startPakeQPLFlow(o("MWPakeQPLEvents").pakeInitiatorQplEvent),A({onJoinSessionSuccess:function(t,n){F({responderId:t,sessionId:n})}}),{pakeClient:L,stopTimeout:v,unsubFromMessagesTable:b}};return O()}l.default=p}),98);