;/*FB_PKG_DELIM*/

__d("ZenonMWThriftSendMessageMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9720271894689175"}),null);
__d("ZenonMWThriftSendMessageMutation.graphql",["ZenonMWThriftSendMessageMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"RtcWebSendMultiwayThriftSignalingMessageResponsePayload",kind:"LinkedField",name:"rtc_web_send_multiway_thrift_signaling_message",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"response",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ZenonMWThriftSendMessageMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ZenonMWThriftSendMessageMutation",selections:t},params:{id:n("ZenonMWThriftSendMessageMutation_facebookRelayOperation"),metadata:{},name:"ZenonMWThriftSendMessageMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("ZenonMWThriftSendMessageMutation",["CometRelayErrorHandling","RequestStreamBodyUtils","ZenonMWThriftMessageSerializer","ZenonMWThriftSendMessageMutation.graphql","cr:1012418","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,a,i){return new Promise(function(l,s){n("cr:1012418").commitMutation(i,{mutation:e!==void 0?e:e=n("ZenonMWThriftSendMessageMutation.graphql"),onCompleted:function(t){return l(t)},onError:function(t){return r("gkx")("20935")&&o("CometRelayErrorHandling").markErrorAsHandled(t),s(t)},variables:{input:{endpoint:JSON.stringify(t),message:o("RequestStreamBodyUtils").uint8ArrayToBase64(o("ZenonMWThriftMessageSerializer").serializeMWThriftMessage(a,!0))}}})})}function u(e){var t=e.rtc_web_send_multiway_thrift_signaling_message;if(t!=null&&t.response!=null){var n=o("RequestStreamBodyUtils").base64ToUint8Array(t.response),r=o("ZenonMWThriftMessageSerializer").deserializeMWThriftMessage(n,!0),a=r.messageBody,i=r.messageHeader;return{body:a,header:i}}return{body:null,header:null}}async function c(e,t,n){var r=await s(e,t,n);return u(r)}l.sendMessage=c}),98);
__d("ZenonStateSyncPayloadSerializer",["RequestStreamBodyUtils","ZenonAppProvider"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return o("ZenonAppProvider").isInstagramApp()?o("RequestStreamBodyUtils").stringToUint8Array(e):o("RequestStreamBodyUtils").base64ToUint8Array(e)}l.stateSyncStringToUint8Array=e}),98);
__d("ZenonMWTranslatorUtils",["ChannelClientID","CurrentUser","IGDWebUtils","OverlayConfigServerLayer","RequestStreamBodyUtils","RpWebMqttEnabledAppIds","ZenonDismissReason","ZenonMWMessageTypes","ZenonParticipantState","ZenonScreenShare","ZenonSignalingProtocol","ZenonSignalingTypes","ZenonStateSyncPayloadSerializer","addDevTierOverridesToHeaderExtensions","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p="signalingDominantSpeakerUpdate",_="signalingVideoUploadUpdate",f="E2eeState",g=new Set(r("RpWebMqttEnabledAppIds").APP_IDS);function h(e,t,n,r){n===void 0&&(n=!1),e&&Object.keys(e).forEach(function(a){if(!(a===f&&r)){var i=e[a],l=i.data,s=i.version;if(l!=null){var u={data:o("ZenonStateSyncPayloadSerializer").stateSyncStringToUint8Array(l),eventName:"stateSyncNotifyRequest",responseRequired:n,topic:a,version:s};t.push(u)}}})}function y(e){var t;if(e){var n=e[f];return(n==null?void 0:n.data)!=null&&(t=o("ZenonStateSyncPayloadSerializer").stateSyncStringToUint8Array(n.data)),t}}function C(e,t,n){var o={appId:k(),deviceId:r("ChannelClientID").getID(),userId:t.userInfo.userID},a=P(t,e);return{endpoint:o,jsonPayload:{body:n,header:a}}}function b(e,t,n,o,a){var i={appId:k(),deviceId:r("ChannelClientID").getID(),userId:t.userInfo.userID},l=N(t,e,o,a);return{endpoint:i,jsonPayload:{body:n,header:l}}}function v(e){var t=o("ZenonDismissReason").mwDismissToDmissReason(e);return t!=null?t:o("ZenonDismissReason").ZenonDismissReason.CallEnded}function S(e){var t=z[e];return t!=null?t:o("ZenonMWMessageTypes").ZenonMWParticipantCallState.UNKNOWN}function R(e){var t=null;return e!=null&&e.forEach(function(e){var n,r=(n=e.body)==null?void 0:n.genericMessage;if(r!=null&&r.topic==="collision_context_payload"){var o=r.data;if(o!=null){var a,i,l,s=JSON.parse(o);t={groupThreadID:(a=s.group_thread_id)!=null?a:null,peerID:(i=s.peer_id)!=null?i:null,serverInfoData:(l=s.server_info_data)!=null?l:null}}}}),t}function L(e){var t,n=(t=e.message.body)!=null?t:{},r=n.dominantSpeakerSignalingInfo,o=n.genericMessage,a=n.videoUploadSignalingInfo;if(o)try{return atob(o.data)}catch(e){return o.data}else{if(r)return JSON.stringify(r);if(a)return JSON.stringify(a)}return null}function E(e){var t,n=(t=e.message.body)!=null?t:{},r=n.dominantSpeakerSignalingInfo,o=n.genericMessage,a=n.videoUploadSignalingInfo;return o?o.topic:r?p:a?_:null}function k(){var e=r("CurrentUser").getAppID();if(e!=null&&o("IGDWebUtils").isInstagramWebSupportedApp(Number(e)))return e;var t=e!=null?e:0xc815778a650a.toString();return g.has(Number(t))?t:0xc815778a650a.toString()}function I(e){var t=e&&e.length>0?e.find(function(e){var t;return((t=e.body)==null||(t=t.genericMessage)==null?void 0:t.topic)==="room_metadata"}):null;if(t){var n,r=(n=t.body)==null||(n=n.genericMessage)==null?void 0:n.data;if(r!=null){var o,a=JSON.parse(r),i=(o=t.header)==null?void 0:o.sender;if(a.link_hash!=null&&a.room_name!=null&&i!=null)return{linkHash:a.link_hash,profileURL:a.profile_url,ringSubtitle:a.ring_subtitle,roomName:a.room_name,sender:i}}}return null}function T(e,t){var n=r("OverlayConfigServerLayer").createFromHeader(t);if(n){var o={eventName:"overlayConfigServerUpdateRequest",serverLayer:n};e.push(o)}}function D(e){return e.reduce(function(e,t){var n,r,o=(n=t.body)==null||(n=n.genericMessage)==null?void 0:n.topic,a=(r=t.body)==null||(r=r.genericMessage)==null?void 0:r.data;return o!=null&&a!=null&&(e[o]=a),e},{})}function x(e){var t,n,o=e.clientSessionId,a=e.conferenceName,i=e.receiver,l=e.receiverUserId,s=e.sequenceNumber,u=e.serverInfoData,c=e.transactionId;if(l==null)throw r("err")("Incoming MW messages should have receiverUserId populated.");var d=o,m={userID:"2"},p={actorID:(t=i==null?void 0:i.actorId)!=null?t:null,messageID:c,messageTags:(n=e.messageTags)!=null?n:[],protocol:r("ZenonSignalingProtocol").MW,remoteInfo:m,retryCount:e.retryCount,roomInfo:{name:a},sequenceNumber:s,signalingID:d,userInfo:{userID:l!=null?l:"1"}};return u!=null&&(p.remoteSignalingID=u),p}function $(e,t){return Object.keys(e).map(function(n){var r=e[n];return{body:{genericMessage:{data:r,topic:n}},header:{recipients:t,topic_DEPRECATED:n}}})}function P(e,t){var n=e.messageID,a=e.messageTags,i=e.remoteSignalingID,l=e.roomInfo,s=e.signalingID,u=r("addDevTierOverridesToHeaderExtensions")(window.location.href),c={clientStack:o("ZenonMWMessageTypes").ZenonMWClientStack.ZENON,conferenceName:l.name,messageTags:a,retryCount:e.retryCount,sequenceNumber:e.sequenceNumber,transactionId:n,type:t};return(u.multiwayCoreTier!==""||u.multiwayWwwTier!=="")&&(c.extensions=u),s!=null&&(c.clientSessionId=s),i!=null&&(c.serverInfoData=i),e.actorID!=null&&(c.sender={id:e.actorID}),c}function N(e,t,n,r){var a=P(e,t);return a.responseStatusCode=n!=null?n:o("ZenonMWMessageTypes").ZenonMWResponseStatusCode.OK,r!=null&&(a.responseSubCode=r),a}function M(e){var t={tracks:{}},n=!o("ZenonScreenShare").screenShareWithReplaceTrack();return e.tracks.forEach(function(e){var r={enabled:e.enabled,name:e.name,owner:e.participantID},o=n?V(e.type):null;o!=null&&(r.label=o),t.tracks[e.trackID]=r}),t}function w(e){if(e==null)return null;switch(e){case o("ZenonMWMessageTypes").ZenonMWTrackLabel.DEFAULT_AUDIO:return"audio";case o("ZenonMWMessageTypes").ZenonMWTrackLabel.DEFAULT_VIDEO:return"video";case o("ZenonMWMessageTypes").ZenonMWTrackLabel.SCREEN_AUDIO:return"screen_audio";case o("ZenonMWMessageTypes").ZenonMWTrackLabel.SCREEN_VIDEO:return"screen"}}function A(e){var t=G[e];return t!=null?t:o("ZenonMWMessageTypes").ZenonMWDeviceStatus.OK}function F(e){switch(e){case o("ZenonDismissReason").ZenonDismissReason.IgnoreCall:return o("ZenonMWMessageTypes").ZenonMWHangupReason.IGNORE_CALL;case o("ZenonDismissReason").ZenonDismissReason.HangupCall:return o("ZenonMWMessageTypes").ZenonMWHangupReason.HANGUP_CALL;case o("ZenonDismissReason").ZenonDismissReason.NoAnswerTimeout:return o("ZenonMWMessageTypes").ZenonMWHangupReason.NO_ANSWER_TIMEOUT;case o("ZenonDismissReason").ZenonDismissReason.ClientError:return o("ZenonMWMessageTypes").ZenonMWHangupReason.CLIENT_ERROR;case o("ZenonDismissReason").ZenonDismissReason.InAnotherCall:return o("ZenonMWMessageTypes").ZenonMWHangupReason.IN_ANOTHER_CALL;case o("ZenonDismissReason").ZenonDismissReason.ClientInterrupted:return o("ZenonMWMessageTypes").ZenonMWHangupReason.CLIENT_INTERRUPTED;case o("ZenonDismissReason").ZenonDismissReason.SessionMigrated:return o("ZenonMWMessageTypes").ZenonMWHangupReason.SESSION_MIGRATED;default:return o("ZenonMWMessageTypes").ZenonMWHangupReason.HANGUP_CALL}}function O(e){var t={};return e.tracks.forEach(function(e){t[e.trackID]=e.enabled}),t}function B(e){var t={},n=!o("ZenonScreenShare").screenShareWithReplaceTrack();return e.tracks.forEach(function(e){var r={enabled:e.enabled},o=n?V(e.type):null;o!=null&&(r.label=o),t[e.trackID]=r}),{tracks:t}}function W(e){return j[e]}function q(e){return e==null?null:K[e]}function U(e){var t={};return e.forEach(function(e,n){t[n]={data:e.data?o("RequestStreamBodyUtils").uint8ArrayToBase64(e.data):void 0,version:e.version}}),t}function V(e){switch(e){case"audio":return o("ZenonMWMessageTypes").ZenonMWTrackLabel.DEFAULT_AUDIO;case"video":return o("ZenonMWMessageTypes").ZenonMWTrackLabel.DEFAULT_VIDEO;case"screen":return o("ZenonMWMessageTypes").ZenonMWTrackLabel.SCREEN_VIDEO;case"screen_audio":return o("ZenonMWMessageTypes").ZenonMWTrackLabel.SCREEN_AUDIO;default:return null}}function H(e,t,n){n===void 0&&(n=0);var r={fromVersion:t,tracks:[],version:n};return e!=null&&Object.keys(e.tracks).forEach(function(t){var n=e.tracks[t],o={enabled:n.enabled,name:n.name,participantID:n.owner,trackID:t,type:w(n.label)};r.tracks.push(o)}),r}var G={IN_ANOTHER_CALL:(c=o("ZenonMWMessageTypes")).ZenonMWDeviceStatus.IN_ANOTHER_CALL,NOT_SUPPORTED:c.ZenonMWDeviceStatus.NOT_SUPPORTED,OK:c.ZenonMWDeviceStatus.OK},z=Object.freeze((e={},e[c.ZenonMWParticipantCallState.UNKNOWN]=(d=o("ZenonParticipantState")).ZenonParticipantState.UNKNOWN,e[c.ZenonMWParticipantCallState.DISCONNECTED]=d.ZenonParticipantState.DISCONNECTED,e[c.ZenonMWParticipantCallState.NO_ANSWER]=d.ZenonParticipantState.NO_ANSWER,e[c.ZenonMWParticipantCallState.REJECTED]=d.ZenonParticipantState.REJECTED,e[c.ZenonMWParticipantCallState.UNREACHABLE]=d.ZenonParticipantState.UNREACHABLE,e[c.ZenonMWParticipantCallState.CONNECTION_DROPPED]=d.ZenonParticipantState.CONNECTION_DROPPED,e[c.ZenonMWParticipantCallState.CONTACTING]=d.ZenonParticipantState.CONTACTING,e[c.ZenonMWParticipantCallState.RINGING]=d.ZenonParticipantState.RINGING,e[c.ZenonMWParticipantCallState.CONNECTING]=d.ZenonParticipantState.CONNECTING,e[c.ZenonMWParticipantCallState.CONNECTED]=d.ZenonParticipantState.CONNECTED,e[c.ZenonMWParticipantCallState.PARTICIPANT_LIMIT_REACHED]=d.ZenonParticipantState.PARTICIPANT_LIMIT_REACHED,e[c.ZenonMWParticipantCallState.IN_ANOTHER_CALL]=d.ZenonParticipantState.IN_ANOTHER_CALL,e[c.ZenonMWParticipantCallState.RING_TYPE_UNSUPPORTED]=d.ZenonParticipantState.RING_TYPE_UNSUPPORTED,e[c.ZenonMWParticipantCallState.PENDING_APPROVAL]=d.ZenonParticipantState.PENDING_APPROVAL,e[c.ZenonMWParticipantCallState.APPROVED]=d.ZenonParticipantState.APPROVED,e[c.ZenonMWParticipantCallState.FAILED_APPROVAL]=d.ZenonParticipantState.FAILED_APPROVAL,e[c.ZenonMWParticipantCallState.UNCALLABLE]=d.ZenonParticipantState.UNREACHABLE,e[c.ZenonMWParticipantCallState.HANGUP_IN_WAITING_ROOM]=d.ZenonParticipantState.HANGUP_IN_WAITING_ROOM,e[c.ZenonMWParticipantCallState.UNCALLABLE_DELAYED]=d.ZenonParticipantState.UNREACHABLE,e)),j=Object.freeze((s={},s[(m=o("ZenonSignalingTypes")).ZenonSignalingStatusCode.OK]=c.ZenonMWResponseStatusCode.OK,s[m.ZenonSignalingStatusCode.REJECTED_FROM_VERSION_DOES_NOT_MATCH]=c.ZenonMWResponseStatusCode.CONDITIONAL_REQUEST_FAILED,s[m.ZenonSignalingStatusCode.METHOD_NOT_ALLOWED]=c.ZenonMWResponseStatusCode.METHOD_NOT_ALLOWED,s)),K=Object.freeze((u={},u[m.ZenonSignalingStatusSubCode.CLIENT_TERMINATED]=c.ZenonMWResponseSubCode.CLIENT_TERMINATED,u));l.E2EE_STATE_SYNC_TOPIC=f,l.addStateStoreSignalingEvents=h,l.fetchE2eeServerState=y,l.createMWRequest=C,l.createMWResponse=b,l.fromMWDismissReason=v,l.fromMWParticipantState=S,l.getCollisionContextFromAppMessages=R,l.getGenericDataMessageData=L,l.getGenericDataMessageTopic=E,l.getMWAppID=k,l.getRoomMetadataFromAppMessages=I,l.maybeAddOverlayConfigServerUpdateRequest=T,l.mwAppMessagesToSignalingAppMessages=D,l.mwMessageHeaderToSignalingMessageHeader=x,l.signalingMessageAppMessagesToMWAppMessages=$,l.toMWClientMediaStatus=M,l.toMWClientTrackContentType=w,l.toMWDeviceStatus=A,l.toMWHangupReason=F,l.toMWMediaStatus=O,l.toMWMediaStatusEx=B,l.toMWResponseStatusCode=W,l.toMWResponseStatusSubCode=q,l.toMWSyncStateStore=U,l.toMWTrackLabel=V,l.toZenonMediaStates=H}),98);
__d("ZenonGraphQLMWThriftMessageSender",["ChannelClientID","FBLogger","MultiwayCommonTypes","RpZenonBinaryThriftSignalingSitevarConfig","ZenonActorHooks","ZenonMWThriftMessageDebugLogger","ZenonMWThriftMessageLogger","ZenonMWThriftMessageMap","ZenonMWThriftMessageReliabilityLogger","ZenonMWThriftMessageTranslator","ZenonMWThriftSendMessageMutation","ZenonMWTranslatorUtils","ZenonValidateMWThriftMessage","err","filterNulls"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$3=e;var t=r("RpZenonBinaryThriftSignalingSitevarConfig").supported_message_types_mqtt.map(function(e){return o("ZenonMWThriftMessageMap").messageTypeFromString(e)});this.$4=new Set(r("filterNulls")(t))}var t=e.prototype;return t.handleResponse=function(t){var e=this.$1;if(e==null)throw r("FBLogger")("rtc_www").mustfixThrow("Should never have null message receiver");var n=t.header||null,a=t.body||null;if(n!=null&&a!=null){var i={messageBody:a,messageHeader:n};r("ZenonMWThriftMessageDebugLogger").logMWThriftMessage("RECEIVED","GraphQL Thrift",i),o("ZenonMWThriftMessageReliabilityLogger").logReceivedMessage(i),this.$2&&this.$2({mwThriftMessage:i,name:"mwThriftMessageRecv"});var l=o("ZenonMWThriftMessageTranslator").toSignalingMessage(i);if(l==null)return;e(l),o("ZenonMWThriftMessageReliabilityLogger").logProcessingMessage(i)}},t.$5=async function(t,n){o("ZenonMWThriftMessageReliabilityLogger").logSendingMessage(n),r("ZenonMWThriftMessageDebugLogger").logMWThriftMessage("SENDING","GraphQL Thrift",n),this.$2&&o("ZenonMWThriftMessageLogger").logSentMessage(n,this.$2);try{var e=await o("ZenonMWThriftSendMessageMutation").sendMessage(t,n,this.$3);o("ZenonMWThriftMessageReliabilityLogger").logSentMessage(n),this.$2&&this.$2({mwThriftMessage:n,name:"mwThriftMessageSent"}),this.handleResponse(e)}catch(e){var a=e!=null?e.toString():"Message Send Error";o("ZenonMWThriftMessageReliabilityLogger").logSendMessageFailed(n,"[GraphQL Thrift] "+a);var i=o("ZenonMWThriftMessageMap").messageTypeToString(n.messageHeader.type);r("ZenonMWThriftMessageDebugLogger").logSendMultiwayThriftMessageFailure(a,i,e)}},t.sendMessage=function(t){var e=o("ZenonMWThriftMessageTranslator").toMWThriftMessage(t);if(!e||!r("ZenonValidateMWThriftMessage")(e))return Promise.reject(r("err")("Invalid MW Thrift message"));if(e.messageHeader.type!=null&&!this.$4.has(e.messageHeader.type))return Promise.resolve();var n=e.messageHeader.type,a={appId:o("ZenonMWTranslatorUtils").getMWAppID(),deviceId:r("ChannelClientID").getID(),userId:t.getHeader().userInfo.userID};return a.userId!==o("ZenonActorHooks").ZenonActor.getAccountID()||n!==o("MultiwayCommonTypes").MessageType.DATA_MESSAGE?this.$5(a,e):Promise.reject(r("err")("GraphQL only sends DATA_MESSAGE for Page users"))},t.setMessageReceiver=function(t){this.$1=t},t.setLoggingEventHandler=function(t){this.$2=t},e})();l.default=e}),98);