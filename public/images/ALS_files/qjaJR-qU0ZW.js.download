;/*FB_PKG_DELIM*/

__d("LSDecryptProtobuf",["LSArrayGetObjectAt","LSBase64Decode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop","LSSymmetricEncryptionCreateDecryptedData.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){var a,i,l;return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][decryptProtobuf] Beginning execution."),r[1]=t.i64.of_float(Date.now()),r[8]=e[1]==null?t.i64.cast([0,0]):e[1],r[2]=t.i64.of_int32(e[3].length),t.i64.eq(r[2],t.i64.cast([0,1]))?t.sequence([function(o){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),e[3],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[12]=t[0],r[13]=t[1],t})},function(o){return r[14]=r[12].get("epoch_anon_id"),r[15]=r[12].get("epoch_root_key"),r[16]=t.createArray(),r[26]=(r[16].push(t.i64.cast([0,32])),r[16]),t.i64.ge(r[8],t.i64.cast([0,3]))?t.resolve(r[17]=void 0):t.sequence([function(o){return t.nativeOperation(n("LSGetBlobFromString.nop"),e[2]).then(function(e){var t;return t=e,r[26]=t[0],t})},function(e){return r[17]=r[26]}])},function(o){return t.i64.ge(r[8],t.i64.cast([0,4]))?(r[26]="_",r[18]=["message_key_in_epoch",r[26],t.blobs.to_string(r[14]),r[26],"cipher_version",r[26],t.i64.to_string(r[8]),r[26],"thread",r[26],e[2]==null?"":e[2]].join("")):(t.i64.ge(r[8],t.i64.cast([0,3]))?(r[27]="_",r[26]=["message_key_in_epoch",r[27],t.blobs.to_string(r[14]),r[27],"cipher_version",r[27],t.i64.to_string(r[8]),r[27],"thread",r[27],e[2]==null?"":e[2]].join("")):(t.i64.ge(r[8],t.i64.cast([0,2]))?(r[28]="_",r[27]=["message_key_in_epoch",r[28],t.blobs.to_string(r[14]),r[28],"cipher_version",r[28],t.i64.to_string(r[8])].join("")):r[27]=["message_key_in_epoch","_",t.blobs.to_string(r[14])].join(""),r[26]=r[27]),r[18]=r[26]),t.nativeOperation(n("LSGetBlobFromString.nop"),r[18]).then(function(e){var t;return t=e,r[19]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[19],r[17],r[15],r[16]).then(function(e){var t;return t=e,r[20]=t[0],t})},function(e){return r[20]?r[21]=!1:r[21]=!0,r[21]?t.resolve(r[22]=void 0):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[20],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[26]=t[0],r[27]=t[1],t})},function(e){return r[22]=r[26]}])},function(o){return t.blobs.neq(r[22],void 0)?t.sequence([function(o){return t.nativeOperation(n("LSBase64Decode.nop"),e[0]).then(function(e){var t;return t=e,r[26]=t[0],t})},function(o){return t.blobs.neq(r[26],void 0)?t.sequence([function(o){return t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedData.nop"),r[22],t.blobs.of_string(["message_thread","_",e[2]].join("")),r[26]).then(function(e){var t;return t=e,r[29]=t[0],t})},function(e){return r[27]=r[29]}]):t.resolve(r[27]=void 0)},function(e){return t.blobs.neq(r[27],void 0)?t.resolve(r[28]=r[27]):t.sequence([function(e){return r[29]=["Failed to decrypt message. Epoch Anon ID: ",t.blobs.to_string(r[14]),", Encryption Version: ",t.i64.to_string(r[8])].join(""),(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsDecryptProtobufStoredProcedure] ","",r[29]].join("")),r[30]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDecryptProtobufStoredProcedure",[r[29]].join(""),r[30],t.i64.cast([0,3]))},function(e){return r[28]=void 0}])},function(e){return r[23]=r[28]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsDecryptProtobufStoredProcedure] Decryption message key is null"),r[26]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDecryptProtobufStoredProcedure","Decryption message key is null",r[26],t.i64.cast([0,3]))},function(e){return r[23]=void 0}])},function(e){var n,o,a;return t.blobs.neq(r[23],void 0)?(n=[r[23],void 0],r[24]=n[0],r[25]=n[1]):(r[26]=new t.Map,r[26].set("error_code",t.i64.cast([0,101])),r[26].set("stored_procedure","LSEncryptedBackupsDecryptProtobufStoredProcedure"),r[26].set("error_message",""),o=[void 0,r[26]],r[24]=o[0],r[25]=o[1]),a=[r[24],r[25]],r[3]=a[0],r[4]=a[1]}]):t.resolve((r[12]=t.i64.of_int32(e[3].length),t.i64.eq(r[12],t.i64.cast([0,0]))?(r[15]=new t.Map,r[15].set("error_code",t.i64.cast([0,102])),r[15].set("stored_procedure","LSEncryptedBackupsDecryptProtobufStoredProcedure"),r[15].set("error_message",""),a=[void 0,r[15]],r[13]=a[0],r[14]=a[1]):(r[15]=new t.Map,r[15].set("error_code",t.i64.cast([0,103])),r[15].set("stored_procedure","LSEncryptedBackupsDecryptProtobufStoredProcedure"),r[15].set("error_message",""),i=[void 0,r[15]],r[13]=i[0],r[14]=i[1]),l=[r[13],r[14]],r[3]=l[0],r[4]=l[1]))},function(e){return r[5]=t.i64.of_float(Date.now()),r[6]=t.i64.random(),r[9]="Finishing execution. Execution time: ",r[10]=t.i64.to_string(t.i64.sub(r[5],r[0])),r[11]=" ms",r[7]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][decryptProtobuf] ",r[7],r[9],r[7],r[10],r[7],r[11]].join("")),t.i64.eq(t.i64.mod_(r[6],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[12]=",",r[13]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"decryptProtobuf",[r[9],r[12],r[10],r[12],r[11]].join(""),r[13],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[3],r[4]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsDecryptProtobufStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSDecryptSupplementalKey",["LSArrayGetObjectAt","LSBase64Decode.nop","LSCreateDerivedKeys.nop","LSLogMebClientEvent.nop","LSSymmetricEncryptionCreateDecryptedData.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][decryptSupplementalKey] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.nativeOperation(n("LSBase64Decode.nop"),e[0]).then(function(e){var t;return t=e,r[2]=t[0],t})},function(o){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),e[1],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[3]=t[0],r[4]=t[1],t})},function(e){var o;return t.blobs.neq(r[2],void 0)?t.sequence([function(e){return r[13]=r[3].get("epoch_root_key"),r[14]=t.createArray(),r[21]=(r[14].push(t.i64.cast([0,32])),r[14]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5zdXBwbGVtZW50YWxfZW5jX2tleQ=="),void 0,r[13],r[14]).then(function(e){var t;return t=e,r[15]=t[0],t})},function(e){return r[15]!==void 0?t.sequence([function(e){return r[21]=t.i64.of_int32(r[15].length),t.i64.ge(r[21],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[15],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[23]=t[0],r[24]=t[1],t})},function(e){return r[22]=r[23]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),r[24]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[24]].join("")),r[23]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[24],r[23],t.i64.cast([0,3]))},function(e){return r[22]=void 0}])},function(e){return r[16]=r[22]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),r[22]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[22]].join("")),r[21]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[22],r[21],t.i64.cast([0,3]))},function(e){return r[16]=void 0}])},function(e){return t.blobs.neq(r[16],void 0)?r[17]=!0:r[17]=!1,r[17]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedData.nop"),r[16],t.blob("c3VwcGxlbWVudGFsX2VuY19hYWQ="),r[2]).then(function(e){var t;return t=e,r[18]=t[0],t})},function(e){var n,o,a;return t.blobs.neq(r[18],void 0)?(n=[t.blobs.to_string(r[18]),void 0],r[19]=n[0],r[20]=n[1]):(r[21]=new t.Map,r[21].set("error_code",t.i64.cast([0,109])),r[21].set("stored_procedure","LSEncryptedBackupsDecryptSupplementalKeyStoredProcedure"),r[21].set("error_message",""),o=[void 0,r[21]],r[19]=o[0],r[20]=o[1]),a=[r[19],r[20]],r[5]=a[0],r[6]=a[1]}]):t.resolve((r[13]=new t.Map,r[13].set("error_code",t.i64.cast([0,109])),r[13].set("stored_procedure","LSEncryptedBackupsDecryptSupplementalKeyStoredProcedure"),r[13].set("error_message",""),o=[void 0,r[13]],r[5]=o[0],r[6]=o[1]))},function(e){return r[7]=t.i64.of_float(Date.now()),r[8]=t.i64.random(),r[10]="Finishing execution. Execution time: ",r[11]=t.i64.to_string(t.i64.sub(r[7],r[0])),r[12]=" ms",r[9]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][decryptSupplementalKey] ",r[9],r[10],r[9],r[11],r[9],r[12]].join("")),t.i64.eq(t.i64.mod_(r[8],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[13]=",",r[14]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"decryptSupplementalKey",[r[10],r[13],r[11],r[13],r[12]].join(""),r[14],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[5],r[6]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsDecryptSupplementalKeyStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSDecryptMessageProtobufsV2",["LSArrayGetObjectAt","LSDecryptProtobuf","LSDecryptSupplementalKey","LSIsEncryptionVersionSecure","LSLogMebClientEvent.nop","LSQplAnnotateInt.nop","LSQplMarkEnd.nop","LSQplMarkPoint.nop","LSQplStartTrace.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(e){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][decryptMessageProtobufsV2] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!1}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[15]=new t.Map,r[15].set("error_msg","Expected a nonempty query result"),r[15].set("code",t.i64.cast([0,3])),r[15].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[16]=t.createArray(),r[17]=(r[16].push(r[15]),r[16]),o=[void 0,r[16]],r[2]=o[0],r[3]=o[1]):(n=l.item,r[15]=new t.Map,r[15].set("backup_id",n.backupId),r[15].set("device_public_key_blob",n.devicePublicKeyBlob),r[15].set("device_private_key_blob",n.devicePrivateKeyBlob),r[15].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[15].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[15].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[15].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[15].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[15].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[15].set("orf_client_state_v2_blob",void 0),r[15].set("orf_v2_authority_level",void 0),r[15].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[15].set("device_id",n.deviceId),r[15].set("backup_tenancy",n.backupTenancy),r[15].set("encryption_version",n.encryptionVersion),r[15].set("revision_version",n.revisionVersion),r[15].set("initialize_restore_result",void 0),r[15].set("device_creation_timestamp_sec",void 0),r[15].set("authority_level",n.authorityLevel),a=[r[15],void 0],r[2]=a[0],r[3]=a[1])})},function(o){var a;return r[5]=new t.Map,r[5].set("value",r[2]),r[5].set("errors",r[3]),r[6]=r[5].get("value"),r[6]!==void 0?t.sequence([function(o){var a;return r[15]=r[6].get("backup_id"),r[16]=r[6].get("device_public_key_blob"),r[17]=r[6].get("device_private_key_blob"),r[18]=r[6].get("epoch_storage_public_key_blob"),r[19]=r[6].get("epoch_storage_private_key_blob"),r[20]=r[6].get("epoch_auth_public_key_blob"),r[21]=r[6].get("epoch_auth_private_key_blob"),r[22]=r[6].get("mailbox_root_key_blob"),r[23]=r[6].get("ocmf_client_state_blob"),r[24]=r[6].get("orf_client_state_v2_blob"),r[25]=r[6].get("orf_v2_authority_level"),r[26]=r[6].get("oblivious_validation_token_blob"),r[27]=r[6].get("device_id"),r[28]=r[6].get("backup_tenancy"),r[29]=r[6].get("encryption_version"),r[30]=r[6].get("revision_version"),r[31]=r[6].get("initialize_restore_result"),r[32]=r[6].get("device_creation_timestamp_sec"),r[33]=r[6].get("authority_level"),t.i64.neq(r[27],void 0)?t.sequence([function(e){return r[36]=void 0,t.i64.neq(r[36],void 0)?t.resolve(r[37]=r[36]):t.sequence([function(e){return r[49]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[50]=t[0],t})},function(e){return r[50]&&(r[59]=(r[49].push(t.i64.cast([0,0])),r[49])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[51]=t[0],t})},function(e){return r[51]&&(r[59]=(r[49].push(t.i64.cast([0,2])),r[49])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[52]=t[0],t})},function(e){return r[52]&&(r[59]=(r[49].push(t.i64.cast([0,3])),r[49])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[53]=t[0],t})},function(e){return r[53]&&(r[59]=(r[49].push(t.i64.cast([0,4])),r[49])),r[54]=t.createArray(),r[55]=t.i64.of_int32(r[49].length),t.i64.gt(r[55],t.i64.cast([0,0]))?t.loopAsync(r[55],function(e){return r[59]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[49],r[59]).then(function(e){var t;return t=e,r[60]=t[0],r[61]=t[1],t})},function(e){return r[62]=(r[54].push(r[60]),r[54])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[59]=t.createArray(),r[60]=t.i64.of_int32(r[54].length),t.i64.gt(r[60],t.i64.cast([0,0]))?t.loopAsync(r[60],function(e){return r[62]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[54],r[62]).then(function(e){var t;return t=e,r[63]=t[0],r[64]=t[1],t})},function(e){return r[65]=(r[59].push(t.i64.to_string(r[63])),r[59])}])}):t.resolve()},function(e){return r[61]=r[59].join(","),r[56]=r[61]}])},function(e){return r[54].some(function(e){return t.i64.eq(r[29],e)})?r[57]=r[29]:r[57]=void 0,t.i64.neq(r[57],void 0)?r[58]=r[57]:r[58]=void 0,r[37]=r[58]}])},function(o){return t.i64.neq(r[37],void 0)?r[38]=r[37]:r[38]=t.i64.cast([0,0]),t.i64.neq(r[28],void 0)?r[39]=r[28]:r[39]=t.i64.cast([0,1]),r[40]=t.createArray(),r[41]=t.createArray(),r[42]=new t.Map,e[2]!==void 0?r[43]=e[2]:(r[49]=new t.Map,r[43]=r[49]),r[44]=r[43].keys(),r[45]=t.i64.of_int32(e[0].length),t.i64.gt(r[45],t.i64.cast([0,0]))?t.loopAsync(r[45],function(o){return r[49]=o,t.sequence([function(o){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),e[0],r[49]).then(function(e){var t;return t=e,r[50]=t[0],r[51]=t[1],t})},function(e){return r[52]=r[50].get("encrypted_protobufs_v2"),r[53]=r[52].get("toplevel_protobuf"),r[54]=t.i64.random(),r[61]=t.i64.to_string(r[54]),t.resolve()},function(e){return t.resolve()},function(e){var n;return r[55]=r[50].get("otid"),r[56]=r[52].get("toplevel_protobuf_v2"),t.resolve((r[62]=new t.Map,r[62].set("error_code",t.i64.cast([0,117])),r[62].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsV2StoredProcedure"),r[62].set("error_message",""),n=[void 0,r[62]],r[57]=n[0],r[58]=n[1]))},function(o){return r[57]!==void 0?t.sequence([function(e){return t.resolve()},function(e){return r[53]!==void 0?t.resolve(0):t.resolve()},function(e){var t;return t=[r[57],r[58]],r[59]=t[0],r[60]=t[1],t}]):t.sequence([function(e){return t.resolve()},function(o){return r[53]!==void 0?t.sequence([function(e){return r[64]=r[53].get("epoch_id"),r[65]=r[53].get("epoch_anon_id"),r[66]=r[42].get(t.blobs.to_string(r[65])),r[66]!==void 0?t.resolve(r[67]=r[66]):t.sequence([function(e){return t.i64.neq(r[64],void 0)?t.sequence([function(e){return r[76]=t.createArray(),t.count(t.db.table(169).fetch([[[r[64]]]])).then(function(e){return r[77]=e})},function(e){return t.i64.le(r[77],t.i64.cast([0,1]))?t.sequence([function(e){return t.db.table(169).fetch([[[r[64]]]]).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[87]=new t.Map,r[87].set("error_msg","Expected a nonempty query result"),r[87].set("code",t.i64.cast([0,3])),r[87].set("src_line","MEBEpochClientUtils.php:313 MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly()"),r[88]=t.createArray(),r[89]=(r[88].push(r[87]),r[88]),o=[void 0,r[88]],r[83]=o[0],r[84]=o[1]):(n=l.item,r[87]=new t.Map,r[87].set("epoch_id",n.epochId),r[87].set("backup_id",n.backupId),r[87].set("epoch_anon_id_blob",n.epochAnonIdBlob),r[87].set("epoch_root_key_blob",n.epochRootKeyBlob),r[87].set("epoch_status",n.epochStatus),r[87].set("epoch_head",n.epochHead),r[87].set("authority_level",n.authorityLevel),a=[r[87],void 0],r[83]=a[0],r[84]=a[1])})},function(e){return r[86]=new t.Map,r[86].set("value",r[83]),r[86].set("errors",r[84]),r[78]=r[86]}]):t.resolve((r[83]=new t.Map,r[83].set("error_msg","Expected at most one result"),r[83].set("code",t.i64.cast([0,4])),r[83].set("src_line","MEBEpochClientUtils.php:313 MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly()"),r[84]=t.createArray(),r[86]=(r[84].push(r[83]),r[84]),r[85]=new t.Map,r[85].set("value",void 0),r[85].set("errors",r[84]),r[78]=r[85]))},function(e){return r[79]=r[78].get("value"),r[79]!==void 0?(r[83]=r[79].get("epoch_id"),r[84]=r[79].get("backup_id"),r[85]=r[79].get("epoch_anon_id_blob"),r[86]=r[79].get("epoch_root_key_blob"),r[87]=r[79].get("epoch_status"),r[88]=r[79].get("epoch_head"),r[89]=r[79].get("authority_level"),t.i64.eq(r[89],t.i64.cast([0,80]))?r[90]=r[78]:(r[91]=new t.Map,r[91].set("error_msg","NONE"),r[91].set("code",t.i64.cast([0,0])),r[91].set("src_line","MEBEpochClientUtils.php:315 Closure$MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly#2()"),r[92]=t.createArray(),r[94]=(r[92].push(r[91]),r[92]),r[93]=new t.Map,r[93].set("value",void 0),r[93].set("errors",r[92]),r[90]=r[93]),r[80]=r[90]):(r[83]=r[78].get("errors"),r[84]=r[78].get("errors"),r[85]=new t.Map,r[85].set("value",void 0),r[85].set("errors",r[83]),r[80]=r[85]),r[81]=r[80].get("value"),r[81]!==void 0?(r[83]=r[81].get("epoch_id"),r[84]=r[81].get("backup_id"),r[85]=r[81].get("epoch_anon_id_blob"),r[86]=r[81].get("epoch_root_key_blob"),r[87]=r[81].get("epoch_status"),r[88]=r[81].get("epoch_head"),r[89]=r[81].get("authority_level"),t.i64.eq(r[84],r[15])&&t.i64.eq(r[89],t.i64.cast([0,80]))&&(r[90]=new t.Map,r[90].set("epoch_root_key",r[86]),r[90].set("epoch_anon_id",r[85]),r[91]=(r[76].push(r[90]),r[76])),r[82]=!0):(r[83]=r[80].get("errors"),r[84]=r[80].get("errors"),r[82]=!1),r[75]=r[76]}]):t.sequence([function(e){return r[76]=t.createArray(),t.filter(t.db.table(169).fetch(),function(e){return t.blobs.eq(e.epochAnonIdBlob,r[65])}).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[83]=new t.Map,r[83].set("error_msg","Expected a nonempty query result"),r[83].set("code",t.i64.cast([0,3])),r[83].set("src_line","MEBEpochClientUtils.php:556 MEBEpochClientUtils::maybeEpochWithAnonIDFromPersistentEpochsTableDirectly()"),r[84]=t.createArray(),r[85]=(r[84].push(r[83]),r[84]),o=[void 0,r[84]],r[77]=o[0],r[78]=o[1]):(n=l.item,r[83]=new t.Map,r[83].set("epoch_id",n.epochId),r[83].set("backup_id",n.backupId),r[83].set("epoch_anon_id_blob",n.epochAnonIdBlob),r[83].set("epoch_root_key_blob",n.epochRootKeyBlob),r[83].set("epoch_status",n.epochStatus),r[83].set("epoch_head",n.epochHead),r[83].set("authority_level",n.authorityLevel),a=[r[83],void 0],r[77]=a[0],r[78]=a[1])})},function(e){return r[80]=new t.Map,r[80].set("value",r[77]),r[80].set("errors",r[78]),r[81]=r[80].get("value"),r[81]!==void 0?(r[83]=r[81].get("epoch_id"),r[84]=r[81].get("backup_id"),r[85]=r[81].get("epoch_anon_id_blob"),r[86]=r[81].get("epoch_root_key_blob"),r[87]=r[81].get("epoch_status"),r[88]=r[81].get("epoch_head"),r[89]=r[81].get("authority_level"),t.i64.eq(r[84],r[15])&&t.i64.eq(r[89],t.i64.cast([0,80]))&&(r[90]=new t.Map,r[90].set("epoch_root_key",r[86]),r[90].set("epoch_anon_id",r[85]),r[91]=(r[76].push(r[90]),r[76])),r[82]=!0):(r[83]=r[80].get("errors"),r[84]=r[80].get("errors"),r[82]=!1),r[75]=r[76]}])},function(e){return r[67]=r[75]}])},function(o){return r[68]=r[53].get("epoch_anon_id"),r[42].set(t.blobs.to_string(r[68]),r[67]),r[69]=r[53].get("encrypted_protobuf"),r[70]=r[53].get("encryption_version"),t.storedProcedure(n("LSDecryptProtobuf"),r[69],r[70],e[1],r[67]).then(function(e){var t;return t=e,r[71]=t[0],r[72]=t[1],t})},function(e){var n,o,a;return t.blobs.neq(r[71],void 0)?(r[75]=r[53].get("protobuf_timestamp_ms"),r[76]=new t.Map,r[76].set("decrypted_protobuf",r[71]),r[76].set("protobuf_timestamp_ms",r[75]),n=[r[76],void 0],r[73]=n[0],r[74]=n[1]):(o=[void 0,r[72]],r[73]=o[0],r[74]=o[1]),a=[r[73],r[74]],r[62]=a[0],r[63]=a[1]}]):t.sequence([function(e){return t.resolve()},function(e){var n;return r[64]=new t.Map,r[64].set("error_code",t.i64.cast([0,116])),r[64].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsV2StoredProcedure"),r[64].set("error_message",""),n=[void 0,r[64]],r[62]=n[0],r[63]=n[1]}])},function(e){var t;return t=[r[62],r[63]],r[59]=t[0],r[60]=t[1],t}])},function(o){return r[59]!==void 0?t.sequence([function(e){return r[62]=r[52].get("supplemental_protobufs"),r[63]=r[52].get("supplemental_protobufs_v2"),r[64]=r[50].get("otid"),r[65]=new t.Map,r[66]=t.createArray(),t.resolve()},function(o){return r[67]=r[65].keys(),r[68]=r[62].keys(),r[69]=t.i64.of_int32(r[68].length),t.i64.gt(r[69],t.i64.cast([0,0]))?t.loopAsync(r[69],function(o){return r[75]=o,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[68],r[75]).then(function(e){var t;return t=e,r[76]=t[0],r[77]=t[1],t})},function(o){return r[78]=r[62].get(r[76]),r[78]!==void 0?t.sequence([function(e){return r[79]=r[78].get("supplemental_otid"),r[79]!==void 0?t.sequence([function(e){return r[81]=!1,r[82]=t.i64.of_int32(r[66].length),t.i64.gt(r[82],t.i64.cast([0,0]))?t.loopAsync(r[82],function(e){return r[83]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[66],r[83]).then(function(e){var t;return t=e,r[84]=t[0],r[85]=t[1],t})},function(e){return r[81]=r[81]||r[79]===r[84]}])}):t.resolve()},function(e){return r[80]=!r[81]}]):t.resolve(r[80]=!0)},function(o){return r[80]?t.sequence([function(e){return r[81]=r[78].get("epoch_id"),r[82]=r[78].get("epoch_anon_id"),r[83]=r[42].get(t.blobs.to_string(r[82])),r[83]!==void 0?t.resolve(r[84]=r[83]):t.sequence([function(e){return t.i64.neq(r[81],void 0)?t.sequence([function(e){return r[90]=t.createArray(),t.count(t.db.table(169).fetch([[[r[81]]]])).then(function(e){return r[91]=e})},function(e){return t.i64.le(r[91],t.i64.cast([0,1]))?t.sequence([function(e){return t.db.table(169).fetch([[[r[81]]]]).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[101]=new t.Map,r[101].set("error_msg","Expected a nonempty query result"),r[101].set("code",t.i64.cast([0,3])),r[101].set("src_line","MEBEpochClientUtils.php:313 MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly()"),r[102]=t.createArray(),r[103]=(r[102].push(r[101]),r[102]),o=[void 0,r[102]],r[97]=o[0],r[98]=o[1]):(n=l.item,r[101]=new t.Map,r[101].set("epoch_id",n.epochId),r[101].set("backup_id",n.backupId),r[101].set("epoch_anon_id_blob",n.epochAnonIdBlob),r[101].set("epoch_root_key_blob",n.epochRootKeyBlob),r[101].set("epoch_status",n.epochStatus),r[101].set("epoch_head",n.epochHead),r[101].set("authority_level",n.authorityLevel),a=[r[101],void 0],r[97]=a[0],r[98]=a[1])})},function(e){return r[100]=new t.Map,r[100].set("value",r[97]),r[100].set("errors",r[98]),r[92]=r[100]}]):t.resolve((r[97]=new t.Map,r[97].set("error_msg","Expected at most one result"),r[97].set("code",t.i64.cast([0,4])),r[97].set("src_line","MEBEpochClientUtils.php:313 MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly()"),r[98]=t.createArray(),r[100]=(r[98].push(r[97]),r[98]),r[99]=new t.Map,r[99].set("value",void 0),r[99].set("errors",r[98]),r[92]=r[99]))},function(e){return r[93]=r[92].get("value"),r[93]!==void 0?(r[97]=r[93].get("epoch_id"),r[98]=r[93].get("backup_id"),r[99]=r[93].get("epoch_anon_id_blob"),r[100]=r[93].get("epoch_root_key_blob"),r[101]=r[93].get("epoch_status"),r[102]=r[93].get("epoch_head"),r[103]=r[93].get("authority_level"),t.i64.eq(r[103],t.i64.cast([0,80]))?r[104]=r[92]:(r[105]=new t.Map,r[105].set("error_msg","NONE"),r[105].set("code",t.i64.cast([0,0])),r[105].set("src_line","MEBEpochClientUtils.php:315 Closure$MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly#2()"),r[106]=t.createArray(),r[108]=(r[106].push(r[105]),r[106]),r[107]=new t.Map,r[107].set("value",void 0),r[107].set("errors",r[106]),r[104]=r[107]),r[94]=r[104]):(r[97]=r[92].get("errors"),r[98]=r[92].get("errors"),r[99]=new t.Map,r[99].set("value",void 0),r[99].set("errors",r[97]),r[94]=r[99]),r[95]=r[94].get("value"),r[95]!==void 0?(r[97]=r[95].get("epoch_id"),r[98]=r[95].get("backup_id"),r[99]=r[95].get("epoch_anon_id_blob"),r[100]=r[95].get("epoch_root_key_blob"),r[101]=r[95].get("epoch_status"),r[102]=r[95].get("epoch_head"),r[103]=r[95].get("authority_level"),t.i64.eq(r[98],r[15])&&t.i64.eq(r[103],t.i64.cast([0,80]))&&(r[104]=new t.Map,r[104].set("epoch_root_key",r[100]),r[104].set("epoch_anon_id",r[99]),r[105]=(r[90].push(r[104]),r[90])),r[96]=!0):(r[97]=r[94].get("errors"),r[98]=r[94].get("errors"),r[96]=!1),r[89]=r[90]}]):t.sequence([function(e){return r[90]=t.createArray(),t.filter(t.db.table(169).fetch(),function(e){return t.blobs.eq(e.epochAnonIdBlob,r[82])}).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[97]=new t.Map,r[97].set("error_msg","Expected a nonempty query result"),r[97].set("code",t.i64.cast([0,3])),r[97].set("src_line","MEBEpochClientUtils.php:556 MEBEpochClientUtils::maybeEpochWithAnonIDFromPersistentEpochsTableDirectly()"),r[98]=t.createArray(),r[99]=(r[98].push(r[97]),r[98]),o=[void 0,r[98]],r[91]=o[0],r[92]=o[1]):(n=l.item,r[97]=new t.Map,r[97].set("epoch_id",n.epochId),r[97].set("backup_id",n.backupId),r[97].set("epoch_anon_id_blob",n.epochAnonIdBlob),r[97].set("epoch_root_key_blob",n.epochRootKeyBlob),r[97].set("epoch_status",n.epochStatus),r[97].set("epoch_head",n.epochHead),r[97].set("authority_level",n.authorityLevel),a=[r[97],void 0],r[91]=a[0],r[92]=a[1])})},function(e){return r[94]=new t.Map,r[94].set("value",r[91]),r[94].set("errors",r[92]),r[95]=r[94].get("value"),r[95]!==void 0?(r[97]=r[95].get("epoch_id"),r[98]=r[95].get("backup_id"),r[99]=r[95].get("epoch_anon_id_blob"),r[100]=r[95].get("epoch_root_key_blob"),r[101]=r[95].get("epoch_status"),r[102]=r[95].get("epoch_head"),r[103]=r[95].get("authority_level"),t.i64.eq(r[98],r[15])&&t.i64.eq(r[103],t.i64.cast([0,80]))&&(r[104]=new t.Map,r[104].set("epoch_root_key",r[100]),r[104].set("epoch_anon_id",r[99]),r[105]=(r[90].push(r[104]),r[90])),r[96]=!0):(r[97]=r[94].get("errors"),r[98]=r[94].get("errors"),r[96]=!1),r[89]=r[90]}])},function(e){return r[84]=r[89]}])},function(e){return r[85]=r[78].get("epoch_anon_id"),r[42].set(t.blobs.to_string(r[85]),r[84]),r[86]=r[78].get("sk_ciphertext"),t.storedProcedure(n("LSDecryptSupplementalKey"),r[86]==null?"":r[86],r[84]).then(function(e){var t;return t=e,r[87]=t[0],r[88]=t[1],t})},function(o){return r[87]!==void 0?t.sequence([function(e){return r[89]=!1,r[90]=t.i64.of_int32(r[67].length),t.i64.gt(r[90],t.i64.cast([0,0]))?t.loopAsync(r[90],function(e){return r[91]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[67],r[91]).then(function(e){var t;return t=e,r[92]=t[0],r[93]=t[1],t})},function(e){return r[89]=r[89]||r[87]===r[92]}])}):t.resolve()},function(o){return r[89]?t.resolve():t.sequence([function(o){return r[91]=r[78].get("encrypted_protobuf"),r[92]=r[78].get("encryption_version"),t.storedProcedure(n("LSDecryptProtobuf"),r[91],r[92],e[1],r[84]).then(function(e){var t;return t=e,r[93]=t[0],r[94]=t[1],t})},function(e){return t.blobs.neq(r[93],void 0)?(r[95]=r[78].get("protobuf_timestamp_ms"),r[96]=new t.Map,r[96].set("decrypted_protobuf",r[93]),r[96].set("protobuf_timestamp_ms",r[95]),r[65].set(r[87],r[96])):r[95]=(r[41].push(r[94]),r[41])}])}]):t.resolve((r[89]=new t.Map,r[89].set("error_code",t.i64.cast([0,109])),r[89].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsV2StoredProcedure"),r[89].set("error_message",""),r[90]=(r[41].push(r[89]),r[41])))}]):t.resolve()}]):(r[79]=["Supplemental key is null for supplemental protobuf with otid: ",r[64]," act_thread_id: ",e[1]].join(""),(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][decryptMessageProtobufsV2] ","",r[79]].join("")),r[80]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"decryptMessageProtobufsV2",[r[79]].join(""),r[80],t.i64.cast([0,3])))}])}):t.resolve()},function(e){return r[70]=r[50].get("otid"),r[71]=r[50].get("message_tags"),r[72]=r[50].get("attachment_data"),r[72]!==void 0?t.sequence([function(e){return r[75]=t.createArray(),r[76]=t.i64.of_int32(r[72].length),t.i64.gt(r[76],t.i64.cast([0,0]))?t.loopAsync(r[76],function(e){return r[79]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[72],r[79]).then(function(e){var t;return t=e,r[80]=t[0],r[81]=t[1],t})},function(e){return r[82]=(r[75].push(r[80]),r[75])}])}):t.resolve()},function(e){return r[77]=new t.Map,r[77].set("attachment_data",r[75]),r[78]=t.toJSON(r[77]),r[73]=r[78]}]):t.resolve(r[73]=void 0)},function(e){return r[74]=new t.Map,r[74].set("otid",r[70]),r[74].set("toplevel_protobuf",r[59]),r[74].set("supplemental_protobufs",r[65]),r[74].set("message_tags",r[71]),r[74].set("restore_message_data",r[73]),r[75]=(r[40].push(r[74]),r[40]),t.resolve()}]):(r[62]=(r[41].push(r[60]),r[41]),t.resolve())}])}):t.resolve()},function(e){var o;return r[46]=t.i64.of_int32(r[41].length),t.i64.gt(r[46],t.i64.cast([0,0]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[41],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[49]=t[0],r[50]=t[1],t})},function(e){var t;return t=[void 0,r[49]],r[47]=t[0],r[48]=t[1],t}]):t.resolve((o=[r[40],void 0],r[47]=o[0],r[48]=o[1],o))},function(e){var t;return t=[r[47],r[48]],r[34]=t[0],r[35]=t[1],t}]):t.resolve((r[36]=new t.Map,r[36].set("error_code",t.i64.cast([0,24])),r[36].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsV2StoredProcedure"),r[36].set("error_message",""),a=[void 0,r[36]],r[34]=a[0],r[35]=a[1]))},function(e){var t;return t=[r[34],r[35]],r[7]=t[0],r[8]=t[1],t}]):t.resolve((r[15]=r[5].get("errors"),r[16]=r[5].get("errors"),r[17]=new t.Map,r[17].set("error_code",t.i64.cast([0,1])),r[17].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsV2StoredProcedure"),r[17].set("error_message",""),a=[void 0,r[17]],r[7]=a[0],r[8]=a[1]))},function(e){return r[9]=t.i64.of_float(Date.now()),r[10]=t.i64.random(),r[12]="Finishing execution. Execution time: ",r[13]=t.i64.to_string(t.i64.sub(r[9],r[0])),r[14]=" ms",r[11]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][decryptMessageProtobufsV2] ",r[11],r[12],r[11],r[13],r[11],r[14]].join("")),t.i64.eq(t.i64.mod_(r[10],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[15]=",",r[16]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"decryptMessageProtobufsV2",[r[12],r[15],r[13],r[15],r[14]].join(""),r[16],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[7],r[8]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsDecryptMessageProtobufsV2StoredProcedure",e.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_epochs"],a.exports=e}),null);
__d("LSHandleMessageWithProtobufsRestoreV2",["LSArrayGetObjectAt","LSDecryptMessageProtobufsV2","LSDeserializeFromJsonIntoDictionaryV2.nop","LSIsEncryptionVersionSecure","LSLoadThreadPkFromThreadId","LSLogMebClientEvent.nop","LSLogWebQpl.nop","LSQplAnnotateString.nop","LSQplMarkEnd.nop","LSQplMarkPoint.nop","LSQplStartTrace.nop","LSRestoreProtobufs.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][handleMessageWithProtobufsRestoreV2] Beginning execution."),r[1]=t.i64.of_float(Date.now()),r[2]=e[5].get("restore_task_source"),e[9]!==void 0?t.nativeOperation(n("LSQplStartTrace.nop"),t.i64.cast([0,679687866]),e[9],!0,void 0):t.resolve()},function(o){return r[3]=t.i64.of_int32(e[0].length),t.i64.eq(r[3],t.i64.cast([0,0]))?t.sequence([function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"maybe_populate_sender_device_keys_called"):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"minos_sender_device_keys_table_null"):t.resolve()}]):t.resolve()},function(o){return t.storedProcedure(n("LSDecryptMessageProtobufsV2"),e[0],e[2],e[10]).then(function(e){var t;return t=e,r[4]=t[0],r[5]=t[1],t})},function(o){return r[6]=e[5].get("request_id"),r[7]=t.i64.of_int32(e[0].length),r[6]!==void 0?t.nativeOperation(n("LSLogWebQpl.nop"),r[6],t.i64.cast([0,521476165]),"call_from_client",r[7],void 0,void 0):t.resolve()},function(o){return t.i64.neq(e[7],void 0)?t.sequence([function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!1}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[21]=new t.Map,r[21].set("error_msg","Expected a nonempty query result"),r[21].set("code",t.i64.cast([0,3])),r[21].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[22]=t.createArray(),r[23]=(r[22].push(r[21]),r[22]),o=[void 0,r[22]],r[15]=o[0],r[16]=o[1]):(n=l.item,r[21]=new t.Map,r[21].set("backup_id",n.backupId),r[21].set("device_public_key_blob",n.devicePublicKeyBlob),r[21].set("device_private_key_blob",n.devicePrivateKeyBlob),r[21].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[21].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[21].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[21].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[21].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[21].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[21].set("orf_client_state_v2_blob",void 0),r[21].set("orf_v2_authority_level",void 0),r[21].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[21].set("device_id",n.deviceId),r[21].set("backup_tenancy",n.backupTenancy),r[21].set("encryption_version",n.encryptionVersion),r[21].set("revision_version",n.revisionVersion),r[21].set("initialize_restore_result",void 0),r[21].set("device_creation_timestamp_sec",void 0),r[21].set("authority_level",n.authorityLevel),a=[r[21],void 0],r[15]=a[0],r[16]=a[1])})},function(o){return r[18]=new t.Map,r[18].set("value",r[15]),r[18].set("errors",r[16]),r[19]=r[18].get("value"),r[19]!==void 0?t.sequence([function(o){return r[21]=r[19].get("backup_id"),r[22]=r[19].get("device_public_key_blob"),r[23]=r[19].get("device_private_key_blob"),r[24]=r[19].get("epoch_storage_public_key_blob"),r[25]=r[19].get("epoch_storage_private_key_blob"),r[26]=r[19].get("epoch_auth_public_key_blob"),r[27]=r[19].get("epoch_auth_private_key_blob"),r[28]=r[19].get("mailbox_root_key_blob"),r[29]=r[19].get("ocmf_client_state_blob"),r[30]=r[19].get("orf_client_state_v2_blob"),r[31]=r[19].get("orf_v2_authority_level"),r[32]=r[19].get("oblivious_validation_token_blob"),r[33]=r[19].get("device_id"),r[34]=r[19].get("backup_tenancy"),r[35]=r[19].get("encryption_version"),r[36]=r[19].get("revision_version"),r[37]=r[19].get("initialize_restore_result"),r[38]=r[19].get("device_creation_timestamp_sec"),r[39]=r[19].get("authority_level"),t.i64.neq(r[33],void 0)?t.sequence([function(e){return r[41]=void 0,t.i64.neq(r[41],void 0)?t.resolve(r[42]=r[41]):t.sequence([function(e){return r[45]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[46]=t[0],t})},function(e){return r[46]&&(r[55]=(r[45].push(t.i64.cast([0,0])),r[45])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[47]=t[0],t})},function(e){return r[47]&&(r[55]=(r[45].push(t.i64.cast([0,2])),r[45])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[48]=t[0],t})},function(e){return r[48]&&(r[55]=(r[45].push(t.i64.cast([0,3])),r[45])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[49]=t[0],t})},function(e){return r[49]&&(r[55]=(r[45].push(t.i64.cast([0,4])),r[45])),r[50]=t.createArray(),r[51]=t.i64.of_int32(r[45].length),t.i64.gt(r[51],t.i64.cast([0,0]))?t.loopAsync(r[51],function(e){return r[55]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[45],r[55]).then(function(e){var t;return t=e,r[56]=t[0],r[57]=t[1],t})},function(e){return r[58]=(r[50].push(r[56]),r[50])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[55]=t.createArray(),r[56]=t.i64.of_int32(r[50].length),t.i64.gt(r[56],t.i64.cast([0,0]))?t.loopAsync(r[56],function(e){return r[58]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[50],r[58]).then(function(e){var t;return t=e,r[59]=t[0],r[60]=t[1],t})},function(e){return r[61]=(r[55].push(t.i64.to_string(r[59])),r[55])}])}):t.resolve()},function(e){return r[57]=r[55].join(","),r[52]=r[57]}])},function(e){return r[50].some(function(e){return t.i64.eq(r[35],e)})?r[53]=r[35]:r[53]=void 0,t.i64.neq(r[53],void 0)?r[54]=r[53]:r[54]=void 0,r[42]=r[54]}])},function(n){return t.i64.neq(r[42],void 0)?r[43]=r[42]:r[43]=t.i64.cast([0,0]),t.i64.neq(r[34],void 0)?r[44]=r[34]:r[44]=t.i64.cast([0,1]),r[40]=t.i64.neq(r[33],e[7])}]):t.resolve(r[40]=!1)},function(e){return r[20]=r[40]}]):t.resolve((r[21]=r[18].get("errors"),r[22]=r[18].get("errors"),r[20]=!1))},function(e){return r[8]=r[20]}]):t.resolve(r[8]=!1)},function(o){return r[8]?t.sequence([function(o){return r[15]=new t.Map,r[15].set("error_code",t.i64.cast([0,110])),r[15].set("stored_procedure","LSEncryptedBackupsHandleMessageWithProtobufsRestoreV2StoredProcedure"),r[15].set("error_message",""),t.storedProcedure(n("LSLoadThreadPkFromThreadId"),e[2]).then(function(e){var t;return t=e,r[16]=t[0],r[17]=t[1],t})},function(o){return r[18]=new t.Map,r[18].set("error_code",t.i64.cast([0,110])),r[18].set("stored_procedure","LSEncryptedBackupsHandleMessageWithProtobufsRestoreV2StoredProcedure"),r[18].set("error_message",""),e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679677570]),e[9],"handle_restore_response"):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,679677570]),e[9],!1):t.resolve()},function(o){return r[18]!==void 0?(r[21]=r[18].get("error_code"),r[19]=["LSEBPayloadSerializerError","_",t.i64.to_string(r[21])].join("")):r[19]="unknown_failure",r[20]=["LSEncryptedBackupsHandleMessageWithProtobufsRestoreV2StoredProcedure",".",r[19]].join(""),e[9]!==void 0&&r[20]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679687866]),e[9],"error",r[20]):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,679687866]),e[9],!1):t.resolve()}]):t.sequence([function(o){return r[4]!==void 0?t.sequence([function(o){return t.storedProcedure(n("LSLoadThreadPkFromThreadId"),e[2]).then(function(e){var t;return t=e,r[17]=t[0],r[18]=t[1],t})},function(o){var a;return t.i64.neq(r[17],void 0)?t.sequence([function(o){var a;return t.sequence([function(o){return r[23]=e[1].get("has_more_before"),r[24]=e[1].get("has_more_after"),r[23]?(r[34]=e[1].get("next_message_timestamp_ms_before"),r[25]=r[34]):r[25]=void 0,r[24]?(r[34]=e[1].get("next_message_timestamp_ms_after"),r[26]=r[34]):r[26]=void 0,r[27]=e[1].get("has_more_before"),r[28]=e[1].get("has_more_after"),r[29]=e[5].get("request_id"),r[30]=e[5].get("reference_timestamp"),r[31]=t.createArray(),r[32]=e[1].get("max_content_timestamp_ms"),t.nativeOperation(n("LSRestoreProtobufs.nop"),e[2],r[4],r[27],r[25],r[28],r[26],e[4],r[29],r[30],e[6],r[31],r[2],void 0,e[8],r[32])},function(o){return r[34]=t.createArray(),r[33]=r[34],t.i64.eq(r[2],t.i64.cast([0,77]))?(r[34]=t.i64.of_int32(e[0].length),t.i64.gt(r[34],t.i64.cast([0,0]))?t.loopAsync(r[34],function(o){return r[35]=o,t.sequence([function(o){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),e[0],r[35]).then(function(e){var t;return t=e,r[36]=t[0],r[37]=t[1],t})},function(o){return r[38]=r[36].get("encrypted_protobufs_v2"),r[39]=r[38].get("toplevel_protobuf_v2"),r[39]?r[40]=!1:r[40]=!0,r[40]?t.sequence([function(o){return r[49]=r[36].get("otid"),e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"maybe_populate_sender_device_keys_called"):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"minos_sender_device_keys_table_null"):t.resolve()}]):t.sequence([function(o){return r[49]=r[36].get("otid"),r[50]=r[39].get("transport_sender_signing_pk"),e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"maybe_populate_sender_device_keys_called"):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"minos_sender_device_keys_table_null"):t.resolve()}])},function(o){return r[41]=r[36].get("encrypted_protobufs_v2"),r[42]=r[41].get("supplemental_protobufs_v2"),r[43]=r[42].keys(),r[44]=t.i64.of_int32(r[43].length),t.i64.gt(r[44],t.i64.cast([0,0]))?t.loopAsync(r[44],function(o){return r[49]=o,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[43],r[49]).then(function(e){var t;return t=e,r[50]=t[0],r[51]=t[1],t})},function(o){return r[52]=r[42].get(r[50]),r[52]!==void 0?t.sequence([function(o){return r[53]=r[52].get("supplemental_otid"),r[54]=r[52].get("transport_sender_signing_pk"),r[55]=r[36].get("otid"),e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"maybe_populate_sender_device_keys_called"):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"minos_sender_device_keys_table_null"):t.resolve()}]):t.resolve()}])}):t.resolve()},function(o){return r[45]=r[36].get("encrypted_protobufs_v2"),r[46]=r[45].get("supplemental_protobufs"),r[47]=r[46].keys(),r[48]=t.i64.of_int32(r[47].length),t.i64.gt(r[48],t.i64.cast([0,0]))?t.loopAsync(r[48],function(o){return r[49]=o,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[47],r[49]).then(function(e){var t;return t=e,r[50]=t[0],r[51]=t[1],t})},function(o){return r[52]=r[46].get(r[50]),r[52]!==void 0?t.sequence([function(o){return r[53]=r[52].get("supplemental_otid"),r[54]=r[36].get("otid"),e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"maybe_populate_sender_device_keys_called"):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"minos_sender_device_keys_table_null"):t.resolve()}]):t.resolve()}])}):t.resolve()}])}):t.resolve()):t.resolve()},function(e){var t;return t=[r[33],void 0],r[21]=t[0],r[22]=t[1],t}])},function(e){var t;return t=[r[21],r[22]],r[19]=t[0],r[20]=t[1],t}]):t.resolve((r[21]=t.createArray(),a=[r[21],r[18]],r[19]=a[0],r[20]=a[1]))},function(e){var t;return t=[r[19],r[20]],r[15]=t[0],r[16]=t[1],t}]):t.sequence([function(o){return r[5]!==void 0&&(r[18]=r[5].get("error_code"),t.i64.eq(r[18],t.i64.cast([0,1]))),e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"maybe_populate_sender_device_keys_called"):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"minos_sender_device_keys_table_null"):t.resolve()},function(e){var n;return r[17]=t.createArray(),n=[r[17],r[5]],r[15]=n[0],r[16]=n[1]}])},function(o){return r[16]!==void 0?t.sequence([function(o){return t.storedProcedure(n("LSLoadThreadPkFromThreadId"),e[2]).then(function(e){var t;return t=e,r[17]=t[0],r[18]=t[1],t})},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679677570]),e[9],"handle_restore_response"):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,679677570]),e[9],!1):t.resolve()},function(o){return e[6]!==void 0?t.sequence([function(n){return r[19]=e[5].get("request_id"),t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!1}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[41]=new t.Map,r[41].set("error_msg","Expected a nonempty query result"),r[41].set("code",t.i64.cast([0,3])),r[41].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[42]=t.createArray(),r[43]=(r[42].push(r[41]),r[42]),o=[void 0,r[42]],r[20]=o[0],r[21]=o[1]):(n=l.item,r[41]=new t.Map,r[41].set("backup_id",n.backupId),r[41].set("device_public_key_blob",n.devicePublicKeyBlob),r[41].set("device_private_key_blob",n.devicePrivateKeyBlob),r[41].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[41].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[41].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[41].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[41].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[41].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[41].set("orf_client_state_v2_blob",void 0),r[41].set("orf_v2_authority_level",void 0),r[41].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[41].set("device_id",n.deviceId),r[41].set("backup_tenancy",n.backupTenancy),r[41].set("encryption_version",n.encryptionVersion),r[41].set("revision_version",n.revisionVersion),r[41].set("initialize_restore_result",void 0),r[41].set("device_creation_timestamp_sec",void 0),r[41].set("authority_level",n.authorityLevel),a=[r[41],void 0],r[20]=a[0],r[21]=a[1])})},function(e){return r[23]=new t.Map,r[23].set("value",r[20]),r[23].set("errors",r[21]),r[24]=r[23].get("value"),r[24]!==void 0?t.sequence([function(e){return r[41]=r[24].get("backup_id"),r[42]=r[24].get("device_public_key_blob"),r[43]=r[24].get("device_private_key_blob"),r[44]=r[24].get("epoch_storage_public_key_blob"),r[45]=r[24].get("epoch_storage_private_key_blob"),r[46]=r[24].get("epoch_auth_public_key_blob"),r[47]=r[24].get("epoch_auth_private_key_blob"),r[48]=r[24].get("mailbox_root_key_blob"),r[49]=r[24].get("ocmf_client_state_blob"),r[50]=r[24].get("orf_client_state_v2_blob"),r[51]=r[24].get("orf_v2_authority_level"),r[52]=r[24].get("oblivious_validation_token_blob"),r[53]=r[24].get("device_id"),r[54]=r[24].get("backup_tenancy"),r[55]=r[24].get("encryption_version"),r[56]=r[24].get("revision_version"),r[57]=r[24].get("initialize_restore_result"),r[58]=r[24].get("device_creation_timestamp_sec"),r[59]=r[24].get("authority_level"),t.i64.neq(r[53],void 0)?t.sequence([function(e){return r[61]=void 0,t.i64.neq(r[61],void 0)?t.resolve(r[62]=r[61]):t.sequence([function(e){return r[65]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[66]=t[0],t})},function(e){return r[66]&&(r[75]=(r[65].push(t.i64.cast([0,0])),r[65])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[67]=t[0],t})},function(e){return r[67]&&(r[75]=(r[65].push(t.i64.cast([0,2])),r[65])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[68]=t[0],t})},function(e){return r[68]&&(r[75]=(r[65].push(t.i64.cast([0,3])),r[65])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[69]=t[0],t})},function(e){return r[69]&&(r[75]=(r[65].push(t.i64.cast([0,4])),r[65])),r[70]=t.createArray(),r[71]=t.i64.of_int32(r[65].length),t.i64.gt(r[71],t.i64.cast([0,0]))?t.loopAsync(r[71],function(e){return r[75]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[65],r[75]).then(function(e){var t;return t=e,r[76]=t[0],r[77]=t[1],t})},function(e){return r[78]=(r[70].push(r[76]),r[70])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[75]=t.createArray(),r[76]=t.i64.of_int32(r[70].length),t.i64.gt(r[76],t.i64.cast([0,0]))?t.loopAsync(r[76],function(e){return r[78]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[70],r[78]).then(function(e){var t;return t=e,r[79]=t[0],r[80]=t[1],t})},function(e){return r[81]=(r[75].push(t.i64.to_string(r[79])),r[75])}])}):t.resolve()},function(e){return r[77]=r[75].join(","),r[72]=r[77]}])},function(e){return r[70].some(function(e){return t.i64.eq(r[55],e)})?r[73]=r[55]:r[73]=void 0,t.i64.neq(r[73],void 0)?r[74]=r[73]:r[74]=void 0,r[62]=r[74]}])},function(e){return t.i64.neq(r[62],void 0)?r[63]=r[62]:r[63]=t.i64.cast([0,0]),t.i64.neq(r[54],void 0)?r[64]=r[54]:r[64]=t.i64.cast([0,1]),r[60]=r[53]}]):t.resolve(r[60]=void 0)},function(e){return r[25]=r[60]}]):t.resolve((r[41]=r[23].get("errors"),r[42]=r[23].get("errors"),r[25]=void 0))},function(o){return r[26]=e[5].get("restore_task_source"),t.nativeOperation(n("LSDeserializeFromJsonIntoDictionaryV2.nop"),e[6]).then(function(e){var t;return t=e,r[27]=t[0],t})},function(e){return r[28]=new t.Map,r[29]=r[27].keys(),r[30]=t.i64.of_int32(r[29].length),t.i64.gt(r[30],t.i64.cast([0,0]))?t.loopAsync(r[30],function(e){return r[41]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[29],r[41]).then(function(e){var t;return t=e,r[42]=t[0],r[43]=t[1],t})},function(e){return r[44]=r[27].get(r[42]),r[28].set(r[42],r[44])}])}):t.resolve()},function(e){return r[31]=r[28].get("query"),r[32]=new t.Map,r[33]=r[31].keys(),r[34]=t.i64.of_int32(r[33].length),t.i64.gt(r[34],t.i64.cast([0,0]))?t.loopAsync(r[34],function(e){return r[41]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[33],r[41]).then(function(e){var t;return t=e,r[42]=t[0],r[43]=t[1],t})},function(e){return r[44]=r[31].get(r[42]),r[32].set(r[42],r[44])}])}):t.resolve()},function(o){return r[35]=r[32].get("__typename"),r[35]==="MPSMessagePointQuery"?t.sequence([function(e){return r[41]=r[32].get("__typename"),r[41]==="MPSMessagePointQuery"?r[42]=r[32]:r[42]=void 0,r[42]?r[43]=!1:r[43]=!0,r[43]?t.resolve(r[44]=void 0):t.sequence([function(e){return r[45]=r[42].get("otids"),r[46]=t.createArray(),r[47]=t.i64.of_int32(r[45].length),t.i64.gt(r[47],t.i64.cast([0,0]))?t.loopAsync(r[47],function(e){return r[50]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[45],r[50]).then(function(e){var t;return t=e,r[51]=t[0],r[52]=t[1],t})},function(e){return r[53]=(r[46].push(r[51]),r[46])}])}):t.resolve()},function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[46],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[48]=t[0],r[49]=t[1],t})},function(e){return r[44]=r[48]}])},function(o){return e[9]!==void 0&&r[44]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679687866]),e[9],"message_id",r[44]):t.resolve()},function(e){return r[36]="POINT_QUERY_RESTORE"}]):t.resolve((r[41]=r[32].get("__typename"),r[41]==="MPSMessageRangeQuery"?r[42]="RANGE_QUERY_RESTORE":(r[43]=r[32].get("__typename"),r[43]==="MPSMessageSurroundingQuery"?r[44]="SURROUNDING_RESTORE":(r[45]=r[32].get("__typename"),r[45]==="MPSTaggedRangeQuery"?r[46]="TAGGED_RANGE_QUERY_RESTORE":r[46]="unknown_query_type",r[44]=r[46]),r[42]=r[44]),r[36]=r[42]))},function(o){return e[9]!==void 0&&r[36]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679687866]),e[9],"restore_type",r[36]):t.resolve()},function(r){return e[9]!==void 0&&e[2]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679687866]),e[9],"act_thread_id",e[2]):t.resolve()},function(o){return e[9]!==void 0&&r[19]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679687866]),e[9],"request_id",r[19]):t.resolve()},function(o){return r[38]=t.i64.to_string(r[25]),e[9]!==void 0&&r[38]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679687866]),e[9],"device_id",r[38]):t.resolve()},function(o){return r[39]=t.i64.to_string(r[26]),e[9]!==void 0&&r[39]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679687866]),e[9],"task_creation_source",r[39]):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679677570]),e[9],"handle_restore_response"):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,679677570]),e[9],!1):t.resolve()},function(o){return r[16]!==void 0?(r[41]=r[16].get("error_code"),r[37]=["LSEBPayloadSerializerError","_",t.i64.to_string(r[41])].join("")):r[37]="unknown_failure",r[40]=["LSEncryptedBackupsHandleMessageWithProtobufsRestoreV2StoredProcedure",".",r[37]].join(""),e[9]!==void 0&&r[40]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679687866]),e[9],"error",r[40]):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,679687866]),e[9],!1):t.resolve()}]):t.resolve()}]):t.sequence([function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679677570]),e[9],"handle_restore_response"):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,679677570]),e[9],!0):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679687866]),e[9],"handle_restore_response"):t.resolve()},function(r){return e[9]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,679687866]),e[9],!0):t.resolve()},function(n){return r[17]=e[5].get("restore_task_source"),t.i64.eq(r[17],t.i64.cast([0,58])),0}])}])},function(e){return r[9]=t.i64.of_float(Date.now()),r[10]=t.i64.random(),r[12]="Finishing execution. Execution time: ",r[13]=t.i64.to_string(t.i64.sub(r[9],r[0])),r[14]=" ms",r[11]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][handleMessageWithProtobufsRestoreV2] ",r[11],r[12],r[11],r[13],r[11],r[14]].join("")),t.i64.eq(t.i64.mod_(r[10],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[15]=",",r[16]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"handleMessageWithProtobufsRestoreV2",[r[12],r[15],r[13],r[15],r[14]].join(""),r[16],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsHandleMessageWithProtobufsRestoreV2StoredProcedure",e.__tables__=["secure_encrypted_backups_client_state"],a.exports=e}),null);