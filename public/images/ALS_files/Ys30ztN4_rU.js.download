;/*FB_PKG_DELIM*/

__d("BotFeedbackKind",[],(function(t,n,r,o,a,i){var e=Object.freeze({BOT_FEEDBACK_POSITIVE:0,BOT_FEEDBACK_NEGATIVE_GENERIC:1,BOT_FEEDBACK_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_NEGATIVE_INTERESTING:3,BOT_FEEDBACK_NEGATIVE_ACCURATE:4,BOT_FEEDBACK_NEGATIVE_SAFE:5,BOT_FEEDBACK_NEGATIVE_OTHER:6,BOT_FEEDBACK_NEGATIVE_REFUSED:7,BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING:8,BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT:9,BOT_FEEDBACK_NEGATIVE_PERSONALIZED:10,BOT_FEEDBACK_NEGATIVE_CLARITY:11,BOT_FEEDBACK_NEGATIVE_DOESNT_LOOK_LIKE_THE_PERSON:12,BOT_FEEDBACK_NEGATIVE_HALLUCINATION_INTERNAL_ONLY:13,BOT_FEEDBACK_NEGATIVE:14,BOT_FEEDBACK_NEGATIVE_DONT_SHOW_AGAIN:15,BOT_FEEDBACK_NEGATIVE_INCORRECT_OWNERSHIP:16,BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_RESPONSE:17,BOT_FEEDBACK_NEGATIVE_TOO_REPETITIVE:18});i.default=e}),66);
__d("ChatGeminiDisplayContextProvider.react",["react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.useContext,d=u.useMemo,m=s.createContext({displaySurface:"inbox"});function p(e){var t=o("react-compiler-runtime").c(7),n=e.children,r=e.displaySurface,a=e.sideChatMainMessage,i=e.sideChatMainMessageId,l,u;t[0]!==r||t[1]!==a||t[2]!==i?(u={displaySurface:r,sideChatMainMessage:a,sideChatMainMessageId:i},t[0]=r,t[1]=a,t[2]=i,t[3]=u):u=t[3],l=u;var c=l,d;return t[4]!==n||t[5]!==c?(d=s.jsx(m.Provider,{value:c,children:n}),t[4]=n,t[5]=c,t[6]=d):d=t[6],d}function _(){return c(m)}l.ChatGeminiDisplayContextProvider=p,l.useChatGeminiDisplayContext=_}),98);
__d("CometFRXQuery$Parameters",["CometFRXQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e={kind:"PreloadableConcreteRequest",params:{id:n("CometFRXQuery_facebookRelayOperation"),metadata:{},name:"CometFRXQuery",operationKind:"query",text:null}};a.exports=e}),null);
__d("CometFRX.entrypoint",["CometFRXQuery$Parameters","JSResourceForInteraction","WebPixelRatio"],(function(t,n,r,o,a,i,l){"use strict";var e={getPreloadProps:function(t){var e=t.conformed_interface_override,n=t.entryPoint,a=t.id,i=t.location,l=t.responsible_id;return{queries:{frx:{parameters:r("CometFRXQuery$Parameters"),variables:{input:{conformed_interface_override:e,entry_point:n,id:a,location:i,responsible_id:l},scale:o("WebPixelRatio").get()}}}}},root:r("JSResourceForInteraction")("CometFRX.react").__setRef("CometFRX.entrypoint")};l.default=e}),98);
__d("DeletionType.react",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({Global:0,Local:1}),l=e;i.default=l}),66);
__d("FRXEntryPoint",[],(function(t,n,r,o,a,i){var e=Object.freeze({ACTIVITY_LOG:"activity_log",AGORA_GROUPS:"agora_groups",AGORA_RECENT_NEWS:"agora_recent_news",BLOCK_BUTTON:"block_button",BLOCK_COMPOSER:"block_composer",BUSINESS_NOTIFICATION_MESSAGE_REPORT_BUTTON:"business_notification_message_report_button",CHEVRON_BUTTON:"chevron_button",CHEVRON_TAGS:"chevron_tags",COLLEGES_LIVE_CHAT_REPORT_TO_FB:"colleges_live_chat_report_to_fb",COMMENT:"comment",CONTENT_OVERLAY:"content_overlay",CROWDSOURCING_REPORT:"crowdsourcing_report",DELETE_CONTENT_REPORT:"delete_content_report",DELETE_CONVERSATION_REPORT:"delete_conversation_report",DEVELOPER_FEEDBACK_BUTTON:"developer_feedback_button",EVENTS_REPORTING:"events_reporting",FEEDBACK_BUTTON:"feedback_button",FOX_CHEVRON_TAGS:"fox_chevron_tags",GEMSTONE_MEDIA:"gemstone_media",GEMSTONE_MESSAGING:"gemstone_messaging",GEMSTONE_PROFILE:"gemstone_profile",GROUP_MALL_RELATED_GROUPS_CHAINING:"group_mall_related_groups_chaining",GROUP_MALL_RHC:"group_mall_rhc",GROUPS_ADMIN_FEEDBACK:"groups_admin_feedback",GROUPS_DISCOVER:"groups_discover_page",GROUPS_DISCOVER_HIDE_BUTTON:"groups_discover_hide_button",GROUPS_JOIN_QUESTION:"groups_join_question",GROUPS_LEAVE:"groups_leave",GROUPS_LEAVE_BROWSE:"groups_leave_browse",GROUPS_LEAVE_SPECIAL:"groups_leave_special",GROUPS_PARTICIPATION_QUESTION:"groups_participation_question",GROUPS_PENDING_QUEUE:"groups_pending_queue",GROUPS_POLL:"groups_poll",GROUPS_REPORT:"groups_report",GROUPS_REPORT_LONG_PRESS_TO_ADMIN:"groups_report_long_press_to_admin",GROUPS_REPORT_TO_ADMIN:"groups_report_to_admin",GROUPS_RULE:"groups_rule",GROUPS_TAB_CHAT_ROW:"groups_tab_chat_row",GROUPS_TAB_DISCOVER_FIRST:"groups_tab_discover_first",GROUPS_TRANSPARENCY:"groups_transparency",HATE_CTA:"hate_cta",HELP_NAV_BUTTON:"help_nav_button",HIDE_AD_BUTTON:"hide_ad_button",HIDE_AD_XOUT_BUTTON:"hide_ad_xout_button",IN_PROFILE_COMMENT_SELECTOR:"in_profile_comment_selector",IN_PROFILE_MEDIA_SELECTOR:"in_profile_media_selector",INSTANT_GAMES_BOT_FEEDBACK_LINK:"instant_games_bot_feedback_link",LEAVE_CONVERSATION_REPORT:"leave_conversation_report",LOCAL_COMMUNITY_DEMOTE_CONTENT:"local_community_demote_content",LOCAL_COMMUNITY_MOD_HUB_DEMOTE:"local_community_mod_hub_demote",LOCAL_COMMUNITY_POST_REPORT_TO_MOD:"local_community_post_report_to_mod",LOCAL_LIVE_CHAT_REPORT_TO_FB:"local_live_chat_report_to_fb",MARK_AS_SOLD_BUTTON:"mark_as_sold_button",MARK_AS_SUSPICIOUS_BUTTON:"mark_as_suspicious_button",MARKETPLACE_SUBCOMPONENT_REPORT_BUTTON:"marketplace_subcomponent_report_button",MESSAGE_MEDIA_BUBBLE_REPORT:"message_media_bubble_report",MOBILE_GYSJ:"mobile_gysj",NOTE_REPORT_BUTTON:"note_report_button",NOTIFICATIONS_JEWEL:"notifications_jewel",PAGE_UNFOLLOW:"page_unfollow",PAGE_UNFOLLOW_CHEVRON:"page_unfollow_chevron",PAGE_UNLIKE:"page_unlike",PAGE_VERIFICATION_BADGE_OPTION:"page_verification_badge_option",PAGE_VERIFICATION_PAGE_OPTION:"page_verification_page_option",POLITICAL_AD_VERIFIED_VOICE:"political_ad_verified_voice",PROACTIVE_WARNING_BANNER:"proactive_warning_banner",PROACTIVE_WARNING_COMPOSER_BLOCK:"proactive_warning_composer_block",PROACTIVE_WARNING_POPOVER:"proactive_warning_popover",PROACTIVE_WARNING_STRAP:"proactive_warning_strap",PROFILE_REPORT_BUTTON:"profile_report_button",PROFILE_REPORT_FLOW:"profile_report_flow",PROFILE_SUBMIT_FEEDBACK:"profile_submit_feedback",QUICK_REPORT_ACTION:"quick_report_action",RELATED_SEARCHES:"related_searches",REPORT_AD_BUTTON:"report_ad_button",REPORT_AD_XOUT_BUTTON:"report_ad_xout_button",REPORT_BUTTON:"report_button",REPORT_BUTTON_DETAILED_FRX:"report_button_detailed_frx",REPORT_FROM_PREVIEW:"report_from_preview",REPORT_JOB_BUTTON:"report_job_button",REPORT_LONG_PRESS:"report_long_press",ROOMS_POST_CALL_HIGH_RATING:"rooms_post_call_high_rating",ROOMS_POST_CALL_LOW_RATING:"rooms_post_call_low_rating",ROOMS_POST_CALL_LOW_RATING_DETAILED:"rooms_post_call_low_rating_detailed",SAFETY_CHECK_RESULTS:"safety_check_results",SCHOOL_COMMUNITY_TAGS:"school_community_tags",SEARCH_META_AI_PROMPT_SUGGESTION:"search_meta_ai_prompt_suggestion",SEARCH_TYPEAHEAD:"search_typeahead",SNACKBAR:"snackbar",STORY_ATTACHMENT_SHARE:"story_attachment_share",STRUCTURED_REPORT_BUTTON:"structured_report_button",TELL_US_WHY:"tell_us_why",THREADLIST_MENU_REPORT:"threadlist_menu_report",TOMBSTONE:"tombstone",TOOLBAR_REPORT_ACTION:"toolbar_report_action",UNDO_HIDE_AD_BUTTON:"undo_hide_ad_button",UNDO_REPORT_AD_BUTTON:"undo_report_ad_button",UNKNOWN:"unknown",UNOWNED_PAGE_ACTION_MENU_REPORT_PAGE:"unowned_page_action_menu_report_page",UPSELL_AFTER_BLOCK_BOTTOM_SHEET:"upsell_after_block_bottom_sheet",USER_CONTROL_MENU:"user_control_menu",WORKPLACE_REPORT_AND_HIDE_BUTTON:"workplace_report_and_hide_button",WORKPLACE_REPORT_BUTTON:"workplace_report_button",WORKROOM_MEETING_REPORT_BUTTON:"workroom_meeting_report_button",WORKROOM_REPORT_BUTTON:"workroom_report_button",WORKROOM_USER_REPORT_BUTTON:"workroom_user_report_button",X_OUT:"x_out"});i.default=e}),66);
__d("LSClearMessageSearchTable",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.sequence([function(n){return t.forEach(t.db.table(69).fetch([[[e[0]]]]),function(e){return e.delete()})},function(n){return t.forEach(t.db.table(70).fetch([[[e[0]]]]),function(e){return e.delete()})}])},function(e){return t.resolve(r)}])}e.__sproc_name__="LSSearchClearMessageSearchTableStoredProcedure",e.__tables__=["message_search_results","message_search_queries"],a.exports=e}),null);
__d("LSClearMessageSearchTableStoredProcedure",["LSClearMessageSearchTable","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSClearMessageSearchTable"),a.type_);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSCommunityThreadCreationStatus",[],(function(t,n,r,o,a,i){var e=Object.freeze({FAILURE:2,PENDING:0,SUCCESS:1});i.default=e}),66);
__d("LSCreateCommunitySubThread",["LSCreateOfflineThreadingID","LSIssueNewTaskAndGetTaskID"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(e){return r[0]=t.i64.of_float(Date.now()),t.storedProcedure(n("LSCreateOfflineThreadingID"),r[0]).then(function(e){var t;return t=e,r[1]=t[0],t})},function(o){return r[2]=new t.Map,r[2].set("client_mutation_id",r[1]),r[2].set("community_id",e[0]),r[2].set("parent_message_id",e[2]),r[2].set("parent_thread_id",e[1]),t.i64.gt(t.i64.cast([0,0]),t.i64.cast([0,0]))?(r[7]=t.i64.of_float(Date.now()),r[3]=t.i64.add(r[7],t.i64.cast([0,0]))):r[3]=t.i64.cast([0,0]),r[4]=r[2].get("parent_thread_id"),r[5]=t.toJSON(r[2]),t.storedProcedure(n("LSIssueNewTaskAndGetTaskID"),["create_community_sub_thread","_",t.i64.to_string(r[4])].join(""),t.i64.cast([0,665]),r[5],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,r[3],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[6]=t[0],t})},function(e){return o[0]=r[6]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxCreateCommunitySubThreadStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSCreateCommunitySubThreadStoredProcedure",["LSCreateCommunitySubThread","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSCreateCommunitySubThread"),a.communityId,a.parentThreadId,a.parentMessageId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSDeleteReaction",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.forEach(t.filter(t.db.table(8).fetch([[[e[0],e[1],e[2]]]]),function(n){return t.i64.eq(n.threadKey,e[0])&&n.messageId===e[1]&&t.i64.eq(n.actorId,e[2])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))}),function(e){return e.delete()})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxDeleteReactionStoredProcedure",e.__tables__=["reactions"],a.exports=e}),null);
__d("LSInsertAnonymousTaskContext",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.db.table(311).add({taskId:e[0],projectName:e[1]})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSAnonymousCredentialsInsertAnonymousTaskContextStoredProcedure",e.__tables__=["anonymous_task_context"],a.exports=e}),null);
__d("LSIssueNewTaskUsingSyncChannel",["LSIssueNewTaskAndGetTaskID"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return t.storedProcedure(n("LSIssueNewTaskAndGetTaskID"),e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[12]).then(function(e){var t;return t=e,r[0]=t[0],t})},function(n){return t.db.table(306).add({taskId:r[0],syncChannel:e[10],requiresAuthentication:e[11]})},function(e){return o[0]=r[0]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSCoreIssueNewTaskUsingSyncChannelStoredProcedure",e.__tables__=["lightspeed_task_context"],a.exports=e}),null);
__d("LSDispatchMediaReceiverFetchForWeb",["LSInsertAnonymousTaskContext","LSIssueNewTaskUsingSyncChannel","LSMailboxTaskCompletionApiOnTaskInsertion"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=new t.Map,r[0].set("thread_key",e[0]),r[0].set("message_id",e[1]),r[0].set("receiver_fetch_id",e[2]),r[0].set("should_fetch_accessibility_summary_text",e[3]),r[1]=r[0].get("message_id"),r[4]=["LSMediaReceiverFetchTransportAnonymizedMsgrWebE2EEMediaReceiverFetchSyncAction",".",r[1]].join(""),r[2]=t.toJSON(r[0]),t.storedProcedure(n("LSIssueNewTaskUsingSyncChannel"),r[4],t.i64.cast([0,1018]),r[2],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,2]),!1,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[3]=t[0],t})},function(e){return t.storedProcedure(n("LSMailboxTaskCompletionApiOnTaskInsertion"),r[3])},function(e){return t.storedProcedure(n("LSInsertAnonymousTaskContext"),r[3],"LS_MediaReceiverFetch")}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMediaReceiverFetchTransportDispatchMediaReceiverFetchForWebStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSDispatchMediaReceiverFetchForWebStoredProcedure",["LSDispatchMediaReceiverFetchForWeb","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSDispatchMediaReceiverFetchForWeb"),a.threadKey,a.messageId,a.receiverFetchId,a.shouldFetchAccessibilitySummaryText);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSGenerateTraceId",["LSRequestId","MetaConfig"],(function(t,n,r,o,a,i,l){"use strict";function e(){if(r("MetaConfig")._("62"))return r("LSRequestId").generate()}l.default=e}),98);
__d("LSInsertRollCallContribution",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.sequence([function(n){return t.forEach(t.filter(t.db.table(255).fetch([[[e[0],e[1],e[2],e[3]]],"optimistic"]),function(n){return t.i64.eq(n.rollCallContributionId,e[0])&&t.i64.eq(n.rollCallId,e[1])&&n.messageId===e[2]&&t.i64.eq(n.messageTimestampMs,e[3])&&t.i64.lt(n.authorityLevel,e[23])}),function(e){return e.delete()})},function(n){return t.db.table(255).add({rollCallContributionId:e[0],rollCallId:e[1],messageId:e[2],messageTimestampMs:e[3],threadKey:e[4],primaryMediaUrl:e[5],primaryMediaUrlFallback:e[6],primaryMediaExpiryMs:e[7],primaryMediaWidth:e[8],primaryMediaHeight:e[9],primaryMediaMimeType:e[10],previewMediaUrl:e[11],previewMediaUrlFallback:e[12],previewMediaExpiryMs:e[13],previewMediaWidth:e[14],previewMediaHeight:e[15],previewMediaMimeType:e[16],authorityLevel:e[23],contributorId:e[17],offlineThreadingId:e[18],blurOverride:e[19],contributionSource:e[20],contributionType:e[21],content:e[22]})}])},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxInsertRollCallContributionStoredProcedure",e.__tables__=["roll_call_contributions_v2"],a.exports=e}),null);
__d("LSLocalApplyOptimisticCommunityChatSubThread",["LSArrayGetObjectAt","LSCreateOfflineThreadingID","LSGetViewerFBID","LSLocalize","LSUpdateMessageSubThreadKey"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(e){return r[0]=t.i64.cast([0,16408]),r[1]=t.i64.cast([0,0]),r[2]=t.i64.cast([0,268437504]),r[3]=t.i64.cast([0,0]),r[4]=t.i64.cast([0,0]),r[5]=t.i64.of_float(Date.now()),t.storedProcedure(n("LSCreateOfflineThreadingID"),r[5]).then(function(e){var t;return t=e,r[6]=t[0],t})},function(e){return n("LSLocalize").localizeV2Async(t.i64.cast([0,261320435]),void 0).then(function(e){return r[7]=e})},function(o){return t.filter(t.db.table(12).fetch([[[e[2]]],"messageId"]),function(n){return t.i64.eq(n.threadKey,e[1])&&n.messageId===e[2]}).next().then(function(o,a){var i=o.done,l=o.value;return i?r[8]=r[7]:(a=l.item,t.sequence([function(o){return r[23]=a.text,r[23]!==void 0?t.resolve(r[22]=r[23]):t.sequence([function(n){return t.filter(t.db.table(12).fetch([[[e[2]]],"messageId"]),function(n){return t.i64.eq(n.threadKey,e[1])&&n.messageId===e[2]}).next().then(function(e,t){var n=e.done,o=e.value;return n?r[24]=void 0:(t=o.item,r[24]=t.senderId)})},function(e){return n("LSLocalize").localizeV2Async(t.i64.cast([0,1369731110]),void 0).then(function(e){return r[26]=e})},function(n){return t.i64.neq(r[24],void 0)?t.sequence([function(n){return t.db.table(216).fetch([[[r[24],e[0]]]]).next().then(function(e,t){var n=e.done,o=e.value;return n?r[31]=void 0:(t=o.item,r[31]=t.profileName)})},function(e){return t.filter(t.db.table(7).fetch([[[r[24]]]]),function(e){return t.i64.eq(e.id,r[24])&&t.i64.eq(t.i64.cast([0,1]),t.i64.cast([0,1]))}).next().then(function(e,t){var n=e.done,o=e.value;return n?r[33]=void 0:(t=o.item,r[37]=t.firstName,r[37]!==void 0?r[36]=r[37]:r[36]=t.name,r[33]=r[36])})},function(e){return r[31]!==void 0?r[35]=r[31]:(r[33]!==void 0?r[36]=r[33]:r[36]=r[26],r[35]=r[36]),r[27]=r[35]}]):t.resolve(r[27]=r[26])},function(n){return t.db.table(16).fetch([[[e[1],e[2]]]]).next().then(function(e,t){var n=e.done,o=e.value;return n?r[28]=void 0:(t=o.item,r[28]=t.attachmentType)})},function(e){return t.i64.eq(r[28],t.i64.cast([0,5]))?t.sequence([function(e){return r[31]=t.createArray(),r[33]=(r[31].push(r[27]),r[31]),n("LSLocalize").localizeV2Async(t.i64.cast([0,216075330]),r[31]).then(function(e){return r[32]=e})},function(e){return r[30]=r[32]}]):t.sequence([function(e){return t.i64.eq(r[28],t.i64.cast([0,2]))?t.sequence([function(e){return r[32]=t.createArray(),r[34]=(r[32].push(r[27]),r[32]),n("LSLocalize").localizeV2Async(t.i64.cast([0,3093868587]),r[32]).then(function(e){return r[33]=e})},function(e){return r[31]=r[33]}]):t.sequence([function(e){return t.i64.eq(r[28],t.i64.cast([0,4]))?t.sequence([function(e){return r[33]=t.createArray(),r[35]=(r[33].push(r[27]),r[33]),n("LSLocalize").localizeV2Async(t.i64.cast([0,1965569930]),r[33]).then(function(e){return r[34]=e})},function(e){return r[32]=r[34]}]):t.sequence([function(e){return t.i64.eq(r[28],t.i64.cast([0,1]))?t.sequence([function(e){return r[34]=t.createArray(),r[36]=(r[34].push(r[27]),r[34]),n("LSLocalize").localizeV2Async(t.i64.cast([0,3981943156]),r[34]).then(function(e){return r[35]=e})},function(e){return r[33]=r[35]}]):t.sequence([function(e){return t.i64.eq(r[28],t.i64.cast([0,3]))?t.sequence([function(e){return r[35]=t.createArray(),r[37]=(r[35].push(r[27]),r[35]),n("LSLocalize").localizeV2Async(t.i64.cast([0,2071149394]),r[35]).then(function(e){return r[36]=e})},function(e){return r[34]=r[36]}]):t.sequence([function(e){return r[35]=t.createArray(),r[37]=(r[35].push(r[27]),r[35]),n("LSLocalize").localizeV2Async(t.i64.cast([0,2414298738]),r[35]).then(function(e){return r[36]=e})},function(e){return r[34]=r[36]}])},function(e){return r[33]=r[34]}])},function(e){return r[32]=r[33]}])},function(e){return r[31]=r[32]}])},function(e){return r[30]=r[31]}])},function(e){return r[22]=r[30]}])},function(e){return r[8]=r[22]}]))})},function(n){return r[10]=r[8],t.db.table(9).fetch([[[e[1]]]]).next().then(function(e,t){var n,o,a=e.done,i=e.value;return a?(n=[void 0,void 0],r[11]=n[0],r[12]=n[1],n):(t=i.item,o=[t.themeFbid,t.customEmoji],r[11]=o[0],r[12]=o[1])})},function(e){return t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,r[14]=t[0],t})},function(e){return t.forEach(t.filter(t.db.table(9).fetch([[[r[6]]]]),function(e){return t.i64.eq(e.threadKey,r[6])&&t.i64.lt(e.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(n){return t.db.table(9).add({threadKey:r[6],mailboxType:t.i64.cast([0,0]),threadType:t.i64.cast([0,26]),clientThreadKey:r[6],folderName:"community",parentThreadKey:e[1],lastActivityTimestampMs:t.i64.cast([0,0]),lastReadWatermarkTimestampMs:t.i64.cast([0,0]),snippetHasEmoji:!1,snippetSenderContactId:r[14],ongoingCallState:t.i64.cast([0,0]),authorityLevel:t.i64.cast([0,20]),capabilities:r[0],capabilities2:r[1],capabilities3:r[2],capabilities4:r[3],capabilities5:r[4],threadName:r[10],themeFbid:r[11],customEmoji:r[12]})},function(n){return t.filter(t.db.table(12).fetch([[[e[2]]],"messageId"]),function(n){return t.i64.eq(n.threadKey,e[1])&&n.messageId===e[2]}).next().then(function(e,t){var n=e.done,o=e.value;return n?r[15]=void 0:(t=o.item,r[15]=t.senderId)})},function(e){return r[17]=t.createArray(),t.i64.neq(r[15],void 0)&&(r[22]=(r[17].push(r[15]),r[17])),t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,r[18]=t[0],t})},function(e){return t.i64.neq(r[15],r[18])?t.sequence([function(e){return t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,r[22]=t[0],t})},function(e){return r[23]=(r[17].push(r[22]),r[17])}]):t.resolve()},function(e){return r[19]=t.i64.of_int32(r[17].length),t.i64.gt(r[19],t.i64.cast([0,0]))?t.loopAsync(r[19],function(e){return r[22]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[17],r[22]).then(function(e){var t;return t=e,r[23]=t[0],r[24]=t[1],t})},function(e){return t.forEach(t.filter(t.db.table(14).fetch([[[r[6],r[23]]]]),function(e){return t.i64.eq(e.threadKey,r[6])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))&&t.i64.eq(e.contactId,r[23])&&t.i64.lt(e.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(e){return t.db.table(14).add({threadKey:r[6],contactId:r[23],readWatermarkTimestampMs:t.i64.cast([0,0]),deliveredWatermarkTimestampMs:t.i64.cast([0,0]),authorityLevel:t.i64.cast([0,20]),isModerator:!1})}])}):t.resolve()},function(o){return t.storedProcedure(n("LSUpdateMessageSubThreadKey"),e[2],r[6])},function(e){return t.resolve()},function(n){return r[20]=new t.Map,r[20].set("client_mutation_id",r[6]),r[20].set("community_id",e[0]),r[20].set("parent_thread_id",e[1]),r[20].set("parent_message_id",e[2]),r[21]=t.toJSON(r[20]),t.db.table(312).put({threadKey:r[6],metadata:r[21]})},function(e){return o[0]=r[6]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxLocalApplyOptimisticCommunityChatSubThreadStoredProcedure",e.__tables__=["messages","contextual_profile_v1","contacts","attachments","threads","participants","threads_optimistic_metadata"],a.exports=e}),null);
__d("LSLocalApplyOptimisticRollCallContribution",["LSArrayGetObjectAt","LSGetFirstAvailableAttachmentCTAID","LSGetViewerFBID","LSInsertAttachmentItem","LSInsertRollCallContribution","LSLocalize"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return e[1]!==void 0?t.sequence([function(n){return t.db.table(250).fetch([[[t.i64.from_string(e[1]),e[0]]]]).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?((function(e){t.logger(e).mustfix(e)})("[LSMailboxLocalApplyOptimisticRollCallContributionStoredProcedure] couldn't find roll call in table roll_calls"),o=["Roll Call",t.i64.cast([0,0])],r[0]=o[0],r[1]=o[1]):(n=l.item,a=[n.rollCallPrompt,n.expiryTimestampSec],r[0]=a[0],r[1]=a[1])})},function(n){return t.islc(t.sortBy(t.filter(t.db.table(255).fetch(),function(n){return t.i64.eq(n.threadKey,e[0])&&t.i64.eq(n.rollCallId,t.i64.from_string(e[1]))}),[["messageTimestampMs","DESC"]]),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,t){var n=e.done,o=e.value;return n?r[3]=void 0:(t=o.item,r[3]=t.messageId)})},function(n){return r[3]!==void 0?t.sequence([function(n){return r[7]=t.createArray(),t.forEach(t.islc(t.sortBy(t.db.table(18).fetch([[[e[0],r[3]]],"fk_attachments"]),[["attachmentIndex","ASC"]]),0,t.i64.to_float(t.i64.cast([0,2]))),function(e){var n=e.item;return r[8]=new t.Map,r[8].set("attachment_index",n.attachmentIndex),r[8].set("preview_url",n.previewUrl),r[8].set("preview_url_expiration_timestamp_ms",n.previewUrlExpirationTimestampMs),r[8].set("preview_url_mime_type",n.previewUrlMimeType),r[8].set("preview_width",n.previewWidth),r[8].set("preview_height",n.previewHeight),r[8].set("default_cta_id",n.defaultCtaId),r[8].set("playable_url",n.playableUrl),r[9]=(r[7].push(r[8]),r[7])})},function(e){return r[5]=r[7]}]):t.resolve((r[7]=t.createArray(),r[5]=r[7]))},function(o){return t.i64.neq(e[6],void 0)?r[6]=e[6]:r[6]=t.i64.cast([0,0]),t.i64.eq(r[6],t.i64.cast([0,0]))?(r[7]=t.i64.of_int32(e[2].length),t.i64.eq(r[7],t.i64.cast([0,1]))?t.sequence([function(o){return e[5]!==void 0?r[8]=t.i64.from_string(e[5]):r[8]=t.i64.cast([0,0]),n("LSLocalize").localizeV2Async(t.i64.cast([0,3989800917]),void 0).then(function(e){return r[9]=e})},function(o){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),e[2],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[10]=t[0],r[11]=t[1],t})},function(e){return t.storedProcedure(n("LSGetFirstAvailableAttachmentCTAID")).then(function(e){var t;return t=e,r[12]=t[0],t})},function(n){return r[13]=r[10].get("offline_attachment_id"),r[14]=r[10].get("attachment_index"),t.filter(t.db.table(16).fetch([[[e[0],e[3],e[1]]]]),function(n){return t.i64.eq(n.threadKey,e[0])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))&&n.messageId===e[3]&&n.attachmentFbid===e[1]&&t.i64.gt(n.authorityLevel,t.i64.cast([0,20]))}).next().then(function(n){var o=n.done,a=n.value;return o?t.db.table(16).put({threadKey:e[0],messageId:e[3],attachmentFbid:e[1],timestampMs:e[4],offlineAttachmentId:r[13],attachmentType:t.i64.cast([0,7]),filesize:t.i64.cast([0,0]),attachmentCta1Id:r[12],attachmentIndex:r[14],hasMedia:!1,hasXma:!0,isSharable:!1,xmaLayoutType:t.i64.cast([0,10]),cta1Title:r[9],cta1Type:"xma_disabled_cta",defaultCtaTitle:r[9],defaultCtaType:"xma_disabled_cta",defaultCtaId:r[12],titleText:r[0],authorityLevel:t.i64.cast([0,20]),countdownTimestampMs:t.i64.mul(r[1],t.i64.cast([0,1e3])),maxTitleNumOfLines:t.i64.cast([0,4])}):0})},function(e){return r[15]=r[10].get("preview_url"),r[26]=r[15]==null?"":r[15],r[16]=r[10].get("preview_url_mime_type"),r[27]=r[16]==null?"":r[16],r[17]=r[10].get("preview_height"),r[23]=r[17]==null?t.i64.cast([0,0]):r[17],r[18]=r[10].get("preview_width"),r[22]=r[18]==null?t.i64.cast([0,0]):r[18],r[19]=r[10].get("playable_url"),r[25]=r[19]==null?"":r[19],r[20]=r[10].get("playable_url_mime_type"),t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,r[21]=t[0],t})},function(o){return t.storedProcedure(n("LSInsertRollCallContribution"),t.i64.cast([0,0]),t.i64.from_string(e[1]),e[3],e[4],e[0],r[25],"",t.i64.cast([0,0]),r[22],r[23],r[20]==null?"":r[20],r[26],"",t.i64.cast([0,0]),r[22],r[23],r[27],r[21],e[3],!1,r[8],e[6],void 0,t.i64.cast([0,20]))},function(n){return t.forEach(t.db.table(250).fetch([[[t.i64.from_string(e[1]),e[0]]]]),function(e){var t=e.update,n=e.item;return t({isBlurred:!1,viewerHasContributed:!0})})},function(o){return r[24]=r[10].get("attachment_index"),t.storedProcedure(n("LSInsertAttachmentItem"),e[1],r[24],e[0],t.i64.cast([0,0]),e[3],void 0,t.i64.cast([0,0]),void 0,void 0,void 0,void 0,void 0,void 0,r[25],void 0,void 0,void 0,void 0,r[26],r[26],t.i64.cast([0,0]),r[27],r[22],r[23],void 0,r[12],r[9],"xma_disabled_cta",void 0,void 0,void 0,!1,"full",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)},function(o){return r[28]=t.i64.of_int32(r[5].length),t.i64.gt(r[28],t.i64.cast([0,0]))?t.loopAsync(r[28],function(o){return r[29]=o,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[5],r[29]).then(function(e){var t;return t=e,r[30]=t[0],r[31]=t[1],t})},function(o){return r[32]=r[30].get("attachment_index"),r[33]=r[30].get("preview_url"),r[34]=r[30].get("preview_url_expiration_timestamp_ms"),r[35]=r[30].get("preview_url_mime_type"),r[36]=r[30].get("preview_width"),r[37]=r[30].get("preview_height"),r[38]=r[30].get("default_cta_id"),r[39]=r[30].get("playable_url"),t.storedProcedure(n("LSInsertAttachmentItem"),e[1],t.i64.add(r[32],t.i64.cast([0,1])),e[0],t.i64.cast([0,0]),e[3],void 0,t.i64.cast([0,0]),void 0,void 0,void 0,void 0,void 0,void 0,r[39],void 0,void 0,void 0,void 0,r[33],r[33],r[34],r[35],r[36],r[37],void 0,r[38],r[9],"xma_disabled_cta",void 0,void 0,void 0,!1,"full",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)}])}):t.resolve()}]):t.resolve((r[8]=t.i64.of_int32(e[2].length),(function(e){t.logger(e).mustfix(e)})(["[LSMailboxLocalApplyOptimisticRollCallContributionStoredProcedure] expected only 1 attachment for MEDIA contribution, but found ",t.i64.to_string(r[8])].join(""))))):t.resolve(t.i64.eq(r[6],t.i64.cast([0,1]))?e[7]!==void 0?0:(function(e){t.logger(e).mustfix(e)})("[LSMailboxLocalApplyOptimisticRollCallContributionStoredProcedure] expected non-null content for TEXT contribution, but found null"):t.i64.eq(r[6],t.i64.cast([0,2]))?(function(e){t.logger(e).mustfix(e)})("[LSMailboxLocalApplyOptimisticRollCallContributionStoredProcedure] LINK contributions are not yet supported"):0)}]):t.resolve((function(e){t.logger(e).mustfix(e)})("[LSMailboxLocalApplyOptimisticRollCallContributionStoredProcedure] param product_fbid is missing"))},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxLocalApplyOptimisticRollCallContributionStoredProcedure",e.__tables__=["roll_calls","roll_call_contributions_v2","attachment_items","attachments"],a.exports=e}),null);
__d("LSLocalApplyOptimisticSharedAlbumContribution",["LSArrayGetObjectAt","LSArrayRemoveObjectAt","LSCollapseAttachments","LSGetFirstAvailableAttachmentCTAID","LSInsertAttachmentItem","LSLocalize"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(e){return n("LSLocalize").localizeV2Async(t.i64.cast([0,2856734260]),void 0).then(function(e){return r[0]=e})},function(e){return t.storedProcedure(n("LSGetFirstAvailableAttachmentCTAID")).then(function(e){var t;return t=e,r[1]=t[0],t})},function(o){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),e[2],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[2]=t[0],r[3]=t[1],t})},function(o){return r[4]=t.i64.random(),r[5]=t.i64.to_string(r[4]),e[1]!==void 0?t.sequence([function(n){return t.db.table(279).fetch([[[t.i64.from_string(e[1]),e[0]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?((function(e){t.logger(e).mustfix(e)})("[LSMailboxLocalApplyOptimisticSharedAlbumContributionStoredProcedure] couldn't find album in table shared_albums"),r[6]=void 0):(n=a.item,r[6]=n.title)})},function(o){return r[6]!==void 0?t.sequence([function(n){return r[8]=r[2].get("offline_attachment_id"),r[9]=r[2].get("attachment_index"),t.filter(t.db.table(16).fetch([[[e[0],e[3],r[5]]]]),function(n){return t.i64.eq(n.threadKey,e[0])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))&&n.messageId===e[3]&&n.attachmentFbid===r[5]&&t.i64.gt(n.authorityLevel,t.i64.cast([0,20]))}).next().then(function(n){var o=n.done,a=n.value;return o?t.db.table(16).put({threadKey:e[0],messageId:e[3],attachmentFbid:r[5],timestampMs:e[4],offlineAttachmentId:r[8],attachmentType:t.i64.cast([0,7]),filesize:t.i64.cast([0,0]),attachmentCta1Id:r[1],attachmentIndex:r[9],hasMedia:!1,hasXma:!0,isSharable:!1,xmaLayoutType:t.i64.cast([0,10]),cta1Title:r[0],cta1Type:"xma_disabled_cta",defaultCtaTitle:r[0],defaultCtaType:"xma_shared_album_viewer",defaultCtaId:r[1],titleText:r[6],authorityLevel:t.i64.cast([0,20]),maxTitleNumOfLines:t.i64.cast([0,4]),collapsibleId:t.i64.from_string(e[1])}):0})},function(r){return t.storedProcedure(n("LSCollapseAttachments"),e[0],t.i64.from_string(e[1]))},function(o){return r[10]=t.i64.of_int32(e[2].length),t.i64.gt(r[10],t.i64.cast([0,0]))?t.loopAsync(r[10],function(o){return r[12]=o,t.sequence([function(o){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),e[2],r[12]).then(function(e){var t;return t=e,r[13]=t[0],r[14]=t[1],t})},function(n){return r[15]=r[13].get("preview_url"),r[23]=r[15]==null?"":r[15],r[16]=r[13].get("preview_height"),r[24]=r[16]==null?t.i64.cast([0,0]):r[16],r[17]=r[13].get("preview_width"),r[25]=r[17]==null?t.i64.cast([0,0]):r[17],r[18]=r[13].get("preview_url_mime_type"),r[19]=r[13].get("playable_url"),r[20]=r[13].get("playable_url_mime_type"),r[21]=r[13].get("preview_url_mime_type"),r[22]=r[13].get("offline_attachment_id"),r[22]!==void 0?t.sequence([function(n){return r[27]="",r[28]=t.i64.from_string(r[22]),r[29]=t.i64.from_string(e[1]),r[26]=t.i64.of_float(Date.now()),t.forEach(t.filter(t.db.table(280).fetch([[[r[29],r[28],e[0],r[27]]]]),function(n){return t.i64.eq(n.sharedAlbumId,r[29])&&t.i64.eq(n.sharedAlbumContributionId,r[28])&&t.i64.eq(n.threadKey,e[0])&&n.messageId===r[27]&&t.i64.lt(n.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(n){return t.db.table(280).add({messageId:r[27],sharedAlbumContributionId:r[28],sharedAlbumId:r[29],threadKey:e[0],mediaUrl:r[19]==null?r[23]:r[19],mediaHeight:r[24],mediaWidth:r[25],mediaUrlFallback:"",urlExpiryMs:t.i64.cast([0,0]),creationTimestampMs:r[26],authorityLevel:t.i64.cast([0,20]),previewMediaUrl:r[23],previewMediaHeight:r[24],previewMediaWidth:r[25],previewMediaMimeType:r[18]==null?"":r[18]})}]):t.resolve((function(e){t.logger(e).mustfix(e)})("[LSMailboxLocalApplyOptimisticSharedAlbumContributionStoredProcedure] param $attachment_otid is missing"))}])}):t.resolve()},function(o){return r[11]=t.createArray(),r[12]=(r[11].push(t.i64.cast([0,0])),r[11]),t.forEach(t.islc(t.sortBy(t.db.table(280).fetch([[[t.i64.from_string(e[1])]]]),[["creationTimestampMs","DESC"]]),0,t.i64.to_float(t.i64.cast([0,4]))),function(o){var a=o.item;return t.sequence([function(e){return r[15]=a.previewMediaUrl,t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[11],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[12]=t[0],r[13]=t[1],t})},function(o){return t.i64.eq(t.i64.cast([0,0]),r[12])?r[14]=r[6]:r[14]=void 0,t.storedProcedure(n("LSInsertAttachmentItem"),r[5],r[12],e[0],t.i64.cast([0,0]),e[3],void 0,t.i64.cast([0,0]),void 0,r[14],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,r[15],r[15],t.i64.cast([0,0]),a.previewMediaMimeType,a.mediaWidth,a.mediaHeight,void 0,r[1],void 0,"xma_shared_album_viewer",void 0,void 0,void 0,!1,"full",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)},function(e){return t.nativeTypeOperation("Array",n("LSArrayRemoveObjectAt"),r[11],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[16]=t[0],t})},function(e){return r[16]=(r[11].push(t.i64.add(r[12],t.i64.cast([0,1]))),r[11])}])})}]):t.resolve()}]):t.resolve((function(e){t.logger(e).mustfix(e)})("[LSMailboxLocalApplyOptimisticSharedAlbumContributionStoredProcedure] param product_fbid is missing"))}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxLocalApplyOptimisticSharedAlbumContributionStoredProcedure",e.__tables__=["shared_albums","attachments","shared_album_contributions"],a.exports=e}),null);
__d("LSLocalApplyOptimisticMessageWithAttachmentsV2",["LSArrayGetObjectAt","LSLocalApplyOptimisticMessageV2","LSLocalApplyOptimisticRollCallContribution","LSLocalApplyOptimisticSharedAlbumContribution","LSSetMessageDisplayedContentTypes"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return t.storedProcedure(n("LSLocalApplyOptimisticMessageV2"),e[0],e[1],e[2],e[3],e[4],e[5],void 0).then(function(e){var t;return t=e,r[0]=t[0],r[1]=t[1],t})},function(o){return r[2]=e[5].get("attachments"),r[3]=e[5].get("product_type"),r[3]==="roll_call"?(r[4]=e[5].get("product_fbid"),r[5]=e[5].get("product_attribution"),r[6]=e[5].get("contribution_type"),t.storedProcedure(n("LSLocalApplyOptimisticRollCallContribution"),e[1],r[4],r[2],r[0],r[1],r[5],r[6],e[3])):r[3]==="shared_albums"?(r[4]=e[5].get("product_fbid"),r[5]=e[5].get("product_attribution"),t.storedProcedure(n("LSLocalApplyOptimisticSharedAlbumContribution"),e[1],r[4],r[2],r[0],r[1],r[5])):(r[4]=t.i64.of_int32(r[2].length),t.i64.gt(r[4],t.i64.cast([0,0]))?t.loopAsync(r[4],function(o){return r[5]=o,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[2],r[5]).then(function(e){var t;return t=e,r[6]=t[0],r[7]=t[1],t})},function(n){return r[8]=r[6].get("attachment_fbid"),r[9]=r[6].get("offline_attachment_id"),r[10]=r[6].get("attachment_type"),r[11]=r[6].get("filename"),r[12]=r[6].get("filesize"),r[13]=r[6].get("attachment_index"),r[14]=r[6].get("has_media"),r[15]=r[6].get("has_xma"),r[16]=r[6].get("playable_url"),r[17]=r[6].get("playable_url_mime_type"),r[18]=r[6].get("playable_duration_ms"),r[19]=r[6].get("preview_url"),r[20]=r[6].get("preview_url_mime_type"),r[21]=r[6].get("mini_preview"),r[22]=r[6].get("preview_width"),r[23]=r[6].get("preview_height"),r[24]=r[6].get("xma_layout_type"),r[25]=r[6].get("xmas_template_type"),r[26]=r[6].get("cta1_title"),r[27]=r[6].get("cta1_type"),r[28]=r[6].get("attachment_cta1_id"),r[29]=r[6].get("cta2_title"),r[30]=r[6].get("cta2_type"),r[31]=r[6].get("attachment_cta2_id"),r[32]=r[6].get("cta3_title"),r[33]=r[6].get("cta3_type"),r[34]=r[6].get("attachment_cta3_id"),r[35]=r[6].get("image_url"),r[36]=r[6].get("action_url"),r[37]=r[6].get("title_text"),r[38]=r[6].get("subtitle_text"),r[39]=r[6].get("description_text"),r[40]=r[6].get("source_text"),r[41]=r[6].get("original_file_hash"),r[42]=r[6].get("sound_bite_client_sound_key"),r[43]=r[6].get("sound_bite_visual"),r[44]=r[6].get("ephemeral_media_state"),r[45]=r[6].get("waveform_data"),r[46]=r[6].get("avatar_audio_message_animated_url"),r[47]=r[6].get("avatar_audio_message_idle_url"),r[48]=r[6].get("avatar_audio_message_animated_b_url"),r[49]=r[6].get("avatar_audio_message_idle_b_url"),r[50]=r[6].get("avatar_audio_message_background_graphics_image_url"),r[51]=r[6].get("avatar_audio_message_pose_id"),r[52]=r[6].get("sampling_frequency_hz"),r[53]=r[6].get("should_autoplay_video"),r[54]=r[6].get("has_xma_favicon"),r[55]=r[6].get("favicon_url"),r[19]!==void 0?r[56]=r[19]:r[56]=r[16],t.filter(t.db.table(16).fetch([[[e[1],r[0],r[8]]]]),function(n){return t.i64.eq(n.threadKey,e[1])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))&&n.messageId===r[0]&&n.attachmentFbid===r[8]&&t.i64.gt(n.authorityLevel,t.i64.cast([0,20]))}).next().then(function(n){var o=n.done,a=n.value;return o?t.db.table(16).put({threadKey:e[1],messageId:r[0],attachmentFbid:r[8],timestampMs:r[1],offlineAttachmentId:r[9],attachmentType:r[10],filename:r[11],filesize:r[12],attachmentIndex:r[13],hasMedia:r[14],hasXma:r[15],isSharable:!1,playableUrl:r[16],playableUrlMimeType:r[17],playableDurationMs:r[18],previewUrl:r[56],previewUrlMimeType:r[20],miniPreview:r[21],previewWidth:r[22],previewHeight:r[23],xmaLayoutType:r[24],xmasTemplateType:r[25],cta1Title:r[26],cta1Type:r[27],attachmentCta1Id:r[28],cta2Title:r[29],cta2Type:r[30],attachmentCta2Id:r[31],cta3Title:r[32],cta3Type:r[33],attachmentCta3Id:r[34],imageUrl:r[35],actionUrl:r[36],titleText:r[37],subtitleText:r[38],descriptionText:r[39],sourceText:r[40],ephemeralMediaState:r[44],waveformData:r[45],samplingFrequencyHz:r[52],originalFileHash:r[41],authorityLevel:t.i64.cast([0,20]),shouldAutoplayVideo:r[53],hasXmaFavicon:r[54],faviconUrl:r[55]}):0})}])}):t.resolve())},function(o){return r[4]=t.i64.of_int32(r[2].length),t.i64.gt(r[4],t.i64.cast([0,0]))?(r[5]=e[5].get("sticker_id"),t.storedProcedure(n("LSSetMessageDisplayedContentTypes"),e[1],r[0],r[1],e[3],!1,t.i64.neq(r[5],void 0))):t.resolve()},function(e){var t;return t=[r[0],r[1]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure",e.__tables__=["attachments"],a.exports=e}),null);
__d("LSLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure",["LSLocalApplyOptimisticMessageWithAttachmentsV2","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSLocalApplyOptimisticMessageWithAttachmentsV2"),a.senderId,a.threadKey,a.threadType,a.text,a.snippet,a.extraSendMessageParams);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSLocalCreateOptimisticCommunityChatSubThread",["LSLocalApplyOptimisticCommunityChatSubThread"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return t.storedProcedure(n("LSLocalApplyOptimisticCommunityChatSubThread"),e[0],e[1],e[2]).then(function(e){var t;return t=e,r[0]=t[0],t})},function(e){return o[0]=r[0]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxLocalCreateOptimisticCommunityChatSubThreadStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSLocalCreateOptimisticCommunityChatSubThreadStoredProcedure",["LSLocalCreateOptimisticCommunityChatSubThread","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSLocalCreateOptimisticCommunityChatSubThread"),a.communityId,a.parentThreadId,a.parentMessageId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSOptimisticContributeToTextPrompt",["LSLocalApplyOptimisticMessageV2","LSLocalApplyOptimisticRollCallContribution"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=t.createArray(),r[1]=new t.Map,r[1].set("snippet_has_emoji",void 0),r[1].set("sticker_id",void 0),r[1].set("sticker_alt_text",void 0),r[1].set("hot_emoji_size",void 0),r[1].set("external_attachment_url",void 0),r[1].set("attribution_app_id",void 0),r[1].set("source",t.i64.cast([0,0])),r[1].set("platform_ref",void 0),r[1].set("platform_token",void 0),r[1].set("reply_source_id",void 0),r[1].set("reply_source_type",void 0),r[1].set("reply_source_type_v2",void 0),r[1].set("mention_data",void 0),r[1].set("mark_read",void 0),r[1].set("calculate_denormalizations",void 0),r[1].set("optimistic_attachment_preview",void 0),r[1].set("initiating_app_id",void 0),r[1].set("initiating_source",void 0),r[1].set("power_up_style",t.i64.cast([0,0])),r[1].set("data_trace_id",void 0),r[1].set("attachments",r[0]),r[1].set("should_copy_attachments",!1),r[1].set("magic_words_data",void 0),r[1].set("local_data_id",void 0),r[1].set("reply_type",void 0),r[1].set("dety_params",void 0),r[1].set("product_type","roll_call"),r[1].set("product_fbid",e[2]),r[1].set("product_attribution",e[3]),t.storedProcedure(n("LSLocalApplyOptimisticMessageV2"),e[1],e[0],t.i64.cast([0,18]),e[4],e[4],r[1],void 0).then(function(e){var t;return t=e,r[2]=t[0],r[3]=t[1],t})},function(o){return r[4]=t.createArray(),t.storedProcedure(n("LSLocalApplyOptimisticRollCallContribution"),e[0],e[2],r[4],r[2],r[3],e[3],t.i64.cast([0,1]),e[4])}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxOptimisticContributeToTextPromptStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSOptimisticContributeToTextPromptStoredProcedure",["LSOptimisticContributeToTextPrompt","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSOptimisticContributeToTextPrompt"),a.threadKey,a.senderId,a.promptId,a.productAttribution,a.text);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSOptimisticCreateRollCall",["LSCreateOfflineThreadingID","LSGetViewerFBID","LSIssueNewTask"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(e){return r[0]=t.i64.of_float(Date.now()),t.storedProcedure(n("LSCreateOfflineThreadingID"),r[0]).then(function(e){var t;return t=e,r[1]=t[0],t})},function(n){return t.forEach(t.filter(t.db.table(250).fetch([[[r[1],e[0]]]]),function(n){return t.i64.eq(n.rollCallId,r[1])&&t.i64.eq(n.threadKey,e[0])&&t.i64.lt(n.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(n){return t.db.table(250).add({rollCallId:r[1],threadKey:e[0],rollCallPrompt:e[1],expiryTimestampSec:t.i64.cast([0,0]),isBlurred:!1,authorityLevel:t.i64.cast([0,20]),offlineThreadingId:r[1],canViewWithoutContributing:!1})},function(o){return r[2]=new t.Map,r[2].set("thread_key",e[0]),r[2].set("prompt",e[1]),r[2].set("offline_threading_id",r[1]),r[2].set("prompt_type",e[2]),t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,r[3]=t[0],t})},function(n){return t.db.table(9).fetch([[[e[0]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[4]=!1:(n=a.item,t.sequence([function(e){return t.filter(t.db.table(14).fetch([[[n.threadKey,r[3]]]]),function(e){return t.i64.eq(e.threadKey,n.threadKey)&&t.i64.eq(t.i64.cast([0,0]),n.mailboxType)&&t.i64.eq(e.contactId,r[3])}).next().then(function(e,o){var a=e.done,i=e.value;return a?r[10]=!1:(o=i.item,t.i64.eq(n.threadType,t.i64.cast([0,152]))?(r[13]=o.threadRoles,t.i64.lt(t.i64.cast([0,7]),t.i64.cast([0,0]))||t.i64.gt(t.i64.cast([0,7]),t.i64.cast([0,9]))?r[14]=!1:r[14]=!t.i64.eq(t.i64.and_(t.i64.lsl_(t.i64.cast([0,1]),t.i64.to_int32(t.i64.cast([0,7]))),r[13]),t.i64.cast([0,0])),r[15]=n.capabilities,r[16]=n.capabilities2,r[17]=n.capabilities3,r[18]=n.capabilities4,r[19]=n.capabilities5,r[21]=t.i64.div(t.i64.cast([0,223]),t.i64.cast([0,64])),r[22]=t.i64.lsl_(t.i64.cast([0,1]),t.i64.to_int32(t.i64.sub(t.i64.cast([0,223]),t.i64.mul(r[21],t.i64.cast([0,64]))))),t.i64.lt(t.i64.cast([0,223]),t.i64.cast([0,0]))||t.i64.gt(t.i64.cast([0,223]),t.i64.cast([0,297]))?r[20]=!1:(t.i64.eq(r[21],t.i64.cast([0,0]))?r[23]=!t.i64.eq(t.i64.and_(r[22],r[15]),t.i64.cast([0,0])):(t.i64.eq(r[21],t.i64.cast([0,1]))?r[24]=!t.i64.eq(t.i64.and_(r[22],r[16]),t.i64.cast([0,0])):(t.i64.eq(r[21],t.i64.cast([0,2]))?r[25]=!t.i64.eq(t.i64.and_(r[22],r[17]),t.i64.cast([0,0])):(t.i64.eq(r[21],t.i64.cast([0,3]))?r[26]=!t.i64.eq(t.i64.and_(r[22],r[18]),t.i64.cast([0,0])):(t.i64.eq(r[21],t.i64.cast([0,4]))?r[27]=!t.i64.eq(t.i64.and_(r[22],r[19]),t.i64.cast([0,0])):r[27]=!1,r[26]=r[27]),r[25]=r[26]),r[24]=r[25]),r[23]=r[24]),r[20]=r[23]),r[14]!==r[20]&&((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),t.throw("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),r[12]=r[14]):r[12]=!1,r[10]=r[12])})},function(e){return r[4]=r[10]}]))})},function(n){return r[4]&&r[2].set("perform_action_as_page",!0),t.db.table(9).fetch([[[e[0]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[6]=t.i64.cast([0,1]):(n=a.item,r[11]=n.syncGroup,t.i64.neq(r[11],void 0)?r[10]=r[11]:r[10]=t.i64.cast([0,1]),r[6]=r[10])})},function(e){return r[2].set("sync_group",r[6]),r[8]=r[2].get("thread_key"),r[9]=t.toJSON(r[2]),t.storedProcedure(n("LSIssueNewTask"),t.i64.to_string(r[8]),t.i64.cast([0,607]),r[9],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))},function(e){var t;return t=[r[1],r[0]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxOptimisticCreateRollCallStoredProcedure",e.__tables__=["roll_calls","threads","participants"],a.exports=e}),null);
__d("LSOptimisticCreateRollCallStoredProcedure",["LSOptimisticCreateRollCall","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSOptimisticCreateRollCall"),a.threadKey,a.prompt,a.promptType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSOptimisticUpsertReaction",["LSCancelTaskByQueueName","LSDeleteReaction","LSIssueNewTask","LSUpsertReaction"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(n){return t.db.table(9).fetch([[[e[0]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[0]=t.i64.cast([0,1]):(n=a.item,r[21]=n.syncGroup,t.i64.neq(r[21],void 0)?r[20]=r[21]:r[20]=t.i64.cast([0,1]),r[0]=r[20])})},function(o){return r[2]=new t.Map,r[2].set("thread_key",e[0]),r[2].set("timestamp_ms",e[1]),r[2].set("message_id",e[2]),r[2].set("actor_id",e[3]),r[2].set("reaction",e[4]),r[2].set("reaction_style",void 0),r[2].set("sync_group",r[0]),r[3]=t.createArray(),r[4]=(r[3].push("reaction"),r[3]),r[5]=r[2].get("message_id"),r[6]=(r[3].push(r[5]),r[3]),r[7]=t.toJSON(r[3]),t.storedProcedure(n("LSCancelTaskByQueueName"),r[7],t.i64.cast([0,29]))},function(o){return e[4]===""?t.sequence([function(r){return t.storedProcedure(n("LSDeleteReaction"),e[0],e[2],e[3])},function(e){return r[8]=void 0}]):t.sequence([function(o){return e[4]==="\u2764\uFE0F"||e[4]==="\u2764\uFE0F"?r[20]="\u2764":r[20]=e[4],t.storedProcedure(n("LSUpsertReaction"),e[0],e[1],e[2],e[3],r[20],t.i64.cast([0,20]),void 0)},function(e){return r[8]=void 0}])},function(n){return r[9]=!0,r[9]?r[10]=void 0:(r[20]=new t.Map,r[20].set("feature_tags",void 0),r[21]=new t.Map,r[21].set("logging_metadata",r[20]),r[22]=t.toJSON(r[21]),r[10]=r[22]),t.db.table(9).fetch([[[e[0]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[11]=t.i64.cast([0,1]):(n=a.item,r[21]=n.syncGroup,t.i64.neq(r[21],void 0)?r[20]=r[21]:r[20]=t.i64.cast([0,1]),r[11]=r[20])})},function(o){return r[13]=new t.Map,r[13].set("thread_key",e[0]),r[13].set("timestamp_ms",e[1]),r[13].set("message_id",e[2]),r[13].set("actor_id",e[3]),r[13].set("reaction",e[4]),r[13].set("reaction_style",void 0),r[13].set("sync_group",r[11]),r[13].set("send_attribution",e[5]),r[13].set("dataclass_params",r[10]),r[13].set("attachment_fbid",void 0),r[14]=t.createArray(),r[15]=(r[14].push("reaction"),r[14]),r[16]=r[13].get("message_id"),r[17]=(r[14].push(r[16]),r[14]),r[18]=t.toJSON(r[14]),r[19]=t.toJSON(r[13]),t.storedProcedure(n("LSIssueNewTask"),r[18],t.i64.cast([0,29]),r[19],void 0,void 0,e[6]==null?t.i64.cast([0,0]):e[6],t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxOptimisticUpsertReactionStoredProcedure",e.__tables__=["threads"],a.exports=e}),null);
__d("LSOptimisticUpsertReactionStoredProcedure",["LSOptimisticUpsertReaction","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSOptimisticUpsertReaction"),a.threadKey,a.timestampMs,a.messageId,a.actorId,a.reaction,a.sendAttribution,a.pluginType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSOptimisticUpsertReactionV2",["LSCancelTaskByQueueName","LSDeleteReaction","LSIssueNewTaskWithExtraOperations","LSUpdateOrInsertReactionV2","LSUpsertReaction"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return t.i64.eq(e[8],t.i64.cast([0,2]))?t.sequence([function(n){return t.db.table(9).fetch([[[e[1]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[16]=t.i64.cast([0,1]):(n=a.item,r[25]=n.syncGroup,t.i64.neq(r[25],void 0)?r[24]=r[25]:r[24]=t.i64.cast([0,1]),r[16]=r[24])})},function(o){return r[18]=new t.Map,r[18].set("thread_id",e[1]),r[18].set("message_id",e[2]),r[18].set("message_timestamp",e[3]),r[18].set("actor_id",e[0]),r[18].set("reaction_fbid",e[4]),r[18].set("reaction_style",e[7]),r[18].set("operation",e[8]),r[18].set("viewer_is_reactor",e[6]),r[18].set("current_count",e[5]),r[18].set("reaction_literal",e[9]),r[18].set("sync_group",r[16]),r[19]=t.createArray(),r[20]=(r[19].push("reaction_v2"),r[19]),r[21]=r[18].get("message_id"),r[22]=(r[19].push(r[21]),r[19]),r[23]=t.toJSON(r[19]),t.storedProcedure(n("LSCancelTaskByQueueName"),r[23],t.i64.cast([0,604]))}]):t.resolve()},function(o){return[t.i64.cast([0,2]),t.i64.cast([0,3])].some(function(n){return t.i64.eq(e[8],n)})?r[0]=t.i64.add(e[5],t.i64.cast([-1,4294967295])):r[0]=t.i64.add(e[5],t.i64.cast([0,1])),[t.i64.cast([0,2]),t.i64.cast([0,3])].some(function(n){return t.i64.eq(e[8],n)})?r[1]=!1:r[1]=!0,r[2]=t.i64.of_float(Date.now()),t.storedProcedure(n("LSUpdateOrInsertReactionV2"),e[1],e[2],e[4],e[9],r[0],t.i64.cast([0,20]),r[1],t.i64.cast([0,0]),r[2])},function(n){return t.db.table(9).fetch([[[e[1]]]]).next().then(function(e,t){var n=e.done,o=e.value;return n?r[3]=void 0:(t=o.item,r[3]=t.threadType)})},function(o){return t.i64.neq(r[3],t.i64.cast([0,23]))?[t.i64.cast([0,2]),t.i64.cast([0,3])].some(function(n){return t.i64.eq(e[8],n)})?t.i64.eq(e[8],t.i64.cast([0,2]))?t.storedProcedure(n("LSDeleteReaction"),e[1],e[2],e[0]):t.sequence([function(n){return t.filter(t.db.table(8).fetch([[[e[1],e[2],e[0]]]]),function(n){return t.i64.eq(n.threadKey,e[1])&&n.messageId===e[2]&&t.i64.eq(n.actorId,e[0])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))}).next().then(function(e,t){var n=e.done,o=e.value;return n?r[16]=void 0:(t=o.item,r[16]=t.reaction)})},function(o){return e[9]!==void 0?(e[9]==="\u2764\uFE0F"||e[9]==="\u2764\uFE0F"?r[18]="\u2764":r[18]=e[9],r[18]===r[16]?t.storedProcedure(n("LSDeleteReaction"),e[1],e[2],e[0]):t.resolve()):t.resolve()}]):e[9]!==void 0?(e[9]==="\u2764\uFE0F"||e[9]==="\u2764\uFE0F"?r[16]="\u2764":r[16]=e[9],r[17]=t.i64.of_float(Date.now()),t.storedProcedure(n("LSUpsertReaction"),e[1],e[3],e[2],e[0],r[16],t.i64.cast([0,20]),r[17])):t.resolve():t.resolve()},function(n){return t.db.table(9).fetch([[[e[1]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[5]=t.i64.cast([0,1]):(n=a.item,r[17]=n.syncGroup,t.i64.neq(r[17],void 0)?r[16]=r[17]:r[16]=t.i64.cast([0,1]),r[5]=r[16])})},function(n){return r[7]=new t.Map,r[7].set("thread_id",e[1]),r[7].set("message_id",e[2]),r[7].set("message_timestamp",e[3]),r[7].set("actor_id",e[0]),r[7].set("reaction_fbid",e[4]),r[7].set("reaction_style",e[7]),r[7].set("current_count",e[5]),r[7].set("viewer_is_reactor",e[6]),r[7].set("operation",e[8]),r[7].set("reaction_literal",e[9]),r[7].set("entry_point",void 0),r[7].set("sync_group",r[5]),t.db.table(9).fetch([[[e[1]]]]).next().then(function(n,o){var a=n.done,i=n.value;return a?r[8]=!1:(o=i.item,t.sequence([function(n){return t.filter(t.db.table(14).fetch([[[o.threadKey,e[0]]]]),function(n){return t.i64.eq(n.threadKey,o.threadKey)&&t.i64.eq(t.i64.cast([0,0]),o.mailboxType)&&t.i64.eq(n.contactId,e[0])}).next().then(function(e,n){var a=e.done,i=e.value;return a?r[16]=!1:(n=i.item,t.i64.eq(o.threadType,t.i64.cast([0,152]))?(r[19]=n.threadRoles,t.i64.lt(t.i64.cast([0,7]),t.i64.cast([0,0]))||t.i64.gt(t.i64.cast([0,7]),t.i64.cast([0,9]))?r[20]=!1:r[20]=!t.i64.eq(t.i64.and_(t.i64.lsl_(t.i64.cast([0,1]),t.i64.to_int32(t.i64.cast([0,7]))),r[19]),t.i64.cast([0,0])),r[21]=o.capabilities,r[22]=o.capabilities2,r[23]=o.capabilities3,r[24]=o.capabilities4,r[25]=o.capabilities5,r[27]=t.i64.div(t.i64.cast([0,223]),t.i64.cast([0,64])),r[28]=t.i64.lsl_(t.i64.cast([0,1]),t.i64.to_int32(t.i64.sub(t.i64.cast([0,223]),t.i64.mul(r[27],t.i64.cast([0,64]))))),t.i64.lt(t.i64.cast([0,223]),t.i64.cast([0,0]))||t.i64.gt(t.i64.cast([0,223]),t.i64.cast([0,297]))?r[26]=!1:(t.i64.eq(r[27],t.i64.cast([0,0]))?r[29]=!t.i64.eq(t.i64.and_(r[28],r[21]),t.i64.cast([0,0])):(t.i64.eq(r[27],t.i64.cast([0,1]))?r[30]=!t.i64.eq(t.i64.and_(r[28],r[22]),t.i64.cast([0,0])):(t.i64.eq(r[27],t.i64.cast([0,2]))?r[31]=!t.i64.eq(t.i64.and_(r[28],r[23]),t.i64.cast([0,0])):(t.i64.eq(r[27],t.i64.cast([0,3]))?r[32]=!t.i64.eq(t.i64.and_(r[28],r[24]),t.i64.cast([0,0])):(t.i64.eq(r[27],t.i64.cast([0,4]))?r[33]=!t.i64.eq(t.i64.and_(r[28],r[25]),t.i64.cast([0,0])):r[33]=!1,r[32]=r[33]),r[31]=r[32]),r[30]=r[31]),r[29]=r[30]),r[26]=r[29]),r[20]!==r[26]&&((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),t.throw("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),r[18]=r[20]):r[18]=!1,r[16]=r[18])})},function(e){return r[8]=r[16]}]))})},function(e){return r[8]&&r[7].set("perform_action_as_page",!0),r[10]=t.createArray(),r[11]=(r[10].push("reaction_v2"),r[10]),r[12]=r[7].get("message_id"),r[13]=(r[10].push(r[12]),r[10]),r[14]=t.toJSON(r[10]),r[15]=t.toJSON(r[7]),t.storedProcedure(n("LSIssueNewTaskWithExtraOperations"),r[14],t.i64.cast([0,604]),r[15],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),void 0,t.i64.cast([0,0]))}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxOptimisticUpsertReactionV2StoredProcedure",e.__tables__=["threads","reactions","participants"],a.exports=e}),null);
__d("LSOptimisticUpsertReactionV2StoredProcedure",["LSOptimisticUpsertReactionV2","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSOptimisticUpsertReactionV2"),a.actorId,a.threadId,a.messageId,a.messageTimestamp,a.reactionFbid,a.currentCount,a.viewerIsReactor,a.reactionStyle,a.operation,a.reactionLiteral);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSSubmitGenAIBotFeedback",["LSIssueNewTaskWithExtraOperations"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=new t.Map,r[0].set("bot_feedback_kind",e[0]),r[0].set("bot_response_id",e[2]),r[0].set("feedback_kind_type",e[0]),r[0].set("bot_id",e[3]),r[1]=t.toJSON(r[0]),t.storedProcedure(n("LSIssueNewTaskWithExtraOperations"),"submit_gen_ai_bot_feedback",t.i64.cast([0,756]),r[1],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),void 0,t.i64.cast([0,0]))},function(n){return t.db.table(315).fetch([[[e[2]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[2]=t.i64.cast([0,0]):(n=a.item,r[2]=n.feedbackSubmissionStatus)})},function(n){return t.i64.eq(r[2],t.i64.cast([0,0]))?t.db.table(315).add({botResponseId:e[2],feedbackSubmissionStatus:t.i64.cast([0,1]),feedbackKindType:e[0]}):t.forEach(t.db.table(315).fetch([[[e[2]]]]),function(n){var r=n.update,o=n.item;return r({feedbackSubmissionStatus:t.i64.cast([0,1]),feedbackKindType:e[0]})})}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxSubmitGenAIBotFeedbackStoredProcedure",e.__tables__=["ai_bot_feedback_submission_status"],a.exports=e}),null);
__d("LSSubmitGenAIBotFeedbackStoredProcedure",["LSSubmitGenAIBotFeedback","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSSubmitGenAIBotFeedback"),a.botFeedbackKind,a.feedbackKindType,a.botResponseId,a.botId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSTaskType",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["BatchLookup","CreateThread","DeleteMessage","DeviceRegistration","DisableDevice","EnableDevice","MessageRangeQuery","PreKeyUpload","SendMessage","SendOrRemoveReaction","UnsendMessage","VerifyThreadChecksum"]),l=e;i.default=l}),66);
__d("LSTasks",["FBLogger","I64","LSIntEnum","LSJson","LSPendingTasksPluginType","LSTaskType"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(e){switch(e){case r("LSTaskType").BatchLookup:return"10003";case r("LSTaskType").CreateThread:return"10002";case r("LSTaskType").DeleteMessage:return"155";case r("LSTaskType").DeviceRegistration:return"10001";case r("LSTaskType").DisableDevice:return"10007";case r("LSTaskType").EnableDevice:return"10006";case r("LSTaskType").MessageRangeQuery:return"14";case r("LSTaskType").PreKeyUpload:return"10004";case r("LSTaskType").SendMessage:return"10005";case r("LSTaskType").SendOrRemoveReaction:return"29";case r("LSTaskType").UnsendMessage:return"33";case r("LSTaskType").VerifyThreadChecksum:throw r("FBLogger")("messenger_web").mustfixThrow("[LS] Not a supported task type")}}async function c(t,n,a,i){await t.pending_tasks.add({context:u(n),dataTraceId:void 0,enqueueTimestampMs:(e||(e=o("I64"))).of_float(Date.now()),failureCount:e.zero,firstExecutedTimestampMs:e.zero,httpUrlOverride:void 0,initTraceTimestampMs:void 0,minTimeToSyncTimestampMs:e.zero,pluginType:(s||(s=o("LSIntEnum"))).ofNumber(r("LSPendingTasksPluginType").LS_BROKER),priority:e.zero,queueName:a,syncGroupId:void 0,taskValue:o("LSJson").stringify(i),timeoutTimestampMs:void 0})}l.enqueue=c}),98);
__d("WAOpusRecorderWorkerClient",["WAWebOpusRecorderWorkerResource","WorkerBundleResource"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e){this.$1=o("WorkerBundleResource").createDedicatedWebWorker(r("WAWebOpusRecorderWorkerResource")),this.$1.onmessage=e!=null?e:null}var t=e.prototype;return t.getWorker=function(){return this.$1},t.postMessage=function(t,n){var e={type:"message",message:t};this.$1.postMessage(e,n)},t.addEventListener=function(t,n){this.$1.addEventListener(t,n)},t.removeEventListener=function(t,n){this.$1.addEventListener(t,n)},e})();function s(){return new e}function u(t){return new e(t)}l.WAOpusRecorderWorkerClient=e,l.getOpusEncoderWorker=s,l.getOpusDecoderWorker=u}),98);
__d("WAOpusRecorderPlayer",["Promise","WABinary","WABlobToArrayBuffer","WALogger","WAOpusRecorderWorkerClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d="audio/wav",m,p=0;function _(){return p++,m||(m=new window.AudioContext),m}function f(){if(p--,p===0&&m){try{m.close().catch(function(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["releaseAudioContext close async error: ",""])),t).devConsole(t)})}catch(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["releaseAudioContext close sync error: ",""])),e).devConsole(e)}m=void 0}}var g=(function(){function e(e){this.oggBlob=e}var t=e.prototype;return t.generateBlob=function(){return this.oggBlobToWAVBlob(this.oggBlob,1)},t.oggBlobToWAVBlob=function(t,r){var e=this;r===void 0&&(r=2);var a=r;return new(c||(c=n("Promise")))(function(n){var r=function(r){if(r.data==null){for(var t=function(t){l.forEach(function(e){for(var n=e[t]||e[0],r=0;r<n.length;r++)s.push(n[r])})},o=0;o<a;o++)t(o);var i=e.encodeWAV(s,c,a),u=new Blob([i.readByteArrayView()],{type:d});f(),n(u)}else l.push(r.data),a=l[0].length},i=o("WAOpusRecorderWorkerClient").getOpusDecoderWorker(r),l=[],s=[],c=_(),m={outputBufferSampleRate:c.sampleRate,bufferLength:4096};i.postMessage({command:"decode-init",config:m}),o("WABlobToArrayBuffer").blobToArrayBuffer(t).then(function(e){i.postMessage({command:"decode",pages:new Uint8Array(e)}),i.postMessage({command:"decode-done"})}).catch(function(e){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Player::oggBlobToWAVBlob error: ",""])),e).devConsole(e)})})},t.encodeWAV=function(t,n,r){var e=new(o("WABinary")).Binary(void 0,!0);e.ensureCapacity(44+t.length*2),e.writeString("RIFF"),e.writeUint32(36+t.length*2),e.writeString("WAVE"),e.writeString("fmt "),e.writeUint32(16),e.writeUint16(1),e.writeUint16(r),e.writeUint32(n.sampleRate),e.writeUint32(n.sampleRate*r*2),e.writeUint16(r*2),e.writeUint16(16),e.writeString("data"),e.writeUint32(t.length*2);for(var a=0;a<t.length;a++){var i=Math.max(-1,Math.min(t[a],1));i*=i>0?32767:32768,e.writeInt16(Math.floor(i))}return e},e})();l.default=g}),98);
__d("WAMaybeTranscodeOggOpusToWavForPlayback",["FBLogger","WABlobToArrayBuffer","WAIsOgg","WAOpusRecorderPlayer","justknobx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=function(){return r("FBLogger")("wmi").tags(["audio"])},m=r("justknobx")._("4988"),p=new Audio().canPlayType("audio/ogg"),_=p==="probably"||p==="maybe";async function f(t){if(_)return d().DEBUG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Ogg playback supported no need to transcode"]))),t;if(d().DEBUG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Ogg playback is not supported. Start transcoding"]))),t.size>m)return d().MUSTFIX(u||(u=babelHelpers.taggedTemplateLiteralLoose(["blob size too large"]))),t;var n=await o("WABlobToArrayBuffer").blobToArrayBuffer(t);if(!o("WAIsOgg").isOgg(new Uint8Array(n)))return d().DEBUG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["blob is not Ogg, skip transcode"]))),t;var a=new(r("WAOpusRecorderPlayer"))(t);return a.generateBlob()}l.isOggPlaybackSupported=_,l.maybeTranscodeOggOpusToWavForPlayback=f}),98);
__d("MAWAudioUtils",["FBLogger","WAMaybeTranscodeOggOpusToWavForPlayback","gkx"],(function(t,n,r,o,a,i,l){"use strict";async function e(e){var t=r("gkx")("3053")?URL.createObjectURL(await o("WAMaybeTranscodeOggOpusToWavForPlayback").maybeTranscodeOggOpusToWavForPlayback(e)):URL.createObjectURL(e);return new Promise(function(e,n){var o=new Audio;o.setAttribute("crossOrigin","anonymous"),o.addEventListener("loadedmetadata",function(t){var r=t.currentTarget;if(r instanceof HTMLAudioElement){var o=r.duration;e(Math.ceil(o))}else n("EventTarget returned for event should be HTMLAudioElement")}),o.src=t,o.onabort=function(){n(r("FBLogger")("messenger_web").mustfixThrow("Error loading audio from provided URL"))},o.onerror=function(){var e,t;n(r("FBLogger")("messenger_web").mustfixThrow("getAudioDurationInSeconds: audioElement error code: %s. message: %s",(e=o.error)==null?void 0:e.code,(t=o.error)==null?void 0:t.message))}})}l.getAudioDurationInSeconds=e}),98);
__d("MAWAudioPreProcess",["MAWAudioUtils","WABlobToArrayBuffer","WATagsLogger","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("WATagsLogger").TAGS(["MAWAudioPreProcess"]),c=["audio/ogg","audio/x-flac","audio/flac"];function d(t){return u.LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["start audio preprocess"]))),o("MAWAudioUtils").getAudioDurationInSeconds(t).then(async function(e){return{durations:e,file:t,isPtt:!0,plaintext:await o("WABlobToArrayBuffer").blobToArrayBuffer(t),type:"audio"}})}function m(e,n){var a=t.URL.createObjectURL(e);u.LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["start optimistic audio preprocess"])));var i=n==null?void 0:n.voiceClipDuration,l=i!=null&&r("gkx")("4255")?Promise.resolve(i):o("MAWAudioUtils").getAudioDurationInSeconds(e);return l.then(function(t){return Promise.resolve({durations:t,file:e,isPtt:!0,type:"audio",url:a})})}function p(e){return e.startsWith("audio/")?!c.includes(e):!1}l.audioPreprocess=d,l.optimisticAudioPreprocess=m,l.isSupportedAudioFileType=p}),98);
__d("MAWIssueReceiverFetchTask",["LSDispatchMediaReceiverFetchForWebStoredProcedure","LSFactory","MAWBridgeUpdateClientMediaStatusHandler","MAWMediaDownloadStatus","WAHashUtils","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n,a){return r("promiseDone")(o("MAWBridgeUpdateClientMediaStatusHandler").call(e,{details:"issue_receiver_fetch_task",key:o("WAHashUtils").stringToPlaintextHash(t),status:r("MAWMediaDownloadStatus").DOWNLOADING,type:"main"})),e.runInTransaction(function(e){return r("LSDispatchMediaReceiverFetchForWebStoredProcedure")(r("LSFactory")(e),{messageId:t,receiverFetchId:n,shouldFetchAccessibilitySummaryText:!0,threadKey:a})},"readwrite",void 0,void 0,i.id+":38")}l.issueReceiverFetchTask=e}),98);
__d("MAWMediaDownloadStatusUIStateType",[],(function(t,n,r,o,a,i){"use strict";function e(e){if(e==null)return!1;switch(e){case"non_retryable_error":case"non_retryable_error_with_preview":case"retryable_error":case"retryable_error_with_preview":return!0;default:return!1}}function l(e){if(e==null)return!1;switch(e){case"retryable_error":case"retryable_error_with_preview":return!0;default:return!1}}i.isErrorState=e,i.isRetryableErrorState=l}),66);
__d("MAWSendVideoToWorker",["MAWMediaWorkerResource","Promise","WALogger","WebWorker"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=d();function c(t){var r;return new(s||(s=n("Promise")))(function(e){r=u&&m(u)?d():u,r.setMessageHandler(function(t){e(t)}).execute(),r.postMessage(t)}).finally(function(){r&&(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Clean up media worker"]))),r.terminate(),(!u||!u.isCurrentState("constructed"))&&(u=d()))})}function d(){return new(r("WebWorker"))(r("MAWMediaWorkerResource")).setAllowCrossPageTransition(!0)}function m(e){return e.isCurrentState("preparing")||e.isCurrentState("executing")}l.sendVideoMessageToWorker=c}),98);
__d("MAWVideoPreProcess",["MAWMediaPreProcessQpl","MAWSendVideoToWorker","MAWVideoUtils","MWFBLogger","MWPBumpEntityKey","VideoTranscodeUtils","WABlobToArrayBuffer","WAMediaWasmWorkerClient","WAResultOrError","cometIsMimeTypeForMedia","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_=["video/x-ms-wmv","video/x-msvideo","video/avi","video/x-flv","video/ogg","video/mpeg"],f=o("MWFBLogger").MWMediaLogger().tags(["MAWVideoPreProcess"]),g=typeof self.BigInt=="function";function h(e,t){return v(e,t).then(function(t){var n;if(!t.success)return t.error,Promise.reject(t.error);var r=(n=t.value)!=null?n:e;return Promise.all([r,o("MAWVideoUtils").getVideoThumbnailUrlAndSpec(r)]).then(async function(e){var t=e[0],n=e[1];return{file:t,plaintext:await o("WABlobToArrayBuffer").blobToArrayBuffer(t),thumbnailUrlAndSpec:n,type:"video"}})})}function y(e){var t=e.file;return Promise.all([o("WABlobToArrayBuffer").blobToArrayBuffer(t),o("MAWVideoUtils").getVideoThumbnailUrlAndSpec(t)]).then(function(e){var n=e[0],r=e[1];return{file:t,plaintext:n,thumbnailUrlAndSpec:r,type:"video"}})}async function C(e,n){var r=await v(e,n).then(function(t){return t.success?t:(o("MWPBumpEntityKey").bumpEntityKeyWithAppId("maw.composer","invalid_video_send_block_with_type_"+e.type),t.error,t.error)});if(r==="invalid-mp4")return Promise.reject(r);var a=r.value,i=await o("MAWVideoUtils").getVideoThumbnailSpec(a),l=t.URL.createObjectURL(a);return Promise.resolve({file:a,thumbnailSpec:i,type:"video",url:l})}async function b(e){await v(e).then(function(t){if(!t.success)return o("MWPBumpEntityKey").bumpEntityKeyWithAppId("maw.composer","invalid_video_send_block_with_type_"+e.type),t.error,Promise.reject(t.error)});var n=await o("MAWVideoUtils").getVideoThumbnailSpec(e),r=t.URL.createObjectURL(e);return Promise.resolve({file:e,thumbnailSpec:n,type:"video",url:r})}function v(t,n){var r=g,a=o("MAWMediaPreProcessQpl").startMediaPreProcessQpl("video",t);a.addAnnotations({bool:{wamedia_wasm_enabled:r},int:{total_number_of_files:n!=null?n:1}});var i=r?S(t,a):R(t);return i.then(function(e){if(!e.success)switch(e.error){case"invalid-media":return a.endFail("invalid-media"),o("WAResultOrError").makeError("invalid-mp4");case"worker-connection-timeout":case"worker-connection-runtime-error":case"internal-error":case"decode-image-error":case"undefined-operation":case"runtime-error":throw e.error;default:throw e.error,e.error}return a.endSuccess({int:{compressed_file_size:e.value.size}}),o("WAResultOrError").makeResult(e.value)}).catch(function(n){return f.MUSTFIX(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Unable to preprocess video: ",""])),n.toString()),a.endFail("unable_to_process_video",{string:{preprocessError:n.toString()}}),o("WAResultOrError").makeResult(t)})}async function S(e,t){f.DEBUG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["start process video through wasm, file name: ",""])),e.name);var n=await e.arrayBuffer(),a=e.type,i;if(r("gkx")("6879")){t.addAnnotations({bool:{passes_transcode_gk:!0}});var l=await o("WAMediaWasmWorkerClient").transcodeToMp4InWorker({eventFlow:t,forceTranscode:a==="video/webm"||a==="video/x-matroska",input:new Uint8Array(n)});l.success?i=o("WAResultOrError").makeResult(l.value.buffer):i=o("WAResultOrError").makeError(l.error.error);var u=l.success?l.value.transcodeResponse:l.error.transcodeResponse;o("VideoTranscodeUtils").annotateTranscodeReponse({eventFlow:t,transcodeResponse:u})}else t.addAnnotations({bool:{passes_transcode_gk:!1}}),i=await o("WAMediaWasmWorkerClient").mp4RepairMuxInWorker({eventFlow:t,input:new Uint8Array(n)});if(!i.success)return i;var c=new File([i.value],e.name,{type:"video/mp4"});return o("WAResultOrError").makeResult(c)}function R(e){return f.DEBUG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["start process video through asm.js, file name: ",""])),e.name),L(e).then(function(t){if(!t)return o("WAResultOrError").makeError("invalid-media");var n=new File([t.file],e.name,{type:t.file.type});return o("WAResultOrError").makeResult(n)})}function L(e){return o("MAWSendVideoToWorker").sendVideoMessageToWorker({asGif:!1,file:e,type:"prep"}).then(function(e){var t=e.error,n=e.file,r=e.filename,o=e.result,a=e.type;switch(a){case"result":return o;case"parsingError":f.MUSTFIX(c||(c=babelHelpers.taggedTemplateLiteralLoose(["trouble parsing file "," (fossil ",") ",""])),n,r,String(t)),n&&f.MUSTFIX(d||(d=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair got parsing error! ",""])),String(t)),f.MUSTFIX(m||(m=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair rejected file (",")"])),String(t));return}}).catch(function(e){f.MUSTFIX(p||(p=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair got error! ",""])),String(e))})}function E(e){return o("cometIsMimeTypeForMedia").isMimeTypeForVideo(e)?!_.includes(e):!1}l.videoPreprocess=h,l.optimisticVideoToFileVideo=y,l.optimisticVideoPreprocessWithFile=C,l.DEPRECATED_optimisticVideoPreprocess=b,l.processVideoThroughWasm=S,l.processVideoThroughAsmJs=R,l.isSupportedVideoFileType=E}),98);
__d("MAWMediaPreprocess",["MAWAudioPreProcess","MAWDocumentPreProcess","MAWImagePreProcess","MAWSupportedDocumentTypes","MAWVideoPreProcess","Promise","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=o("WATagsLogger").TAGS(["MAWMediaPreprocess"]);function d(t,n,r){return c.DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["start mediaPreprocess, file name: ",""])),t.name),p(t,function(e){return o("MAWImagePreProcess").imagePreprocess(e,!1,n,r)},function(e){return o("MAWVideoPreProcess").videoPreprocess(e,n)},o("MAWAudioPreProcess").audioPreprocess,o("MAWDocumentPreProcess").documentPreprocess)}function m(e){return c.DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["start optimistic mediaPreprocess, file name: ",""])),e.name),p(e,o("MAWImagePreProcess").optimisticImagePreprocess,o("MAWVideoPreProcess").DEPRECATED_optimisticVideoPreprocess,o("MAWAudioPreProcess").optimisticAudioPreprocess,o("MAWDocumentPreProcess").optimisticDocumentPreprocess)}function p(e,t,r,a,i){return e.size===0?(u||(u=n("Promise"))).reject("Empty file"):o("MAWImagePreProcess").isSupportedImageFileType(e.type)?t(e):o("MAWVideoPreProcess").isSupportedVideoFileType(e.type)?r(e):o("MAWAudioPreProcess").isSupportedAudioFileType(e.type)?a(e):o("MAWSupportedDocumentTypes").isAllowedType(e.name)?i(e):(u||(u=n("Promise"))).reject("Unsupported file type")}function _(e,t){e:{if(t.type==="image"){var r;return o("MAWImagePreProcess").imagePreprocess(e,!1,t.totalNumberOfFilesForLogging,(r=t.hdEnabled)!=null?r:void 0)}if(t.type==="audio")return o("MAWAudioPreProcess").audioPreprocess(e);if(t.type==="document")return o("MAWDocumentPreProcess").documentPreprocess(e);if(t.type==="empty-file")return(u||(u=n("Promise"))).reject("Empty file");if(t.type==="invalid")return(u||(u=n("Promise"))).reject("Unsupported file type");throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+t.type)}}function f(e,t){e:{if(t==="image")return o("MAWImagePreProcess").optimisticImagePreprocess(e);if(t==="audio")return o("MAWAudioPreProcess").optimisticAudioPreprocess(e);if(t==="document")return o("MAWDocumentPreProcess").optimisticDocumentPreprocess(e);if(t==="empty-file")return(u||(u=n("Promise"))).reject("Empty file");if(t==="invalid")return(u||(u=n("Promise"))).reject("Unsupported file type");throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+t)}}function g(e){return e.size===0?"empty-file":o("MAWImagePreProcess").isSupportedImageFileType(e.type)?"image":o("MAWVideoPreProcess").isSupportedVideoFileType(e.type)?"video":o("MAWAudioPreProcess").isSupportedAudioFileType(e.type)?"audio":o("MAWSupportedDocumentTypes").isAllowedType(e.name)?"document":"invalid"}l.mediaPreprocess=d,l.optimisticMediaPreprocess=m,l.getMediaPreprocessPromise=_,l.getOptimisticMediaPreprocessPromise=f,l.getSupportedAttachmentType=g}),98);
__d("MWMediaManagerTypes",["MessagingAttachmentType"],(function(t,n,r,o,a,i,l){"use strict";function e(e){switch(e){case"animated_image":return r("MessagingAttachmentType").ANIMATED_IMAGE;case"image":return r("MessagingAttachmentType").IMAGE;case"video":return r("MessagingAttachmentType").VIDEO;case"audio":return r("MessagingAttachmentType").AUDIO;case"document":return r("MessagingAttachmentType").FILE;default:return null}}l.getMessagingAttachmentTypeFromMediaMetadataAttachmentType=e}),98);
__d("MAWMediaManagerUtils",["FBLogger","MAWBridgeFireAndForget","MAWMediaPreprocess","MAWMediaUtils","MAWMiActOnActThreadReady","MAWVideoPreProcess","MWMediaManagerTypes","gkx","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e=new Map;function s(t,n){var a=n===!0;return Promise.all(t.map(async function(i){var l,s,u,c,d=i[0],m=i[1],p,_;if(r("gkx")("11480")){var f=o("MAWMediaPreprocess").getSupportedAttachmentType(d);f==="video"?(_=await o("MAWVideoPreProcess").optimisticVideoPreprocessWithFile(d,t.length),p=o("MAWVideoPreProcess").optimisticVideoToFileVideo(_)):(p=f==="image"?o("MAWMediaPreprocess").getMediaPreprocessPromise(d,{hdEnabled:n,totalNumberOfFilesForLogging:t.length,type:f}):o("MAWMediaPreprocess").getMediaPreprocessPromise(d,{type:f}),_=await o("MAWMediaPreprocess").getOptimisticMediaPreprocessPromise(d,f))}else p=o("MAWMediaPreprocess").mediaPreprocess(d,t.length,n),_=await o("MAWMediaPreprocess").optimisticMediaPreprocess(d);e.set(m,{optimisticMedia:_,originalFile:d,processedMediaPromise:p});var g=o("MWMediaManagerTypes").getMessagingAttachmentTypeFromMediaMetadataAttachmentType(_.type),h={attachmentType:g!=null?g:void 0,file:d,isHd:a,offlineAttachmentId:m,previewHeight:(l=(s=_.imageSpec)==null?void 0:s.height)!=null?l:void 0,previewWidth:(u=(c=_.imageSpec)==null?void 0:c.width)!=null?u:void 0};return Promise.resolve(h)}))}function u(t,n,a){r("promiseDone")(o("MAWMiActOnActThreadReady").onActThreadReady(t.tables,n,"MAWMediaManagerUtils",async function(t,n){var i=a.reduce(function(t,n){var r,o=(r=e.get(n.offlineAttachmentId))==null?void 0:r.processedMediaPromise;return o!=null&&t.push(o),t},[]),l=await Promise.all(i);return l.forEach(function(e){var t;switch(e.type){case"image":return o("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:e.file,jid:n,thumbnail:o("MAWMediaUtils").convertJpegThumbnailArrayBufferToFile((t=e.thumbnailUrlAndSpec)==null?void 0:t.jpegThumbnail)});case"animated_image":return o("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:e.file,jid:n,thumbnail:null});case"video":return o("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:e.file,jid:n,thumbnail:o("MAWMediaUtils").convertJpegThumbnailArrayBufferToFile(e.thumbnailUrlAndSpec.jpegThumbnail)});case"audio":return o("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:e.file,jid:n,thumbnail:null});case"document":return o("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:e.file,jid:n,thumbnail:null});default:r("FBLogger")("messenger_web_media").mustfix("MAW Optimistic upload media: unknown media attachment file type: "+e.type)}}),Promise.resolve()}))}function c(e,t,n){r("promiseDone")(o("MAWMiActOnActThreadReady").onActThreadReady(e.tables,t,"MAWMediaManagerUtils",function(e,t){return n.forEach(function(e){return o("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:e,jid:t,thumbnail:null})}),Promise.resolve()}))}l.MAWMediaManagerAttachmentsV2=e,l.preprocessV2=s,l.upload=u,l.uploadForXMA=c}),98);
__d("MAWMessageIntegrityCheckFlytrapResultCache",["CometLruCache","I64","justknobx"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("justknobx")._("3629"),u=o("CometLruCache").create(s);function c(e,t){e!=null&&u.set(e,t)}function d(e){return u.get(e)}function m(t,n){if(n.length===0)return null;var r=n[0].offlineThreadingId,a=n[n.length-1].offlineThreadingId;return(e||(e=o("I64"))).to_string(t)+"_"+r+"_"+a}l.cacheMessageIntegrityCheckResult=c,l.getMessageIntegrityCheckResult=d,l.generateMessageIntegrityCheckPageKey=m}),98);
__d("MAWMessageIntegrityEBFetchStatus",[],(function(t,n,r,o,a,i){"use strict";var e=new Set;function l(t){return e.has(t)}function s(t){e.add(t)}i.hasEBFailure=l,i.recordEBFailure=s}),66);
__d("useIsLastNonAdminMessage",["ReQL","ReQLSuspense","react-compiler-runtime","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s=10;function u(t,n){var a=o("react-compiler-runtime").c(6),l=(e||(e=r("useReStore")))(),u;a[0]!==l.tables.messages||a[1]!==t?(u=function(){return o("ReQL").fromTableDescending(l.tables.messages.index("messageDisplayOrder"),["messageId","isAdminMessage"]).getKeyRange(t).take(s).filter(c)},a[0]=l.tables.messages,a[1]=t,a[2]=u):u=a[2];var d;a[3]!==l||a[4]!==t?(d=[l,t],a[3]=l,a[4]=t,a[5]=d):d=a[5];var m=o("ReQLSuspense").useFirst(u,d,i.id+":29");return(m==null?void 0:m.messageId)===n}function c(e){return e.isAdminMessage===!1}l.default=u}),98);
__d("MessageReactionOperation",[],(function(t,n,r,o,a,i){var e=Object.freeze({ADD:1,REMOVE:2,REMOVE_MULTI_REACT:3});i.default=e}),66);
__d("MessageReactionStyle",[],(function(t,n,r,o,a,i){var e=Object.freeze({NONE:0,BASIC_SUPER_REACT_ANIMATION:1,FB_EMOJI:2,FB_NON_DEFAULT_EMOJI:3});i.default=e}),66);
__d("useMWPSendOrUnsendReaction",["FBLogger","I64","Int64Hooks","LSFactory","LSIntEnum","LSOptimisticUpsertReactionStoredProcedure","LSOptimisticUpsertReactionV2StoredProcedure","MWPActor.react","MessageReactionOperation","MessageReactionStyle","ReQL","promiseDone","react-compiler-runtime","useIsMultiReactionEnabled","useIsReactionsV2Enabled","useMWLSDefaultThreadSourceAndResetAttribution","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(e,t,n,a,l,u){r("promiseDone")(e.runInTransaction(function(e){return r("LSOptimisticUpsertReactionV2StoredProcedure")(r("LSFactory")(e),{actorId:t,currentCount:l,messageId:n.messageId,messageTimestamp:n.timestampMs,operation:(s||(s=o("LSIntEnum"))).ofNumber(r("MessageReactionOperation").ADD),reactionFbid:a,reactionLiteral:u,reactionStyle:s.ofNumber(r("MessageReactionStyle").BASIC_SUPER_REACT_ANIMATION),threadId:n.threadKey,viewerIsReactor:!0})},"readwrite",void 0,void 0,i.id+":42"))}async function d(e,t,n,a,l,u,c){await e.runInTransaction(function(e){return r("LSOptimisticUpsertReactionV2StoredProcedure")(r("LSFactory")(e),{actorId:t,currentCount:a,messageId:n.messageId,messageTimestamp:n.timestampMs,operation:(s||(s=o("LSIntEnum"))).ofNumber(c?r("MessageReactionOperation").REMOVE_MULTI_REACT:r("MessageReactionOperation").REMOVE),reactionFbid:l,reactionLiteral:u,reactionStyle:s.ofNumber(r("MessageReactionStyle").BASIC_SUPER_REACT_ANIMATION),threadId:n.threadKey,viewerIsReactor:!1})},"readwrite",void 0,void 0,i.id+":72")}function m(e,t,n,a,i){r("promiseDone")(o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.tables.reactions_v2).getKeyRange(n.threadKey,n.messageId,a)).then(function(r){r!=null?c(e,t,n,a,r.count,i):c(e,t,n,a,(u||(u=o("I64"))).zero,i)}))}function p(t){var n=o("react-compiler-runtime").c(7),a=(e||(e=r("useReStore")))(),l=o("MWPActor.react").useActor(),s=r("useMWLSDefaultThreadSourceAndResetAttribution")(),c=o("useIsMultiReactionEnabled").useIsMultiReactEnabled(t.threadKey),p,_;return n[0]!==l||n[1]!==a||n[2]!==s||n[3]!==c||n[4]!==t?(p=function(n){r("promiseDone")((async function(){var e=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(a.tables.threads).getKeyRange(t.threadKey)),p=e?o("useIsReactionsV2Enabled").isReactionsV2Enabled(e):!1;if(p){var _=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(a.tables.reaction_v2_types).filter(function(e){return e.reactionLiteral===n||e.reactionLiteralVariant16===n}));if(_!=null){var f=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(a.tables.reactions_v2).getKeyRange(t.threadKey,t.messageId).filter(function(e){return(!c||(u||(u=o("I64"))).equal(e.reactionFbid,_.reactionFbid))&&e.viewerIsReactor}));if(f==null)return m(a,l,t,_.reactionFbid,n);var g=(u||(u=o("I64"))).equal(f.reactionFbid,_.reactionFbid);(!c||g)&&await d(a,l,t,f.count,f.reactionFbid,n,c),g||await m(a,l,t,_.reactionFbid,n)}else r("FBLogger")("messenger_web").warn("Reactions v2: trying to send reaction that is not in reaction_v2_types table");return}return a.runInTransaction(function(e){return r("LSOptimisticUpsertReactionStoredProcedure")(r("LSFactory")(e),{actorId:l,messageId:t.messageId,reaction:n,sendAttribution:s(t.threadKey),threadKey:t.threadKey,timestampMs:(u||(u=o("I64"))).of_float(Date.now())})},"readwrite",void 0,void 0,i.id+":227")})())},_=[a,t,c,l,s],n[0]=l,n[1]=a,n[2]=s,n[3]=c,n[4]=t,n[5]=p,n[6]=_):(p=n[5],_=n[6]),o("Int64Hooks").useCallbackInt64(p,_)}l.default=p}),98);
__d("MAWPSendOrRemoveReaction.react",["I64","Int64Hooks","LSMessagingThreadAttributionType","MAWExternalId","MAWODSProxy","MWLSThread","MWPActor.react","WAOdsEnums","cr:12043","cr:9778","promiseDone","requireDeferred","sendToSentQPLLogger","useIsLastNonAdminMessage","useIsSecureMessage","useLSMessagingSource","useMWPSendOrUnsendReaction","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("requireDeferred")("MWLogMessageAction").__setRef("MAWPSendOrRemoveReaction.react");function c(t,a,i){var l,c=(s||(s=r("useReStore")))(),d=o("MWPActor.react").useActor(),m=(l=n("cr:9778")==null?void 0:n("cr:9778").useSendOrRemoveReaction(t.threadKey,(e||(e=o("I64"))).to_string(t.senderId)))!=null?l:null,p=r("useIsSecureMessage")(c,t,{fallbackIsSecure:a}),_=r("useIsLastNonAdminMessage")(t.threadKey,t.messageId),f=r("useMWPSendOrUnsendReaction")(t),g=r("useLSMessagingSource")(),h=o("MWLSThread").useThread(t.threadKey);return o("Int64Hooks").useMemoInt64(function(){return(function(e,l,s){if(_&&n("cr:12043")!=null&&n("cr:12043").touchThreadMetadata(t.threadKey),p&&m!==null){var g=o("MAWExternalId").generateExternalId(),y=function(n){return m(e,l,n,g).then(function(e){return[e]})},C=o("sendToSentQPLLogger").markSendToSentStartWithAnnotation(h,{isReaction:!0},r("LSMessagingThreadAttributionType").UNKNOWN,void 0,void 0,g);r("promiseDone")(y(C)),o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.MAW_SEND_REACTION,key:"post-cutover_msg"})}else a&&o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.MAW_SEND_REACTION,key:"pre-cutover_msg"}),f(l!=null?l:"");u.onReady(function(e){return r("promiseDone")(e.log(c,t.messageId,t.threadKey,i,s,void 0,void 0,void 0,t.senderId,void 0,d))})})},[_,p,m,a,f,c,g,h,t.messageId,t.threadKey,t.senderId,i,d])}l.useSendOrRemoveReaction=c}),98);
__d("MDSScrollableArea.react",["CometScrollableArea.react","MDSScrollableAreaStyles","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["xstyle"],s,u=s||(s=o("react"));function c(t){var n=o("react-compiler-runtime").c(8),a,i;n[0]!==t?(i=t.xstyle,a=babelHelpers.objectWithoutPropertiesLoose(t,e),n[0]=t,n[1]=a,n[2]=i):(a=n[1],i=n[2]);var l;n[3]!==i?(l=[r("MDSScrollableAreaStyles").unthemed,i],n[3]=i,n[4]=l):l=n[4];var s;return n[5]!==a||n[6]!==l?(s=u.jsx(r("CometScrollableArea.react"),babelHelpers.extends({forceBrowserDefault:!0,xstyle:l},a)),n[5]=a,n[6]=l,n[7]=s):s=n[7],s}l.default=c}),98);
__d("MWChatPollFacepile.react",["fbt","CometImage.react","FDSDots3HorizontalFilled16Icon","FDSIcon.react","MWXPressable.react","MWXTooltip.react","MWXTooltipGroup.react","intlList","intlSummarizeNumber","react","react-compiler-runtime","stylex"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react")),d={large:{height:"x10w6t97",$$css:!0},medium:{height:"x1qx5ct2",$$css:!0},mediumLarge:{height:"xxk0z11",$$css:!0},small:{height:"x1v9usgg",$$css:!0}},m={contact:{borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",$$css:!0},contactGapNegative:{marginInlineStart:"x137kccz",$$css:!0},contactGapNormal:{marginInlineStart:"xdwrcjd",$$css:!0},contactLarge:{height:"x10w6t97",width:"x1td3qas",$$css:!0},contactMedium:{height:"x1qx5ct2",width:"xw4jnvo",$$css:!0},contactMediumLarge:{height:"xxk0z11",width:"xvy4d1p",$$css:!0},contactSmall:{height:"x1v9usgg",width:"x6jxa94",$$css:!0},contactWithBorder:{borderTopColor:"x1exxf4d",borderInlineEndColor:"xpv9jar",borderBottomColor:"x1nb4dca",borderInlineStartColor:"x1nmn18",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopWidth:"x178xt8z",borderInlineEndWidth:"x1lun4ml",borderBottomWidth:"xso031l",borderInlineStartWidth:"xpilrb4",marginTop:"x1y332i5",$$css:!0},contactWithGap:{borderTopColor:"x1bsybk2",borderInlineEndColor:"x38sb4y",borderBottomColor:"x2lbui5",borderInlineStartColor:"xgmch35",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopWidth:"xamhcws",borderInlineEndWidth:"x1alpsbp",borderBottomWidth:"xlxy82",borderInlineStartWidth:"xyumdvf",marginTop:"x1198e8h",$$css:!0},overflow:{backgroundColor:"x1vtvx1t",borderStartStartRadius:"x16qb05n",borderStartEndRadius:"xi7iut8",borderEndEndRadius:"x1dm3dyd",borderEndStartRadius:"x1pv694p",boxSizing:"x9f619",color:"xi81zsa",fontSize:"x1nxh6w3",fontWeight:"xk50ysn",lineHeight:"x1u7k74",marginBottom:"x4ii5y1",marginInlineStart:"x137kccz",marginTop:"xr1yuqi",paddingTop:"x1nn3v0j",paddingInlineEnd:"xf159sx",paddingBottom:"x1120s5i",paddingInlineStart:"xmzvs34",$$css:!0},overflowForPrompt:{alignItems:"x6s0dn4",backgroundColor:"x1qhmfi1",borderStartStartRadius:"x1iwo8zk",borderStartEndRadius:"x1033uif",borderEndEndRadius:"x179ill4",borderEndStartRadius:"x1b60jn0",color:"xzsf02u",display:"x78zum5",justifyContent:"xl56j7k",$$css:!0},photoWrap:{display:"x1rg5ohu",marginBottom:"x4ii5y1",marginTop:"xr1yuqi",position:"x1n2onr6",$$css:!0},root:{display:"x78zum5",$$css:!0},rootReversed:{flexDirection:"x15zctf7",$$css:!0}};function p(e){switch(e){case"small":return m.contactSmall;case"medium":return m.contactMedium;case"mediumLarge":return m.contactMediumLarge;case"large":return m.contactLarge;default:}}function _(e){var t=o("react-compiler-runtime").c(3),n=e.children,a=e.tooltip,i;return t[0]!==n||t[1]!==a?(i=a!=null?c.jsx(r("MWXTooltip.react"),{align:"middle",label:s._(/*BTDS*/"More"),position:"above",tooltip:a,children:n}):n,t[0]=n,t[1]=a,t[2]=i):i=t[2],i}function f(t){var n=o("react-compiler-runtime").c(42),a=t.contacts,i=t.contactWithBorder,l=t.countOverride,u=t.direction,f=t.gap,b=t.isPrompt,v=t.limit,S=t.onPress,R=t.overflowStyle,L=t.size,E=i===void 0?!0:i,k=u===void 0?"normal":u,I=f===void 0?"normal":f,T=b===void 0?!1:b,D=v===void 0?2:v,x=R===void 0?"showTotalCount":R,$=l!=null?l:a.length,P=$>D,N;if(n[0]!==a||n[1]!==D||n[2]!==$){var M=a.slice(0,-D).reverse().filter(C).map(y),w=$-D-M.length;w>0&&M.push(s._(/*BTDS*/"_j{\"*\":\"and {count} others\",\"_1\":\"and {count} other\"}",[s._plural(w),s._param("count",r("intlSummarizeNumber")(w))])),N=M.length===0?void 0:c.jsx("ul",{children:M.map(h)}),n[0]=a,n[1]=D,n[2]=$,n[3]=N}else N=n[3];var A=N,F;if(n[4]!==a||n[5]!==D||n[6]!==P||n[7]!==$){var O=a.slice(-(P?D:1e3)).reverse(),B=O.map(g);F=a.length>0?s._(/*BTDS*/"_j{\"*\":{\"*\":\"{number} votes including those from {=names}\"},\"_1\":{\"_1\":\"1 vote from {=names}\"}}",[s._plural($,"number"),s._plural($),s._param("=names",r("intlList")(B))]):s._(/*BTDS*/"0 votes"),n[4]=a,n[5]=D,n[6]=P,n[7]=$,n[8]=F}else F=n[8];var W=F,q;n[9]!==T||n[10]!==D||n[11]!==A||n[12]!==x||n[13]!==P||n[14]!==L||n[15]!==$?(q=P&&x==="showTotalCount"&&c.jsx(_,{tooltip:A,children:c.jsx("div",babelHelpers.extends({},(e||(e=r("stylex"))).props(m.overflow,T&&m.overflowForPrompt,T&&d[L]),{children:"+"+r("intlSummarizeNumber")($-D)}))}),n[9]=T,n[10]=D,n[11]=A,n[12]=x,n[13]=P,n[14]=L,n[15]=$,n[16]=q):q=n[16];var U;if(n[17]!==E||n[18]!==a||n[19]!==I||n[20]!==T||n[21]!==D||n[22]!==x||n[23]!==P||n[24]!==L){var V;n[26]!==E||n[27]!==I||n[28]!==T||n[29]!==D||n[30]!==x||n[31]!==P||n[32]!==L?(V=function(n,o){return c.createElement("div",babelHelpers.extends({},(e||(e=r("stylex"))).props(m.photoWrap,I==="normal"?m.contactGapNormal:m.contactGapNegative,p(L)),{key:String(o)}),c.jsx(_,{tooltip:n.name,children:c.jsx(r("CometImage.react"),{src:n.profile_picture_url,xstyle:[m.contact,p(L),E&&!T?m.contactWithBorder:!1,T?m.contactWithGap:!1]})}),P&&x==="overlayLastPhoto"&&o===D-1?c.jsx("div",{className:"x6s0dn4 xdit8p8 x1c9tyrk xeusxvb x1pahc9y x1ertn4p x1ey2m1c x78zum5 xtijo5x x1o0tod xl56j7k x1us6l5c x6ikm8r x10wlt62 x10l6tqk x13vifvy x1vjfegm",children:c.jsx(r("FDSIcon.react"),{color:"white",icon:r("FDSDots3HorizontalFilled16Icon"),size:16})}):null)},n[26]=E,n[27]=I,n[28]=T,n[29]=D,n[30]=x,n[31]=P,n[32]=L,n[33]=V):V=n[33],U=a.slice(-(P?D:1e3)).reverse().map(V),n[17]=E,n[18]=a,n[19]=I,n[20]=T,n[21]=D,n[22]=x,n[23]=P,n[24]=L,n[25]=U}else U=n[25];var H;n[34]!==U||n[35]!==q?(H=c.jsxs(r("MWXTooltipGroup.react"),{children:[q,U]}),n[34]=U,n[35]=q,n[36]=H):H=n[36];var G=H,z;return n[37]!==k||n[38]!==G||n[39]!==W||n[40]!==S?(z=S!=null?c.jsx(r("MWXPressable.react"),{label:W,onPress:S,overlayDisabled:!0,xstyle:[m.root,k==="reversed"?m.rootReversed:!1],children:G}):c.jsx("div",babelHelpers.extends({"aria-label":W},(e||(e=r("stylex"))).props(m.root,k==="reversed"?m.rootReversed:!1),{children:G})),n[37]=k,n[38]=G,n[39]=W,n[40]=S,n[41]=z):z=n[41],z}function g(e){var t;return(t=e.name)!=null?t:""}function h(e,t){return c.jsx("li",{children:e},String(t))}h.displayName=h.name+" [from "+i.id+"]";function y(e){var t=e.name;return t!=null?t:""}function C(e){return e.name!=null}l.default=f}),226);
__d("MWChatPromptFlyoutFrontCard.react",["fbt","BaseTextArea.react","CometPlaceholder.react","MWChatPollFacepile.react","MWPActor.react","ReQL","ReQLSuspense","react","react-compiler-runtime","useReStore","vulture"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react")),d=150,m=200,p=16,_={textarea:{background:"x11g6tue",borderTopStyle:"x1ejq31n",borderInlineEndStyle:"x18oe1m7",borderBottomStyle:"x1sy0etr",borderInlineStartStyle:"xstzfhl",color:"xzsf02u",fontSize:"x6prxxf",fontWeight:"x1xlr1w8",height:"x1m3v4wt",paddingTop:"xyamay9",paddingBottom:"x1l90r2v",paddingInlineStart:"xmzvs34",paddingInlineEnd:"xf159sx",paddingLeft:null,paddingRight:null,textAlign:"x2b8uid",width:"xrostsh",$$css:!0}};function f(){var t=o("react-compiler-runtime").c(10);r("vulture")("--I5l4MGyBjEFx_7p5moc1YSO7o=");var n=(e||(e=r("useReStore")))(),a=o("MWPActor.react").useActor(),l;t[0]!==n.tables.contacts||t[1]!==a?(l=function(){return o("ReQL").fromTableAscending(n.tables.contacts).getKeyRange(a).map(g)},t[0]=n.tables.contacts,t[1]=a,t[2]=l):l=t[2];var s;t[3]!==n||t[4]!==a?(s=[n,a],t[3]=n,t[4]=a,t[5]=s):s=t[5];var u=o("ReQLSuspense").useFirst(l,s,i.id+":72"),d;t[6]!==u?(d=u!=null?[{profile_picture_url:u}]:[],t[6]=u,t[7]=d):d=t[7];var m=d,p;return t[8]!==m?(p=c.jsx(r("MWChatPollFacepile.react"),{contacts:m,direction:"reversed",gap:"negative",size:"mediumLarge"}),t[8]=m,t[9]=p):p=t[9],p}function g(e){return e.profilePictureUrl}function h(e){var t=o("react-compiler-runtime").c(12),n=e.maxLength,a=e.onChange,i=e.showFacepile,l=e.value,u=i===void 0?!1:i,d;t[0]===Symbol.for("react.memo_cache_sentinel")?(d={className:"x9bbmet xbjudin xnlwouz xpp8er5 xs9wviy xi1c1fh xdt5ytf x1iyjqo2 x2lah0s x1m3v4wt x1gslohp x12nagc x1n2onr6 xrostsh x1vjfegm"},t[0]=d):d=t[0];var m;t[1]===Symbol.for("react.memo_cache_sentinel")?(m=s._(/*BTDS*/"Prompt"),t[1]=m):m=t[1];var p;t[2]===Symbol.for("react.memo_cache_sentinel")?(p=s._(/*BTDS*/"Type something"),t[2]=p):p=t[2];var g;t[3]!==n||t[4]!==a||t[5]!==l?(g=c.jsx(r("BaseTextArea.react"),{"aria-label":m,maxLength:n,onChange:a,placeholder:p,suppressFocusRing:!0,unresizable:!0,value:l,xstyle:_.textarea}),t[3]=n,t[4]=a,t[5]=l,t[6]=g):g=t[6];var h;t[7]!==u?(h=u?c.jsx(r("CometPlaceholder.react"),{fallback:null,name:"MWChatPromptFlyoutFrontCard",children:c.jsx("div",{className:"xvc5jky x11t971q x1l90r2v",children:c.jsx(f,{})})}):null,t[7]=u,t[8]=h):h=t[8];var y;return t[9]!==g||t[10]!==h?(y=c.jsxs("div",babelHelpers.extends({},d,{children:[g,h]})),t[9]=g,t[10]=h,t[11]=y):y=t[11],y}l.default=h}),226);
__d("MWChatReactionsActionContainer.react",["JSResourceForInteraction","MWV2MessageRowIsRowFocusedContext.react","MWXLazyPopoverTrigger.react","MWXPopoverLoadingState.react","emptyFunction","qex","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.useCallback,d=u.useContext,m=u.useState,p={popoverLoading:{minHeight:"x1wiwyrm",minWidth:"x1q6reyq",$$css:!0}};function _(e){var t=o("react-compiler-runtime").c(28),n=e.align,a=e.alwaysShowEmojiPicker,i=e.children,l=e.closeActionsMenu,u=e.disableCustomReactions,c=e.disableReflowToPositionOnNarrowWidth,_=e.hasReactionsV2,f=e.isBroadcastChannel,g=e.isBroadcastThread,h=e.isSecure,y=e.messageID,C=e.onVisibilityChange,b=e.reactionsPopoverResource,v=e.sendReaction,S=n===void 0?"middle":n,R=a===void 0?!1:a,L=u===void 0?!1:u,E=c===void 0?!1:c,k=h===void 0?!1:h,I=d(o("MWV2MessageRowIsRowFocusedContext.react").context),T;t[0]!==b?(T=b!=null?b:r("JSResourceForInteraction")("MWChatReactionsMenu.react").__setRef("MWChatReactionsActionContainer.react"),t[0]=b,t[1]=T):T=t[1];var D=T,x=m(!1),$=x[0],P=x[1],N=R||$,M;t[2]!==l||t[3]!==_||t[4]!==v?(M=function(t,n){var e=n[0],r=_!==!0&&e===t;return v(t,r),l()},t[2]=l,t[3]=_,t[4]=v,t[5]=M):M=t[5];var w=M,A;t[6]!==I||t[7]!==C?(A=function(t){t||P(!1),C(t),I.setFocused(t)},t[6]=I,t[7]=C,t[8]=A):A=t[8];var F=A,O=r("qex")._("2997")?"button_aggressive":"button",B=S==="end_"?"end":S,W;t[9]===Symbol.for("react.memo_cache_sentinel")?(W=s.jsx(r("MWXPopoverLoadingState.react"),{withArrow:!1,xstyle:p.popoverLoading}),t[9]=W):W=t[9];var q;t[10]!==l||t[11]!==L||t[12]!==f||t[13]!==g||t[14]!==k||t[15]!==y||t[16]!==w||t[17]!==N?(q={closeActionsMenu:l,disableCustomReactions:L,isBroadcastChannel:f,isBroadcastThread:g,isSecure:k,messageID:y,onClose:r("emptyFunction"),onSelect:w,setShowEmojiPicker:P,showEmojiPicker:N},t[10]=l,t[11]=L,t[12]=f,t[13]=g,t[14]=k,t[15]=y,t[16]=w,t[17]=N,t[18]=q):q=t[18];var U=N?"dialog":"menu",V=N?"below":"above",H;return t[19]!==i||t[20]!==E||t[21]!==F||t[22]!==D||t[23]!==q||t[24]!==U||t[25]!==V||t[26]!==B?(H=s.jsx(r("MWXLazyPopoverTrigger.react"),{align:B,disableReflowToPositionOnNarrowWidth:E,fallback:W,onVisibilityChange:F,popoverProps:q,popoverResource:D,popoverType:U,position:V,preloadTrigger:O,children:i}),t[19]=i,t[20]=E,t[21]=F,t[22]=D,t[23]=q,t[24]=U,t[25]=V,t[26]=B,t[27]=H):H=t[27],H}l.default=_}),98);
__d("MWFalcoFeatureEventLogger",["I64","LSMessagingThreadTypeUtil","MessengerWebEventsFalcoEvent","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n,a,i,l){r("gkx")("24170")&&r("MessengerWebEventsFalcoEvent").log(function(){return{entry_point:t,event_name:n,is_secured:o("LSMessagingThreadTypeUtil").isArmadilloSecure(l),other_user_fbid:a!=null?(e||(e=o("I64"))).to_string(a):null,thread_fbid:(e||(e=o("I64"))).to_string(i)}})}l.logEvent=s}),98);
__d("MWPConversationSearchContext.react",["$InternalEnum","gkx","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.createContext,d=u.useCallback,m=u.useMemo,p=u.useState,_=n("$InternalEnum")({NAVIGATING:1,NAVIGATED:2}),f=c(),g=f;function h(e){var t=o("react-compiler-runtime").c(9),n=e.children,a=p(),i=a[0],l=a[1],u=p(),c=u[0],d=u[1],m=p(!1),_=m[0],g=m[1],h=p(!1),y=h[0],C=h[1],b;t[0]===Symbol.for("react.memo_cache_sentinel")?(b=function(t){C(t),r("gkx")("4741")&&g(t)},t[0]=b):b=t[0];var v=b,S,R;t[1]!==y||t[2]!==c||t[3]!==i||t[4]!==_?(R={isConversationSearchVisible:y,navigation:c,search:i,setIsConversationSearchVisible:v,setNavigation:d,setSearch:l,setShouldNavigateSidePanelToSearch:g,shouldNavigateSidePanelToSearch:_},t[1]=y,t[2]=c,t[3]=i,t[4]=_,t[5]=R):R=t[5],S=R;var L=S,E;return t[6]!==n||t[7]!==L?(E=s.jsx(f.Provider,{value:L,children:n}),t[6]=n,t[7]=L,t[8]=E):E=t[8],E}l.SearchNavigationState=_,l.context=g,l.MWPConversationSearchContext=h}),98);
__d("useMWPClearConversationSearch",["LSClearMessageSearchTableStoredProcedure","LSFactory","LSIntEnum","LSMessageSearchType","MWPConversationSearchContext.react","MWPVisibleMessageContext.react","nullthrows","promiseDone","react","react-compiler-runtime","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=u||(u=o("react")),d=c.useCallback,m=c.useContext;function p(){var t=o("react-compiler-runtime").c(7),n=m(o("MWPConversationSearchContext.react").context),a;t[0]!==n?(a=r("nullthrows")(n),t[0]=n,t[1]=a):a=t[1];var l=a,u=l.setNavigation,c=l.setSearch,d=o("MWPVisibleMessageContext.react").useMWPVisibleMessageContext(),p=d.setVisibleMessage,f=(e||(e=r("useReStore")))(),g;return t[2]!==f||t[3]!==u||t[4]!==c||t[5]!==p?(g=function(t){var e,n,a=(e=t==null?void 0:t.shouldResetNavigation)!=null?e:!0,l=(n=t==null?void 0:t.shouldClearThreadSearch)!=null?n:!0;c(),a&&u(),p(_),r("promiseDone")(f.runInTransaction(async function(e){var t=r("LSFactory")(e);await r("LSClearMessageSearchTableStoredProcedure")(t,{type_:(s||(s=o("LSIntEnum"))).ofNumber(r("LSMessageSearchType").MESSAGE)}),l&&await r("LSClearMessageSearchTableStoredProcedure")(t,{type_:(s||(s=o("LSIntEnum"))).ofNumber(r("LSMessageSearchType").THREAD)})},"readwrite",void 0,void 0,i.id+":53"))},t[2]=f,t[3]=u,t[4]=c,t[5]=p,t[6]=g):g=t[6],g}function _(e){return(e==null?void 0:e.source)==="Search"?null:e}l.default=p}),98);
__d("useMWPCloseConversationSearchSession",["MWPConversationSearchContext.react","MWPConversationSearchLogger","nullthrows","react","react-compiler-runtime","useMWPClearConversationSearch"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useCallback,c=s.useContext;function d(){var e=o("react-compiler-runtime").c(5),t=r("useMWPClearConversationSearch")(),n=c(o("MWPConversationSearchContext.react").context),a;e[0]!==n?(a=r("nullthrows")(n),e[0]=n,e[1]=a):a=e[1];var i=a,l=i.setIsConversationSearchVisible,s;return e[2]!==t||e[3]!==l?(s=function(n){l(!1),t(n),r("MWPConversationSearchLogger").logMessageSearchEnd()},e[2]=t,e[3]=l,e[4]=s):s=e[4],s}l.default=d}),98);
__d("MWInboxInfoPanelContext.react",["Int64Hooks","MWInboxPersistedUIState","MWResponsiveLayoutConstants","MWResponsiveLayoutContext.react","cr:124","emptyFunction","gkx","isMessengerPWA","react","useEmptyFunction","useMWPCloseConversationSearchSession"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c=s,d=c.createContext,m=c.useCallback,p=c.useContext,_=c.useRef,f=c.useState,g=(e=n("cr:124"))!=null?e:r("useEmptyFunction"),h=d({currentSubthreadView:null,isOnBestPracticesPageRef:{current:!1},isOnMemberRequestsPageRef:{current:!1},navToBestPracticesRef:{current:!1},openMethod:"saved_state",pushBestPracticesPage:r("emptyFunction"),pushMemberRequestsPage:r("emptyFunction"),setCurrentSubthreadView:r("emptyFunction"),setPushBestPracticesPage:r("emptyFunction"),setPushMemberRequestsPage:r("emptyFunction"),setShouldNavToMemberRequests:r("emptyFunction"),setShowSubthreadList:r("emptyFunction"),setSubthreadKey:r("emptyFunction"),setThreadInfoVisible:r("emptyFunction"),shouldNavToMemberRequests:!1,sourceIsSubthreadNav:{current:!1},subthreadKey:null,threadInfoVisible:!r("isMessengerPWA")()});function y(){return p(h)}function C(e){var t=e.children,n=o("MWInboxPersistedUIState").usePersistedUIState(!r("isMessengerPWA")(),"__MWInboxDetail.info__"),a=n[0],i=n[1],l=f("saved_state"),s=l[0],c=l[1],d=_(!1),y=f(null),C=y[0],b=y[1],v=_(!1),S=d.current,R=_(r("emptyFunction")),L=R.current,E=_(!1),k=_(!1),I=_(!1),T=f(null),D=T[0],x=T[1],$=r("useMWPCloseConversationSearchSession")(),P=m(function(){i(!1),b(null),x(null)},[i]);g(o("MWResponsiveLayoutConstants").MWLayoutPanel.INFO_PANEL,P);var N=p(r("MWResponsiveLayoutContext.react")),M=N.popCard,w=N.pushCard,A=m(function(e){if(r("gkx")("24056")){var t=e?w:M;t(o("MWResponsiveLayoutConstants").MWLayoutPanel.INFO_PANEL)}},[w,M]),F=m(function(e){e?(c("callback"),x(null),b(null)):$({shouldClearThreadSearch:!1,shouldResetNavigation:!1}),i(e),A(e)},[i,$,A]),O=m(function(e){i(!1),b(e),A(e)},[i,A]),B=m(function(e){d.current=e},[]),W=m(function(e,t){t===void 0&&(t=!1),e&&(i(!1),$({shouldClearThreadSearch:!1,shouldResetNavigation:!1}),b(null)),x(e?"subthreadList":null),I.current=e&&t,A(e)},[i,A,$]),q=m(function(e){R.current=e},[]),U=m(function(e){R.current=e},[]),V=o("Int64Hooks").useMemoInt64(function(){return{currentSubthreadView:D,isOnBestPracticesPageRef:k,isOnMemberRequestsPageRef:E,navToBestPracticesRef:v,openMethod:s,pushBestPracticesPage:L,pushMemberRequestsPage:L,setCurrentSubthreadView:x,setPushBestPracticesPage:U,setPushMemberRequestsPage:q,setShouldNavToMemberRequests:B,setShowSubthreadList:W,setSubthreadKey:O,setThreadInfoVisible:F,shouldNavToMemberRequests:S,sourceIsSubthreadNav:I,subthreadKey:C,threadInfoVisible:a}},[D,k,s,L,U,q,B,W,O,F,S,C,a,v]);return u.jsx(h.Provider,{value:V,children:t})}C.displayName=C.name+" [from "+i.id+"]",l.useMWInboxInfoPanelContext=y,l.MWInboxInfoPanelProvider=C}),98);
__d("MWMessageListDisplayContext.react",["react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.useContext,d=u.useMemo,m=s.createContext("standard");function p(e){var t=o("react-compiler-runtime").c(3),n=e.children,r=e.value,a=r===void 0?"standard":r,i;return t[0]!==n||t[1]!==a?(i=s.jsx(m.Provider,{value:a,children:n}),t[0]=n,t[1]=a,t[2]=i):i=t[2],i}function _(){var e=o("react-compiler-runtime").c(4),t=c(m),n,r=t==="pinnedMessages",a=t==="reportMessages",i=t==="standard",l;return e[0]!==r||e[1]!==a||e[2]!==i?(l={isPinnedMessageList:r,isReportMessageList:a,isStandardMessageList:i},e[0]=r,e[1]=a,e[2]=i,e[3]=l):l=e[3],n=l,n}l.MWMessageListDisplayContextProvider=p,l.useMWMessageListDisplayContext=_}),98);
__d("MWMessageListLoggingContext",["react","react-compiler-runtime","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.createContext,d=u.useContext,m=u.useRef,p=c({current:""});function _(e){var t=o("react-compiler-runtime").c(2),n=e.children,r=e.flowInstanceId,a=m(r),i;return t[0]!==n?(i=s.jsx(p.Provider,{value:a,children:n}),t[0]=n,t[1]=i):i=t[1],i}function f(){return d(p)}function g(){var e=d(p);return(e.current===null||e.current==="")&&(e.current=r("uuidv4")()),e}l.MWMessageListLoggingContext=_,l.useFlowInstanceIdContext=f,l.useFlowInstanceId=g}),98);
__d("useAttachmentDataLS",["I64","ReQL","ReQLSuspense","react-compiler-runtime","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(e){var t,n=o("react-compiler-runtime").c(9),a=(s||(s=r("useReStore")))(),l;n[0]!==a||n[1]!==e.messageId||n[2]!==e.threadKey?(l=function(){return o("ReQL").fromTableAscending(a.tables.attachments).getKeyRange(e.threadKey,e.messageId).map(function(e){var t=m(a,e);return{attachment:e,attachmentCTAs:t}})},n[0]=a,n[1]=e.messageId,n[2]=e.threadKey,n[3]=l):l=n[3];var u;n[4]!==a||n[5]!==e?(u=[e,a],n[4]=a,n[5]=e,n[6]=u):u=n[6];var p=o("ReQLSuspense").useArray(l,u,i.id+":41").toSorted(d),_=(t=p[0])==null?void 0:t.attachment,f=o("ReQLSuspense").useArray(function(){return _==null?o("ReQL").empty():o("ReQL").fromTableAscending(a.tables.attachment_items).getKeyRange(_.attachmentFbid).map(function(e){var t=m(a,e);return{attachmentItem:e,attachmentItemCTAs:t}})},[_,a],i.id+":60").reduce(c,[[],[]]),g=f[0],h=f[1],y=[];p.map(function(e){y.push(e.attachment)});var C;if(g.length>0)C=h;else{var b,v=(b=p[0])==null?void 0:b.attachmentCTAs,S;n[7]!==v?(S=v?[v]:[],n[7]=v,n[8]=S):S=n[8],C=S}return{attachmentCTAs:C,attachmentItems:g,attachments:y}}function c(e,t){var n=t.attachmentItem,r=t.attachmentItemCTAs;return e[0].push(n),e[1].push(r),e}function d(t,n){return(e||(e=o("I64"))).compare(t.attachment.attachmentIndex,n.attachment.attachmentIndex)}function m(e,t){var n={},r=t.attachmentCta1Id,a=t.attachmentCta2Id,l=t.attachmentCta3Id,s=t.defaultCtaId;return n.defaultCta=s!=null?o("ReQLSuspense").first(o("ReQL").fromTableAscending(e.tables.attachment_ctas).getKeyRange(s),i.id+":113"):void 0,n.attachmentCta1=r!=null?o("ReQLSuspense").first(o("ReQL").fromTableAscending(e.tables.attachment_ctas).getKeyRange(r),i.id+":121"):void 0,n.attachmentCta2=a!=null?o("ReQLSuspense").first(o("ReQL").fromTableAscending(e.tables.attachment_ctas).getKeyRange(a),i.id+":129"):void 0,n.attachmentCta3=l!=null?o("ReQLSuspense").first(o("ReQL").fromTableAscending(e.tables.attachment_ctas).getKeyRange(l),i.id+":137"):void 0,n}l.useAttachmentDataLS=u}),98);
__d("fetchOpenMissingMessage",["FBLogger","I64","LSFactory","LSMessagePointQueryStoredProcedure"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t,n,a){var l,s=(e||(e=o("I64"))).to_int32((l=n.syncGroup)!=null?l:(e||(e=o("I64"))).neg_one);if(s!==-1&&s===95){r("FBLogger")("messenger_web").mustfix("fetchMissingMessage: incorrect call to MPQ with secure mailbox");return}await t.runInTransaction(function(e){return r("LSMessagePointQueryStoredProcedure")(r("LSFactory")(e),{messageId:a,threadKey:n.threadKey,threadType:n.threadType})},"readwrite",void 0,void 0,i.id+":38")}l.default=s}),98);
__d("fetchSecureMissingMessage",["MAWBridgeSendAndReceive","MAWMiActOnActThreadReady","MAWMpsGating","MAWPutMessagesToDB","MpsMessageToLoadResponse","MpsOverBridge","MpsTypes","WAStanzaUtils"],(function(t,n,r,o,a,i,l){"use strict";async function e(e,t,n,r,a){var i=await o("MAWMiActOnActThreadReady").waitForACTThreadReady(e.tables,t,a),l=i.chatJid;if(o("MAWMpsGating").isMpsMessageRendering()){var u=await o("MpsOverBridge").mps().loadMessage({config:{strategy:"local-first"},debug:{purpose:"fetchSecureMissingMessageFullMps"},messageId:o("MpsTypes").toMessageId(n),threadId:o("MpsTypes").toThreadId(l)});if(u.value!=null){var c=babelHelpers.extends({},o("MpsMessageToLoadResponse").messageToLoadMsgsResponse([u.value]),{hasMoreAfter:!1,hasMoreBefore:!1});await o("MAWPutMessagesToDB").insertMessageResponseIntoDatabase(e,c)}return}var d=await s({config:{admin:!0,editMsgHistory:!1,media:!0,polls:!0,reactions:!1,receiverFetch:!0,xma:!0},externalId:n});await o("MAWPutMessagesToDB").insertMessageResponseIntoDatabaseByExternalId(e,d),!(d.msgs.length>0||!r)&&await o("MpsOverBridge").mps().copMps.loadMsgIntoMaw({config:{shouldFetchSupplementals:!0,shouldFetchTags:!1,strategy:"full-fetch"},debug:{purpose:"fetchSecureMissingMessageM3"},messageId:o("MpsTypes").toMessageId(n),threadId:o("MpsTypes").toThreadId(l)})}async function s(e){var t=e.config,n=e.externalId;return babelHelpers.extends({},await o("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMsgsByExternalId",{config:t,externalId:o("WAStanzaUtils").toStanzaId(n)}))}l.default=e}),98);
__d("useGetOriginalMsgFromBumpMsg",["FBLogger","LSMessagingThreadTypeUtil","MAWFetchExternalIdUsingCache","MWEBEntrypointsKillswitch.enum","ReQL","ReQLSuspense","fetchOpenMissingMessage","fetchSecureMissingMessage","isMWBumpMessage","promiseDone","react-compiler-runtime","useMWEBBackupState","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n,a){var l=o("react-compiler-runtime").c(14),s;l[0]!==t?(s=r("isMWBumpMessage")(t),l[0]=t,l[1]=s):s=l[1];var u=s,c=(e||(e=r("useReStore")))(),d;l[2]===Symbol.for("react.memo_cache_sentinel")?(d={entrypoint:r("MWEBEntrypointsKillswitch.enum").BUMP_MESSAGES},l[2]=d):d=l[2];var m=r("useMWEBBackupState")(d),p;l[3]!==c.tables.threads||l[4]!==a?(p=function(){return a!=null?o("ReQL").fromTableAscending(c.tables.threads,["threadKey","threadType","syncGroup"]).getKeyRange(a):o("ReQL").empty()},l[3]=c.tables.threads,l[4]=a,l[5]=p):p=l[5];var _;l[6]!==c||l[7]!==a?(_=[c,a],l[6]=c,l[7]=a,l[8]=_):_=l[8];var f=o("ReQLSuspense").useFirst(p,_,i.id+":40"),g,h;l[9]!==c.tables.messages||l[10]!==u||l[11]!==n?(g=function(){return n!=null&&u?o("ReQL").fromTableDescending(c.tables.messages.index("messageId")).getKeyRange(n):o("ReQL").empty()},h=[c.tables.messages,n,u],l[9]=c.tables.messages,l[10]=u,l[11]=n,l[12]=g,l[13]=h):(g=l[12],h=l[13]);var y=o("ReQLSuspense").useFirst(g,h,i.id+":52");if(y==null&&f!=null&&n!=null&&u)if(o("LSMessagingThreadTypeUtil").isArmadilloSecure(f.threadType)){var C=m===3;r("promiseDone")(o("MAWFetchExternalIdUsingCache").fetchExternalIdUsingCache(n).then(function(e){e!=null?r("promiseDone")(r("fetchSecureMissingMessage")(c,f.threadKey,e,C,"MAWFetchBumpMessage")):r("FBLogger")("mw_bump_message").warn("[useGetOriginalMsgFromBumpMsg] failed fetch external id, invalid msgId %s",n)}))}else r("promiseDone")(r("fetchOpenMissingMessage")(c,f,n));return y}l.default=s}),98);
__d("useAttachmentData",["react-compiler-runtime","useAttachmentDataLS","useGetOriginalMsgFromBumpMsg"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n=o("react-compiler-runtime").c(4),a=r("useGetOriginalMsgFromBumpMsg")(e.replyType,e.replySourceId,e.threadKey),i=a!=null?a:e,l=o("useAttachmentDataLS").useAttachmentDataLS(i),s=l.attachmentCTAs,u=l.attachmentItems,c=l.attachments,d;return n[0]!==s||n[1]!==u||n[2]!==c?(d={attachmentCTAs:s,attachmentItems:u,attachments:c},n[0]=s,n[1]=u,n[2]=c,n[3]=d):d=n[3],d}l.useAttachmentData=e}),98);
__d("MWPAttachmentDataContext",["FBLogger","I64","ReQL","ReQLSuspense","react","react-compiler-runtime","useAttachmentData","useAttachmentDataLS","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=u||(u=o("react")),d=u,m=d.createContext,p=d.useContext,_=m({attachmentCTAs:[],attachmentItems:[],attachments:[]});function f(e){var t=o("react-compiler-runtime").c(3),n=e.children,r=e.isSecureMessage,a=e.message,i=o("useAttachmentData").useAttachmentData(a,r),l;return t[0]!==i||t[1]!==n?(l=c.jsx(_.Provider,{value:i,children:n}),t[0]=i,t[1]=n,t[2]=l):l=t[2],l}function g(e){var t=o("react-compiler-runtime").c(3),n=e.attachmentData,r=e.children,a;return t[0]!==n||t[1]!==r?(a=c.jsx(_.Provider,{value:n,children:r}),t[0]=n,t[1]=r,t[2]=a):a=t[2],a}function h(e){var t=o("react-compiler-runtime").c(3),n=e.children,r=e.message,a=o("useAttachmentDataLS").useAttachmentDataLS(r),i;return t[0]!==a||t[1]!==n?(i=c.jsx(_.Provider,{value:a,children:n}),t[0]=a,t[1]=n,t[2]=i):i=t[2],i}function y(e){var t=p(_).attachments,n=C(e);return t.length===0&&n.length>0?(r("FBLogger")("messenger_web_media","attachment_context_missing").info("MWPAttachmentContext is not set, failed to retrieve attachments from context, instead retrieved attachments directly from LSDB"),n):t}function C(t){var n=o("react-compiler-runtime").c(10),a=(e||(e=r("useReStore")))(),l;n[0]!==a.tables.attachments||n[1]!==t.messageId||n[2]!==t.threadKey?(l=function(){return o("ReQL").fromTableAscending(a.tables.attachments).getKeyRange(t.threadKey,t.messageId)},n[0]=a.tables.attachments,n[1]=t.messageId,n[2]=t.threadKey,n[3]=l):l=n[3];var s;n[4]!==a||n[5]!==t.messageId||n[6]!==t.threadKey?(s=[a,t.messageId,t.threadKey],n[4]=a,n[5]=t.messageId,n[6]=t.threadKey,n[7]=s):s=n[7];var u=o("ReQLSuspense").useArray(l,s,i.id+":99"),c;return n[8]!==u?(c=u.toSorted(b),n[8]=u,n[9]=c):c=n[9],c}function b(e,t){return(s||(s=o("I64"))).compare(e.attachmentIndex,t.attachmentIndex)}function v(e){var t,n,a,i=(s||(s=o("I64"))).to_int32(e.attachmentIndex),l=(t=p(_).attachmentCTAs[i])!=null?t:{},u=S(e),c=(l==null?void 0:l.defaultCta)==null&&(u==null?void 0:u.defaultCta)!=null||(l==null?void 0:l.attachmentCta1)==null&&(u==null?void 0:u.attachmentCta1)!=null;if(u!=null&&(n=u.attachmentCta1)!=null&&(n=n.type_)!=null&&n.includes("poll")||l!=null&&(a=l.attachmentCta1)!=null&&(a=a.type_)!=null&&a.includes("poll")){var d,m,f={attachmentIndex:i,contextCta1Type:(l==null||(d=l.attachmentCta1)==null?void 0:d.type_)||"null",contextHasCta1:(l==null?void 0:l.attachmentCta1)!=null,contextHasDefaultCta:(l==null?void 0:l.defaultCta)!=null,lsCta1Type:(u==null||(m=u.attachmentCta1)==null?void 0:m.type_)||"null",lsHasCta1:(u==null?void 0:u.attachmentCta1)!=null,lsHasDefaultCta:(u==null?void 0:u.defaultCta)!=null,messageId:e.messageId||"null",shouldUseFallback:c};r("FBLogger")("messenger_web_media","poll_cta_debug").info("Poll CTA debug: %s",JSON.stringify(f))}return c?(r("FBLogger")("messenger_web_media","attachment_context_missing").info("MWPAttachmentContext is not set, failed to retrieve attachmentCTAs from context, instead retrieved attachmentCTAs directly from LSDB"),u):l}function S(t){var n=(e||(e=r("useReStore")))(),o={};return o.defaultCta=R(n,t==null?void 0:t.defaultCtaId),o.attachmentCta1=R(n,t==null?void 0:t.attachmentCta1Id),o.attachmentCta2=R(n,t==null?void 0:t.attachmentCta2Id),o.attachmentCta3=R(n,t==null?void 0:t.attachmentCta3Id),o}function R(e,t){var n=o("react-compiler-runtime").c(4),r,a;return n[0]!==t||n[1]!==e?(r=function(){return t!=null?o("ReQL").fromTableAscending(e.tables.attachment_ctas).getKeyRange(t):o("ReQL").empty()},a=[e,t],n[0]=t,n[1]=e,n[2]=r,n[3]=a):(r=n[2],a=n[3]),o("ReQLSuspense").useFirst(r,a,i.id+":176")}function L(e){var t,n=(t=p(_).attachmentItems)!=null?t:[],o=E(e);return n.length===0&&o.length>0?(r("FBLogger")("messenger_web_media","attachment_context_missing").info("MWPAttachmentContext is not set, failed to retrieve attachmentItems from context, instead retrieved attachmentItems directly from LSDB"),o):n}function E(t){var n=o("react-compiler-runtime").c(6),a=(e||(e=r("useReStore")))(),l;n[0]!==t.attachmentFbid||n[1]!==a.tables.attachment_items?(l=function(){var e=t.attachmentFbid;return o("ReQL").fromTableAscending(a.tables.attachment_items).getKeyRange(e)},n[0]=t.attachmentFbid,n[1]=a.tables.attachment_items,n[2]=l):l=n[2];var s;return n[3]!==t||n[4]!==a?(s=[t,a],n[3]=t,n[4]=a,n[5]=s):s=n[5],o("ReQLSuspense").useArray(l,s,i.id+":206")}l.MWPAttachmentDataContext=_,l.MWPAttachmentDataContextProvider=f,l.MWPAttachmentDataContextProviderMAW=g,l.MWPAttachmentDataContextProviderLS=h,l.useMWPGetAttachments=y,l.useMWPGetAttachmentCTAs=v,l.useMWPGetAttachmentItems=L}),98);
__d("RollCallContributionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({MEDIA:0,TEXT:1,LINK:2});i.default=e}),66);
__d("RollCallPromptType",[],(function(t,n,r,o,a,i){var e=Object.freeze({MEDIA:0,TEXT:1,LINK:2});i.default=e}),66);
__d("MWPromptCreationUtils",["I64","LSAuthorityLevel","LSFactory","LSIntEnum","LSLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure","LSMessagingThreadAttributionType","LSOptimisticContributeToTextPromptStoredProcedure","LSOptimisticCreateRollCallStoredProcedure","LSShape","LSVec","MWXMAAttachmentSharedStackConstants","MessagingAttachmentType","OfflineThreadingId","Promise","ReQL","RollCallContributionType","RollCallPromptType","XComposerPhotoUploader"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(t,a,l,c){return new(u||(u=n("Promise")))(function(n,u){t.runInTransaction(function(t){return r("LSOptimisticCreateRollCallStoredProcedure")(r("LSFactory")(t),{prompt:l,promptType:(e||(e=o("LSIntEnum"))).ofNumber(c),threadKey:a})},"readwrite",void 0,void 0,i.id+":49").then(function(e){var a=e[0],i=o("ReQL").fromTableAscending(t.tables.roll_calls).subscribe(function(e,t){if(t.operation==="add"||t.operation==="put"){var l=t.value.offlineThreadingId,u=(s||(s=o("I64"))).to_int32(t.value.authorityLevel)>=r("LSAuthorityLevel").AUTHORITATIVE;u&&l!=null&&(s||(s=o("I64"))).equal(l,a)&&(i(),n(t.value.rollCallId))}})}).catch(function(e){u(e)})})}function d(e,t,n,a,l){return e.runInTransaction(function(e){return r("LSOptimisticContributeToTextPromptStoredProcedure")(r("LSFactory")(e),{productAttribution:String(r("LSMessagingThreadAttributionType").ROLLCALL),promptId:(s||(s=o("I64"))).to_string(a),senderId:t,text:l!=null?l:"",threadKey:n})},"readwrite",void 0,void 0,i.id+":91")}function m(t,n,a,l,u,c,d,m){var p,_=o("OfflineThreadingId").createOfflineThreadingID(),f=(p=m==null?void 0:m.startsWith("video/"))!=null?p:!1;return t.runInTransaction(function(t){return r("LSLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure")(r("LSFactory")(t),{extraSendMessageParams:o("LSShape").ofRecord({attachments:r("LSVec").ofArray([o("LSShape").ofRecord({attachment_fbid:_,attachment_index:(s||(s=o("I64"))).zero,attachment_type:(e||(e=o("LSIntEnum"))).ofNumber(f?r("MessagingAttachmentType").VIDEO:r("MessagingAttachmentType").IMAGE),has_media:!0,has_xma:!0,offline_attachment_id:_,playable_url:f?d:void 0,preview_height:s.of_float(o("MWXMAAttachmentSharedStackConstants").STACK_ITEM_HEIGHT),preview_url:f?void 0:d,preview_url_mime_type:f?void 0:m,preview_width:s.of_float(o("MWXMAAttachmentSharedStackConstants").STACK_ITEM_WIDTH)})]),contribution_type:e.ofNumber(r("RollCallContributionType").MEDIA),product_fbid:s.to_string(u),product_type:"roll_call",source:e.ofNumber(r("LSMessagingThreadAttributionType").ROLLCALL)}),senderId:n,text:c,threadKey:a,threadType:l})},"readwrite",void 0,void 0,i.id+":114").then(function(e){var t=e[0];return t})}function p(e,t,o,a,i,l,s,c,p){switch(s){case r("RollCallPromptType").MEDIA:return m(e,t,o,a,i,l,c,p);case r("RollCallPromptType").TEXT:return d(e,t,o,i,l);default:return(u||(u=n("Promise"))).reject("Unsupported type")}}function _(e,t,n,a){var i=o("OfflineThreadingId").createOfflineThreadingID(),l=e;l.uploadID=i;var u=new(r("XComposerPhotoUploader"))({onUploadFailure:function(t,n){},onUploadSuccess:function(t,n){},uploadEndpoint:"/messenger/upload_roll_call/"});u.getAsyncFileUploadRequest([l],[i],{data:{message_otid:n,roll_call_id:(s||(s=o("I64"))).to_string(t),thread_id:a}}).send()}l.createAuthoritiativeRollCall=c,l.createOptimisticRollCallMessage=p,l.startRollCallMediaUpload=_}),98);
__d("MWReportingUtils",["LSMessagingThreadTypeUtil","MWCMThreadTypes.react","MWPThreadIsPage.react"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t,n=(t=o("LSMessagingThreadTypeUtil")).isOneToOne(e),r=t.isGroup(e),a=t.isArmadilloSecure(e),i=o("MWPThreadIsPage.react").useIsPage(),l=t.isDiscoverableChannel(e),s=o("MWCMThreadTypes.react").isJoinedCMThread(e),u=t.isCMSubthread(e);return i&&!l?"messenger_p2b_direct_thread_details":n&&a?"messenger_encrypted_direct_thread":n&&!a?"messenger_direct_thread_details":s?"messenger_community_messaging_group_thread_details":r&&a?"messenger_encrypted_group_thread":r&&!a?"messenger_group_thread_details":u&&!a?"messenger_community_messaging_subthread_view":"unknown"}l.useGetNFXStoryLocationType=e}),98);
__d("MWV2MessageRowActionsContext.react",["emptyFunction","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.createContext,d=u.useContext,m={current:r("emptyFunction")},p={current:r("emptyFunction")},_={current:r("emptyFunction")},f={current:r("emptyFunction")},g={forwardMessage:m,openReactionsMenu:p,removeMessage:_,replyToMessage:f},h=c(g);function y(){return d(h)}function C(e){var t=o("react-compiler-runtime").c(3),n=e.children,r=e.value,a;return t[0]!==n||t[1]!==r?(a=s.jsx(h.Provider,{value:r,children:n}),t[0]=n,t[1]=r,t[2]=a):a=t[2],a}l.useMessageRowActionsContext=y,l.MWV2MessageRowActionsContextProvider=C}),98);
__d("MWV2OnlyGlobalRemoveMessageDialog.entrypoint",["JSResourceForInteraction"],(function(t,n,r,o,a,i,l){"use strict";var e={getPreloadProps:function(){return{}},root:r("JSResourceForInteraction")("MWV2OnlyGlobalRemoveMessageDialog.react").__setRef("MWV2OnlyGlobalRemoveMessageDialog.entrypoint")};l.default=e}),98);
__d("MWXDialog.react",["MWXColumn.react","MWXColumnItem.react","cr:3020","cr:6827","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["children","hasTextOnlyContent"],s=["scrollAreaFocusProps"],u,c=u||(u=o("react"));function d(t){var a=o("react-compiler-runtime").c(15),i,l,u;if(a[0]!==t?(l=t.children,u=t.hasTextOnlyContent,i=babelHelpers.objectWithoutPropertiesLoose(t,e),a[0]=t,a[1]=i,a[2]=l,a[3]=u):(i=a[1],l=a[2],u=a[3]),n("cr:3020")!=null){var d;if(a[4]!==i){var m=i,p=m.scrollAreaFocusProps,_=babelHelpers.objectWithoutPropertiesLoose(m,s);d=_,a[4]=i,a[5]=d}else d=a[5];var f;a[6]!==l?(f=c.jsx(r("MWXColumn.react"),{expanding:!0,paddingHorizontal:16,paddingVertical:16,children:c.jsx(r("MWXColumnItem.react"),{expanding:!0,children:l})}),a[6]=l,a[7]=f):f=a[7];var g;return a[8]!==d||a[9]!==f?(g=c.jsx(n("cr:3020"),babelHelpers.extends({},d,{children:f})),a[8]=d,a[9]=f,a[10]=g):g=a[10],g}if(n("cr:6827")!=null){var h;return a[11]!==i||a[12]!==l||a[13]!==u?(h=c.jsx(n("cr:6827"),babelHelpers.extends({hasTextOnlyContent:u},i,{children:l})),a[11]=i,a[12]=l,a[13]=u,a[14]=h):h=a[14],h}return null}l.default=d}),98);
__d("MWXDialogHeader.react",["cr:73","cr:7626","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["closeButtonTestId","mdsTitleLayout","showTruncationTooltip","title","titleImageAddOn","withoutDivider"],s,u=s||(s=o("react"));function c(t){var r=o("react-compiler-runtime").c(21),a,i,l,s,c,d,m;r[0]!==t?(i=t.closeButtonTestId,l=t.mdsTitleLayout,s=t.showTruncationTooltip,c=t.title,d=t.titleImageAddOn,m=t.withoutDivider,a=babelHelpers.objectWithoutPropertiesLoose(t,e),r[0]=t,r[1]=a,r[2]=i,r[3]=l,r[4]=s,r[5]=c,r[6]=d,r[7]=m):(a=r[1],i=r[2],l=r[3],s=r[4],c=r[5],d=r[6],m=r[7]);var p=s===void 0?!0:s;if(n("cr:7626")!=null){var _=c!=null?c:void 0,f;return r[8]!==a||r[9]!==i||r[10]!==p||r[11]!==_||r[12]!==d||r[13]!==m?(f=u.jsx(n("cr:7626"),babelHelpers.extends({closeTestID:i,text:_,titleImageAddOn:d},a,{showTruncationTooltip:p,withoutDivider:m})),r[8]=a,r[9]=i,r[10]=p,r[11]=_,r[12]=d,r[13]=m,r[14]=f):f=r[14],f}if(n("cr:73")!=null){var g;return r[15]!==a||r[16]!==i||r[17]!==l||r[18]!==c||r[19]!==d?(g=u.jsx(n("cr:73"),babelHelpers.extends({closeButtonTestId:i,title:c,titleImageAddOn:d,titleLayout:l},a)),r[15]=a,r[16]=i,r[17]=l,r[18]=c,r[19]=d,r[20]=g):g=r[20],g}return null}l.default=c}),98);
__d("MWXScrollableArea.react",["MDSScrollableArea.react"],(function(t,n,r,o,a,i,l){"use strict";l.default=r("MDSScrollableArea.react")}),98);
__d("MetaBrandExclamationTriangleFilled24Icon.react",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs("svg",babelHelpers.extends({viewBox:"0 0 24 24",fill:"currentColor",width:"1em",height:"1em"},e,{children:[e.title!=null&&s.jsx("title",{children:e.title}),e.children!=null&&s.jsx("defs",{children:e.children}),s.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.203 2.088a2.028 2.028 0 0 1 3.594 0l8.956 16.86C23.486 20.326 22.5 22 20.956 22H3.044c-1.545 0-2.53-1.673-1.797-3.053l8.956-16.859zm3.048 14.91c0 .6-.417 1-1.25 1-.834 0-1.25-.4-1.25-1s.416-1 1.25-1c.833 0 1.25.4 1.25 1zm-.375-8.125a.875.875 0 0 0-1.75 0v4.975a.875.875 0 1 0 1.75 0V8.873z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._isSVG=!0;var c=u;l.default=c}),98);
__d("MwbActorExperienceEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("3231"),s=o("FalcoLoggerInternal").create("mwb_actor_experience_event",e),u=s;l.default=u}),98);
__d("SubthreadCreationStrings.react",["fbt"],(function(t,n,r,o,a,i,l,s){"use strict";var e=s._(/*BTDS*/"Create sidechat"),u=s._(/*BTDS*/"See sidechat");l.createSubthreadLabel=e,l.viewSubthreadLabel=u}),226);
__d("XFBBotFeedbackKind.facebook",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["BOT_FEEDBACK_NEGATIVE","BOT_FEEDBACK_NEGATIVE_ACCURATE","BOT_FEEDBACK_NEGATIVE_CLARITY","BOT_FEEDBACK_NEGATIVE_DOESNT_LOOK_LIKE_THE_PERSON","BOT_FEEDBACK_NEGATIVE_DONT_SHOW_AGAIN","BOT_FEEDBACK_NEGATIVE_GENERIC","BOT_FEEDBACK_NEGATIVE_HALLUCINATION_INTERNAL_ONLY","BOT_FEEDBACK_NEGATIVE_HELPFUL","BOT_FEEDBACK_NEGATIVE_INCORRECT_OWNERSHIP","BOT_FEEDBACK_NEGATIVE_INTERESTING","BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_RESPONSE","BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT","BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING","BOT_FEEDBACK_NEGATIVE_OTHER","BOT_FEEDBACK_NEGATIVE_PERSONALIZED","BOT_FEEDBACK_NEGATIVE_REFUSED","BOT_FEEDBACK_NEGATIVE_SAFE","BOT_FEEDBACK_NEGATIVE_TOO_REPETITIVE","BOT_FEEDBACK_POSITIVE"]),l=e;i.default=l}),66);
__d("cdsPushToast",["BaseToasterStateManager","MetaBrandExclamationTriangleFilled24Icon.react","XMDSIcon.react","basePushToast","deferredLoadComponent","getToastDurationFromTextLength","react","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e=["action"],s,u=s||(s=o("react")),c=r("BaseToasterStateManager").getInstance(),d=r("deferredLoadComponent")(r("requireDeferred")("XMDSToast.react").__setRef("cdsPushToast")),m={LONG:5e3,MEDIUM:3e3};function p(t,n,a){var i=a?m[a]:void 0,l=n!=null?n:c;if(o("basePushToast").passesNewToastAPIGK())if(o("basePushToast").isInteractiveToast(t)){var s=o("basePushToast").pushPersistentToast(u.jsx(d,babelHelpers.extends({},t,{loadImmediately:!0,onDismiss:function(){return l.expire(s)}})),l);return s}else{var p=t.action,_=babelHelpers.objectWithoutPropertiesLoose(t,e),f=babelHelpers.extends({withoutCloseButton:!0},_),g=o("basePushToast").pushAlertToast(babelHelpers.extends({},f),u.jsx(d,babelHelpers.extends({},f,{loadImmediately:!0,onDismiss:function(){return l.expire(g)}})),l,i);return g}else{var h=l.push(u.jsx(d,babelHelpers.extends({},t,{loadImmediately:!0,onDismiss:function(){return l.expire(h)}})),i!=null?i:r("getToastDurationFromTextLength")(t.message.toString(),l));return h}}function _(e){return p({message:e})}function f(e,t,n){return p(babelHelpers.extends({},e,{addOnStart:u.jsx(r("XMDSIcon.react"),{icon:r("MetaBrandExclamationTriangleFilled24Icon.react"),size:24})}),t,n)}function g(e,t){var n=t!=null?t:c,r=n.push(u.jsx(d,babelHelpers.extends({},e,{loadImmediately:!0,onDismiss:function(){return n.expire(r)}})),1/0);return r}l.pushToast=p,l.pushSimpleToast=_,l.pushErrorToast=f,l.pushPersistentToast=g}),98);
__d("getMWOtherUserFBID",["I64","LSMessagingThreadTypeUtil","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t,n,r,a){var i=o("LSMessagingThreadTypeUtil").isOneToOne(a);if(!i)return null;var l=o("LSMessagingThreadTypeUtil").isArmadilloSecure(a);if(!l)return r;var s=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.tables.participants,["contactId"]).getKeyRange(r).filter(function(t){var r=t.contactId;return!(e||(e=o("I64"))).equal(r,n)}).take(1));return s==null?void 0:s.contactId}l.getMWOtherUserFBID=s}),98);
__d("handleMWV2NoMessageOrTurn",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";function e(){r("FBLogger")("gen_ai_feedback_actions").mustfix("Either message or turn must be provided")}l.default=e}),98);
__d("shouldUseImageGrouping",["I64","LSIntEnum"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t,n){var r,a=t.displayedContentTypes,i=t.groupId,l=(e||(e=o("I64"))).to_int32((r=t.groupSize)!=null?r:(e||(e=o("I64"))).zero);return n&&(e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(2))&&i!=null&&t.groupIndex!=null&&t.groupSize!=null&&l>1}l.default=u}),98);
__d("threadCreationUtils",["I64","LSIntEnum"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t,n){return(e||(e=o("I64"))).equal(t.creationStatus,(s||(s=o("LSIntEnum"))).ofNumber(n))}l.creationStatusEquals=u}),98);
__d("useGenAiFeedbackSubmittedToast",["fbt","cdsPushToast","handleMWV2NoMessageOrTurn","react","react-compiler-runtime","useMWXPushToast"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=(e||(e=o("react"))).useCallback;function c(e,t){var n=o("react-compiler-runtime").c(6),a=r("useMWXPushToast")(),i=d,l;n[0]!==e||n[1]!==a||n[2]!==t?(e?l=a:t?l=i:r("handleMWV2NoMessageOrTurn")(),n[0]=e,n[1]=a,n[2]=t,n[3]=l):l=n[3];var u;return n[4]!==l?(u=function(){l&&l({title:s._(/*BTDS*/"Feedback has been submitted")})},n[4]=l,n[5]=u):u=n[5],u}function d(e){var t=e.title;o("cdsPushToast").pushToast({message:t})}l.default=c}),226);
__d("useMWV2SubmitFeedbackAction",["LSFactory","LSIntEnum","LSSubmitGenAIBotFeedbackStoredProcedure","promiseDone","react","react-compiler-runtime","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=(u||(u=o("react"))).useCallback;function d(t,n,a){var l=o("react-compiler-runtime").c(5),u=(e||(e=r("useReStore")))(),c;return l[0]!==n||l[1]!==a||l[2]!==t||l[3]!==u?(c=function(l){r("promiseDone")(u.runInTransaction(function(e){return r("LSSubmitGenAIBotFeedbackStoredProcedure")(r("LSFactory")(e),{botFeedbackKind:(s||(s=o("LSIntEnum"))).ofNumber(l),botId:a,botResponseId:t||"",feedbackKindType:s.ofNumber(l)})},"readwrite",void 0,void 0,i.id+":32"),n)},l[0]=n,l[1]=a,l[2]=t,l[3]=u,l[4]=c):c=l[4],c}l.default=d}),98);
__d("useUGCAgentsSubmitFeedbackMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9600826256672927"}),null);
__d("useUGCAgentsSubmitFeedbackMutation.graphql",["useUGCAgentsSubmitFeedbackMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],kind:"ScalarField",name:"xfb_gen_ai_persona_submit_feedback",storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"useUGCAgentsSubmitFeedbackMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"useUGCAgentsSubmitFeedbackMutation",selections:t},params:{id:n("useUGCAgentsSubmitFeedbackMutation_facebookRelayOperation"),metadata:{},name:"useUGCAgentsSubmitFeedbackMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("useUGCAgentsSubmitFeedbackMutation",["fbt","BotFeedbackKind","FBLogger","RelayHooks","XFBBotFeedbackKind.facebook","cdsPushToast","objectEntries","react","react-compiler-runtime","useUGCAgentsSubmitFeedbackMutation.graphql"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=(u||(u=o("react"))).useCallback,d=e!==void 0?e:e=n("useUGCAgentsSubmitFeedbackMutation.graphql"),m=function(t){var e=r("objectEntries")(r("BotFeedbackKind")).find(function(e){var n=e[0],r=e[1];return r===t});if(e==null){r("FBLogger")("ugc_personas").mustfix("ugc_personas_could_not_convert_bot_feedback_kind_type");return}var n=r("XFBBotFeedbackKind.facebook").cast(e[0]);if(n==null){r("FBLogger")("ugc_personas").mustfix("ugc_personas_could_not_cast_bot_feedback_kind_type");return}return n};function p(e,t){var n=o("react-compiler-runtime").c(4),a=o("RelayHooks").useMutation(d),i=a[0],l;return n[0]!==t||n[1]!==i||n[2]!==e?(l=function(a){var n;e==null||e.setIsFeedbackSubmitted(!0);var l=m(a);l&&i({onCompleted:function(n){t()},onError:function(n){r("FBLogger")("ugc_personas").event("ugc_personas_submit_feedback_error").catching(n),o("cdsPushToast").pushToast({message:s._(/*BTDS*/"Something went wrong when submitting feedback. Please try again later.")}),e==null||e.setIsFeedbackSubmitted(!1)},variables:{input:{bot_feedback_kind:l,response_id:(n=e==null?void 0:e.responseId)!=null?n:"",surface:"AI_STUDIO_WEB"}}})},n[0]=t,n[1]=i,n[2]=e,n[3]=l):l=n[3],l}l.default=p}),226);
__d("useGenAiNegativeFeedback",["fbt","JSResourceForInteraction","handleMWV2NoMessageOrTurn","react-compiler-runtime","useGenAiFeedbackSubmittedToast","useMWV2SubmitFeedbackAction","useMWXLazyDialog","useUGCAgentsSubmitFeedbackMutation"],(function(t,n,r,o,a,i,l,s){"use strict";var e=r("JSResourceForInteraction")("MWV2SubmitNegativeFeedbackDialog.react").__setRef("useGenAiNegativeFeedback");function u(t,n){var a=o("react-compiler-runtime").c(13),i=r("useGenAiFeedbackSubmittedToast")(t,n),l="";if(t){var u;l=(u=t.botResponseId)!=null?u:""}else n?l=n.responseId:r("handleMWV2NoMessageOrTurn")();var c=r("useMWV2SubmitFeedbackAction")(l,i,t==null?void 0:t.threadKey),d=r("useUGCAgentsSubmitFeedbackMutation")(n,i),m;a[0]!==t||a[1]!==c||a[2]!==d||a[3]!==n?(t?m=c:n?m=d:r("handleMWV2NoMessageOrTurn")(),a[0]=t,a[1]=c,a[2]=d,a[3]=n,a[4]=m):m=a[4];var p=r("useMWXLazyDialog")(e),_=p[0],f;a[5]===Symbol.for("react.memo_cache_sentinel")?(f=s._(/*BTDS*/"Bad response"),a[5]=f):f=a[5];var g=f,h;a[6]!==t||a[7]!==m||a[8]!==_||a[9]!==n?(h=function(){return _({message:t,onSubmit:m,turn:n})},a[6]=t,a[7]=m,a[8]=_,a[9]=n,a[10]=h):h=a[10];var y=h,C;return a[11]!==y?(C=[y,g],a[11]=y,a[12]=C):C=a[12],C}l.default=u}),226);
__d("useGenAiPositiveFeedback",["fbt","BotFeedbackKind","MWMessageListLoggingContext","MessengerWebUXLogger","handleMWV2NoMessageOrTurn","react","useGenAiFeedbackSubmittedToast","useMWV2SubmitFeedbackAction","useUGCAgentsSubmitFeedbackMutation"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=u.useCallback,d=u.useMemo;function m(e,t){var n="";if(e){var a;n=(a=e.botResponseId)!=null?a:""}else t?n=t.responseId:r("handleMWV2NoMessageOrTurn")();var i=r("useGenAiFeedbackSubmittedToast")(e,t),l=r("useMWV2SubmitFeedbackAction")(n,i,e==null?void 0:e.threadKey),u=r("useUGCAgentsSubmitFeedbackMutation")(t,i),m;e?m=l:t?m=u:r("handleMWV2NoMessageOrTurn")();var p=o("MWMessageListLoggingContext").useFlowInstanceId(),_=d(function(){return{extraData:{botResponseId:n},flowInstanceId:p.current}},[n,p]),f=r("MessengerWebUXLogger").useInteractionLogger(),g=c(function(){m(r("BotFeedbackKind").BOT_FEEDBACK_POSITIVE),f==null||f(babelHelpers.extends({eventName:"submit_positive_feedback"},_))},[m,f,_]),h=s._(/*BTDS*/"Good response");return[g,h]}l.default=m}),226);
__d("useMediaDownloadStatusForGroup",["MAWMediaDownloadStatusUIStateType","react","react-compiler-runtime","useMAWMediaDownloadStatusBulk"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useMemo;function u(e,t,n){var a=o("react-compiler-runtime").c(19),i;e:{if(!t){var l;a[0]===Symbol.for("react.memo_cache_sentinel")?(l=[],a[0]=l):l=a[0],i=l;break e}var s;if(a[1]!==n||a[2]!==e){var u;a[4]!==n?(u=function(t){var e=t.attachment,r=t.mediaStatus;return e==null?null:{attachment:e,mediaRenderQpl:n,mediaStatus:r,statusKey:e.attachmentFbid}},a[4]=n,a[5]=u):u=a[5],s=e.map(u).filter(Boolean),a[1]=n,a[2]=e,a[3]=s}else s=a[3];i=s}var m=i,p=r("useMAWMediaDownloadStatusBulk")(m),_=p.uiStates,f,g;a[6]!==_?(g=_!=null?_:[],a[6]=_,a[7]=g):g=a[7],f=g;var h=f,y,C;a[8]!==h?(C=h.filter(d),a[8]=h,a[9]=C):C=a[9],y=C;var b=y,v,S;if(a[10]!==m||a[11]!==h){var R;a[13]!==h?(R=function(t,n){return t.attachment!=null&&o("MAWMediaDownloadStatusUIStateType").isRetryableErrorState(h[n])},a[13]=h,a[14]=R):R=a[14],S=m.filter(R).map(c),a[10]=m,a[11]=h,a[12]=S}else S=a[12];v=S;var L=v,E=b.length,k;return a[15]!==L||a[16]!==E||a[17]!==h?(k={attachmentsToRetryDownload:L,mediaDownloadErrorsCount:E,mediaDownloadStatuses:h},a[15]=L,a[16]=E,a[17]=h,a[18]=k):k=a[18],k}function c(e){var t=e.attachment,n=e.mediaStatus;return{attachment:t,mediaStatus:n}}function d(e){return o("MAWMediaDownloadStatusUIStateType").isErrorState(e)}l.default=u}),98);
__d("useGetMediaGroupInformation",["I64","MWMessageListDisplayContext.react","ReQL","ReQLSuspense","qex","react","shouldUseImageGrouping","useMediaDownloadStatusForGroup","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=(u||(u=o("react"))).useMemo;function d(t,n,a){var l,u,d,m,p,_=(e||(e=r("useReStore")))(),f=t.groupId,g=t.threadKey,h=(s||(s=o("I64"))).to_int32((l=t.groupIndex)!=null?l:(s||(s=o("I64"))).zero),y=s.to_int32((u=t.groupSize)!=null?u:(s||(s=o("I64"))).zero),C=o("MWMessageListDisplayContext.react").useMWMessageListDisplayContext(),b=C.isPinnedMessageList,v=r("shouldUseImageGrouping")(t,n),S=v?4:0;v&&y<4&&(S=y);var R=o("ReQLSuspense").useArray(function(){return v&&f!=null?o("ReQL").fromTableDescending(_.tables.messages.index("messageGroupId")).getKeyRange(f).map(function(e){var t,n=(t=o("ReQLSuspense").first(o("ReQL").fromTableDescending(_.tables.attachments).getKeyRange(g,e.messageId),i.id+":105"))!=null?t:null,r=n!=null?o("ReQLSuspense").first(o("ReQL").fromTableDescending(_.tables.client_media_status).getKeyRange(n.attachmentFbid),i.id+":113"):void 0;return{attachment:n,mediaStatus:r,message:e}}):o("ReQL").empty()},[_,f,g,v],i.id+":97"),L=c(function(){return R.sort(function(e,t){var n,r;return(s||(s=o("I64"))).to_int32((n=e.message.groupIndex)!=null?n:(s||(s=o("I64"))).zero)-s.to_int32((r=t.message.groupIndex)!=null?r:(s||(s=o("I64"))).zero)})},[R]),E=v&&L.length>=1?(d=L[0])==null?void 0:d.message:null,k=o("ReQLSuspense").useFirst(function(){if(!v||E==null)return o("ReQL").empty();var e;return r("qex")._("18")?e=o("ReQL").fromTableAscending(_.tables.messages.index("messageDisplayOrderOfflineThreadingId")).getKeyRange(E.threadKey).bounds({gte:o("ReQL").key(E.primarySortKey,E.offlineThreadingId)}):e=o("ReQL").fromTableAscending(_.tables.messages.index("messageDisplayOrder")).getKeyRange(E.threadKey).bounds({gte:o("ReQL").key(E.primarySortKey)}),e.filter(function(e){return e.groupId!==E.groupId}).filter(function(e){return!e.isAdminMessage})},[_,E,v],i.id+":141"),I=r("useMediaDownloadStatusForGroup")(L,v,a),T=I.attachmentsToRetryDownload,D=I.mediaDownloadErrorsCount,x=I.mediaDownloadStatuses;if(v!==!0)return null;var $=L.length>=1?(s||(s=o("I64"))).to_int32((m=(p=L[0])==null||(p=p.message)==null?void 0:p.groupIndex)!=null?m:(s||(s=o("I64"))).zero):0,P=h===$;if(b&&!P)return null;for(var N=new Array(S),M=function(t){var e=L.findIndex(function(e){return e.message.groupIndex!=null&&(s||(s=o("I64"))).to_int32(e.message.groupIndex)===t});e===-1?N[t]={attachment:null,message:null}:N[t]={attachment:L[e].attachment,message:L[e].message}},w=0;w<S&&w<S;++w)M(w);return{attachmentsToRetryDownload:T,groupId:f,groupIndex:h,groupSize:y,groupsLastMessage:L!=null&&L.length>0?L[L.length-1].message:null,groupsNextMessage:k!=null?k:null,hasAllMessagesSent:L.every(function(e){return(s||(s=o("I64"))).equal(e.message.sendStatusV2,s.of_int32(2))}),hasMissingMedia:L.some(function(e){return e.attachment==null}),hasMissingMessages:L.length!==y,isFirstMediaMessageInGroup:P,isMediaGroupLastMessage:k==null,mediaDownloadErrorsCount:D,mediaDownloadStatuses:x,messagesAndAttachments:L,messagesAndAttachmentsShownInGroup:N,tileSize:S}}l.default=d}),98);
__d("useMWV2LocalRemoveMessage",["I64","LSDict","LSIntEnum","LSTaskType","LSTasks","MWV2LogMessageClick","MessengerWebUXLogger","QPLUserFlow","Random","WebUserFlowLoggingDataContextProvider.react","promiseDone","qpl","react","react-compiler-runtime","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=c||(c=o("react")),m=d.useCallback,p=d.useContext;function _(){var t=o("react-compiler-runtime").c(4),n=(e||(e=r("useReStore")))(),a=p(o("WebUserFlowLoggingDataContextProvider.react").WebUserFlowLoggingDataContext),l=a.loggingDataRef,c=r("MessengerWebUXLogger").useInteractionLogger(),d;return t[0]!==n||t[1]!==c||t[2]!==l?(d=function(t){var e=r("qpl")._(25308285,"2002"),a=Date.now()+(Math.round(o("Random").random()*1e4)+1e4);r("QPLUserFlow").start(e,{annotations:{string:{isEphemeralMessage:t.ephemeralDurationInSec!=null||t.ephemeralExpirationTs!=null?"true":"false",type:"openDeleteMessageForMe"}},instanceKey:a}),o("MWV2LogMessageClick").log(n,t,46),r("promiseDone")(n.runInTransaction(function(n){return o("LSTasks").enqueue(n,r("LSTaskType").DeleteMessage,(s||(s=o("I64"))).to_string((u||(u=o("LSIntEnum"))).ofNumber(155)),new(r("LSDict"))([["message_id",t.messageId],["thread_key",t.threadKey]])).then(function(){c==null||c(babelHelpers.extends({},l.current,{eventName:"message_remove_success",eventType:"backend"})),r("QPLUserFlow").endSuccess(e,{instanceKey:a})}).catch(function(e){return c==null?void 0:c(babelHelpers.extends({},l.current,{eventName:"message_remove_failure",eventType:"backend",extraData:babelHelpers.extends({},l.current.extraData,{error:e.toString()})}))})},"readwrite",void 0,void 0,i.id+":57"))},t[0]=n,t[1]=c,t[2]=l,t[3]=d):d=t[3],d}l.default=_}),98);
__d("useHandleRemoveLocalMessage",["DeletionType.react","MessengerWebUXLogger","cr:9775","react","react-compiler-runtime","useGetMediaGroupInformation","useIsSecureMessage","useMWV2LocalRemoveMessage","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useCallback;function c(){return d}function d(e,t){}var m=n("cr:9775")||c;function p(t,n,a){var i=o("react-compiler-runtime").c(10),l=(e||(e=r("useReStore")))(),s=r("MessengerWebUXLogger").useInteractionLogger(),u;i[0]!==t?(u={fallbackThreadType:t},i[0]=t,i[1]=u):u=i[1];var c=r("useIsSecureMessage")(l,n,u),d=m(),p=r("useMWV2LocalRemoveMessage")(),_=r("useGetMediaGroupInformation")(n,c),f;return i[2]!==c||i[3]!==p||i[4]!==s||i[5]!==_||i[6]!==n||i[7]!==a||i[8]!==d?(f=function(t){s==null||s(babelHelpers.extends({},t,{eventName:"message_remove_confirm"})),c?d(n,_):p(n),a&&a(r("DeletionType.react").Local)},i[2]=c,i[3]=p,i[4]=s,i[5]=_,i[6]=n,i[7]=a,i[8]=d,i[9]=f):f=i[9],f}l.default=p}),98);
__d("useMWCMCreateSubthread",["fbt","FBLogger","Int64Hooks","LSCommunityThreadCreationStatus","LSCreateCommunitySubThreadStoredProcedure","LSFactory","LSLocalCreateOptimisticCommunityChatSubThreadStoredProcedure","LSPlatformWaitForTaskCompletion","LSThreadBitOffset","MWLSThread","ReQL","ReQLSuspense","emptyFunction","promiseDone","react","threadCreationUtils","useCommunityFolder","useMWXPushErrorToast","useOpenSubthreadView","useReStore"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react")),d=c.useEffect,m=c.useRef,p=c.useState;function _(t){var n=(e||(e=r("useReStore")))(),a=o("MWLSThread").useThreadExn(t.threadKey),l=r("useCommunityFolder")(a),u=m(r("emptyFunction")),c=r("useMWXPushErrorToast")(),_=p(!1),f=_[0],g=_[1],h=r("useOpenSubthreadView")(),y=o("LSThreadBitOffset").has(206,a);d(function(){return function(){u==null||u.current()}},[]);var C=o("Int64Hooks").useCallbackInt64(async function(){if(l!=null){var e=await n.runInTransaction(function(e){return r("LSLocalCreateOptimisticCommunityChatSubThreadStoredProcedure")(r("LSFactory")(e),{communityId:l.folderId,parentMessageId:t.messageId,parentThreadId:t.threadKey})},"readwrite",void 0,void 0,i.id+":65"),o=e[0];h(o,!0)}},[n,l,t.messageId,t.threadKey,h]),b=o("Int64Hooks").useCallbackInt64(function(){if(!y){var e=function(t){var e=t[0];if(e==null)return a();var l=o("ReQL").fromTableAscending(n.tables.thread_creation_status).getKeyRange(e),s=o("ReQLSuspense").first(l,i.id+":97");s==null||o("threadCreationUtils").creationStatusEquals(s,r("LSCommunityThreadCreationStatus").PENDING)?c():d(s);function c(){u.current=l.subscribe(function(e,t){if(t.operation!=="delete"){var n=t.value;o("threadCreationUtils").creationStatusEquals(n,r("LSCommunityThreadCreationStatus").PENDING)||(u.current(),d(n))}})}function d(e){g(!1);try{var t=e.threadId;if(o("threadCreationUtils").creationStatusEquals(e,r("LSCommunityThreadCreationStatus").FAILURE)||t==null)throw r("FBLogger")("cm_web").warn("sidechat creation failed");h(t,!0)}catch(e){a()}}},a=function(){g(!1),c({title:s._(/*BTDS*/"Sidechat creation failed")})};l!=null&&(g(!0),r("promiseDone")(r("LSPlatformWaitForTaskCompletion")(n,function(e){return r("LSCreateCommunitySubThreadStoredProcedure")(r("LSFactory")(e),{communityId:l.folderId,parentMessageId:t.messageId,parentThreadId:t.threadKey})},"createSocialChannel"),function(t){return e(t)},a))}},[n,l,y,t.messageId,t.threadKey,h,c]);return[y?C:b,f]}l.default=_}),226);
__d("useMWChatReactionsActionContainerProps.react",["I64","LSMessagingThreadTypeUtil","MAWPSendOrRemoveReaction.react","MWCMThreadTypes.react","MWChatMessageId","react","useIsReactionsV2Enabled"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e||(e=o("react")),c=u.useCallback,d=u.useMemo;function m(e,t,n,r,a,i){var l=o("LSMessagingThreadTypeUtil").isArmadilloSecure(n),u=(s||(s=o("I64"))).to_string(e.threadKey),m=s.to_string(e.timestampMs),p=d(function(){return o("MWChatMessageId").makeSent(u,e.messageId,m)},[u,e.messageId,m]),_=o("MAWPSendOrRemoveReaction.react").useSendOrRemoveReaction(e,l,"reaction_tray"),f=o("MWCMThreadTypes.react").isBroadcastThread(n),g=o("LSMessagingThreadTypeUtil").isDiscoverablePublicBroadcastChannel(n),h=o("useIsReactionsV2Enabled").useIsReactionsV2Enabled(e.threadKey),y=c(function(t,n){return r&&r(),_(e.messageId,n?void 0:t,n?"remove_reaction":"reaction")},[r,_,e.messageId]),C=h&&f;return{closeActionsMenu:t,disableCustomReactions:C,hasReactionsV2:h,isBroadcastChannel:g,isBroadcastThread:f,isSecure:l,messageID:p,onVisibilityChange:a,reactionsPopoverResource:i,sendReaction:y}}l.default=m}),98);
__d("useMWFalcoFeatureEventLogger",["MWFalcoFeatureEventLogger","MWPActor.react","getMWOtherUserFBID","react","react-compiler-runtime","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useCallback;function c(t,n){var a=o("react-compiler-runtime").c(5),i=(e||(e=r("useReStore")))(),l=o("MWPActor.react").useActor(),s;return a[0]!==l||a[1]!==i||a[2]!==t||a[3]!==n?(s=function(r,a){o("getMWOtherUserFBID").getMWOtherUserFBID(i,l,t,n).then(function(e){o("MWFalcoFeatureEventLogger").logEvent(r,a,e,t,n)}).catch(d)},a[0]=l,a[1]=i,a[2]=t,a[3]=n,a[4]=s):s=a[4],s}function d(){}l.default=c}),98);
__d("useMWV2ShouldDisableReactions.react",["LSMessagingThreadTypeUtil","ReQL","ReQLSuspense","isFeatureLimitEnabled","react-compiler-runtime","useIsReactionsV2Enabled","useIsReadOnlyFeatureLimitedWithThreadType","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n){var a=o("react-compiler-runtime").c(9),l;a[0]!==t?(l=o("LSMessagingThreadTypeUtil").isArmadilloSecure(t),a[0]=t,a[1]=l):l=a[1];var s=l,u=r("useIsReadOnlyFeatureLimitedWithThreadType")(t),c;a[2]!==u||a[3]!==s?(c=(!s||r("isFeatureLimitEnabled")())&&u,a[2]=u,a[3]=s,a[4]=c):c=a[4];var d=c,m=o("useIsReactionsV2Enabled").useIsReactionsV2Enabled(n),p=(e||(e=r("useReStore")))(),_;a[5]!==p.tables.reaction_v2_types?(_=function(){return o("ReQL").fromTableAscending(p.tables.reaction_v2_types)},a[5]=p.tables.reaction_v2_types,a[6]=_):_=a[6];var f;a[7]!==p?(f=[p],a[7]=p,a[8]=f):f=a[8];var g=o("ReQLSuspense").useFirst(_,f,i.id+":38")!=null;return d||m&&!g}l.default=s}),98);
__d("useSharedNUX",["CometNUXManagerContext","FBLogger","react","react-compiler-runtime","useNUXLoggers","useStable"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useContext,c=s.useEffect,d=s.useState;function m(e){var t=o("react-compiler-runtime").c(9),n;t[0]!==e?(n=function(){return e},t[0]=e,t[1]=n):n=t[1];var a=r("useStable")(n);a!==e&&r("FBLogger")("comet_ui").mustfix("Error nux changed at runtime from %s to %s, this is not supported and will lead to erratic behavior, we have continued to use your initially supplied nux",a!=null?a:"null",e!=null?e:"null");var i=d(!1),l=i[0],s=i[1],m=u(r("CometNUXManagerContext")),p=m.registerNUX,_=m.removeNUX,f,g;t[2]!==a||t[3]!==p?(f=function(){if(a!=null)return p(a,s,!0)},g=[a,p],t[2]=a,t[3]=p,t[4]=f,t[5]=g):(f=t[4],g=t[5]),c(f,g);var h=r("useNUXLoggers")(a,_),y;return t[6]!==l||t[7]!==h?(y=[l,h],t[6]=l,t[7]=h,t[8]=y):y=t[8],y}l.default=m}),98);
__d("useSubthreadInfoSafeForNonWork",["cr:13566"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return null}var s=n("cr:13566")!=null?n("cr:13566"):e;l.default=s}),98);